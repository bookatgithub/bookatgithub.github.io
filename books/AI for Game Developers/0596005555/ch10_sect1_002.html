<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>10.2 Fuzzy Logic Basics</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch10_sect1_001.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch10_sect1_003.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch10_sect1_002"></A>
<H3 class="docSection1Title" id="">10.2 Fuzzy Logic Basics</H3>
<P class="docText">Now that you have an idea of what fuzzy logic is all about and how you can use it in games, let's take a close look at how fuzzy logic works and is implemented. If the concept of fuzzy logic is still a little, well, fuzzy to you at this point, don't worry. The concepts will become much clearer as we go over the details in the next few sections.</P>
<A NAME="ch10_sect2_004"></A>
<H4 class="docSection2Title">10.2.4 Overview</H4>
<P class="docText">The fuzzy control or inference process comprises three basic steps. <A class="docLink" HREF="#ch10_fig01">Figure 10-1</A> illustrates these steps.</P>
<A NAME="ch10_fig01"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-1. Fuzzy process overview</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig01.jpg" ALT="figs/ch10_fig01.jpg">
</CENTER></p><br>
<P class="docText">The first part of the process is called the <span class="docEmphasis">fuzzification</span> process. In this step, a mapping process converts <span class="docEmphasis">crisp</span> data (real numbers) to fuzzy data. This mapping process involves finding the degree of membership of the crisp input in predefined fuzzy sets. For example, given a person's weight in pounds, we can find the degree to which the person is underweight, overweight, or at an ideal weight.</P>
<P class="docText">Once you have expressed all the inputs to the system in terms of fuzzy set membership, you can combine them using logical, fuzzy rules to determine the degree to which each rule is true. In other words, you can find the strength of each rule or the degree of membership in an output, or action, fuzzy set. For example, given a person's weight and activity level as input variables, we can define rules that look something such as the following:</P>
<UL><LI><P class="docList">If overweight AND NOT active then frequent exercise</P></LI><LI><P class="docList">If overweight AND active then moderate diet</P></LI></UL>
<P class="docText">These rules combine the fuzzy input variables using logical operators to yield a degree of membership, or degree or truth, of the corresponding output action, which in this case is the recommendation to engage in frequent exercise or go on a moderate diet.</P>
<P class="docText">Often, having a fuzzy output such as <span class="docEmphasis">frequent exercise</span> is not enough. We might want to quantify the amount of exercise—for example, three hours per week. This process of taking fuzzy output membership and producing a corresponding crisp numerical output is called <span class="docEmphasis">defuzzification</span>. Let's consider each step in more detail.</P>

<A NAME="ch10_sect2_005"></A>
<H4 class="docSection2Title">10.2.5 Fuzzification</H4>
<P class="docText">Input to a fuzzy system can originate in the form of crisp numbers. These are real numbers quantifying the input variables—for example, a person weighs 185.3 pounds or a person is 6 feet 1 inch tall. In the fuzzification process we want to map these crisp values to degrees of membership in qualitative fuzzy sets. For example, we might map 185.3 pounds to <span class="docEmphasis">slightly overweight</span> and 6 feet 1 inch to <span class="docEmphasis">tall</span>. You achieve this type of mapping using membership functions, also called <span class="docEmphasis">characteristic functions</span>.</P>
<A NAME="ch10_sect3_001"></A>
<H5 class="docSection3Title">10.2.1 Membership Functions</H5>
<P class="docText"><span class="docEmphasis">Membership functions</span> map input variables to a degree of membership, in a fuzzy set, between 0 and 1. If the degree of membership in a given set is 1, we can say the input for that set is absolutely true. If the degree is 0, we can say for that set the input is absolutely false. If the degree is somewhere between 0 and 1, it is true to a certain extent—that is, to a degree.</P>
<P class="docText">Before looking at fuzzy membership functions, let's consider the membership function for Boolean logic. <A class="docLink" HREF="#ch10_fig02">Figure 10-2</A> illustrates such a function.</P>
<A NAME="ch10_fig02"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-2. Boolean logic membership function</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig02.jpg" ALT="figs/ch10_fig02.jpg">
</CENTER></p><br>
<P class="docText">Here we see that input values lower than <span class="docEmphasis">x</span><SUB>0</SUB> are mapped to <span class="docEmphasis">false</span>, while values higher than <span class="docEmphasis">x</span><SUB>0</SUB> are mapped to <span class="docEmphasis">true</span>. There is no in-between mapping. Going back to the weight example, if <span class="docEmphasis">x</span><SUB>0</SUB> equals 170 pounds, anyone weighing more than 170 pounds is <span class="docEmphasis">overweight</span> and anyone weighing less than 170 pounds is <span class="docEmphasis">not overweight</span>. Even if a person weighs 169.9 pounds, he still is considered not overweight. Fuzzy membership functions enable us to transition gradually from <span class="docEmphasis">false</span> to <span class="docEmphasis">true</span>, or from <span class="docEmphasis">not overweight</span> to <span class="docEmphasis">overweight</span> in our example.</P>
<P class="docText">You can use virtually any function as a membership function, and the shape usually is governed by desired accuracy, the nature of the problem being considered, experience, and ease of implementation, among other factors. With that said, a handful of commonly used membership functions have proven useful for a wide variety of applications. We'll discuss those common membership functions in this chapter.</P>
<P class="docText">Consider the grade function illustrated in <A class="docLink" HREF="#ch10_fig03">Figure 10-3</A>.</P>
<A NAME="ch10_fig03"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-3. Grade membership function</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig03.jpg" ALT="figs/ch10_fig03.jpg">
</CENTER></p><br>
<P class="docText">Here you can see the gradual transition from 0 to 1. The range of x-values for which this function applies is called its <span class="docEmphasis">support</span>. For values less than <span class="docEmphasis">x</span><SUB>0</SUB>, the degree of membership is 0 or absolutely false, while for values greater than <span class="docEmphasis">x</span><SUB>1</SUB>, the degree is 1 or absolutely true. Between <span class="docEmphasis">x</span><SUB>0</SUB> and <span class="docEmphasis">x</span><SUB>1</SUB>, the degree of membership varies linearly.</P>
<P class="docText">Using the point-slope equation for a straight line, we can write the equation representing the grade membership function as follows:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq01.jpg" ALT="figs/ch10_ueq01.jpg">
<P class="docText">Going back to the weight example, let's say this function represents the membership for <span class="docEmphasis">overweight</span>. Let <span class="docEmphasis">x</span><SUB>0</SUB> equal 175 and <span class="docEmphasis">x</span><SUB>1</SUB> equal 195. If a person weighs 170 pounds, he is <span class="docEmphasis">overweight</span> to a degree of 0—that is, he is <span class="docEmphasis">not overweight</span>. If he weighs 185 pounds, he is <span class="docEmphasis">overweight</span> to a degree of 0.5—he's somewhat overweight.</P>
<P class="docText">Typically, we're interested in the degree to which an input variable falls within a number of qualitative sets. For example, we might want to know the degree to which a person is <span class="docEmphasis">overweight</span>, <span class="docEmphasis">underweight</span>, or at an <span class="docEmphasis">ideal</span> weight. In this case, we could set up a collection of sets, as illustrated in <A class="docLink" HREF="#ch10_fig04">Figure 10-4</A>.</P>
<A NAME="ch10_fig04"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-4. Fuzzy sets</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig04.jpg" ALT="figs/ch10_fig04.jpg">
</CENTER></p><br>
<A NAME="ch10_sdr001"></A><P><TABLE CELLSPACING="0" WIDTH="90%" BORDER="1" cellpadding="5"><TR><TD>
<H2 class="docSidebarTitle">Point-slope Equation for a Straight Line</H2>
<P class="docText">The equation for a straight line passing through the points (x<SUB>0</SUB>,y<SUB>0</SUB>) and (x<SUB>1</SUB> y<SUB>1</SUB>) is:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq02.jpg" ALT="figs/ch10_ueq02.jpg">
<P class="docText">where m is the slope of the line and is equal to:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq03.jpg" ALT="figs/ch10_ueq03.jpg">
</TD></TR></TABLE></P><br>
<P class="docText">With this sort of collection, we can calculate a given input value's membership in each of the three sets—<span class="docEmphasis">underweight</span>, <span class="docEmphasis">ideal</span>, and <span class="docEmphasis">overweight</span>. We might, for a given weight, find that a person is <span class="docEmphasis">underweight</span> to a degree of 0, <span class="docEmphasis">ideal</span> to a degree of 0.75, and <span class="docEmphasis">overweight</span> to a degree of 0.15. We can infer in this case that the person's weight is substantially ideal—that is, to a degree of 75%.</P>
<P class="docText">The triangular membership function shown in <A class="docLink" HREF="#ch10_fig04">Figure 10-4</A> is another common form of membership function. Referring to <A class="docLink" HREF="#ch10_fig05">Figure 10-5</A>, you can write the equation for a triangular membership function as follows:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq04.jpg" ALT="figs/ch10_ueq04.jpg">
<A NAME="ch10_fig05"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-5. Triangular membership function</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig05.jpg" ALT="figs/ch10_fig05.jpg">
</CENTER></p><br>
<P class="docText"><A class="docLink" HREF="#ch10_fig04">Figure 10-4</A> also shows a reverse-grade membership function for the <span class="docEmphasis">underweight</span> set. Referring to <A class="docLink" HREF="#ch10_fig06">Figure 10-6</A>, you can write the equation for the reverse grade as follows:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq05.jpg" ALT="figs/ch10_ueq05.jpg">
<A NAME="ch10_fig06"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-6. Reverse grade membership function</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig06.jpg" ALT="figs/ch10_fig06.jpg">
</CENTER></p><br>
<P class="docText">Another common membership function is the trapezoid function, as shown in <A class="docLink" HREF="#ch10_fig07">Figure 10-7</A>.</P>
<A NAME="ch10_fig07"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-7. Trapezoid membership function</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig07.jpg" ALT="figs/ch10_fig07.jpg">
</CENTER></p><br>
<P class="docText">You can write the trapezoid function as follows:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq06.jpg" ALT="figs/ch10_ueq06.jpg">
<P class="docText">Setting up collections of fuzzy sets for a given input variable, as shown in <A class="docLink" HREF="#ch10_fig04">Figure 10-4</A>, is largely a matter of judgment and trial and error. It's not uncommon to tune the arrangement of set membership functions to achieve desirable or optimum results. While tuning, you can try different shapes for each fuzzy set, or you can try using more or fewer fuzzy sets. Some fuzzy logic practitioners recommend the use of seven fuzzy sets to fully define the practical working range of any input variable. <A class="docLink" HREF="#ch10_fig08">Figure 10-8</A> illustrates such an arrangement.</P>
<A NAME="ch10_fig08"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-8. Seven fuzzy sets</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig08.jpg" ALT="figs/ch10_fig08.jpg">
</CENTER></p><br>
<P class="docText">The seven fuzzy sets shown in <A class="docLink" HREF="#ch10_fig08">Figure 10-8</A> are <span class="docEmphasis">center</span>, <span class="docEmphasis">near right</span>, <span class="docEmphasis">right</span>, <span class="docEmphasis">far right</span>, <span class="docEmphasis">near left</span>, <span class="docEmphasis">left</span>, and <span class="docEmphasis">far left</span>. These categories can be anything, depending on your problem. For example, to represent the alignment of player and nonplayer characters in your role-playing game, you might have fuzzy sets such as <span class="docEmphasis">neutral</span>, <span class="docEmphasis">neutral good</span>, <span class="docEmphasis">good</span>, <span class="docEmphasis">chaotic good</span>, <span class="docEmphasis">neutral evil</span>, <span class="docEmphasis">evil</span>, and <span class="docEmphasis">chaotic evil</span>.</P>
<P class="docText">Notice that each set in <A class="docLink" HREF="#ch10_fig04">Figures 10-4</A> and <A class="docLink" HREF="#ch10_fig08">10-8</A> overlaps immediately adjacent sets. This is important for smooth transitions. The generally accepted rule of thumb is that each set should overlap its neighbor by about 25%.</P>
<P class="docText">The membership functions we discussed so far are the most commonly used; however, other functions sometimes are employed when higher accuracy or nonlinearity is required. For example, some applications use Gaussian curves, while others use S-shaped curves. These are illustrated in <A class="docLink" HREF="#ch10_fig09">Figure 10-9</A>. For most applications and games, the piecewise linear functions discussed here are sufficient.</P>
<A NAME="ch10_fig09"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-9. Examples of other membership functions</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig09.jpg" ALT="figs/ch10_fig09.jpg">
</CENTER></p><br>
<P class="docText"><A class="docLink" HREF="#ch10exm01">Example 10-1</A> shows how the various membership functions we've discussed might look in code.</P>
<A NAME="ch10exm01"></A>
<H5 class="docExampleTitle">Example 10-1. Fuzzy membership functions</H5>
<PRE>
double     FuzzyGrade(double value, double x0, double x1)
{
      double result = 0;
      double x = value;
      if(x &lt;= x0)
            result = 0;
      else if(x &gt;= x1)
            result = 1;
      else
            result = (x/(x1-x0))-(x0/(x1-x0));
      return result;
}
double  FuzzyReverseGrade(double value, double x0, double x1)
{
      double result = 0;
      double x = value;
      if(x &lt;= x0)
            result = 1;
      else if(x &gt;= x1)
            result = 0;
      else
            result = (-x/(x1-x0))+(x1/(x1-x0));
      return result;
}
double     FuzzyTriangle(double value, double x0,
                               double x1, double x2)
{
      double result = 0;
      double x = value;
      if(x &lt;= x0)
             result = 0;
      else if(x == x1)
             result = 1;
      else if((x&gt;x0) &amp;&amp; (x&lt;x1))
             result = (x/(x1-x0))-(x0/(x1-x0));
      else
             result = (-x/(x2-x1))+(x2/(x2-x1));
      return result;
}
double     FuzzyTrapezoid(double value, double x0, double x1,
                                double x2, double x3)
{
      double result = 0;
      double x = value;
      if(x &lt;= x0)
             result = 0;
      else if((x&gt;=x1) &amp;&amp; (x&lt;=x2))
             result = 1;
      else if((x&gt;x0) &amp;&amp; (x&lt;x1))
             result = (x/(x1-x0))-(x0/(x1-x0));
      else
             result = (-x/(x3-x2))+(x3/(x3-x2));
      return result;
}
</PRE><BR>


<P class="docText">To determine the membership of a given input value in a particular set, you simply call one of the functions in <A class="docLink" HREF="#ch10exm01">Example 10-1</A>, passing the value and parameters that define the shape of the function. For example, <span class="docEmphasis">FuzzyTrapezoid(value, x0, x1, x2, x3)</span> determines the degree of membership of <span class="docEmphasis">value</span> in the set defined by <span class="docEmphasis">x0</span>, <span class="docEmphasis">x1</span>, <span class="docEmphasis">x2</span>, <span class="docEmphasis">x3</span> with a shape, as shown in <A class="docLink" HREF="#ch10_fig07">Figure 10-7</A>.</P>

<A NAME="ch10_sect3_002"></A>
<H5 class="docSection3Title">10.2.2 Hedges</H5>
<P class="docText"><span class="docEmphasis">Hedge functions</span> are sometimes used to modify the degree of membership returned by a membership function. The idea behind hedges is to provide additional linguistic constructs that you can use in conjunction with other logical operations. Two common hedges are VERY and NOT_VERY, which are defined as follows:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq07.jpg" ALT="figs/ch10_ueq07.jpg">
<P class="docText">Here, <span class="docEmphasis">Truth(A)</span> is the degree of membership of <span class="docEmphasis">A</span> in some fuzzy set. Hedges effectively change the shape of membership functions. For example, these hedges applied to piecewise linear membership functions will result in the linear portions of those membership functions becoming nonlinear.</P>
<P class="docText">Hedges are not required in fuzzy systems. You can construct membership functions to suit your needs without the additional hedges. We mention them here for completeness, as they often appear in fuzzy logic literature.</P>


<A NAME="ch10_sect2_006"></A>
<H4 class="docSection2Title">10.2.6 Fuzzy Rules</H4>
<P class="docText">After fuzzifying all input variables for a given problem, what we'd like to do next is construct a set of rules, combining the input in some logical manner, to yield some output. In an if-then style rule such as <span class="docEmphasis">if A then B</span>, the "if A" part is called the <span class="docEmphasis">antecedent</span>, or the premise. The "then B" part is called the <span class="docEmphasis">consequent</span>, or conclusion. We want to combine fuzzy input variables in a logical manner to form the premise, which will yield a fuzzy conclusion. The conclusion effectively will be the degree of membership in some predefined output fuzzy set.</P>
<A NAME="ch10_sect3_003"></A>
<H5 class="docSection3Title">10.2.3 Fuzzy Axioms</H5>
<P class="docText">If we're going to write logical rules given fuzzy input, we'll need a way to apply the usual logical operators to fuzzy input much like we would do for Boolean input. Specifically, we'd like to be able to handle <span class="docEmphasis">conjunction</span> (logical <span class="docEmphasis">AND</span>), <span class="docEmphasis">disjunction</span> (logical <span class="docEmphasis">OR</span>), and <span class="docEmphasis">negation</span> (logical <span class="docEmphasis">NOT</span>). For fuzzy variables, these logical operators typically are defined as follows:</P>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_ueq08.jpg" ALT="figs/ch10_ueq08.jpg">
<P class="docText">Here, again, <span class="docEmphasis">Truth(A)</span> means the degree of membership of <span class="docEmphasis">A</span> in some fuzzy set. This will be a real number between 0 and 1. The same applies for <span class="docEmphasis">Truth(B)</span> as well. As you can see, the logical <span class="docEmphasis">OR</span> operator is defined as the maximum of the operands, the <span class="docEmphasis">AND</span> operator is defined as the minimum of the operands, and <span class="docEmphasis">NOT</span> is simply 1 minus the given degree of membership.</P>
<P class="docText">Let's consider an example. Given a person is <span class="docEmphasis">overweight</span> to a degree of 0.7 and <span class="docEmphasis">tall</span> to a degree of 0.3, the logical operators defined earlier result in the following:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq09.jpg" ALT="figs/ch10_ueq09.jpg">
<P class="docText">In code, these logical operations are fairly trivial, as shown in <A class="docLink" HREF="#ch10exm02">Example 10-1</A>.</P>
<A NAME="ch10exm02"></A>
<H5 class="docExampleTitle">Example 10-2. Fuzzy logical operator functions</H5>
<PRE>
double FuzzyAND(double A, double B) {
   	return MIN(A, B);
}
double FuzzyOR(double A, double B) {
   	return MAX(A, B);
}
double FuzzyNOT(double A) {
   	return 1.0 - A;
}
</PRE><BR>


<P class="docText">These are not the only definitions used for <span class="docEmphasis">AND</span>, <span class="docEmphasis">OR</span>, and <span class="docEmphasis">NOT</span>. Some specific applications use other definitions—for example, you can define <span class="docEmphasis">AND</span> as the product of two degrees of membership, and you can define <span class="docEmphasis">OR</span> as the <span class="docEmphasis">probabilistic-OR</span>, as follows:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq10.jpg" ALT="figs/ch10_ueq10.jpg">
<P class="docText">Some third-party fuzzy logic tools even facilitate user-defined logical operators, making the possibilities endless. For most applications, however, the definitions presented here work well.</P>

<A NAME="ch10_sect3_004"></A>
<H5 class="docSection3Title">10.2.4 Rule Evaluation</H5>
<P class="docText">In a traditional Boolean logic application, rules such as <span class="docEmphasis">if A AND B then C</span> evaluate to absolutely <span class="docEmphasis">true</span> or <span class="docEmphasis">false</span> 1 or 0. After reading the previous section, you can see that this clearly is not the case using fuzzy logic. <span class="docEmphasis">A AND B</span> in fuzzy logic can evaluate to any number between 0 and 1, inclusive. This fact makes a fundamental difference in how fuzzy rules are evaluated versus Boolean logic rules.</P>
<P class="docText">In a traditional Boolean system, each rule is evaluated in series until one evaluates to <span class="docEmphasis">true</span> and it fires, so to speak—that is, its conclusion is processed. In a fuzzy rules system, all rules are evaluated in parallel. Each rule always fires; however, they fire to various degrees, or strengths. The result of the logical operations in each rule's premise yields the strength of the rule's conclusion. In other words, the strength of each rule represents the degree of membership in the output fuzzy set.</P>
<P class="docText">Let's say you have a video game and are using a fuzzy system to evaluate whether a creature should attack a player. The input variables are range, creature health, and opponent ranking. The membership functions for each variable might look something like those shown in <A class="docLink" HREF="#ch10_fig10">Figure 10-10</A>.</P>
<A NAME="ch10_fig10"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-10. Input variable membership functions</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig10.jpg" ALT="figs/ch10_fig10.jpg">
</CENTER></p><br>
<P class="docText">The output actions in this example can be <span class="docEmphasis">flee</span>, <span class="docEmphasis">attack</span>, or <span class="docEmphasis">do nothing</span>. We can write some rules that look something like the following:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq11.jpg" ALT="figs/ch10_ueq11.jpg">
<P class="docText">You can set up several more rules to handle more possibilities. In your game, all these rules would be evaluated to yield a degree of membership for each output action. Given specific degrees for the input variables, you might get outputs that look something like this:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq12.jpg" ALT="figs/ch10_ueq12.jpg">
<P class="docText">In code, evaluation of these rules would look something like that shown in <A class="docLink" HREF="#ch10exm03">Example 10-1</A>, where you can see a distinct difference from traditional if-then style rules.</P>
<A NAME="ch10exm03"></A>
<H5 class="docExampleTitle">Example 10-3. Fuzzy rules</H5>
<PRE>
degreeAttack = MIN(MIN (degreeMelee, degreeUninjured),
                               1.0 - degreeHard);
degreeDoNothing = MIN ( (1.0 - degreeMelee),
                               degreeUninjured);
degreeFlee = MIN (MIN ((1.0 - degreeOutOfRange),
                              (1.0 - degreeUninjured)),
                              (1.0 - degreeWimp));
</PRE><BR>


<P class="docText">The output degrees represent the strength of each rule. The easiest way to interpret these outputs is to take the action associated with the highest degree. In this example, the resulting action would be to <span class="docEmphasis">flee</span>.</P>
<P class="docText">In some cases, you might want to do more with the output than execute the action with the highest degree. For example, in the threat assessment case we discussed earlier in this chapter, you might want to use the fuzzy output to determine the number, a crisp number, of defensive units to deploy. To get a crisp number as an output, you have to defuzzify the results from the fuzzy rules.</P>


<A NAME="ch10_sect2_007"></A>
<H4 class="docSection2Title">10.2.7 Defuzzification</H4>
<P class="docText">Defuzzification is required when you want a crisp number as output from a fuzzy system. As we mentioned earlier, each rule results in a degree of membership in some output fuzzy set. Let's go back to our previous example. Say that instead of determining some finite action—do nothing, flee, or attack—you also want to use the output to determine the speed to which the creature should take action. For example, if the output action is to <span class="docEmphasis">flee</span>, does the creature walk away or run away, and how fast does it go? To get a crisp number, we need to aggregate the output strengths somehow and we need to define output membership functions.</P>
<P class="docText">For example, we might have output membership functions such as those shown in <A class="docLink" HREF="#ch10_fig11">Figure 10-11</A>.</P>
<A NAME="ch10_fig11"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-11. Output fuzzy sets</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig11.jpg" ALT="figs/ch10_fig11.jpg">
</CENTER></p><br>
<P class="docText">With the numerical output we discussed already—0.2 degree attack, 0.4 degree do nothing, and 0.7 degree flee—we'd end up with a composite membership function, as shown in <A class="docLink" HREF="#ch10_fig12">Figure 10-12</A>.</P>
<A NAME="ch10_fig12"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 10-12. Output membership function</H5>
<IMG BORDER="0" id="" SRC="images/0596005555/figs/ch10_fig12.jpg" ALT="figs/ch10_fig12.jpg">
</CENTER></p><br>
<P class="docText">To arrive at such a composite membership function, each output set is truncated to the output degree of membership for that set as determined by the strength of the rules. Then all output sets are combined using disjunction.</P>
<P class="docText">At this point, we still have only an output membership function and no single crisp number. We can arrive at a crisp number from such an output fuzzy set in many ways. One of the more common methods involves finding the geometric centroid of the area under the output fuzzy set and taking the corresponding horizontal axis coordinate of that center as the crisp output. This yields a compromise between all the rules—that is, the single output number is a weighted average of all the output memberships.</P>
<P class="docText">To find the center of area for such an output function, you have to integrate the area under the curve using numerical techniques. Or you can consider it a polygon and use computational geometry methods to find the center. There are other schemes as well. In any case, finding the center of area is computationally expensive, especially considering the large number of times such a calculation would be performed in a game. Fortunately, there's an easier way that uses so-called <span class="docEmphasis">singleton</span> output membership functions.</P>
<P class="docText">A singleton output function is really just a spike and not a curve. It is essentially a predefuzzified output function. For our example, we can assign speeds to each output action, such as -10 for <span class="docEmphasis">flee</span>, 1 for <span class="docEmphasis">do nothing</span>, and 10 for <span class="docEmphasis">attack</span>. Then, the resulting speed for <span class="docEmphasis">flee</span>, for example, would be the preset value of -10 times the degree to which the output action <span class="docEmphasis">flee</span> is <span class="docEmphasis">true</span>. In our example, we'd have -10 times 0.7, or -7 for the flee speed. (Here, the negative sign simply indicates <span class="docEmphasis">flee</span> as opposed to <span class="docEmphasis">attack</span>.) Considering the aggregate of all outputs requires a simple weighted average rather than a center of gravity calculation.</P>
<P class="docText">In general, let <span class="docEmphasis"><font face="symbol">m</font></span> be the degree to which an output set is true and let <span class="docEmphasis">x</span> be the crisp result, singleton, associated with the output set. The aggregate, defuzzified output would then be:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq13.jpg" ALT="figs/ch10_ueq13.jpg">
<P class="docText">In our example, we might have something such as:</P>
<IMG BORDER="0" id="" ALIGN="center" SRC="images/0596005555/figs/ch10_ueq14.jpg" ALT="figs/ch10_ueq14.jpg">
<P class="docText">Such an output when used to control the motion of the creature would result in the creature fleeing, but not necessarily in earnest.</P>
<P class="docText">To reinforce all the concepts we've discussed so far, let's consider a few examples in greater detail.</P>


<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch10_sect1_001.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch10_sect1_003.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
