<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>12.1 How Do You Use Probability in Games?</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch12.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch12_sect1_002.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch12_sect1_001"></A>
<H3 class="docSection1Title">12.1 How Do You Use Probability in Games?</H3>
<P class="docText">Bayesian analysis for decision making under uncertainty is fundamentally tied to probability. Genetic algorithms also use probability to some extent—for example, to determine mutation rates. Even neural networks can be coupled with probabilistic methods. We cover these rather involved methods to various extents later in this book.</P>
<A NAME="ch12_sect2_001"></A>
<H4 class="docSection2Title">12.2.1 Randomness</H4>
<P class="docText">Because the examples we discuss rely heavily on generating random numbers, let's look at some code to generate random numbers. The standard C function to generate a random number is <span class="docEmphasis">rand()</span>, which generates a random integer in the range from 0 to <span class="docEmphasis">RAND_MAX</span>. Typically <span class="docEmphasis">RAND_MAX</span> is set to 32727. To get a random integer between 0 and 99, use <span class="docEmphasis">rand() % 100</span>. Similarly, to get a random number between 0 and any integer <span class="docEmphasis">N-1</span>, use <span class="docEmphasis">rand() % N</span>. Don't forget to seed the random number generator once at the start of your program by calling <span class="docEmphasis">srand</span> (<span class="docEmphasis">seed</span>). Note that <span class="docEmphasis">srand</span> takes a single <span class="docEmphasis">unsigned int</span> parameter as the random seed with which to initialize the random number generator.</P>
<P class="docText">In a very simple example, say you decide to program a little randomness to unit movement in your game. In this case, you can say the unit, when confronted, will move left with a 25% probability or will move right with a 25% probability or will back up with a 50% probability. Given these probabilities, you need only generate a random number between 0 and 99 and perform a few tests to determine in which direction to move the unit. To perform these tests, we'll assign the range 0 to 24 as the possible range of values for the move-left event. Similarly, we'll assign the range of values 75 to 99 as the possible range of values for the move-right event. Any other value between 25 and 74 (inclusive) indicates the backup event. Once a random number is selected, we need only test within which range it falls and then make the appropriate move. Admittedly, this is a very simple example, and one can argue that this is not intelligent movement; however, developers commonly use this technique to present some uncertainty to the player, making it more difficult to predict where the unit will move when confronted.</P>

<A NAME="ch12_sect2_002"></A>
<H4 class="docSection2Title">12.2.2 Hit Probabilities</H4>
<P class="docText">Another common use of probabilities in games involves representing a creature or player's chances to hit an opponent in combat. Typically, the game developer defines several probabilities, given certain characteristics of the player and his opponent. For example, in a role-playing game you can say that a player with a moderate dexterity ranking has a 60% probability of striking his opponent with a knife in melee combat. If the player's dexterity ranking is high, you might give him better odds of successfully striking with a knife; for example, you can say he has a 90% chance of striking his opponent. Notice that these are essentially conditional probabilities. We're saying that the player's probability of success is 90% given that he is highly dexterous, whereas his probability of success is 60% given that he is moderately dexterous. In a sense, all probabilities are conditional on some other event or events, even though we might not explicitly state the condition or assign a probability to it, as we did formally in the previous section. In fact, it's common in games to make adjustments to such hit probabilities given other factors. For example, you can say that the player's probability of successfully striking his opponent is increased to 95% given that he possesses a "dagger of speed." Or, you can say the player's chances of success are reduced to 85% given his opponent's magic armor. You can come up with any number of these and list them in what commonly are called <span class="docEmphasis">hit probability tables</span> to calculate the appropriate probability given the occurrence or nonoccurrence of any number of enumerated events.</P>

<A NAME="ch12_sect2_003"></A>
<H4 class="docSection2Title">12.2.3 Character Abilities</H4>
<P class="docText">Yet another example of using probabilities in games is to define abilities of character classes or creature types. For example, say you have a role-playing game in which the player can take on the persona of a wizard, fighter, rouge, or ranger. Each class has its own strengths and weaknesses relative to the other classes, which you can enumerate in a table of skills with probabilities assigned so as to define each class's characteristics. <A class="docLink" HREF="#ch12_tab01">Table 12-1</A> gives a simple example of such a character class ability table.</P>
<A NAME="ch12_tab01"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 12.1. Character class ability</h5></CAPTION><COLGROUP><COL><COL><COL><COL><COL></COLGROUP><THEAD><TR><TH class="thead"><P class="docText">Ability</P></TH><TH class="thead"><P class="docText">Wizard</P></TH><TH class="thead"><P class="docText">Fighter</P></TH><TH class="thead"><P class="docText">Rouge</P></TH><TH class="thead"><P class="docText">Ranger</P></TH></TR></THEAD><TR><TD class="docTableCell"><P class="docText">Use magic</P></TD><TD class="docTableCell"><P class="docText">0.9</P></TD><TD class="docTableCell"><P class="docText">0.05</P></TD><TD class="docTableCell"><P class="docText">0.2</P></TD><TD class="docTableCell"><P class="docText">0.1</P></TD></TR><TR><TD class="docTableCell"><P class="docText">Wield sword</P></TD><TD class="docTableCell"><P class="docText">0.1</P></TD><TD class="docTableCell"><P class="docText">0.9</P></TD><TD class="docTableCell"><P class="docText">0.7</P></TD><TD class="docTableCell"><P class="docText">0.75</P></TD></TR><TR><TD class="docTableCell"><P class="docText">Harvest wood</P></TD><TD class="docTableCell"><P class="docText">0.3</P></TD><TD class="docTableCell"><P class="docText">0.5</P></TD><TD class="docTableCell"><P class="docText">0.6</P></TD><TD class="docTableCell"><P class="docText">0.8</P></TD></TR><TR><TD class="docTableCell"><P class="docText">Pick locks</P></TD><TD class="docTableCell"><P class="docText">0.15</P></TD><TD class="docTableCell"><P class="docText">0.1</P></TD><TD class="docTableCell"><P class="docText">0.05</P></TD><TD class="docTableCell"><P class="docText">0.5</P></TD></TR><TR><TD class="docTableCell"><P class="docText">Find traps</P></TD><TD class="docTableCell"><P class="docText">0.13</P></TD><TD class="docTableCell"><P class="docText">0.05</P></TD><TD class="docTableCell"><P class="docText">0.2</P></TD><TD class="docTableCell"><P class="docText">0.7</P></TD></TR><TR><TD class="docTableCell"><P class="docText">Read map</P></TD><TD class="docTableCell"><P class="docText">0.4</P></TD><TD class="docTableCell"><P class="docText">0.2</P></TD><TD class="docTableCell"><P class="docText">0.1</P></TD><TD class="docTableCell"><P class="docText">0.8</P></TD></TR><TR><TD class="docTableCell"><P class="docText">&#8230;</P></TD><TD class="docTableCell"><P class="docText">&#8230;</P></TD><TD class="docTableCell"><P class="docText">&#8230;</P></TD><TD class="docTableCell"><P class="docText">&#8230;</P></TD><TD class="docTableCell"><P class="docText">&#8230;</P></TD></TR></TABLE></P><br>
<P class="docText">Typically such character class tables are far more expansive than the few skills we show here. However, these serve to illustrate that each skill is assigned a probability of success, which is conditional on the character class. For example, a wizard has a 90% chance of successfully using magic, a fighter has a mere 5% chance, and so on. In practice these probabilities are further conditioned on the overall class level for each individual player. For example, a first-level wizard might have only a 10% chance of using magic. Here, the idea is that as the player earns levels, his proficiency in his craft will increase and the probabilities assigned to each skill will reflect this progress.</P>
<P class="docText">On the computer side of such a game's AI, all creatures in the world will have similar sets of probability tables defining their abilities given their type. For example, dragons would have a different set of proficiencies than would giant apes, and so on.</P>

<A NAME="ch12_sect2_004"></A>
<H4 class="docSection2Title">12.2.4 State Transitions</H4>
<P class="docText">You can take creature abilities a step further by combining probabilities with state transitions in the finite state machine that you can use to manage the various creature states. (See <A class="docLink" HREF="ch09.html#ch09">Chapter 9</A> for a discussion of finite state machines.) For example, <A class="docLink" HREF="#ch12_fig01">Figure 12-1</A> illustrates a few states that a creature can assume.</P>
<A NAME="ch12_fig01"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 12-1. Creature states</H5>
<IMG BORDER="0" SRC="images/0596005555/figs/ch12_fig01.jpg" ALT="figs/ch12_fig01.jpg">
</CENTER></p><br>
<P class="docText">Let's assume that this is one branch within a finite state machine that will be executed when the computer-controlled creature encounters the player. In the figure, <span class="docEmphasis">Conditions</span> are the necessary conditions that are checked in the finite state machine that would cause this set of states—Attack, Flee, Hide, etc.—to be considered. A condition could be something such as "the player is within range and has a weapon drawn." Instead of deterministically selecting a state for the creature, we can assign certain probabilities to each applicable state. For illustration purposes we show that there's a 50% chance the creature will attack the player. However, there's a 20% chance the creature will flee the scene, and there's a 10% chance it will try to hide. For even more variability, you can assign different probabilities to different types of creatures, making some more or less aggressive than others, and so on. Furthermore, within each creature type you can assign individual creatures different probabilities, giving each one their own distinct personality.</P>
<P class="docText">To select a state given probabilities such as these, you pick a random number between, say, 0 and 99, and check to see if it falls within specific ranges corresponding to each probability. Alternatively, you can take a lottery-type approach. In this case, you enumerate each state—for example, 0 for attack, 1 for flee, 2 for hide, and so on—and fill an array with these values in proportion to their probability. For example, for the attack state you'd fill half of the array with <span class="docEmphasis">0</span>s. Once the array is populated, you simply pick a random number from 0 to the maximum size of the array minus 1, and you use that as an index to the array to get the chosen state.</P>

<A NAME="ch12_sect2_005"></A>
<H4 class="docSection2Title">12.2.5 Adaptability</H4>
<P class="docText">A somewhat more compelling use of probability in games involves updating certain probabilities as the game is played in an effort to facilitate computer-controlled unit learning or adapting. For example, during a game you can collect statistics on the number and outcomes of confrontations between a certain type of creature and a certain class of player—for example, a wizard, fighter, and so on. Then you can calculate in real time the probability that the encounter results in the creature's death. This is essentially the relative frequency approach to determining probabilities. Once you have this probability, you can use it—rather, the creature can—when deciding whether to engage players of this class in combat. If the probability is high that a certain class of player will kill this type of creature, you can have creatures of this type start to avoid that particular class. On the other hand, if the probability suggests that the creature might do well against a particular type of player class, you can have the creature seek out players of that class.</P>
<P class="docText">We look at this type of analysis in the next chapter, where we show you how to calculate such things as given the probability that the player is of a certain class and the probability that death results from encounters with this class, what is the probability that death will result? You could take this a step further by not assuming that the creature knows in what class the player belongs. Instead, the creature's knowledge of the player can be uncertain, and it will have to infer what class he is facing to make a decision. Being able to collect statistics during gameplay and use probabilities for decisions clearly offers some interesting possibilities.</P>
<P class="docText">So far we discussed probability without actually giving it a formal definition. We need to do so before we move on to the next chapter on Bayesian methods. Further, we need to establish several fundamental rules of probability that you must know to fully appreciate the material in the next chapter. Therefore, in the remainder of this chapter we cover fundamental aspects of probability theory. If you're already up to speed on this material, you can skip right to the next chapter.</P>


<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch12.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch12_sect1_002.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
