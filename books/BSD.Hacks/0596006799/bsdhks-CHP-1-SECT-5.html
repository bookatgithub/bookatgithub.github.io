<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Hack 4 Use Terminal and X Bindings</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="bsdhks-CHP-1-SECT-4.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="bsdhks-CHP-1-SECT-6.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="bsdhks-CHP-1-SECT-5"></A>
<H3 class="docSection1Title">Hack 4 Use Terminal and X Bindings</H3><P class="docText"><IMG BORDER="0" ALIGN="absmiddle" width="14" height="36" SRC="images/0596006799/figs/beginner.gif" ALT="figs/beginner.gif"> <IMG BORDER="0" ALIGN="absmiddle" width="36" height="36" SRC="images/0596006799/figs/hack4.gif" ALT="figs/hack4.gif"></P>

<P class="docText"><span class="docEmphBold">Take advantage of your
terminal's capabilities</span>.</P>

<P class="docText">It's not just the <TT>tcsh</TT> shell that
is capable of understanding bindings. Your FreeBSD terminal provides
the <TT>kbdcontrol</TT> command to map commands to your
keyboard. Unfortunately, neither NetBSD nor OpenBSD offer this
feature. You can, however, remap your keyboard under X, as described
later.</P>

<A NAME="bsdhks-CHP-1-SECT-5.1"></A>

<H4 class="docSection2Title">1.5.1 Creating Temporary Mappings</H4>

<P class="docText">Let's start by experimenting with some temporary
mappings. The syntax for mapping a command with
<TT>kbdcontrol</TT> is as follows:</P>

<PRE>kbdcontrol -f <TT><I>number</I></TT> "<TT><I>command</I></TT>"</PRE><BR>


<P class="docText"><A class="docLink" HREF="#bsdhks-CHP-1-TABLE-2">Table 1-2</A> lists the possible numbers, each with
its associated key combination.</P>

<A NAME="bsdhks-CHP-1-TABLE-2"></A>
<P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 1-2. Key numbers</h5></CAPTION><COLGROUP><COL><COL></COLGROUP><THEAD><TR><TH class="docTableHeader">
<P class="docText">Number</P>
</TH><TH class="docTableHeader">
<P class="docText">Key combination</P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText">1, 2, . . . 12</P>
</TD><TD class="docTableCell">
<P class="docText">F1, F2, . . . F12</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">13, 14, . . . 24</P>
</TD><TD class="docTableCell">
<P class="docText">Shift+F1, Shift+F2, . . . Shift+F12</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">25, 26, . . . 36</P>
</TD><TD class="docTableCell">
<P class="docText">Ctrl+F1, Ctrl+F2, . . . Ctrl+F12</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">37, 38, . . . 48</P>
</TD><TD class="docTableCell">
<P class="docText">Shift+Ctrl+F1, Shift+Ctrl+F2, . . . Shift+Ctrl+F12</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">49</P>
</TD><TD class="docTableCell">
<P class="docText">Home</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">50</P>
</TD><TD class="docTableCell">
<P class="docText">Up arrow</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">51</P>
</TD><TD class="docTableCell">
<P class="docText">Page Up</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">52</P>
</TD><TD class="docTableCell">
<P class="docText">Numpad - (Num Lock off)</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">53</P>
</TD><TD class="docTableCell">
<P class="docText">Left arrow (also works in editor)</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">54</P>
</TD><TD class="docTableCell">
<P class="docText">Numpad 5 (without Num Lock)</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">55</P>
</TD><TD class="docTableCell">
<P class="docText">Right arrow</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">56</P>
</TD><TD class="docTableCell">
<P class="docText">Numpad + (without Num Lock)</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">57</P>
</TD><TD class="docTableCell">
<P class="docText">End</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">58</P>
</TD><TD class="docTableCell">
<P class="docText">Down arrow (affects c history)</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">59</P>
</TD><TD class="docTableCell">
<P class="docText">Page Down</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">60</P>
</TD><TD class="docTableCell">
<P class="docText">Ins</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">61</P>
</TD><TD class="docTableCell">
<P class="docText">Del</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">62</P>
</TD><TD class="docTableCell">
<P class="docText">Left GUI key (Windows icon next to left Ctrl)</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">63</P>
</TD><TD class="docTableCell">
<P class="docText">Right GUI key (Windows icon next to right Alt)</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">64</P>
</TD><TD class="docTableCell">
<P class="docText">Menu (menu icon next to right Ctrl)</P>
</TD></TR></TABLE></P><br>

<P class="docText">Those last three key combinations may or may not be present,
depending upon your keyboard. My Logitech keyboard has a key with a
Windows icon next to the left Ctrl key; that is the left GUI key.
There's another key with a Windows icon next to my
right Alt key; this is the right GUI key. The next key to the right
has an icon of a cursor pointing at a square containing lines; that
is the Menu key.</P>

<P class="docText">Now that we know the possible numbers, let's map
<TT>lynx</TT> to the Menu key:</P>

<PRE>% <B>kbdcontrol -f 64 "lynx"</B></PRE><BR>


<P class="docText">Note that the command must be contained within quotes and be in your
path. (You <span class="docEmphasis">could</span> give an absolute path, but
there's a nasty limitation coming up soon.)</P>

<P class="docText">If I now press the Menu key, <TT>lynx</TT> is typed to the
terminal for me. I just need to press Enter to launch the browser.
This may seem a bit tedious at first, but it is actually quite handy.
It can save you from inadvertently launching the wrong application if
you're anything like me and tend to forget which
commands you've mapped to which keys.</P>

<P class="docText">Let's see what happens if I modify that original
mapping somewhat:</P>

<PRE>% <B>kbdcontrol -f 64 "lynx www.google.ca"</B>
kbdcontrol: function key string too long (18 &gt; 16)</PRE><BR>


<P class="docText">When doing your own mappings, beware that the command and its
arguments can't exceed 16 characters. Other than
that, you can pretty well map any command that strikes your fancy.</P>


<A NAME="bsdhks-CHP-1-SECT-5.2"></A>

<H4 class="docSection2Title">1.5.2 Shell Bindings Versus Terminal Bindings</H4>

<P class="docText">Before going any further, I'd like to pause a bit
and compare shell-specific bindings, which we saw in  <A class="docLink" HREF="bsdhks-CHP-1-SECT-4.html#bsdhks-CHP-1-SECT-4"><span class="docEmphBold">[Hack #3]</span></A>, and the terminal-specific
bindings we're running across here.</P>

<P class="docText">One advantage of using <TT>kbdcontrol</TT> is that your
custom bindings work in any terminal, regardless of the shell you
happen to be using. A second advantage is that you can easily map to
any key on your keyboard. Shell mappings can be complicated if you
want to map them to anything other than "Ctrl
letter".</P>

<P class="docText">However, the terminal mappings have some restrictions that
don't apply to the <TT>tcsh</TT> mappings.
For example, shell mappings don't have a 16
character restriction, allowing for full pathnames. Also, it was
relatively easy to ask the shell to press Enter to launch the desired
command.</P>

<P class="docText">Terminal bindings affect only the current user's
terminal. Any other users who are logged in on different terminals
are not affected. However, if the mappings are added to
<I>rc.conf</I> (which only the superuser can do), they
will affect all terminals. Since bindings are terminal specific, even
invoking <TT>su</TT> won't change the
behavior, as the user is still stuck at the same terminal.</P>


<A NAME="bsdhks-CHP-1-SECT-5.3"></A>

<H4 class="docSection2Title">1.5.3 More Mapping Caveats</H4>

<P class="docText">There are some other caveats to consider when choosing which key to
map. If you use the tcsh shell and enjoy viewing your history  <A class="docLink" HREF="bsdhks-CHP-1-SECT-2.html#bsdhks-CHP-1-SECT-2"><span class="docEmphBold">[Hack #1]</span></A>, you'll be
disappointed if you remap your up and down arrows. The right and left
arrows can also be problematic if you use them for navigation, say,
in a text editor. Finally, if you're physically
sitting at your FreeBSD system, F1 through F8 are already mapped to
virtual terminals and F9 is mapped to your GUI terminal. By default,
F10 to F12 are unmapped.</P>

<P class="docText">If you start experimenting with mappings and find
you're stuck with one you don't
like, you can quickly return all of your keys to their default
mappings with this command:</P>

<PRE>% <B>kbdcontrol -F</B></PRE><BR>


<P class="docText">On the other hand, if you find some new mappings you absolutely
can't live without, make them permanent. If you have
superuser privileges on a FreeBSD system you physically sit at, you
can carefully add the mappings to <I>/etc/rc.conf</I>.
Here, I've added two mappings. One maps
<TT>lynx</TT> to the Menu key and the other maps
<TT>startx</TT> to the left GUI key:</P>

<PRE>keychange="64 lynx"
keychange="62 startx"</PRE><BR>


<P class="docText">Since the superuser will be setting these mappings, the mapped keys
will affect all users on that system. If you want to save your own
personal mappings, add your specific <TT>kbdcontrol</TT>
commands to the end of your shell configuration file. For example,
I've added these to the very end of my
<I>~/.cshrc</I> file, just before the last line which
says <TT>endif</TT>:</P>

<PRE>% <B>kbdcontrol -f 64 "lynx"</B>
% <B>kbdcontrol -f 62 "startx"</B></PRE><BR>



<A NAME="bsdhks-CHP-1-SECT-5.4"></A>

<H4 class="docSection2Title">1.5.4 Making Mappings Work with X</H4>

<P class="docText">This is all extremely handy, but what will happen if you try one of
your newly mapped keys from an X Window session? You can press that
key all you want, but nothing will happen. You won't
even hear the sound of the system bell beeping at you in protest.
This is because the X protocol handles all input and output during an
X session.</P>

<P class="docText">You have a few options if you want to take advantage of keyboard
bindings while in an X GUI. One is to read the documentation for your
particular window manager. Most of the newer window managers provide
a point and click interface to manage keyboard bindings. My favorite
alternative is to try the <TT>xbindkeys_config</TT>
application, which is available in the ports collection  <A class="docLink" HREF="bsdhks-CHP-8-SECT-9.html#bsdhks-CHP-8-SECT-9"><span class="docEmphBold">[Hack #84]</span></A> :</P>

<PRE># <B>cd /usr/ports/x11/xbindkeys_config</B>
# <B>make install clean</B></PRE><BR>


<P class="docText">This port also requires <TT>xbindkeys</TT>:</P>

<PRE># <B>cd /usr/ports/x11/xbindkeys</B>
# <B>make install clean</B></PRE><BR>


<P><table border="0" bgcolor="black" cellspacing="0" cellpadding="1" width="90%" align="center"><tr><td><table bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="6"><tr><td width="60" valign="top"><img src="images/pushpin.gif" width="52" height="51"></td><td valign="top">
<P class="docText">Rather than building both ports, you could instead add this line to
<I>/usr/ports/x11/xbindkeys_config/Makefile</I>:</P>

<PRE>BUILD_DEPENDS=  xbindkeys:${PORTSDIR}/x11/xbindkeys</PRE><BR>


<P class="docText">This will ask the <TT>xbindkeys_config</TT> build to
install both ports.</P>
</td></tr></table></td></tr></table></P><br>

<P class="docText">Once your builds are complete, open an <TT>xterm</TT> and
type:</P>

<PRE>% <B>xbindkeys --defaults  ~/.xbindkeysrc</B>
% <B>xbindkeys_config</B></PRE><BR>


<P class="docText">The GUI in <A class="docLink" HREF="#bsdhks-CHP-1-FIG-1">Figure 1-1</A> will appear.</P>

<A NAME="bsdhks-CHP-1-FIG-1"></A>
<p><CENTER>
<H5 class="docFigureTitle">Figure 1-1. The xbindkeys_config program</H5>
<IMG BORDER="0" width="431" height="288" SRC="images/0596006799/figs/bsdh_0101.gif" ALT="figs/bsdh_0101.gif"></CENTER></p><br>

<P class="docText">Creating a key binding is a simple matter of pressing the New button
and typing a useful name into the Name: section. Then, press Get Key
and a little window will appear. Press the desired key combination,
and voil&agrave;, the correct mapping required by X will autofill
for you. Associate your desired Action:, then press the Save &amp;
Apply &amp; Exit button.</P>

<P class="docText">Any keyboard mappings you create using this utility will be saved to
a file called <I>~/.xbindkeysrc</I>.</P>


<A NAME="bsdhks-CHP-1-SECT-5.5"></A>

<H4 class="docSection2Title">1.5.5 See Also</H4>
<UL><LI><P class="docList"><TT>man kbdcontrol</TT> </P></LI><LI><P class="docList"><TT>man atkbd</TT> </P></LI><LI><P class="docList">The <TT>xbindkeys</TT> web site (<A class="docLink" target="_blank" HREF="http://hocwp.free.fr/xbindkeys/xbindkeys.html">http://hocwp.free.fr/xbindkeys/xbindkeys.html</A>)</P></LI></UL>



<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="bsdhks-CHP-1-SECT-4.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="bsdhks-CHP-1-SECT-6.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
