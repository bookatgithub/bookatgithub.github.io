<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Hack 89 How'd He Know That?</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="bsdhks-CHP-9-SECT-1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="bsdhks-CHP-9-SECT-3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="bsdhks-CHP-9-SECT-2"></A>
<H3 class="docSection1Title">Hack 89 How'd He Know That?</H3><P class="docText"><IMG BORDER="0" id="134053078072" ALIGN="absmiddle" width="14" height="36" SRC="images/0596006799/figs/beginner.gif" ALT="figs/beginner.gif"> <IMG BORDER="0" id="134053078072" ALIGN="absmiddle" width="36" height="36" SRC="images/0596006799/figs/hack89.gif" ALT="figs/hack89.gif"></P>
<P class="docText"><span class="docEmphBold">Make the most of your available resources.</span></P>
<P class="docText">Unless you've achieved Unix guru status, you
probably find yourself asking "how did he know
that?" whenever you're around other
Unix users or read a really cool snippet in a book.
Here's a little secret: he probably had to look it
up. As I tell my students, "No one knows everything.
Make sure the one thing you do know is where to go to get the
information you need."</P>

<A NAME="bsdhks-CHP-9-SECT-2.1"></A>

<H4 class="docSection2Title">9.2.1 Online Resources</H4>

<P class="docText">If <A NAME="bsdhks-CHP-9-ITERM-3129"></A>
you're using
<A NAME="bsdhks-CHP-9-ITERM-3130"></A>
 <A NAME="bsdhks-CHP-9-ITERM-3131"></A>
FreeBSD, there is no shortage of
well-written documentation. If you haven't already,
bookmark the FreeBSD Documentation page at <A class="docLink" target="_blank" HREF="http://www.freebsd.org/docs">http://www.freebsd.org/docs</A>.</P>

<P class="docText">There you'll find hyperlinks to the four handbooks,
the FAQ, how-to articles, online manpages, as well as other sources
of information. There's a very good chance that
someone else has already documented what you want to do.</P>


<A NAME="bsdhks-CHP-9-SECT-2.2"></A>

<H4 class="docSection2Title">9.2.2 Keeping Offline Resources Up-to-Date</H4>

<P class="docText">Online <A NAME="bsdhks-CHP-9-ITERM-3132"></A>
resources are great, but what if
you don't always have access to an Internet
connection? If you installed the <TT>doc</TT> distribution,
you already have most of those resources on your hard drive.
You'll find the handbooks, FAQ, and articles in
<I>/usr/share/doc</I>. That directory contains symlinks
so you can quickly navigate to the desired resource.</P>

<P><table border="0" bgcolor="black" cellspacing="0" cellpadding="1" width="90%" align="center"><tr><td><table bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="6"><tr><td width="60" valign="top"><img src="images/pushpin.gif" width="52" height="51"></td><td valign="top">
<P class="docText">If you haven't installed the <TT>doc</TT>
directory structure, you can do so through
<TT>/stand/sysinstall</TT>. Enter
<TT>Configuration</TT>, then
<TT>Distributions</TT>, and use your spacebar to select
<TT>doc</TT>.</P>
</td></tr></table></td></tr></table></P><br>

<P class="docText">The online resources receive daily updates, so be sure to update your
docs when you use <TT>cvsup</TT>. Make sure your
<I>cvsup</I> file includes this line:</P>

<PRE>doc-all tag=.</PRE><BR>


<P><table border="0" bgcolor="black" cellspacing="0" cellpadding="1" width="90%" align="center"><tr><td><table bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="6"><tr><td width="60" valign="top"><img src="images/pushpin.gif" width="52" height="51"></td><td valign="top">
<P class="docText">If you're not using cvsup  <A class="docLink" HREF="bsdhks-CHP-8-SECT-5.html#bsdhks-CHP-8-SECT-5"><span class="docEmphBold">[Hack #80]</span></A>  yet, you have no idea what
you're missing!</P>
</td></tr></table></td></tr></table></P><br>

<P class="docText">As <TT>cvsup</TT> retrieves the latest docs, it will write
them to <I>/usr/doc</I>. This will
<span class="docEmphasis">not</span> overwrite or update existing files in
<I>/usr/share/doc</I>. Also, if you've
ever poked about <I>/usr/doc</I>, you probably noticed
that the resources themselves are written in SGML, making them a bit
hard to read (unless you enjoy wading through tags).</P>

<P class="docText">How do you merge in those new changes? It's going to
require a conversion of SGML to HTML. To achieve that, first install
the <TT>docproj-nojadetex</TT> port:</P>

<PRE># <B>cd /usr/ports/textproc/docproj-nojadetex</B> 
# <B>make install clean</B></PRE><BR>


<P class="docText">Then:</P>

<PRE># <B>cd /usr/doc</B>
# <B>make install clean</B></PRE><BR>


<P class="docText">This will merge all of the changes into the HTML files in
<I>/usr/share/doc</I>. If you add this step to your
<TT>cvsup</TT> routine, your offline resources will always
be up-to-date.</P>


<A NAME="bsdhks-CHP-9-SECT-2.3"></A>

<H4 class="docSection2Title">9.2.3 What Did the Manpage Forget to Say?</H4>

<P class="docText">Have <A NAME="bsdhks-CHP-9-ITERM-3133"></A>
 <A NAME="bsdhks-CHP-9-ITERM-3134"></A>
 <A NAME="bsdhks-CHP-9-ITERM-3135"></A>
you ever read a manpage and been unclear on
how a certain switch worked? Perhaps you thought you understood the
syntax until you tried it out and only managed to produce syntax
<A NAME="bsdhks-CHP-9-ITERM-3136"></A>
error
messages? Even more maddeningly, you might scour the Internet for
concrete examples only to find endless links to the same manpage!</P>

<P class="docText">When this happens to me, I consider the program's
source as a possible answer. If you're thinking,
"I'm not a programmer; I
couldn't read source code if my life depended on
it," don't just skip to the next
hack. You can still read comments, and most source in the FreeBSD
core is very well commented.</P>

<P class="docText">Here's an example. I was reading through
<TT>man mac_portacl</TT>, which indicates that the rule MIB
takes this syntax:</P>

<PRE>idtype:id:protocol:port[,idtype:id:protocol:port,...]</PRE><BR>


<P class="docText">but didn't give a specific example of a working
rule. Since this particular MAC policy doesn't do
anything until you successfully create a rule, I was looking for a
more concrete example of an effective rule. And, since this module is
fairly new, there weren't any tutorials or how-tos
on the Internet. So, before hitting the mailing lists, I took a peek
at the source.</P>

<P class="docText">To locate any C source file, use the <TT>locate</TT>
<A NAME="bsdhks-CHP-9-ITERM-3137"></A>
command. Pass
it the name of what you're looking for, followed by
a <TT>.c</TT>. For example:</P>

<PRE>% <B>locate mac_portacl.c</B>
/usr/src/sys/security/mac_portacl/mac_portacl.c</PRE><BR>


<P class="docText">You must have <TT>src</TT> installed in order for this to
work, and, as indicated, it will only find source code written in C.
Happily, that's most of the FreeBSD core. You can
use <TT>/sys/sysinstall</TT> to install all of the
<TT>src</TT> distributions. If disk space is an issue or
it's not appropriate to install source on the system
you're logged into, you can read the source online
at <A class="docLink" target="_blank" HREF="http://minnie.tuhs.org/FreeBSD-srctree/FreeBSD.html">http://minnie.tuhs.org/FreeBSD-srctree/FreeBSD.html</A>.</P>

<P class="docText">If you have <TT>src</TT> installed but
don't see any results or do receive an error message
that your database is too small, update the database and try again:</P>

<PRE>% <B>su</B>
Password:
# <B>/usr/libexec/locate.updatedb</B>
&gt;&gt;&gt; WARNING
&gt;&gt;&gt; Executing updatedb as root. This WILL reveal all filenames
&gt;&gt;&gt; on your machine to all login users, which is a security risk.
# <B>exit</B></PRE><BR>


<P class="docText">Once you've located the source file, skim through
its comments:</P>

<PRE>% <B>grep '*' /usr/src/sys/security/mac_portacl/mac_portacl.c | tail +30</B></PRE><BR>


<P class="docText">Here, I told <TT>grep</TT> to search for an asterisk
(<TT>*</TT>), since C comments always include one. If you
forget to enclose the asterisk within single quotes
(''), you won't receive any
results, as it is also a shell wildcard. You may want to adjust
<TT>tail +30</TT> for your own purposes. Source code begins
with anywhere from 25 to 40 lines of copyright and licensing
comments. Here I've told <TT>tail</TT> to
ignore the first (<TT>+</TT>) 30 lines of comments.</P>

<P class="docText">In this particular case, the comments included the example I hoped
for:</P>

<PRE>* # sysctl security.mac.portacl.rules="uid:425:tcp:80,uid:425:tcp:79"
*
* This ruleset, for example, permits uid 425 to bind TCP ports 80 (http)
* and 79 (finger).  User names and group names can't be used directly
* because the kernel only knows about uids and gids.</PRE><BR>


<P class="docText">Your mileage will vary, but source is definitely another <A NAME="bsdhks-CHP-9-ITERM-3138"></A>
resource <A NAME="bsdhks-CHP-9-ITERM-3139"></A>
 <A NAME="bsdhks-CHP-9-ITERM-3140"></A>
 <A NAME="bsdhks-CHP-9-ITERM-3141"></A>
at <A NAME="bsdhks-CHP-9-ITERM-3142"></A>
 <A NAME="bsdhks-CHP-9-ITERM-3143"></A>
your disposal.</P>


<A NAME="bsdhks-CHP-9-SECT-2.4"></A>

<H4 class="docSection2Title">9.2.4 See Also</H4>
<UL><LI><P class="docList"><TT>man hier</TT> (includes a description of the contents of <I>/usr/share/doc/</I>)</P></LI><LI><P class="docList"><TT>man tail</TT></P></LI></UL>


<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="bsdhks-CHP-9-SECT-1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="bsdhks-CHP-9-SECT-3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
