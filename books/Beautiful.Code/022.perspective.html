<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link href="styles/globalstyle.css" type="text/css" rel="stylesheet"/>
<link title="medium" href="styles/two.css" type="text/css" rel="stylesheet"/>
<script src="scripts/main.js" type="text/javascript" language="javascript"></script>
<title>Section 3.3. Perspective</title>
</head><body>
<DIV class=h3 style="MARGIN-TOP: 0px; PADDING-BOTTOM: 1em; WIDTH: 100%; PADDING-TOP: 0px"><SPAN>The Most Beautiful Code I Never Wrote</SPAN><SPAN> &gt; Perspective</SPAN></DIV>
<DIV></DIV>
<DIV>
<DIV><A name=perspective></A>
<H3 class=docSection1Title id=-100000>3.3. Perspective</H3>
<P class=docText><A class=docLink href="javascript:moveTo('evolution_of_quicksort_comparison_counting');">Table 3-2</A><A name="summarizes the"></A> summarizes the programs used to analyze Quicksort throughout this chapter.</P><A name=evolution_of_quicksort_comparison_counting></A>
<P>
<TABLE cellSpacing=0 width="100%" border=1>
<CAPTION>
<H5 class=docTableTitle><A name="Quicksort comparison"></A>Table 3-2. Evolution of Quicksort comparison counting</H5></CAPTION>
<COLGROUP span=6>
<COL>
<COL>
<COL>
<COL>
<COL>
<COL></COLGROUP>
<THEAD>
<TR>
<TH class="docTableCell thead" scope=col>Example Number </TH>
<TH class="docTableCell thead" scope=col>Lines of code </TH>
<TH class="docTableCell thead" scope=col>Type of answer </TH>
<TH class="docTableCell thead" scope=col>Number of answer </TH>
<TH class="docTableCell thead" scope=col>Runtime </TH>
<TH class="docTableCell thead" scope=col>Space </TH></TR></THEAD>
<TBODY>
<TR>
<TD class=docTableCell>2 </TD>
<TD class=docTableCell>13 </TD>
<TD class=docTableCell>Sample </TD>
<TD class=docTableCell>1 </TD>
<TD class=docTableCell><TT><I>n</I></TT> <TT>l</TT> <SPAN class=docEmphasis>g</SPAN> <TT><I>n</I></TT> </TD>
<TD class=docTableCell><TT><I>N</I></TT> </TD></TR>
<TR>
<TD class=docTableCell>3 </TD>
<TD class=docTableCell>13 </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD></TR>
<TR>
<TD class=docTableCell>4 </TD>
<TD class=docTableCell>8 </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell><TT><I>n</I></TT> </TD>
<TD class=docTableCell>lg<TT><I>n</I></TT> </TD></TR>
<TR>
<TD class=docTableCell>5 </TD>
<TD class=docTableCell>8 </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD></TR>
<TR>
<TD class=docTableCell>6 </TD>
<TD class=docTableCell>6 </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD></TR>
<TR>
<TD class=docTableCell>7 </TD>
<TD class=docTableCell>6 </TD>
<TD class=docTableCell>Exact </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>3<TT><I>N</I></TT> </TD>
<TD class=docTableCell><TT><I>N</I></TT> </TD></TR>
<TR>
<TD class=docTableCell>8 </TD>
<TD class=docTableCell>6 </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell><TT><I>N</I></TT> </TD>
<TD class=docTableCell><TT><I>N<SUP>2</SUP></I></TT> </TD>
<TD class=docTableCell><TT><I>N</I></TT> </TD></TR>
<TR>
<TD class=docTableCell>9 </TD>
<TD class=docTableCell>6 </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD></TR>
<TR>
<TD class=docTableCell>10 </TD>
<TD class=docTableCell>6 </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD></TR>
<TR>
<TD class=docTableCell>11 </TD>
<TD class=docTableCell>4 </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell>" </TD>
<TD class=docTableCell><TT><I>N</I></TT> </TD>
<TD class=docTableCell>" </TD></TR>
<TR>
<TD class=docTableCell>12 </TD>
<TD class=docTableCell>4 </TD>
<TD class=docTableCell>Exact </TD>
<TD class=docTableCell><TT><I>N</I></TT> </TD>
<TD class=docTableCell><TT><I>N</I></TT> </TD>
<TD class=docTableCell>1 </TD></TR></TBODY></TABLE></P><BR>
<P class=docText><A name="in the"></A>Each individual step in the evolution of our code was pretty straightforward; the transition from the sample in <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_skeleton_implemented_as_a_function">Example 3-6</A><A name="exact answer"></A> to the exact answer in <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_average_comparisons_as_pseudocode">Example 3-7</A><A name="most subtle"></A> is probably the most subtle. Along the way, as the code became faster and more useful, it also shrank in size. In the middle of the 19th century, Robert Browning observed that "less is more," and this table helps to quantify one instance of that minimalist philosophy.</P>
<P class=docText>We have seen three fundamentally different types of programs. <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_inner_loop_instrumented_to_count_comparisons">Example 3-2</A> and <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_inner_loop_with_increment_moved_out_of_loop">Example 3-3</A><A name="real array"></A> are working Quicksorts, instrumented to count comparisons as they sort a real array. <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_skeleton_reduced_to_counting">Example 3-4</A> through <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_skeleton_implemented_as_a_function">Example 3-6</A><A name="simple model"></A> implement a simple model of Quicksort: they mimic one run of the algorithm, without actually doing the work of sorting. <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_average_comparisons_as_pseudocode">Example 3-7</A> through <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_calculationmdashfinal_version">Example 3-12</A><A name="they compute"></A> implement a more sophisticated model: they compute the true average number of comparisons without ever tracing any particular run.</P>
<P class=docText>The <A name=idx-CHP-3-0131></A><A name="program are"></A>techniques used to achieve each program are summarized as follows:</P>
<UL>
<LI>
<P class=docList><A name=idx-CHP-3-0132></A><A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_inner_loop_instrumented_to_count_comparisons">Example 3-2</A>, <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_skeleton_reduced_to_counting">Example 3-4</A>, <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_average_comparisons_as_pseudocode">Example 3-7</A><A name="Fundamental change"></A>: Fundamental change of problem definition.</P></LI>
<LI>
<P class=docList><A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_skeleton_with_single_size_argument">Example 3-5</A>, <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_skeleton_implemented_as_a_function">Example 3-6</A>, <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_calculationmdashfinal_version">Example 3-12</A><A name="function definition"></A>: Slight change of function definition.</P></LI>
<LI>
<P class=docList><A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_calculation_with_dynamic_programming">Example 3-8</A><A name="to implement"></A>: New data structure to implement dynamic programming.</P></LI></UL>
<P class=docText><A name="are typical"></A>These techniques are typical. We can often simplify a program by asking, "What problem do we really need to solve?" or, "Is there a better function to solve that problem?"</P>
<P class=docText><A name="this analysis"></A>When I presented this analysis to undergraduates, the program finally shrank to zero lines of code and disappeared in a puff of mathematical smoke. We can reinterpret <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_average_comparisons_as_pseudocode">Example 3-7</A> as the following recurrence relation:</P>
<P class=docText><IMG id="" height=58 alt="" src="images/perspective.0.png" width=500 border=0> </P>
<P class=docText>This is precisely the approach taken by <A name=idx-CHP-3-0133></A>Hoare and later presented by D. E. <A name=idx-CHP-3-0134></A>Knuth in his classic <SPAN class=docEmphasis>The Art of Computer Programming, Volume 3: Sorting and Searching</SPAN> (Addison-Wesley). The programming tricks of <A name=idx-CHP-3-0135></A>re-expression and symmetry that give rise to <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_calculation_with_symmetry">Example 3-10</A> allow us to simplify the recursive part to:<A name=idx-CHP-3-0136></A></P>
<P class=docText><IMG id="" height=74 alt="" src="images/perspective.1.png" width=390 border=0> </P>
<P class=docText>Knuth's technique to remove the summation sign gives (roughly) <A class=docLink href="021.more_and_more_with_less_and_less.html#quicksort_calculation_with_the_inner_loop_removed">Example 3-11</A><A name="in two"></A>, which can be re-expressed as a system of two recurrence relations in two unknowns as:</P>
<P class=docText><SPAN class=docEmphasis>C<SUB>0</SUB> = 0 S<SUB>0</SUB> = 0 S<SUB>n</SUB> = S<SUB>n-1</SUB> + 2C<SUB>n-1</SUB> C<SUB>n</SUB> = n - 1 + S<SUB>n</SUB>/n</SPAN> </P>
<P class=docText><A name="the mathematical"></A>Knuth uses the mathematical technique of a <A name=idx-CHP-3-0137></A>"summing factor" to achieve the solution:</P>
<P class=docText><SPAN class=docEmphasis>C<SUB>n</SUB></SPAN> = (<SPAN class=docEmphasis>n + 1</SPAN>)(2<SPAN class=docEmphasis>H<SUB>n+1</SUB></SPAN>-2) - 2<SPAN class=docEmphasis><SUB>n</SUB></SPAN> ~ 1.386<SPAN class=docEmphasis>nlgn</SPAN></P>
<P class=docText>where H<SPAN class=docEmphasis><SUB>n</SUB></SPAN> denotes the <SPAN class=docEmphasis>n</SPAN><TT><I><SUP>th</SUP></I></TT> harmonic number, 1 + 1/2 + 1/3 + … 1/<SPAN class=docEmphasis>n</SPAN><A name="progressed from"></A>. Thus we have smoothly progressed from experimenting on a program by augmenting it with probes to a completely mathematical analysis of its behavior.</P>
<P class=docText><A name="We have"></A>With this formula, we end our quest. We have followed Einstein's famous advice to "make everything as simple as possible, but no simpler."</P><A name=a_bonus_analysis></A>
<H4 class=docSection2Title id=title-ID0E5JDK>3.3.1. A Bonus Analysis</H4>
<P class=docText><A name="Goethe famously"></A>Goethe famously said that "architecture is frozen music." In exactly that sense, I assert that <A name=idx-CHP-3-0138></A><A name="And if"></A>"data structures are frozen algorithms." And if we freeze the Quicksort algorithm, we get the data structure of a binary search tree. Knuth's publication presents that structure and analyzes its runtime with a recurrence relation similar to that for Quicksort.</P>
<P class=docText><A name="to analyze"></A>If we wanted to analyze the average cost of <A name=idx-CHP-3-0139></A><A name="element into"></A>inserting an element into a <A name=idx-CHP-3-0140></A><A name="could start"></A>binary search tree, we could start with the code, augment it to count comparisons, and then conduct experiments on the data we gather. We could then simplify that code (and expand its power) in a manner very reminiscent of the previous section. A simpler solution is to define a new <A name=idx-CHP-3-0141></A>Quicksort that uses an <SPAN class=docEmphasis>ideal partitioning</SPAN><A name="on both"></A> method that leaves the elements in the same relative order on both sides. That Quicksort is isomorphic to binary search trees, as illustrated in <A name=idx-CHP-3-0142></A><A class=docLink href="javascript:moveTo('an_ideal_partitioning_quicksort_and_the_corresponding_binary');">Figure 3-1</A>.<A name=idx-CHP-3-0143></A></P><A name=an_ideal_partitioning_quicksort_and_the_corresponding_binary></A>
<P>
<CENTER>
<H5 class=docFigureTitle><A name="ideal partitioning"></A>Figure 3-1. An ideal partitioning Quicksort and the corresponding binary search tree</H5><IMG id="" height=198 alt="" src="images/perspective.2.png" width=500 border=0> </CENTER>
<P></P><BR>
<P class=docText><A name="left show"></A>The boxes on the left show an ideal-partitioning Quicksort in progress, and the graph on the right shows the corresponding binary search tree that has been built from the same input. Not only do the two processes make the same <SPAN class=docEmphasis>number</SPAN><A name=same></A> of comparisons, they make exactly the same <SPAN class=docEmphasis>set</SPAN><A name="of comparisons"></A> of comparisons. Our previous analysis for the average performance of randomizing Quicksort on a set of distinct elements therefore gives us the average number of comparisons to insert randomly permuted distinct elements into a binary search tree.</P></DIV></DIV>
<p>&nbsp;</p><p>&nbsp;</p><!-- 仁·义 -->
</body></html>
