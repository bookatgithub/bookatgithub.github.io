<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link href="styles/globalstyle.css" type="text/css" rel="stylesheet"/>
<link title="medium" href="styles/two.css" type="text/css" rel="stylesheet"/>
<script src="scripts/main.js" type="text/javascript" language="javascript"></script>
<title>Section 23.3. Other MapReduce Examples</title>
</head><body>
<DIV class=h3 style="MARGIN-TOP: 0px; PADDING-BOTTOM: 1em; WIDTH: 100%; PADDING-TOP: 0px"><SPAN>Distributed Programming with MapReduce</SPAN><SPAN> &gt; Other MapReduce Examples</SPAN></DIV>
<DIV></DIV>
<DIV>
<DIV><A name=other_mapreduce_examples></A>
<H3 class=docSection1Title id=-100000>23.3. Other MapReduce Examples</H3>
<P class=docText><A name="examine the"></A>We'll examine the implementation of a much more sophisticated driver program that automatically runs MapReduce programs on large-scale clusters of machines in a moment, but first, let's consider a few other problems and how they can be solved using Map-Reduce:<A name=idx-CHP-23-1908></A></P><A name=idx-CHP-23-1909></A><A name=idx-CHP-23-1910></A><A name=idx-CHP-23-1911></A><A name=idx-CHP-23-1912></A><A name=idx-CHP-23-1913></A><A name=idx-CHP-23-1914></A><A name=idx-CHP-23-1915></A><A name=idx-CHP-23-1916></A><A name=idx-CHP-23-1917></A><A name=idx-CHP-23-1918></A>
<DL class=docList>
<DT><BR>
<P><SPAN class=docPubcolor><SPAN class=docEmphasis>Distributed grep</SPAN> </SPAN></P></DT>
<DD>
<P class=docList><A name="emits a"></A>The Map function emits a line if it matches a supplied regular expression pattern. The Reduce function is an identity function that just copies the supplied intermediate data to the output.<A name=idx-CHP-23-1909></A></P></DD>
<DT><BR>
<P><SPAN class=docPubcolor><SPAN class=docEmphasis>Reverse web-link graph</SPAN> </SPAN></P></DT>
<DD>
<P class=docList>A <A name=idx-CHP-23-1910></A><A name="a graph"></A>forward web-link graph is a graph that has an edge from node URL1 to node URL2 if the web page found at URL1 has a hyperlink to URL2. A <A name=idx-CHP-23-1911></A><A name="is the"></A>reverse web-link graph is the same graph with the edges reversed. <A name=idx-CHP-23-1912></A><A name="be used"></A>MapReduce can easily be used to construct a reverse web-link graph. The Map function outputs <SPAN class=docEmphasis>&lt;target, source&gt;</SPAN><A name="a document"></A> pairs for each link to a target URL found in a document named <SPAN class=docEmphasis>source</SPAN><A name="function concatenates"></A>. The Reduce function concatenates the list of all source URLs associated with a given target URL and emits the pair <SPAN class=docEmphasis>&lt;target, list of source URLs&gt;</SPAN>.<A name=idx-CHP-23-1913></A></P></DD>
<DT><BR>
<P><SPAN class=docPubcolor><SPAN class=docEmphasis>Term vector per host</SPAN> </SPAN></P></DT>
<DD>
<P class=docList><A name="the most"></A>A term vector summarizes the most important words that occur in a document or a set of documents as a list of <SPAN class=docEmphasis>&lt;word, frequency&gt;</SPAN> pairs. The Map function emits a <SPAN class=docEmphasis>&lt;hostname, term vector&gt;</SPAN><A name="the hostname"></A> pair for each input document (where the hostname is extracted from the URL of the document). The Reduce function is passed all per-document term vectors for a given host. It adds these term vectors, throwing away infrequent terms, and then emits a final <SPAN class=docEmphasis><A name="term vector"></A>&lt;hostname, term vector&gt;</SPAN> pair.<A name=idx-CHP-23-1914></A></P></DD>
<DT><BR>
<P><SPAN class=docPubcolor><SPAN class=docEmphasis>Inverted index</SPAN> </SPAN></P></DT>
<DD>
<P class=docList>An <A name=idx-CHP-23-1915></A><A name="a data"></A>inverted index is a data structure that maps from each unique word to a list of documents that contain the word (where the documents are typically identified with a numeric identifier to keep the inverted index data relatively compact). The Map function parses each document and emits a sequence of <SPAN class=docEmphasis>&lt;word, docid&gt;</SPAN><A name="accepts all"></A> pairs. The Reduce function accepts all docids for a given word, sorts the corresponding document IDs, and emits a <SPAN class=docEmphasis>&lt;word, list of docids&gt;</SPAN><A name="of all"></A> pair. The set of all output pairs forms a simple inverted index. It is easy to augment this computation to keep track of word positions within each document.<A name=idx-CHP-23-1916></A></P></DD>
<DT><BR>
<P><SPAN class=docPubcolor><SPAN class=docEmphasis>Distributed sort</SPAN> </SPAN></P></DT>
<DD>
<P class=docList><A name=idx-CHP-23-1917></A><A name="be used"></A>MapReduce can also be used to sort data by a particular key. The Map function extracts the key from each record, and emits a <SPAN class=docEmphasis>&lt;key, record&gt;</SPAN><A name="This computation"></A> pair. The Reduce function emits all pairs unchanged (i.e., the identity Reduce function). This computation depends on the partitioning facilities and ordering properties described later in this chapter.<A name=idx-CHP-23-1918></A></P></DD></DL>
<P class=docText><A name="many more"></A>There are many more examples of computations that can easily be expressed as a Map-Reduce computation. For more complex computations, it is often easy to express them as a sequence of MapReduce steps or as an iterative application of a MapReduce computation, where the output of one MapReduce step is the input to the next MapReduce step.</P>
<P class=docText><A name="of data"></A>One you start thinking of data processing problems in terms of MapReduce, they are often relatively easy to express. As some testament to this, over the last four years, the number of <A name=idx-CHP-23-1919></A><A name="gone from"></A>MapReduce programs at Google has gone from a small handful of candidate problems in March 2003 (when we started to design MapReduce) to more than 6,000 distinct MapReduce programs in December 2006. These programs were written by more than a thousand different software developers, many of whom had never written a parallel or <A name=idx-CHP-23-1920></A><A name="distributed program"></A>distributed program before using MapReduce.</P></DIV></DIV>
<p>&nbsp;</p><p>&nbsp;</p><!-- 仁·义 -->
</body></html>
