<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link href="styles/globalstyle.css" type="text/css" rel="stylesheet"/>
<link title="medium" href="styles/two.css" type="text/css" rel="stylesheet"/>
<script src="scripts/main.js" type="text/javascript" language="javascript"></script>
<title>Chapter 28. Beautiful Debugging</title>
</head><body>
<DIV class=h3 style="MARGIN-TOP: 0px; PADDING-BOTTOM: 1em; WIDTH: 100%; PADDING-TOP: 0px"><SPAN>Beautiful Debugging</SPAN><SPAN> &gt; Debugging a Debugger</SPAN></DIV>
<DIV></DIV>
<DIV>
<DIV><A name=beautiful_debugging></A>
<H2 class=docChapterTitle id=title-ID0E5GEK>28. Beautiful Debugging</H2>
<P class=docText><SPAN class=docEmphasis><A name="Andreas Zeller"></A>Andreas Zeller</SPAN> <A name=idx-CHP-28-2427></A><A name=idx-CHP-28-2428></A></P>
<P class=docText><SPAN class=docEmphSmaller><A name="and i"></A>My name is andreas, and i have been debugging</SPAN><A name="where you"></A>." Welcome to Debuggers Anonymous, where you can tell your debugging story and find relief in the stories of others. So you have spent another night away from home? Good thing you've only been in front of the debugger. So you still cannot tell your manager when that showstopper will be fixed? Let's hope for the best! The fellow in the cubicle next to you brags about searching for a bug for 36 consecutive hours? Now that's impressive!</P>
<P class=docText><A name="nothing glamorous"></A>No, there is nothing glamorous about debugging. It is the ugly duckling of our profession, the admission that we are far from perfect, the one activity that is the least predictable or accountable—and a constant impetus to feelings of remorse and guilt: "If only we had done better right from the start, we wouldn't be stuck in this mess." The defect is the crime; debugging is the punishment.</P>
<P class=docText><A name="we have"></A>Let us assume, though, that we have done all we can to prevent errors. Yet, from time to time, we will find ourselves in a situation where we need to debug. And as with all other activities, we need to handle debugging in the most professional, maybe even "beautiful" way.</P>
<P class=docText>So, can there be any beauty in <A name=idx-CHP-28-2429></A><A name="have been"></A>debugging? I believe there can. In my own life as a programmer, there have been a number of moments when I encountered true beauty in debugging. These moments not only helped me solve a problem at hand, but actually evolved into new approaches to debugging as a whole—approaches that are not only "beautiful" in some way, but actually boost your productivity in debugging. This is because they are <SPAN class=docEmphasis>systematic</SPAN><A name="guide you"></A>—they guarantee to guide you toward the problem solution—and partly even <SPAN class=docEmphasis>automatic</SPAN><A name="while you"></A>—they do all the work while you pursue other tasks.</P>
<P class=docText>Curious? Read on.</P><A name=debugging_a_debugger></A>
<H3 class=docSection1Title id=-100000>28.1. Debugging a Debugger</H3>
<P class=docText><A name="in debugging"></A>My first experience of beauty in debugging was granted by one of my students. In her 1994 Master's thesis, Dorothea Lütkehaus built a visual debugger interface that provided a textbook visualization of data structures. <A class=docLink href="javascript:moveTo('the_ddd_debugger_in_action');">Figure 28-1</A> <A name=idx-CHP-28-2430></A><A name="shows a"></A>shows a screenshot of her tool, called the <SPAN class=docEmphasis>data display debugger</SPAN>, or <SPAN class=docEmphasis>ddd</SPAN><A name="demoed her"></A> for short. As Dorothea demoed her debugger, the audience and myself were amazed: one could grasp complex data within seconds, and explore and manipulate it just by using the mouse.<A name=idx-CHP-28-2431></A><A name=idx-CHP-28-2432></A></P>
<P class=docText><SPAN class=docEmphasis>ddd</SPAN><A name="for the"></A> was a wrapper for the command-line debuggers in use at this time (in particular <SPAN class=docEmphasis>gdb</SPAN><A name="which were"></A>, the GNU debugger), which were very powerful tools but difficult to use. Since graphical user interfaces for programming tools were still scarce, <SPAN class=docEmphasis>ddd</SPAN><A name="In the"></A> was a small revolution. In the following months, Dorothea and I did our best to make <SPAN class=docEmphasis>ddd</SPAN><A name="of the"></A> the most beautiful debugger interface around, and it eventually became part of the GNU ecosystem.<A name=idx-CHP-28-2433></A></P>
<P class=docText><A name=with></A>While debugging with <SPAN class=docEmphasis>ddd</SPAN><A name="than using"></A> is usually more fun than using a command-line tool, it does not necessarily make you a more efficient debugger. For this, the debugging <SPAN class=docEmphasis>process</SPAN><A name="the tool"></A> is far more important than the tool. Incidentally, I learned this through <SPAN class=docEmphasis>ddd</SPAN><A name="as well"></A> as well. It all started with a <SPAN class=docEmphasis>ddd</SPAN><A name="received on"></A> bug report I received on July 31, 1998, which started my second experience of beauty in debugging. Here is the bug report:</P>
<BLOCKQUOTE>
<P class=docText><A name="with GDB"></A>When using DDD with GDB 4.16, the run command correctly uses any prior command-line arguments, or the value of set args. However, when I switched to GDB 4.17, this no longer worked: If I entered a run command in the console window, the prior command-line options would be lost.</P></BLOCKQUOTE>
<P class=docText>Those <SPAN class=docEmphasis>gdb</SPAN><A name="done it"></A> developers had done it again—releasing a new <SPAN class=docEmphasis>gdb</SPAN><A name="slightly differently"></A> version that behaved slightly differently from the earlier version. Because <SPAN class=docEmphasis>ddd</SPAN> was a frontend, it actually sent commands to <SPAN class=docEmphasis>gdb</SPAN>, just like a human would do, and parsed the <SPAN class=docEmphasis>gdb</SPAN><A name="this process"></A> replies to present its information in the user interface. Something in this process had apparently failed.</P>
<P class=docText><A name="needed to"></A>All I needed to do was grab and install the new <SPAN class=docEmphasis>gdb</SPAN> version, run <SPAN class=docEmphasis>ddd</SPAN><A name="whether I"></A> as its frontend, and see whether I could reproduce the problem. If I could, I would have to launch another debugger instance to walk through the problem. All in all, this was business as usual.</P>
<P class=docText><A name="I was"></A>It turned out, though, that at this time, I was pretty fed up with running debuggers, debugging our own debugger, and in particular debugging because of third-party changes.</P><A name=the_ddd_debugger_in_action></A>
<P>
<CENTER>
<H5 class=docFigureTitle><A name="Figure "></A>Figure 28-1. The ddd debugger in action</H5><IMG id="" height=522 alt="" src="images/beautiful_debugging.0.png" width=500 border=0> </CENTER>
<P></P><BR>
<P class=docText><A name="and wondered"></A>So, I sat back and wondered: is there a way to solve this problem without actually launching the debugger? Or: <SPAN class=docEmphasis><A name="something without"></A>can I debug something without debugging?</SPAN><A name=idx-CHP-28-2434></A></P>
<P class=docText><A name="problem was"></A>Since the problem was caused by a change to the <SPAN class=docEmphasis>gdb</SPAN><A name="simply look"></A> source code, I could simply look into the <SPAN class=docEmphasis>gdb</SPAN> code—or, more precisely, at the <A name=idx-CHP-28-2435></A>differences between the two releases. The code <A name=idx-CHP-28-2436></A><A name="needed to"></A>difference, so I thought, would point me directly to the failure-inducing change. All I needed to do was to run the two code bases through <SPAN class=docEmphasis>diff</SPAN><A name="for detecting"></A>, a tool for detecting text differences. And this I did.</P>
<P class=docText>The <SPAN class=docEmphasis>diff</SPAN><A name="had a"></A> results surprised me. The log had a length of 178,200 lines, which was enormous—especially considering that the total <SPAN class=docEmphasis>gdb</SPAN><A name="of code"></A> source code contained roughly 600,000 lines of code. In no less than 8,721 locations, developers had inserted, deleted, or changed the source code. This was quite a lot for a "minor" release and, of course, far more than I could handle. Even if it took me just 10 seconds to check a single location, I would still spend 24 hours searching for the troublesome change. I sighed, invoked the debugger, and braced myself for yet another boring <A name=idx-CHP-28-2437></A><A name="debugging session"></A>debugging session. Still, I thought, there must be a better way to do this—a more "beautiful" way.</P></DIV></DIV>
<p>&nbsp;</p><p>&nbsp;</p><!-- 仁·义 -->
</body></html>
