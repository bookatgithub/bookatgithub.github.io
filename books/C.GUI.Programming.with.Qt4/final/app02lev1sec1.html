<html>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<head>
<title>app02lev1sec1.html</title>
<link rel="STYLESHEET" type="text/css" href="images/css1.css">
<link rel="STYLESHEET" type="text/css" href="images/css2.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=app02.html><img src="images/prev.gif" width="20" height="20" border="0" align="absmiddle" alt="Previous Page"></a>
<a href=app02lev1sec2.html><img src="images/next.gif" width="20" height="20" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<div style=""><div><a name="app02"></a><h2 id="title-ID0EMQPM" class="docAppendixTitle">B. Building Qt Applications</h2>




<ul><li><p class="docList"><a name="iddle1405"></a><a name="iddle1722"></a><a name="iddle3746"></a><a name="iddle3861"></a><a name="iddle5340"></a><a name="iddle6749"></a><a name="iddle8284"></a><span class="docEmphasis"><a class="docLink" href="app02lev1sec1.html#app02lev1sec1">Using qmake</a></span></p></li><li><p class="docList"><span class="docEmphasis"><a class="docLink" href="app02lev1sec2.html#app02lev1sec2">Using Third-Party Build Tools</a></span></p></li></ul>
<p class="docText"><a name="Building Qt"></a>&#66;uilding &#81;t a&#112;pli&#99;ations is gr&#101;atly simplifi&#101;d by the us&#101; of a build tool. Three options are open to &#117;s: We can us&#101; th&#101; <tt>qmake</tt><a name="with Qt"></a> tool su&#112;plied w&#105;th Qt, we can use a third-party build &#116;ool, or we can use an integrated developm&#101;nt environment (IDE).</p>
<p class="docText">The <tt>qmake</tt><a name="generates a"></a> tool genera&#116;es a platform-specific makefile from a platform-&#110;e&#117;tral <tt>.pro</tt> f&#105;le. The t&#111;ol &#104;as the ne&#99;essary logic to invoke Qt's code-ge&#110;erating tools (<tt>moc</tt>, <tt>uic</tt>, and <tt>rcc</tt>) built-in. We h&#97;ve used <tt>qm&#97;ke</tt><a name="using relatively"></a> for all &#116;he examples in the bo&#111;k, in m&#111;st cases using relatively si&#109;ple <tt>.pro</tt> files. In fact, <tt>qmake</tt><a name="features including"></a> provides a ri&#99;h range of features including the ability to create ma&#107;efiles that recursively invoke other makefiles and &#116;o switch &#99;ertain feat&#117;res on or o&#102;f de&#112;ending on th&#101; target platform. In t&#104;e first section of this append&#105;x, we wil&#108; review <tt>qma&#107;e</tt> and introdu&#99;e some of its more advance&#100; features.</p>
<p class="docText"><a name="but it"></a>In theory, &#97;ny third-party build tool can be used f&#111;r Qt development, but it is much easier to use on&#101; that is already Qt-aware. We will look at some of t&#104;e Qt-aw&#97;re build t&#111;ol&#115; in the s&#101;cond &#115;ection.</p>
<p class="docText"><a name="iddle1180"></a><a name="iddle1737"></a><a name="iddle2069"></a><a name="iddle2331"></a><a name="iddle2840"></a><a name="iddle3009"></a><a name="iddle3135"></a><a name="iddle3201"></a><a name="iddle3249"></a><a name="iddle3412"></a><a name="iddle3537"></a><a name="iddle3543"></a><a name="iddle3823"></a><a name="iddle4454"></a><a name="iddle4466"></a><a name="iddle4485"></a><a name="iddle4487"></a><a name="iddle4494"></a><a name="iddle4501"></a><a name="iddle4518"></a><a name="iddle4921"></a><a name="iddle5662"></a><a name="iddle6750"></a><a name="iddle6916"></a><a name="iddle7587"></a><a name="iddle7879"></a><a name="iddle7959"></a><a name="iddle8276"></a><a name="iddle8285"></a><a name="iddle8475"></a><a name="to build"></a>Some deve&#108;opers would rather use an IDE to build t&#104;eir ap&#112;lic&#97;tions. Trolltech prov&#105;des software to i&#110;tegrate with Visual Stu&#100;io and Eclipse (shown in <a class="docLink" href="#app02fig01">Figure B.1</a><a name="support for"></a>), and th&#101; open source IDEs KDevelop and QDevelo&#112;—both written using Qt—provide excell&#101;nt &#115;upport &#102;or Q&#116; develop&#109;ent.</p>
<a name="app02fig01"></a><p><center>

<h5 class="docFigureTitle"><a name="Visual Studio"></a>Figure B.1. The Qt V&#105;sual Studio and Eclipse integ&#114;ations in action</h5>
<p class="docText"><div class="st1"><a target="_blank" href="images/NzlkOW1jM2FhMDc4L2lwdHJnZTFnMTRzOXIvMy83X3BwcnNobmlhdGkvdmlzbmN0b2FsZS5nZ3Rq.jpg">[View full size image]</a></div><img border="0" id="" width="500" height="181" src="images/NzlkOW1jM2FhMDc4L2lwdHJnZTFnMTRzOXIvMy83LnByc2huaWFpL3RzdmljbnRvanBlZ2c-.jpg" alt="" /></p>
</center></p><br />




<a name="app02lev1sec1"></a>
<h3 class="docSection1Title" id="-100000">Using qmake</h3>
<p class="docText">The <tt>qmake</tt><a name="supplied with"></a> to&#111;l i&#115; suppli&#101;d with Qt. It &#105;s used to bu&#105;ld Qt itself as well as the tool&#115; and examples that accompany it. Throughout the book, &#119;e have used <tt>qmake</tt><a name="project "></a> project (<tt>.pro</tt><a name="build our"></a>) files to build our example appl&#105;cations and plugins. In this section, we will study the <tt>.&#112;ro</tt><a name="syntax in"></a> f&#105;le synt&#97;x in a more &#115;ystema&#116;ic (although by no me&#97;ns comprehensive) wa&#121;, and we will review a few f&#117;ndamenta&#108; <tt>qmake</tt> conc&#101;pts. For com&#112;lete co&#118;erage, see the <tt>qmake</tt> manu&#97;l, available online at <a class="docLink" target="_blank" href="http://doc.trolltech.com/4.3/qmake-manual.html">http://doc.trolltech.com/4.3/qmake-manual.html</a>.</p>
<p class="docText">The purpose of a <tt>.&#112;ro</tt><a name="involved in"></a> file is to list the source files that are &#105;nvolved in a project. Since <tt>qmake</tt><a name="and its"></a> &#105;s used f&#111;r b&#117;ilding Qt &#97;nd its ass&#111;ciated tools, &#105;t knows Qt very &#119;ell and can generate rules for invoking <tt>moc</tt>, <tt>ui&#99;</tt>, and <tt>rcc</tt><a name="to learn"></a>. As a r&#101;su&#108;t, the syntax i&#115; very conc&#105;se and easy to learn.</p>
<p class="docText"><a name="are"></a>The thre&#101; main types of project file&#115; are <tt>app</tt> (for stand-alone applications), <tt>lib</tt> (&#102;or static and shared libraries), and <tt>subdirs</tt> (for r&#101;cu&#114;sive s&#117;bdirecto&#114;y buil&#100;s). This ca&#110; be speci&#102;ied using the <tt>TEMPLATE</tt> variable, as follows:</p>
<div class="docText"><pre>TEMPLATE = lib</pre></div><br />
<p class="docText">The <tt>sub&#100;i&#114;s</tt><a name="we need"></a> temp&#108;ate can be used for b&#117;ilding targets i&#110; subdirectories. In that case, &#119;e need to specify only the <tt>SUBDIRS</tt><a name="to"></a> variable &#105;n addition to <tt>TEMPLATE = subdirs</tt>. In each subdirect&#111;ry, <tt>qmake</tt><a name="a"></a> looks for a <tt>.pro</tt><a name="file named"></a> file named after the di&#114;ector&#121; an&#100; w&#105;ll buil&#100; that pro&#106;ect. The <tt>examples.pro</tt><a name="with the"></a> fil&#101; supplied with the exa&#109;ples provid&#101;d f&#111;r this boo&#107; uses the <tt>subdirs</tt><a name="to run"></a> tem&#112;late to run <tt>qmake</tt> on the in&#100;ividual examples.</p>
<p class="docText">If no <tt>TEMPLATE</tt> entr&#121; is present, the default is <tt>app</tt>. For <tt>app</tt> or <tt>lib</tt> p&#114;ojects, the most commonly used variables are the f&#111;ll&#111;wi&#110;g:</p>
<ul><li><p class="docList"><tt>&#72;EAD&#69;RS</tt> specifies the pro&#106;ect's C++ header (<tt>.h</tt>) files.</p></li><li><p class="docList"><tt>SOURCE&#83;</tt> specifies the project's C++ impleme&#110;t&#97;tion (<tt>.cpp</tt>) f&#105;les.</p></li><li><p class="docList"><tt>FORMS</tt> specifi&#101;s the <span class="docEmphasis">Qt De&#115;igner</span> <tt>.ui</tt> files to be proc&#101;ssed by <tt>uic</tt>.</p></li><li><p class="docList"><tt>RESOURCES</tt> speci&#102;ies the <tt>.qrc</tt> files to be processed by <tt>rcc</tt>.</p></li><li><p class="docList"><tt>DEFINES</tt> specifies the C++ p&#114;eprocessor symbols that should be predef&#105;ned.</p></li><li><p class="docList"><tt>INC&#76;UDEPATH</tt><a name="preprocessor for"></a> &#115;pecifi&#101;s t&#104;e directories that &#115;hould be searched by t&#104;e C++ preprocessor for l&#111;ca&#116;ing glob&#97;l header files.</p></li><li><p class="docList"><tt>LIB&#83;</tt><a name="to the"></a> specifies th&#101; libraries to link to the pr&#111;ject. The libraries are specified &#101;ither as absolute paths or using the Uni&#120;-inspired <tt>-L</tt> and <tt>-l</tt> flags (e.g., <tt>-L/usr/local/l&#105;b</tt> and <tt>-ld&#98;_cxx</tt>).</p></li><li><p class="docList"><tt>CONFIG</tt> &#115;pecifi&#101;s v&#97;rious project conf&#105;guration and &#99;ompiler options.</p></li><li><p class="docList"><a name="iddle1414"></a><a name="iddle1767"></a><a name="iddle2045"></a><a name="iddle2105"></a><a name="iddle2181"></a><a name="iddle2184"></a><a name="iddle2309"></a><a name="iddle2322"></a><a name="iddle2849"></a><a name="iddle3136"></a><a name="iddle3250"></a><a name="iddle3540"></a><a name="iddle3739"></a><a name="iddle3747"></a><a name="iddle3824"></a><a name="iddle4023"></a><a name="iddle4359"></a><a name="iddle4458"></a><a name="iddle4460"></a><a name="iddle4464"></a><a name="iddle4520"></a><a name="iddle6019"></a><a name="iddle6103"></a><a name="iddle6139"></a><a name="iddle6852"></a><a name="iddle7728"></a><a name="iddle7933"></a><a name="iddle8153"></a><a name="iddle8432"></a><a name="iddle8476"></a><a name="iddle8495"></a><a name="iddle8521"></a><tt>QT</tt><a name="default is"></a> specifies the Qt mod&#117;les that a&#114;e used &#98;y the project. (The defaul&#116; is <tt>core gui</tt>, corresp&#111;nding to the <span class="docEmphasis">QtCore</span> and <span class="docEmphasis">Qt&#71;ui</span> modules.)</p></li><li><p class="docList"><tt>VERSION</tt> specifies &#116;he version number of the target library.</p></li><li><p class="docList"><tt>TARGE&#84;</tt><a name="executable or"></a> specifies the base name of the target executable or library, e&#120;c&#108;uding any e&#120;t&#101;ns&#105;on, prefix, or ver&#115;ion number. (The default is the n&#97;me of the current directory.)</p></li><li><p class="docList"><tt>DESTDIR</tt><a name="default is"></a> spe&#99;ifies the di&#114;ector&#121; in which the tar&#103;et execu&#116;able should be put. (The default is plat&#102;orm-dependent; for e&#120;ample, on Linux, it is the current directory, and on Windows, i&#116; is the <tt>debug</tt> or <tt>release</tt> subdirectory.)</p></li><li><p class="docList"><tt>DLLDESTDIR</tt><a name="in which"></a> specifi&#101;s t&#104;e dire&#99;tory in whic&#104; the ta&#114;get library file s&#104;ould be put. (It has th&#101; same default as <tt>DESTDIR</tt>.)</p></li></ul>
<p class="docText">The <tt>CONFIG</tt><a name="used to"></a> variable is &#117;sed to con&#116;rol vari&#111;us aspects of &#116;he build proc&#101;ss. The following options &#97;re supported:</p>
<ul><li><p class="docList"><tt>debug</tt><a name="means that"></a> means that an executable or li&#98;rary with debugging information should be built, a&#110;d links against the debug versions of the Qt libraries.</p></li><li><p class="docList"><tt>r&#101;le&#97;se</tt><a name="an executable"></a> means t&#104;at an e&#120;e&#99;utable or library witho&#117;t debugging informa&#116;ion should be built, and links against the re&#108;ease versi&#111;ns &#111;f the Qt li&#98;raries. If both <tt>&#100;ebug</tt> and <tt>release</tt> are specified, <tt>debug</tt> &#119;ins.</p></li><li><p class="docList"><tt>warn_off</tt><a name="off as"></a> switches off as many warnings as p&#111;ssible. By default, builds are done with warnin&#103;s switched on.</p></li><li><p class="docList"><tt>qt</tt><a name="is included"></a> means that the application or library u&#115;es Qt. Th&#105;s optio&#110; i&#115; includ&#101;d by de&#102;ault.</p></li><li><p class="docList"><tt>dll</tt><a name="should be"></a> means that a s&#104;ared library should be built.</p></li><li><p class="docList"><tt>stat&#105;clib</tt> me&#97;ns that a s&#116;atic library sh&#111;uld b&#101; built.</p></li><li><p class="docList"><tt>plugin</tt><a name="shared libraries"></a> means that a plu&#103;in should be built. Plug&#105;ns are always shared libraries, so this opt&#105;on implies the <tt>dll</tt> option.</p></li><li><p class="docList"><tt>console</tt><a name="to the"></a> means that the ap&#112;lic&#97;tion need&#115; to writ&#101; to &#116;he console (using <tt>cou&#116;</tt>, <tt>cerr</tt>, <tt>qWarning()</tt>, etc.).</p></li><li><p class="docList"><tt>app_bun&#100;le</tt><a name="executable should"></a> applies only to Mac OS X bui&#108;ds, and mean&#115; that th&#101; execu&#116;able should be put i&#110; a bundle, which is the de&#102;ault on Mac OS X.</p></li><li><p class="docList"><tt>lib_bundle</tt><a name="Mac OS"></a> applies only to Mac OS X &#98;uilds, and means that the library should b&#101; put in a framework.</p></li></ul>
<p class="docText"><a name="a makefile"></a>To generate a makefile fo&#114; a proj&#101;ct &#102;ile &#99;alled <tt>hello.&#112;ro</tt><a name="we type"></a>, we ty&#112;e</p>
<div class="docText"><pre>qmake hello.pro</pre></div><br />
<p class="docText"><a name="can invoke"></a>After that, we ca&#110; invoke <tt>make</tt> or <tt>nmake</tt><a name="build the"></a> to build t&#104;e proj&#101;ct. &#87;e can also use <tt>qmake</tt> t&#111; gene&#114;ate a Microsoft Visual Studio pro&#106;ect (<tt>.dsp</tt> or <tt>.vproj</tt>) file by typing</p>
<div class="docText"><pre>qmake -tp vc hello.pro</pre></div><br />
<p class="docText"><a name="iddle1695"></a><a name="iddle3748"></a><a name="iddle4455"></a><a name="iddle4462"></a><a name="iddle4495"></a><a name="iddle4496"></a><a name="iddle4522"></a><a name="iddle4532"></a><a name="iddle7601"></a><a name="iddle8699"></a><a name="file using"></a>On Mac OS X, we c&#97;n generate an Xcode project file using</p>
<div class="docText"><pre>qmake -spec macx-xcode hello.pro</pre></div><br />
<p class="docText">and makefiles using</p>
<div class="docText"><pre>qmake -spec macx-g++ hello.pro</pre></div><br />
<p class="docText">Th&#101; <tt>-spec</tt> command-line option lets us specify a platform/&#99;ompiler com&#98;ination. No&#114;mally, <tt>&#113;make</tt><a name="some cases"></a> &#100;etects the &#99;orrect platform, but in some c&#97;ses it may be necessary to specify it expli&#99;itly. For exa&#109;ple, to gener&#97;te a makefile that &#105;nvokes the Intel &#67;++ Compiler (ICC) for Linux in 64-bit mo&#100;e, we would type</p>
<div class="docText"><pre>qmake -spec linux-icc-64 hello.pro</pre></div><br />
<p class="docText">The possible speci&#102;ications are located in Qt's <tt>mkspecs</tt> directory.</p>
<p class="docText">&#65;lthough <tt>qmake</tt>'s primary purpose is to generate ma&#107;efiles fr&#111;m <tt>.p&#114;o</tt> file&#115;, we can a&#108;so use <tt>qmake</tt> to &#103;enerate a <tt>.pro</tt> file for the cu&#114;rent directory, using the <tt>-project</tt> &#111;pt&#105;on. For e&#120;ample:</p>
<div class="docText"><pre>qmake -project</pre></div><br />
<p class="docText">In this m&#111;de, <tt>qmake</tt><a name="extensions "></a> &#119;ill search the current di&#114;ectory for files with known extensions (<tt>.&#104;</tt>, <tt>.cpp</tt>, <tt>.ui</tt>, etc.) and produce a <tt>.pro</tt> file that list&#115; these files.</p>
<p class="docText"><a name="look in"></a>In the rest of this section, we will look in mo&#114;e deta&#105;l at the <tt>.&#112;ro</tt> f&#105;le synt&#97;x. A <tt>.pro</tt> file en&#116;ry normally has the synt&#97;x</p>
<div class="docText"><pre><span class="docEmphasis">variable</span> = <span class="docEmphasis">values</span></pre></div><br />
<p class="docText">where <span class="docEmphasis"><tt>values</tt></span><a name="sign "></a> is a list of string values. C&#111;mm&#101;nt&#115; start with the p&#111;und s&#105;gn (<tt>#</tt><a name="the end"></a>) and terminate at the end of &#116;he line. For example, the line</p>
<div class="docText"><pre>CONFIG = qt release warn_off       # I know what I'm doing</pre></div><br />
<p class="docText"><a name="list "></a>assigns th&#101; list [&quot;qt&quot;, &quot;release&quot;, &quot;warn_off&quot;] to th&#101; <tt>CONFIG</tt><a name="overwriting any"></a> variable, overwriting any previous values. Additio&#110;a&#108; operators &#97;re provid&#101;d t&#111; supple&#109;ent the <tt>=</tt> operator. The <tt>+=</tt><a name="us append"></a> opera&#116;or lets us append values to a variable. Thus, the line&#115;</p>
<div class="docText"><pre>CONFIG  = qt
CONFIG += release
CONFIG += warn_off</pre></div><br />
<p class="docText"><a name="assign the"></a>effect&#105;vely as&#115;ign the list [&quot;qt&quot;, &quot;rele&#97;se&quot;, &quot;warn_off&quot;] to <tt>C&#79;NFIG</tt>, just as the previous exa&#109;ple did. The <tt>-=</tt><a name="the variable"></a> operator removes all occurren&#99;es of the specified values from the variable's curren&#116; value. Thus,</p>
<div class="docText"><pre>CONFIG  = qt release warn_off
CONFIG -= qt</pre></div><br />
<p class="docText">leaves <tt>CONFIG</tt> with the list [&quot;release&quot;, &quot;warn_off&quot;]. Th&#101; <tt>*=</tt><a name="a variable"></a> op&#101;ra&#116;or adds a &#118;alue to a va&#114;iable, but only if t&#104;e value is no&#116; already in the variable's list; otherwis&#101;, it &#100;o&#101;s noth&#105;ng. For exa&#109;ple, the line</p>
<div class="docText"><pre>SOURCES *= main.cpp</pre></div><br />
<p class="docText">will add the implementation f&#105;le <tt>main.cpp</tt> to the project only if it isn't specifi&#101;d already. Finally, the <tt>~=</tt><a name="match a"></a> operator can be used to replace any val&#117;es that match a regular expression with the specified replac&#101;me&#110;t &#116;ext, usin&#103; a syn&#116;ax inspired by <tt>s&#101;d</tt> (the Unix stream e&#100;itor). For example,</p>
<div class="docText"><pre>SOURCES ~= s/\.cpp\b/.cxx/</pre></div><br />
<p class="docText">replaces all <tt>.cpp</tt> fil&#101; ex&#116;ensions &#119;ith <tt>.cxx</tt> in the <tt>SO&#85;RCES</tt> variable.</p>
<p class="docText"><a name="iddle2431"></a><a name="iddle4502"></a>&#73;nside the list of val&#117;es, <tt>qmake</tt><a name="other"></a> provides ways to access the values of ot&#104;er <tt>qmake</tt><a name="in"></a> variables, of environment variabl&#101;s, and of Qt configuration options. The &#115;yntaxe&#115; are lis&#116;ed in <a class="docLink" href="#app02fig02">Figure B.2</a>.</p>
<a name="app02fig02"></a><p><table cellspacing="0" class="allBorders" border="1"><caption><h5 class="docTableTitle"><a name="available in"></a>Fig&#117;re B.2. Varia&#98;le accessors avai&#108;able in <tt>qmake</tt></h5></caption><colgroup align="left" span="2"><col width="200" /><col width="350" /></colgroup><thead><tr><th scope="col" class="docTableCell thead" align="center" valign="top" style="background-color:#E6E6E6">Accessor</th><th scope="col" class="docTableCell thead" align="center" valign="top" style="background-color:#E6E6E6">Descr&#105;ption</th></tr></thead><tr><td class="docTableCell" align="left" valign="top"><tt>$$</tt><span class="docEmphasis"><tt>varName</tt></span> <span class="docEmphRomanAlt">or</span> <tt>$${</tt><span class="docEmphasis"><tt>varName</tt></span><tt>}</tt></td><td class="docTableCell" align="left" valign="top"><span class="docEmphRomanAlt">Value of</span> <tt>qmake</tt> <span class="docEmphRomanAlt"><a name="that point"></a>variable at &#116;hat poin&#116; in the</span> <tt>.pr&#111;</tt> <span class="docEmphRomanAlt">file</span></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>$$(</tt><span class="docEmphasis"><tt>varName</tt></span><tt>)</tt></td><td class="docTableCell" align="left" valign="top"><span class="docEmphRomanAlt"><a name="Value of"></a>V&#97;lue of environmen&#116; variable when</span> <tt>qmake</tt> <span class="docEmphRomanAlt">is run</span></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>$(</tt><span class="docEmphasis"><tt>va&#114;Name</tt></span><tt>)</tt></td><td class="docTableCell" align="left" valign="top"><span class="docEmphRomanAlt"><a name="environment variable"></a>Value of environment variable wh&#101;n makefile is processed</span></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>$$[</tt><span class="docEmphasis"><tt>varName</tt></span><tt>]</tt></td><td class="docTableCell" align="left" valign="top"><span class="docEmphRomanAlt"><a name="of Qt"></a>Val&#117;e of Qt configuration option</span></td></tr></table></p><br />
<p class="docText"><a name="as"></a>In the examples so f&#97;r, we alway&#115; used st&#97;ndard var&#105;ables, s&#117;ch as <tt>SOURCES</tt> and <tt>CON&#70;IG</tt><a name="set the"></a>, but it is pos&#115;ible to set the value of any variable and t&#111; re&#102;er t&#111; it later using &#116;he <tt>$$</tt><span class="docEmphasis"><tt>varName</tt></span> or <tt>$${</tt><span class="docEmphasis"><tt>varName</tt></span><tt>}</tt> &#115;yntax. For example:</p>
<div class="docText"><pre>MY_VERSION    = 1.2
SOURCES_BASIC = alphadialog.cpp \
                main.cpp \
                windowpanel.cpp
SOURCES_EXTRA = bezierextension.cpp \
                xplot.cpp
SOURCES       = $$SOURCES_BASIC \
                $$SOURCES_EXTRA
TARGET        = imgpro_$${MY_VERSION}</pre></div><br />
<p class="docText"><a name="earlier and"></a>The next &#101;xample combines several of the syntaxes shown &#101;arlier and uses the built-in function <tt>$$lowe&#114;()</tt> to convert strings to lowercase:</p>
<div class="docText"><pre># List of classes in the project
MY_CLASSES    = Annotation \
                CityBlock \
                CityScape \
                CityView

# Append .cpp extension to lowercased class names, and add main.cpp
SOURCES       = $$lower($$MY_CLASSES)
SOURCES      ~= s/([a-z0-9_]+)/\1.cpp/
SOURCES      += main.cpp
# Append .h extension to lowercased class names
HEADERS       = $$lower($$MY_CLASSES)
HEADERS      ~= s/([a-z0-9_]+)/\1.h/</pre></div><br />
<p class="docText"><a name="iddle3194"></a><a name="iddle3650"></a><a name="iddle4426"></a><a name="iddle4456"></a><a name="iddle4492"></a><a name="iddle8308"></a><a name="iddle8610"></a><a name="names that"></a>Sometimes we may need to s&#112;eci&#102;y fi&#108;e names tha&#116; include &#115;paces in a <tt>.&#112;ro</tt> file. In that case, we c&#97;n simply put quotes around the file na&#109;e.</p>
<p class="docText"><a name="to specify"></a>When compi&#108;ing a proje&#99;t on different &#112;latform&#115;, it might be necessary to speci&#102;y different files or diff&#101;rent options based on t&#104;e platform. The general syntax for conditionals in <tt>qmak&#101;</tt> is</p>
<div class="docText"><pre><span class="docEmphasis">condition</span> {
    <span class="docEmphasis">then-case</span>
} else {
    <span class="docEmphasis">else-case</span>
}</pre></div><br />
<p class="docText">&#84;he <span class="docEmphasis"><tt>con&#100;i&#116;ion</tt></span><a name="a platform"></a> part &#99;an be a platform &#110;ame (e.g., <tt>win32</tt>, <tt>unix</tt>, or <tt>m&#97;cx</tt><a name="more complex"></a>) or a more complex predicate. The <span class="docEmphasis"><tt>then-c&#97;se</tt></span><a name="and"></a> and <span class="docEmphasis"><tt>els&#101;-ca&#115;e</tt></span><a name="the values"></a> parts specify &#116;he values of vari&#97;bles using the standard synt&#97;x. For example:</p>
<div class="docText"><pre>win32 {
    SOURCES += serial_win.cpp
} else {
    SOURCES += serial_unix.cpp
}</pre></div><br />
<p class="docText">The <tt>else</tt><a name="is optional"></a> branch is optional. Fo&#114; convenience, <tt>qmake</tt> also suppor&#116;s a one-line syntax when the <span class="docEmphasis"><tt>then-case</tt></span><a name="is no"></a> part consists of o&#110;l&#121; on&#101; va&#114;iable &#97;ssignment and ther&#101; is no <span class="docEmphasis"><tt>els&#101;-case</tt></span>:</p>
<div class="docText"><pre><span class="docEmphasis">condition</span>:<span class="docEmphasis">then-case</span></pre></div><br />
<p class="docText">For example:</p>
<div class="docText"><pre>macx:SOURCES += serial_mac.cpp</pre></div><br />
<p class="docText"><a name="files that"></a>If we have several proje&#99;t files that &#110;e&#101;d to sh&#97;re some of the same e&#110;tries, we can factor out the comm&#111;n entries in a separate file &#97;nd include it in the individual <tt>.pro</tt> files tha&#116; need it using the <tt>include()</tt> directive:</p>
<div class="docText"><pre>include(../common.pri)

HEADERS      += window.h
SOURCES      += main.cpp \
                window.cpp</pre></div><br />
<p class="docText"><a name="other project"></a>Conv&#101;nt&#105;onally, &#112;roj&#101;ct &#102;iles that ar&#101; meant to be included by oth&#101;r project files are given a <tt>.&#112;ri</tt> (p&#114;oject &#105;nclude) ext&#101;nsion.</p>
<p class="docText">In a p&#114;evious example, we saw the <tt>$$l&#111;wer()</tt><a name="Another useful"></a> built-in function, which retur&#110;s a lowercase version of its argument. A&#110;other useful function is <tt>$$system()</tt><a name="we need"></a>: It allows &#117;s to gener&#97;te string&#115; from ex&#116;ernal ap&#112;lications. For &#101;xample, if we need t&#111; determine which version of Uni&#120; i&#115; being u&#115;ed, we can w&#114;ite</p>
<div class="docText"><pre>OS_VERSION = $$system(uname -r).</pre></div><br />
<p class="docText"><a name="iddle1361"></a><a name="iddle1649"></a><a name="iddle3375"></a><a name="iddle3749"></a><a name="iddle4402"></a><a name="iddle7039"></a><a name="iddle8305"></a><a name="use the"></a>We can then use t&#104;e resulting variable in a condition, to&#103;ether with <tt>contains()</tt>:</p>
<div class="docText"><pre>contains(OS_VERSION, SunOS):SOURCES += mythread_sun.c</pre></div><br />
<p class="docText"><a name="we have"></a>In this sectio&#110;, we have barely skimmed the surface. T&#104;e <tt>qmake</tt><a name="tool provides"></a> tool provides many more options &#97;nd featur&#101;s t&#104;an we p&#114;esent&#101;d here, &#105;ncluding support &#102;or precompiled headers, for M&#97;c OS X univ&#101;rs&#97;l binaries, and for &#117;ser-defined c&#111;mpilers or tools. Refer t&#111; the online <tt>qmake</tt><a name="full details"></a> manual for full detail&#115;.</p>

</div></div>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=app02.html><img src="images/prev.gif" width="20" height="20" border="0" align="absmiddle" alt="Previous Page"></a>
<a href=app02lev1sec2.html><img src="images/next.gif" width="20" height="20" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>