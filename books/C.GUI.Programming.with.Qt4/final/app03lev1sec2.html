<html>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<head>
<title>app03lev1sec2.html</title>
<link rel="STYLESHEET" type="text/css" href="images/css1.css">
<link rel="STYLESHEET" type="text/css" href="images/css2.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=app03lev1sec1.html><img src="images/prev.gif" width="20" height="20" border="0" align="absmiddle" alt="Previous Page"></a>
<a href=app03lev1sec3.html><img src="images/next.gif" width="20" height="20" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<div style=""><div><a name="app03lev1sec2"></a>
<h3 class="docSection1Title" id="-100000">Using Qt Jambi in the Eclipse IDE</h3>
<p class="docText"><a name="The Eclipse"></a>&#84;he Ecl&#105;pse IDE (&quot;&#69;clipse&quot; for s&#104;ort) is &#111;ne of t&#104;e key pieces of softwar&#101; in the Eclipse family of more than six&#116;y open so&#117;rce proje&#99;ts. Eclipse is very po&#112;ular with J&#97;va programmers, and since it is written i&#110; Java, it runs on all major platforms. Ec&#108;ipse displays a collection of panels, called views. Many views &#97;re available in Eclipse, including navigator, out&#108;ine, and edi&#116;or views, &#97;nd each pa&#114;ticul&#97;r collection of vi&#101;ws is called a &#112;erspective.</p>
<p class="docText"><a name="Qt Jambi"></a>To make Qt Jambi and <span class="docEmphasis">Qt Desi&#103;ner</span><a name="inside Eclipse"></a> a&#118;ailable in&#115;ide Eclipse, it i&#115; necessary to inst&#97;ll the Qt Jambi Eclipse integration &#112;ackage. Once the package is unpacked in the ri&#103;ht location, Eclipse must be run with the <tt>-c&#108;ean</tt><a name="than relying"></a> option to force it to look for new plugins, rather t&#104;an rel&#121;in&#103; on it&#115; cache. T&#104;e Prefere&#110;ces dialog wi&#108;l now have an extra option c&#97;lled &quot;Qt Ja&#109;bi Preferen&#99;e Page&quot;. It is nece&#115;sary to go to t&#104;is page and set Q&#116; Jambi's location, as explaine&#100; in <tt>http://doc.trolltech.com/qtjambi-4.3.2_01/co&#109;/trolltech/qt/qtjambi-eclipse.html</tt><a name="set and"></a>. Once the path has been s&#101;t a&#110;d &#118;erified, Ec&#108;ipse shoul&#100; be cl&#111;sed and &#114;estarted for the changes to take effect.</p>
<p class="docText">T&#104;e next &#116;ime we st&#97;rt Eclipse an&#100; click <span class="docEmphRomanAlt">File|Ne&#119; Project</span><a name="two kinds"></a>, the New Project dialog that p&#111;ps up will offer two kinds of Qt Jambi p&#114;oject: <span class="docEmphRomanAlt">Qt Jambi Project</span> and <span class="docEmphRomanAlt">Qt Jambi Project (Using De&#115;igner Form)</span><a name="these project"></a>. In this section, we will discuss b&#111;th &#111;f t&#104;ese pr&#111;je&#99;t types by prese&#110;ting a Qt Jambi versi&#111;n of the Go to Cell example d&#101;ve&#108;oped in <a class="docLink" href="ch02.html#ch02">Chapter 2</a>.</p>
<p class="docText">To c&#114;eate a Qt J&#97;mbi application purel&#121; in code, click <span class="docEmphRomanAlt">File|New Project</span><a name="the end"></a>, choose &quot;Qt J&#97;mbi Project&quot;, and go through each page of the wiza&#114;d. At the end, Eclipse <a name="iddle2142"></a><a name="iddle2602"></a><a name="iddle2936"></a><a name="iddle3377"></a><a name="iddle3403"></a><a name="iddle6110"></a><a name="project with"></a>will create a proj&#101;ct with a skeleton <tt>.java</tt><a name="a"></a> file with a <tt>main()</tt><a name="method and"></a> method a&#110;d &#97; construc&#116;or. The ap&#112;lic&#97;tion can be ru&#110; from within Ecl&#105;pse using the <span class="docEmphRomanAlt">Run|Run</span><a name="shows syntax"></a> menu &#111;pt&#105;on. Ecli&#112;se shows sy&#110;tax errors i&#110; the left margin of the edi&#116;or, and shows any errors that occur at run-&#116;ime in a console window.</p>
<p class="docText"><a name="a Qt"></a>Creating a Qt Jambi appli&#99;ation that uses <span class="docEmphasis">Qt Designer</span> is very similar to creating a pure co&#100;e &#97;pplicati&#111;n. C&#108;ick <span class="docEmphRomanAlt">File|Ne&#119; Project</span><a name="Call the"></a>, and then choo&#115;e &quot;Qt Jambi Project (Using Des&#105;gner Form)&quot;. Again, a wizard will appea&#114;. Call t&#104;e proj&#101;ct &quot;JambiG&#111;ToCell&quot;, and on &#116;he last page, specify &quot;GoToCell&#68;ialog&quot; as the class name and choose &quot;D&#105;alog&quot; as the form type.</p>
<p class="docText"><a name="will have"></a>Once the wizard has finished, &#105;t will have created <tt>GoToCellDialog.java</tt> and also a J&#97;va user in&#116;erface f&#105;le <tt>GoTo&#67;ellDialo&#103;.jui</tt>. Doub&#108;e-click the <tt>.jui</tt> file to ma&#107;e the <span class="docEmphasis">Qt Designer</span> editor visible. A form wit&#104; <span class="docEmphRomanAlt">OK</span> and <span class="docEmphRomanAlt">&#67;ancel</span> but&#116;ons will be shown. To a&#99;cess <span class="docEmphasis">Qt Designer</span>'s &#102;unctionality, click <span class="docEmphRomanAlt">Wind&#111;w|Open Perspective|Othe&#114;</span>, then double-click <span class="docEmphRomanAlt">Qt Designer UI</span>. This &#112;erspective shows <span class="docEmphasis">Qt Designer</span>'s signal–slot editor, a&#99;tion editor, &#112;rop&#101;rt&#121; ed&#105;tor, widget bo&#120;, and more, as shown &#105;n <a class="docLink" href="#app03fig02">Figure C.2</a>.</p>
<a name="app03fig02"></a><p><center>

<h5 class="docFigureTitle">Figure C.2. The Go to Cell dialog in Ec&#108;ipse</h5>
<p class="docText"><div class="st1"><a target="_blank" href="images/NzlkOW1jM2FhMDc4L2lwdHJnZTFnMTRzOXIvMy83anAyY2gubGwvX2Flc2NpaXB0cGdzZQ--.jpg">[View full size image]</a></div><img border="0" id="" width="500" height="317" src="images/NzlkOW1jM2FhMDc4L2lwdHJnZTFnMTRzOXIvMy83cDJjaGwuanAvaXNlaWNwZ3Nl.jpg" alt="" /></p>
</center></p><br />
<p class="docText"><a name="in"></a>To com&#112;let&#101; the de&#115;ign, we perf&#111;rm the same steps as in <a class="docLink" href="ch02.html#ch02">Chapter 2</a> (p. <a class="docLink" href="ch02lev1sec3.html#ch02fig05">24</a><a name="could be"></a>). The &#100;ialog can be previewed as it could &#98;e within <span class="docEmphasis">Qt Designer</span><a name="to run"></a>, and since Eclipse genera&#116;es skeleton code it is also possible to run it by clicking <span class="docEmphRomanAlt">Run|Run</span>.</p>
<p class="docText"><a name="is to"></a>&#84;he fin&#97;l stage is &#116;o edit th&#101; <tt>Go&#84;oCellDialog.java</tt><a name="implement the"></a> &#102;ile to implement &#116;he functionality we need. T&#119;o construct&#111;rs &#97;re generated by Ecl&#105;pse, but we only want o&#110;e of them, so we de&#108;ete the parameterless constructor. In the ge&#110;erated <tt>main()</tt><a name="we must"></a> method, we must pass <tt>null</tt><a name="parent to"></a> as the parent to th&#101; <tt>GoToCellDialog</tt> constructor. Also, <a name="iddle1263"></a><a name="iddle2603"></a><a name="iddle3378"></a><a name="iddle3394"></a><a name="iddle3404"></a><a name="iddle3406"></a><a name="iddle3470"></a><a name="iddle6111"></a><a name="iddle7407"></a><a name="iddle7448"></a><a name="iddle7523"></a><a name="iddle8263"></a><a name="iddle8277"></a><a name="must implement"></a>we must implement the <tt>GoT&#111;Ce&#108;lDialog(QW&#105;dget pa&#114;ent)</tt> co&#110;structor, a&#110;d provide a <tt>on_l&#105;neEdit_textChanged(String)</tt> method that &#105;s calle&#100; w&#104;enever the li&#110;e edi&#116;or's <tt>textChanged()</tt> signal is emitte&#100;. Here is the resulting <tt>GoT&#111;CellDialog.java</tt> file:</p>
<div class="docText"><div class="codeSegmentsExpansionLinks">
              Code View:</div><pre class="">import com.trolltech.qt.core.*;
import com.trolltech.qt.gui.*;

public class GoToCellDialog extends QDialog {
    private Ui_GoToCellDialogClass ui = new Ui_GoToCellDialogClass();

    public GoToCellDialog(QWidget parent) {
        super(parent);
        ui.setupUi(this);

        ui.okButton.setEnabled(false);

        QRegExp regExp = new QRegExp("[A-Za-z][1-9][0-9]{0,2}");
        ui.lineEdit.setValidator(new QRegExpValidator(regExp, this));

        ui.okButton.clicked.connect(this, "accept()");
        ui.cancelButton.clicked.connect(this, "reject()");
    }

    private void on_lineEdit_textChanged(String text) {
        ui.okButton.setEnabled(!text.isEmpty());
    }

    public static void main(String[] args) {
        QApplication.initialize(args);
        GoToCellDialog testGoToCellDialog = new GoToCellDialog(null);
        testGoToCellDialog.show();
        QApplication.exec();
    }
}

					  </pre></div><br />
<p class="docText">Eclipse takes care of inv&#111;king <tt>juic</tt> to convert <tt>GoToCe&#108;lDialog.ju&#105;</tt> into <tt>Ui_&#71;oT&#111;-Ce&#108;lDialogClass.java</tt>, wh&#105;ch defines a class &#99;alled <tt>Ui_GoToCellDialogClass</tt> that reprod&#117;ces the di&#97;log we des&#105;gned using <span class="docEmphasis">Qt De&#115;igner</span><a name="a reference"></a>. We cr&#101;ate an instance of &#116;his class and keep a referenc&#101; to it in a private field called <tt>ui</tt>.</p>
<p class="docText">In the cons&#116;ructor, we call the <tt>Ui_GoToCellDialogClass</tt>'s <tt>setupUi()</tt><a name="out the"></a> metho&#100; t&#111; cr&#101;at&#101; an&#100; lay out the w&#105;dgets and to set the&#105;r properties and signal–slot connect&#105;ons, inc&#108;uding auto&#109;atic connections for &#115;lots that follow t&#104;e naming convention <tt>on_</tt><span class="docEmphasis"><tt>o&#98;jectName</tt></span><tt>_</tt><span class="docEmphasis"><tt>signalName</tt></span><tt>()</tt>.</p>
<p class="docText"><a name="it is"></a>A convenient feat&#117;re of the Eclipse integration is that it is easy to ma&#107;e <tt>QWidget</tt><a name="be dragged"></a> subclasses available in the widget box to be dragged on t&#111; fo&#114;ms. We w&#105;ll brie&#102;ly r&#101;view t&#104;e <tt>LabeledLineEdit</tt> custom w&#105;dget, and then describe how to make it avai&#108;able in <span class="docEmphasis">Qt D&#101;si&#103;ner</span>'s widget box.</p>
<p class="docText">Wh&#101;n we cr&#101;ate custom widgets f&#111;r use with <span class="docEmphasis">Qt Designer</span><a name="can change"></a>, it is often &#99;onvenient to provide propert&#105;es that the programmer can change to customize the widge&#116;. The scre&#101;ns&#104;ot in <a class="docLink" href="#app03fig03">Figure C.3</a> s&#104;ows a c&#117;stom <tt>LabeledLineEdi&#116;</tt><a name="The widget"></a> widget in a form. &#84;he widget has two custom properties, <tt>l&#97;belText</tt> a&#110;d <tt>&#101;ditText</tt><a name="be set"></a>, tha&#116; can be set in <a name="iddle1169"></a><a name="iddle1986"></a><a name="iddle3191"></a><a name="iddle4111"></a><a name="iddle4540"></a><a name="iddle4612"></a><a name="iddle6152"></a><a name="iddle6153"></a><a name="iddle6489"></a><a name="iddle7872"></a><a name="iddle8585"></a><a name="the property"></a>the pr&#111;perty editor. In C++/Qt, prop&#101;rties are defined b&#121; means of the <tt>Q_PROPERTY()</tt><a name="introspection is"></a> macro. In Qt Jambi, intro&#115;pection is used to detect pairs of accessor met&#104;ods th&#97;t follow t&#104;e Qt na&#109;ing convent&#105;on <span class="docEmphasis"><tt>xxx</tt></span><tt>()</tt>/<tt>set</tt><span class="docEmphasis"><tt>X&#120;x</tt></span><tt>()</tt><a name="the Java"></a> or the Java &#110;aming convention <tt>get</tt><span class="docEmphasis"><tt>Xxx</tt></span><tt>()</tt>/<tt>set</tt><span class="docEmphasis"><tt>Xxx</tt></span><tt>()</tt><a name="to hide"></a>. I&#116; is also p&#111;ss&#105;ble to speci&#102;y other pro&#112;erties and to hide &#97;utomatically detected properties using ann&#111;tations.</p>
<a name="app03fig03"></a><p><center>

<h5 class="docFigureTitle">Figure C.3. The <tt>LabeledLineEdit</tt> custom w&#105;dget in a form</h5>
<p class="docText"><div class="st1"><a target="_blank" href="images/NzlkOW1jM2FhMDc4L2lwdHJnZTFnMTRzOXIvMy83anAzY2gubGwvX2Flc2NpaXB0cGdzZQ--.jpg">[View full size image]</a></div><img border="0" id="" width="500" height="311" src="images/NzlkOW1jM2FhMDc4L2lwdHJnZTFnMTRzOXIvMy83cDNjaGwuanAvaXNlaWNwZ3Nl.jpg" alt="" /></p>
</center></p><br />
<div class="docText"><pre>import com.trolltech.qt.*;
import com.trolltech.qt.gui.*;

public class LabeledLineEdit extends QWidget {</pre></div><br />
<p class="docText">The first <tt>import</tt><a name="Qt Jambi"></a> declaration is ne&#101;de&#100; t&#111; ac&#99;ess Qt Jambi'&#115; <tt>@QtPropert&#121;Reader()</tt> and <tt>@QtPr&#111;pertyWriter()</tt> annotations, which let us expo&#114;t prop&#101;rt&#105;es to <span class="docEmphasis">Qt Designer</span>.</p>
<div class="docText"><pre>    @QtPropertyReader(name="labelText")
    public String labelText() { return label.text(); }

    @QtPropertyWriter(name="labelText")
    public void setLabelText(String text) { label.setText(text); }

    @QtPropertyReader(name="editText")
    public String editText() { return lineEdit.text(); }

    @QtPropertyWriter(name="editText")
    public void setEditText(String text) { lineEdit.setText(text); }</pre></div><br />
<p class="docText">Fo&#114; read-onl&#121; properties, we ca&#110; simply use the <tt>@QtPr&#111;pertyReader()</tt><a name="provide read"></a> annotation and provide &#97; getter method. Here we want to provide read-write properties, <a name="iddle4364"></a><a name="For this"></a>so ea&#99;h has a gette&#114; and a s&#101;tt&#101;r. F&#111;r this exa&#109;ple, we could have omitted th&#101; annotations, since the accessor m&#101;th&#111;ds &#102;ollow t&#104;e Qt naming convent&#105;on.</p>
<div class="docText"><pre>    public LabeledLineEdit(QWidget parent){
        super(parent);

        label = new QLabel();
        lineEdit = new QLineEdit();
        label.setBuddy(lineEdit);

        QHBoxLayout layout = new QHBoxLayout();
        layout.addWidget(label);
        layout.addWidget(lineEdit);
        setLayout(layout);
    }

    private QLabel label;
    private QLineEdit lineEdit;</pre></div><br />
<p class="docText"><a name="the widget"></a>The constructor is quite c&#111;nventional. To be eligible for u&#115;e in the widget box, we must provide a constructor that takes a sing&#108;e <tt>QWidget</tt> argument.</p>
<div class="docText"><pre>    public static void main(String[] args) {
        QApplication.initialize(args);
        LabeledLineEdit testLabeledLineEdit = new LabeledLineEdit(null);
        testLabeledLineEdit.setLabelText("&amp;Test");
        testLabeledLineEdit.show();
        QApplication.exec();
    }
}</pre></div><br />
<p class="docText">Eclipse generates the <tt>main()</tt><a name="passed"></a> method a&#117;tomatica&#108;ly. We have p&#97;ssed <tt>null</tt><a name="argument to"></a> &#97;s the argu&#109;ent to the <tt>LabeledLineE&#100;it</tt><a name="constructor and"></a> constructor and adde&#100; a line to set the label's text propert&#121;.</p>
<p class="docText"><a name="have a"></a>On&#99;e we have a cu&#115;tom widget, we &#99;an add it to a proj&#101;ct by copying its <tt>.java</tt><a name="into the"></a> file into the p&#114;oject's <tt>src</tt><a name="and click"></a> in the package explorer. T&#104;en we invoke the project's Properties d&#105;alog and click the <span class="docEmphRomanAlt">Qt Designer Plugins</span><a name="suitable"></a> page. This pa&#103;e lis&#116;s all the &#115;uitabl&#101; <tt>QW&#105;dget</tt><a name="check the"></a> subclasses th&#97;t are in the proje&#99;t. We just need to check the <span class="docEmphRomanAlt">Enabl&#101; pl&#117;gin</span><a name="we want"></a> check&#98;ox for any of the &#115;ubclasses that &#119;e want to appear in the widg&#101;t box and click <span class="docEmphRomanAlt">OK</span>. The next &#116;ime we edit a form using the integrated <span class="docEmphasis">Qt Des&#105;gner</span><a name="will appear"></a>, the widgets we have added to the project as pl&#117;gins will &#97;ppear at t&#104;e bott&#111;m o&#102; the widget box in &#97; separate section.</p>
<p class="docText"><a name="brief introduction"></a>This co&#110;cludes our brief introduction to usin&#103; Ecli&#112;se f&#111;r Qt Jambi pr&#111;gramming. Ecl&#105;pse provides a powerful and f&#117;nctional IDE with many conveni&#101;nces for software development. And with &#116;he Qt Jambi integration in place, it is possible to creat&#101; Qt &#74;ambi a&#112;pli&#99;ations, incl&#117;ding those th&#97;t use <span class="docEmphasis">Qt Designer</span><a name="the Eclipse"></a>, comp&#108;etely within the Eclipse environment. &#84;rollt&#101;ch &#97;lso provide&#115; a C++/Qt Eclipse integ&#114;ation with most of the same benefits as &#116;he Qt Jambi one.</p>

</div></div>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=app03lev1sec1.html><img src="images/prev.gif" width="20" height="20" border="0" align="absmiddle" alt="Previous Page"></a>
<a href=app03lev1sec3.html><img src="images/next.gif" width="20" height="20" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>