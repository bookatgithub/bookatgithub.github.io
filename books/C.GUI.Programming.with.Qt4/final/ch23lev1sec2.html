<html>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<head>
<title>ch23lev1sec2.html</title>
<link rel="STYLESHEET" type="text/css" href="images/css1.css">
<link rel="STYLESHEET" type="text/css" href="images/css2.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch23lev1sec1.html><img src="images/prev.gif" width="20" height="20" border="0" align="absmiddle" alt="Previous Page"></a>
<a href=ch23lev1sec3.html><img src="images/next.gif" width="20" height="20" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<div style=""><div><a name="ch23lev1sec2"></a>
<h3 class="docSection1Title" id="-100000">Using ActiveX on Windows</h3>
<p class="docText"><a name="ActiveX technology"></a>&#77;icrosoft'&#115; Active&#88; technolog&#121; al&#108;ows applications to i&#110;corpora&#116;e user interface component&#115; provid&#101;d b&#121; other app&#108;ications or libra&#114;ies. It is built on Microsof&#116; COM and defines one set of i&#110;terfaces for applications that use comp&#111;nents and another set of interfaces for ap&#112;lic&#97;tions and &#108;ibraries t&#104;at pro&#118;ide component&#115;.</p>
<p class="docText"><a name="Edition provides"></a>The Qt/Windows Desk&#116;op Edition provides the ActiveQt fr&#97;mework to &#115;eamles&#115;ly combine Acti&#118;eX and Qt. ActiveQt co&#110;sists of two modules:</p>
<ul><li><p class="docList">The <span class="docEmphasis">QA&#120;Container</span><a name="allows us"></a> module allows us to use COM &#111;bjects and to embed ActiveX controls in Qt applica&#116;ions.</p></li><li><p class="docList">The <span class="docEmphasis">QAxServer</span><a name="ActiveX controls"></a> module allows us to export &#99;ustom COM ob&#106;ects and &#65;ctiveX &#99;ontrols wri&#116;ten using Qt.</p></li></ul>
<p class="docText"><a name="the Windows"></a>Ou&#114; first example will emb&#101;d the Windows Media Player i&#110; a &#81;t a&#112;plication using &#116;he <span class="docEmphasis">QAxCont&#97;iner</span> module (see <a class="docLink" href="#ch23fig03">Figure 23.3</a>). The Qt application a&#100;ds an <span class="docEmphRomanAlt">Open</span> button, a <span class="docEmphRomanAlt">Play/Pause</span> button, &#97; <span class="docEmphRomanAlt">Stop</span> button, and a slider to the Windows Media Play&#101;r ActiveX control.</p>
<a name="ch23fig03"></a><p><center>

<h5 class="docFigureTitle">Figure 23.3. The Media Player ap&#112;lic&#97;tion</h5>

<p class="docText">
<img border="0" id="" width="267" height="300" src="images/NzlkOW1jM2FhMDc4L2lwdHJnZTFnMTRzOXIvMy83cHBhZWhqZHIveWVtc2NpaWEuZ3Bs.jpg" alt="" /></p>



</center></p><br />
<p class="docText">The a&#112;pli&#99;ation's main &#119;indow is of type <tt>&#80;layerWindow</tt>:</p>
<div class="docText"><div class="codeSegmentsExpansionLinks">
              Code View:</div><pre class="">class PlayerWindow : public QWidget
{
    Q_OBJECT
    Q_ENUMS(ReadyStateConstants)

public:
    enum PlayStateConstants { Stopped = 0, Paused = 1, Playing = 2 };
    enum ReadyStateConstants { Uninitialized = 0, Loading = 1,
                               Interactive = 3, Complete = 4 };
    PlayerWindow();

protected:
    void timerEvent(QTimerEvent *event);
private slots:
    void onPlayStateChange(int oldState, int newState);
    void onReadyStateChange(ReadyStateConstants readyState);
    void onPositionChange(double oldPos, double newPos);
    void sliderValueChanged(int newValue);
    void openFile();

private:
    QAxWidget *wmp;
    QToolButton *openButton;
    QToolButton *playPauseButton;
    QToolButton *stopButton;
    QSlider *seekSlider;
    QString fileFilters;
    int updateTimer;
};

					  </pre></div><br />
<p class="docText"><a name="iddle4324"></a><a name="iddle4593"></a><a name="iddle4751"></a><a name="iddle4771"></a><a name="iddle4777"></a><a name="iddle4778"></a><a name="iddle7162"></a><a name="iddle7470"></a><a name="iddle7541"></a>The <tt>PlayerW&#105;ndow</tt> class is derived from <tt>QWidget</tt>. T&#104;e <tt>Q_ENU&#77;S()</tt> macro (ju&#115;t below <tt>Q_OB&#74;ECT</tt>) is ne&#99;essary to tell <tt>moc</tt> that the <tt>ReadySt&#97;teConstants</tt> type used in t&#104;e <tt>onReadyStateChange()</tt><a name="a"></a> slot is an enum type. In the private &#115;ection, we declare a <tt>QAxWidget *</tt> member variable.</p>
<div class="docText"><pre>PlayerWindow::PlayerWindow()
{
    wmp = new QAxWidget;
    wmp-&gt;setControl("{22D6F312-B0F6-11D0-94AB-0080C74C7E95}");</pre></div><br />
<p class="docText">In the constructor, &#119;e start by cr&#101;at&#105;ng a <tt>QAx&#87;idget</tt><a name="ActiveX control"></a> obj&#101;ct to encaps&#117;late the Windows Medi&#97; Player ActiveX control. The <span class="docEmphasis">QAxContainer</span> mod&#117;le consis&#116;s of thre&#101; classes: <tt>QAxO&#98;ject</tt> encapsulates &#97; COM object, <tt>QAxWidget</tt> enc&#97;psulates an ActiveX control, and <tt>QAxBase</tt> implements th&#101; core COM functionality for <tt>QAxObject</tt> and <tt>QAxW&#105;dget</tt>. The relationships between these classes are i&#108;lustrated &#105;n <a class="docLink" href="#ch23fig04">Figure 23.4</a>.</p>

<p class="docText"></p><a name="ch23fig04"></a><p><center>

<h5 class="docFigureTitle">Figur&#101; 23.4. In&#104;erita&#110;ce tr&#101;e for the <span class="docEmphasis">QAxC&#111;ntainer</span> module</h5>

<p class="docText">
<img border="0" id="" width="226" height="94" src="images/NzlkOW1jM2FhMDc4L2lwdHJnZTFnMTRzOXIvMy83cC4zaGZpZmcvaXMyaWNnMDQ-.jpg" alt="" /></p>


</center></p><br />
<p class="docText"><a name="iddle1834"></a><a name="iddle2312"></a><a name="iddle2890"></a><a name="iddle3128"></a><a name="iddle4108"></a><a name="iddle4537"></a><a name="iddle4753"></a><a name="iddle5472"></a><a name="iddle6456"></a><a name="iddle6602"></a><a name="iddle7292"></a><a name="iddle7323"></a><a name="iddle8414"></a><a name="iddle8582"></a>We call <tt>setControl()</tt> on t&#104;e <tt>QAxW&#105;dget</tt><a name="will create"></a> wi&#116;h the class ID of t&#104;e Windows &#77;edia Player 6.4 control. Thi&#115; will create an instance of &#116;he required component. From t&#104;en on, all the properties, events, and methods of the ActiveX control &#97;re availa&#98;le as Qt pro&#112;ert&#105;es, sign&#97;ls, and slots throug&#104; the <tt>QAxWidget</tt> ob&#106;ect.</p>
<p class="docText"><a name="types are"></a>The COM data types are automatically conv&#101;rt&#101;d i&#110;to th&#101; correspo&#110;ding Qt types, as summar&#105;zed in <a class="docLink" href="#ch23fig05">Figure 23.5</a><a name="of type"></a>. For example, an in-parameter of t&#121;pe <tt>VARIANT_BOOL</tt><a name="becomes a"></a> becomes a <tt>bool</tt><a name="of type"></a>, and an out-parameter o&#102; type <tt>VARIANT_BOOL</tt><a name="a"></a> becomes a <tt>bool &amp;</tt>. If the resu&#108;ting type i&#115; a Qt cla&#115;s (<tt>QStri&#110;g</tt>, <tt>&#81;DateTime</tt>, et&#99;.), the in-parameter is a co&#110;st reference (e.g., <tt>const QString &amp;</tt>).</p>
<a name="ch23fig05"></a><p><table cellspacing="0" class="allBorders" border="1"><caption><h5 class="docTableTitle">Figure 23.5. Relati&#111;ns&#104;ip bet&#119;een COM types and Qt t&#121;pes</h5></caption><colgroup align="left" span="2"><col width="350" /><col width="200" /></colgroup><thead><tr><th scope="col" class="docTableCell thead" align="center" valign="top" style="background-color:#E6E6E6">COM Typ&#101;s</th><th scope="col" class="docTableCell thead" align="center" valign="top" style="background-color:#E6E6E6">Qt Types</th></tr></thead><tr><td class="docTableCell" align="left" valign="top"><tt>VARIANT_BOOL</tt></td><td class="docTableCell" align="left" valign="top"><tt>b&#111;ol</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>char</tt><span class="docEmphRomanAlt">,</span> <tt>short</tt><span class="docEmphRomanAlt">,</span> <tt>int</tt><span class="docEmphRomanAlt">,</span> <tt>long</tt></td><td class="docTableCell" align="left" valign="top"><tt>int</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>unsigned char</tt><span class="docEmphRomanAlt">,</span> <tt>uns&#105;gned short</tt><span class="docEmphRomanAlt">,</span> <tt>unsigned int</tt><span class="docEmphRomanAlt">,</span> <tt>unsigned long</tt></td><td class="docTableCell" align="left" valign="top"><tt>&#117;int</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>float</tt><span class="docEmphRomanAlt">,</span> <tt>double</tt></td><td class="docTableCell" align="left" valign="top"><tt>double</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>CY</tt></td><td class="docTableCell" align="left" valign="top"><tt>qlonglong</tt><span class="docEmphRomanAlt">,</span> <tt>qulonglong</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>BSTR</tt></td><td class="docTableCell" align="left" valign="top"><tt>QS&#116;ring</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>DAT&#69;</tt></td><td class="docTableCell" align="left" valign="top"><tt>QDateTime</tt><span class="docEmphRomanAlt">,</span> <tt>Q&#68;ate</tt><span class="docEmphRomanAlt">,</span> <tt>QTime</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>O&#76;E_COLOR</tt></td><td class="docTableCell" align="left" valign="top"><tt>Q&#67;olor</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>SAFEARRAY(VA&#82;IANT)</tt></td><td class="docTableCell" align="left" valign="top"><tt>QList&lt;QVa&#114;iant&gt;</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>SAFEARRAY(BSTR)</tt></td><td class="docTableCell" align="left" valign="top"><tt>QStringList</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>SAFEA&#82;RAY(&#66;YTE)</tt></td><td class="docTableCell" align="left" valign="top"><tt>QByt&#101;Array</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>VAR&#73;ANT</tt></td><td class="docTableCell" align="left" valign="top"><tt>QVariant</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>I&#70;ontDisp *</tt></td><td class="docTableCell" align="left" valign="top"><tt>QFont</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><tt>IPi&#99;tureDisp *</tt></td><td class="docTableCell" align="left" valign="top"><tt>QPixmap</tt></td></tr><tr><td class="docTableCell" align="left" valign="top"><span class="docEmphRomanAlt">User define&#100; type</span></td><td class="docTableCell" align="left" valign="top"><tt>QRect</tt><span class="docEmphRomanAlt">,</span> <tt>QSize</tt><span class="docEmphRomanAlt">,</span> <tt>QPoint</tt></td></tr></table></p><br />
<p class="docText"><a name="in a"></a>To obta&#105;n the list of the properties, signals, and slots availa&#98;le in a <tt>QAxO&#98;ject</tt> or <tt>QAx&#87;idget</tt> wit&#104; their &#81;t data types, c&#97;ll <tt>QAxBase::gene&#114;ateDocumentation()</tt> or use Qt's <tt>dumpdoc</tt> comman&#100;-l&#105;ne tool, &#108;ocated in Qt's <tt>tools\a&#99;tiveqt\dumpdo&#99;</tt> directory.</p>
<p class="docText">Let's continue with the <tt>Pl&#97;yerWindow</tt> constructor:</p>
<div class="docText"><pre>    wmp-&gt;setProperty("ShowControls", false);
    wmp-&gt;setSizePolicy(QSizePolicy::Expanding, QSizePolicy::Expanding);
    connect(wmp, SIGNAL(PlayStateChange(int, int)),
            this, SLOT(onPlayStateChange(int, int)));
    connect(wmp, SIGNAL(ReadyStateChange(ReadyStateConstants)),
            this, SLOT(onReadyStateChange(ReadyStateConstants)));
    connect(wmp, SIGNAL(PositionChange(double, double)),
            this, SLOT(onPositionChange(double, double)));</pre></div><br />
<p class="docText">After calling <tt>QAxWidget::se&#116;Control()</tt>, we call <tt>QObject::setProperty()</tt> to set the <tt>ShowControls</tt><a name="Player to"></a> p&#114;operty of the Windows Media Player to <tt>false</tt>, since we &#112;rov&#105;de our o&#119;n buttons to &#109;anipulate t&#104;e compone&#110;t. <tt>QObject::setP&#114;operty()</tt><a name="normal Qt"></a> can be used b&#111;th &#102;or C&#79;M properties and for &#110;ormal Qt &#112;roperties. Its seco&#110;d parameter is of type <tt>QVariant</tt>.</p>
<p class="docText">Nex&#116;, we call <tt>setSizePolicy()</tt><a name="the available"></a> to make the ActiveX control take &#97;ll the available space in the layout, and we conn&#101;ct &#116;hree Act&#105;veX eve&#110;t&#115; from the CO&#77; component to three slots.</p>
<div class="docText"><pre>    ...
    stopButton = new QToolButton;
    stopButton-&gt;setText(tr("&amp;Stop"));
    stopButton-&gt;setEnabled(false);
    connect(stopButton, SIGNAL(clicked()), wmp, SLOT(Stop()));
    ...
}</pre></div><br />
<p class="docText"><a name="iddle1400"></a><a name="iddle1996"></a><a name="iddle2036"></a><a name="iddle2559"></a><a name="iddle3147"></a><a name="iddle3316"></a><a name="iddle4109"></a><a name="iddle4129"></a><a name="iddle4325"></a><a name="iddle4547"></a><a name="iddle5465"></a><a name="iddle5476"></a><a name="iddle7002"></a><a name="iddle8083"></a><a name="iddle8086"></a><a name="iddle8407"></a><a name="iddle8408"></a><a name="iddle8583"></a>Th&#101; rest of the <tt>PlayerWindow</tt><a name="signals to"></a> constructo&#114; follo&#119;s the usual p&#97;ttern, except &#116;hat we conn&#101;ct some Qt signals to sl&#111;ts provided by the COM object (<tt>Play()</tt>, <tt>P&#97;use()</tt>, and <tt>Stop()</tt><a name="are similar"></a>). Since the buttons are similar, we have shown &#111;nly the <span class="docEmphRomanAlt">Stop</span> button's implementation h&#101;re.</p>
<p class="docText"><a name="constructor and"></a>&#76;et's leav&#101; th&#101; co&#110;structor a&#110;d look at the <tt>timerEve&#110;t()</tt> function:</p>
<div class="docText"><pre>void PlayerWindow::timerEvent(QTimerEvent *event)
{
    if (event-&gt;timerId() == updateTimer) {
        double curPos = wmp-&gt;property("CurrentPosition").toDouble();
        onPositionChange(-1, curPos);
    } else {
        QWidget::timerEvent(event);
    }
}</pre></div><br />
<p class="docText"><a name="The"></a>The <tt>timerEvent()</tt><a name="called at"></a> &#102;unc&#116;ion is ca&#108;led at regular interva&#108;s while a medi&#97; clip is playing. We use it to advanc&#101; the slider. This is done by calling <tt>p&#114;operty()</tt><a name="the ActiveX"></a> on the ActiveX control to o&#98;tain the value of the <tt>CurrentPosition</tt> property as &#97; <tt>QVariant</tt> &#97;nd callin&#103; <tt>toDo&#117;ble()</tt> to con&#118;ert it to a <tt>doub&#108;e</tt>. We then call <tt>onPositionC&#104;ange()</tt> to perform the update.</p>
<p class="docText"><a name="iddle1266"></a><a name="iddle1366"></a><a name="iddle1734"></a><a name="iddle1974"></a><a name="iddle2316"></a><a name="iddle2568"></a><a name="iddle3138"></a><a name="iddle3258"></a><a name="iddle3266"></a><a name="iddle3373"></a><a name="iddle3814"></a><a name="iddle4467"></a><a name="iddle4752"></a><a name="iddle4754"></a><a name="iddle4755"></a><a name="iddle4756"></a><a name="iddle4772"></a><a name="iddle4774"></a><a name="iddle4779"></a><a name="iddle6425"></a><a name="iddle6426"></a><a name="iddle6843"></a><a name="iddle7464"></a><a name="iddle7536"></a><a name="iddle7828"></a><a name="iddle7829"></a><a name="iddle7830"></a><a name="because most"></a>We will &#110;o&#116; review t&#104;e rest of t&#104;e code because mos&#116; of it isn't directly relevant to Ac&#116;iveX and doesn't show anything tha&#116; we haven't covered already. The code is inclu&#100;ed with the book's examples.</p>
<p class="docText">In t&#104;e <tt>.pro</tt><a name="link with"></a> f&#105;le, we ne&#101;d t&#104;is ent&#114;y to link &#119;ith the <span class="docEmphasis">QAxContainer</span> modu&#108;e:</p>
<div class="docText"><pre>CONFIG += qaxcontainer</pre></div><br />
<p class="docText"><a name="to be"></a>One frequent need when dea&#108;ing with CO&#77; objects i&#115; to be able to call a C&#79;M method direct&#108;y (as opposed to conn&#101;cting it to a Qt signal). The easiest way &#116;o do this is to invoke <tt>QAxBase::dynamicCall()</tt><a name="method as"></a> with &#116;he name and signature of the method as the fi&#114;st par&#97;meter and &#116;he argum&#101;nt&#115; to the meth&#111;d as additiona&#108; parameters. For example:</p>
<div class="docText"><pre>wmp-&gt;dynamicCall("TitlePlay(uint)", 6);</pre></div><br />
<p class="docText">The <tt>dynamicCall()</tt> function take&#115; up to ei&#103;ht pa&#114;ameters of ty&#112;e <tt>QVariant</tt> and &#114;eturns a <tt>QVariant</tt>. If we need t&#111; pass an <tt>IDispatch *</tt> or an <tt>IUnknown *</tt> this &#119;ay, we can encapsulate the component in a <tt>QAxO&#98;ject</tt> and call <tt>asVariant()</tt> on it to convert it to a <tt>QVariant</tt><a name="an"></a>. If w&#101; ne&#101;d t&#111; ca&#108;l a COM meth&#111;d that ret&#117;rns an <tt>IDispatch *</tt> or an <tt>IUn&#107;nown *</tt><a name="need to"></a>, or if we need to access a COM property of o&#110;e &#111;f t&#104;ose types, w&#101; can u&#115;e <tt>querySubObject()</tt> instead:</p>
<div class="docText"><pre>QAxObject *session = outlook.querySubObject("Session");
QAxObject *defaultContacts =
        session-&gt;querySubObject("GetDefaultFolder(OlDefaultFolders)",
                                "olFolderContacts");</pre></div><br />
<p class="docText"><a name="want to"></a>&#73;f we want to call methods that have unsupport&#101;d data types in their parameter list, w&#101; can use <tt>QAxBase::queryInterface()</tt><a name="to retrieve"></a> to retrie&#118;e the COM in&#116;erface a&#110;d &#99;all the meth&#111;d directly. &#65;s usual with COM, we must call <tt>R&#101;lease()</tt><a name="have finished"></a> when we have finished usi&#110;g &#116;he inter&#102;ace. If we o&#102;ten ne&#101;d to call such methods, &#119;e can subclass <tt>QAxObject</tt> or <tt>QAxWidget</tt><a name="provide member"></a> an&#100; provide member functions that encapsulate the COM &#105;nterface calls. Be aware that <tt>QAxObject</tt> and <tt>QAxWidget</tt> su&#98;classes ca&#110;n&#111;t d&#101;fi&#110;e their own &#112;roperties, sign&#97;ls, or slots.</p>
<p class="docText">We will now review the <span class="docEmphasis">QAxServe&#114;</span><a name="program into"></a> modul&#101;. Th&#105;s module en&#97;bles us to turn a sta&#110;dard Qt program into an &#65;ctiveX server. The server can be eithe&#114; a shared library or a stand-alone applic&#97;tion. Servers built as shared libraries are often called <span class="docEmphasis">in-pr&#111;ce&#115;s serve&#114;s</span>; stan&#100;-a&#108;one applications are &#99;alled <span class="docEmphasis">out-of-process &#115;ervers</span>.</p>
<p class="docText">Our first <span class="docEmphasis">QAxServer</span><a name="provides a"></a> example is an in-pr&#111;ce&#115;s serve&#114; that provide&#115; a widget that sho&#119;s a ball bouncing left and right. We wi&#108;l also see how to embed the widget i&#110; Internet Explorer.</p>
<p class="docText">Here's &#116;he beginning of the class definition of th&#101; <tt>Ax&#66;ouncer</tt> w&#105;dget:</p>
<div class="docText"><pre>class AxBouncer : public QWidget, public QAxBindable
{
    Q_OBJECT
    Q_ENUMS(SpeedValue)
    Q_PROPERTY(QColor color READ color WRITE setColor)
    Q_PROPERTY(SpeedValue speed READ speed WRITE setSpeed)
    Q_PROPERTY(int radius READ radius WRITE setRadius)
    Q_PROPERTY(bool running READ isRunning)</pre></div><br />
<p class="docText"><a name="iddle3808"></a><a name="iddle3860"></a><a name="iddle3948"></a><a name="iddle4594"></a><a name="iddle5438"></a><a name="iddle7471"></a><a name="iddle7542"></a><tt>Ax&#66;ouncer</tt>, s&#104;own in <a class="docLink" href="#ch23fig06">Figure 23.6</a>, is deriv&#101;d from both <tt>QWidg&#101;t</tt> and <tt>QAxBindable</tt>. The <tt>QAx&#66;indable</tt><a name="ActiveX client"></a> &#99;lass provid&#101;s an i&#110;terf&#97;ce between the widget a&#110;d an ActiveX client. Any <tt>QWidget</tt><a name="by subclassing"></a> can b&#101; exported as an ActiveX control, but by subcl&#97;ssing <tt>QAxBindable</tt><a name="can implement"></a> we can notify the client when a property's va&#108;ue changes, &#97;nd we can i&#109;plement COM &#105;nterfa&#99;es to supplement those al&#114;eady implemented by <span class="docEmphasis">QA&#120;Server</span>.</p>
<a name="ch23fig06"></a><p><center>

<h5 class="docFigureTitle">Figure 23.6. The <tt>Ax&#66;ouncer</tt> w&#105;dget in &#73;nterne&#116; Explorer</h5>

<p class="docText">
<img border="0" id="" width="446" height="468" src="images/NzlkOW1jM2FhMDc4L2lwdHJnZTFnMTRzOXIvMy83cC5vaHVwZ2ovaXNibmNjZXI-.jpg" alt="" /></p>



</center></p><br />
<p class="docText"><a name="inheritance involving"></a>When d&#111;ing multiple inheri&#116;ance involving a <tt>QObject</tt><a name="always put"></a>-derived class, we &#109;ust always put the <tt>QObject</tt><a name="class first"></a>-derived class first s&#111; that <tt>moc</tt><a name="it up"></a> can pick it up.</p>
<p class="docText"><a name="declare three"></a>We declare three read-write pr&#111;pe&#114;ties a&#110;d &#111;ne &#114;ead-only property. &#84;he <tt>Q_ENUMS()</tt> macro is &#110;ecessary to tell <tt>moc</tt> that the <tt>SpeedV&#97;lue</tt><a name="the public"></a> type i&#115; an enum &#116;ype. The enu&#109; is declared in the pu&#98;lic section of the class:</p>
<div class="docText"><pre>public:
    enum SpeedValue { Slow, Normal, Fast };

    AxBouncer(QWidget *parent = 0);

    void setSpeed(SpeedValue newSpeed);
    SpeedValue speed() const { return ballSpeed; }
    void setRadius(int newRadius);
    int radius() const { return ballRadius; }
    void setColor(const QColor &amp;newColor);
    QColor color() const { return ballColor; }
    bool isRunning() const { return myTimerId != 0; }
    QSize sizeHint() const;
    QAxAggregated *createAggregate();

public slots:
    void start();
    void stop();

signals:
    void bouncing();</pre></div><br />
<p class="docText"><a name="iddle1267"></a><a name="iddle1269"></a><a name="iddle2682"></a><a name="iddle4110"></a><a name="iddle4538"></a><a name="iddle4548"></a><a name="iddle4758"></a><a name="iddle4759"></a><a name="iddle4765"></a><a name="iddle6883"></a><a name="iddle7148"></a><a name="iddle8584"></a>The <tt>AxB&#111;uncer</tt><a name="for a"></a> constructor is a standard constructo&#114; for a widget, with a <tt>parent</tt> parameter. The <tt>QAXF&#65;CTORY_DEFAULT()</tt><a name="constructor with"></a> macro, which we will use to export the compone&#110;t, &#101;xp&#101;ct&#115; a const&#114;uctor with this sig&#110;ature.</p>
<p class="docText">The <tt>createA&#103;gregate()</tt> function is reimpleme&#110;t&#101;d f&#114;om <tt>QAxBindable</tt>. &#87;e will explain it in a m&#111;ment.</p>
<div class="docText"><pre>protected:
    void paintEvent(QPaintEvent *event);
    void timerEvent(QTimerEvent *event);

private:
    int intervalInMilliseconds() const;

    QColor ballColor;
    SpeedValue ballSpeed;
    int ballRadius;
    int myTimerId;
    int x;
    int delta;
};</pre></div><br />
<p class="docText"><a name="class are"></a>The protected an&#100; private sections of the class are the &#115;ame as those we would have if this was a standard Q&#116; widget.</p>
<div class="docText"><pre>AxBouncer::AxBouncer(QWidget *parent)
    : QWidget(parent)
{
    ballColor = Qt::blue;
    ballSpeed = Normal;
    ballRadius = 15;
    myTimerId = 0;
    x = 20;
    delta = 2;
}</pre></div><br />
<p class="docText">The <tt>AxBouncer</tt> constructor initializes the class'&#115; privat&#101; va&#114;iable&#115;.</p>
<div class="docText"><pre>void AxBouncer::setColor(const QColor &amp;newColor)
{
    if (newColor != ballColor &amp;&amp; requestPropertyChange("color")) {
        ballColor = newColor;
        update();
        propertyChanged("color");
    }
}</pre></div><br />
<p class="docText"><a name="iddle1104"></a><a name="iddle1268"></a><a name="iddle1270"></a><a name="iddle1271"></a><a name="iddle1272"></a><a name="iddle1273"></a><a name="iddle1853"></a><a name="iddle1899"></a><a name="iddle3259"></a><a name="iddle3307"></a><a name="iddle3374"></a><a name="iddle4084"></a><a name="iddle4749"></a><a name="iddle4750"></a><a name="iddle4757"></a><a name="iddle6423"></a><a name="iddle6424"></a><a name="iddle6844"></a><a name="iddle7296"></a><a name="iddle7329"></a><a name="iddle7708"></a><a name="iddle7770"></a><a name="iddle7819"></a><a name="iddle7827"></a>The <tt>set&#67;olor()</tt> function sets &#116;he value of the <tt>colo&#114;</tt> property. It calls <tt>update()</tt> to repain&#116; the widg&#101;t.</p>
<p class="docText">T&#104;e unusual part is &#116;he <tt>requestPrope&#114;tyChange()</tt> and <tt>p&#114;opertyChanged()</tt> calls. These functions a&#114;e inherited from <tt>QAxBindable</tt> and should ideally &#98;e called whenever we change a property. The <tt>re&#113;uest&#80;r&#111;pe&#114;tyCha&#110;ge()</tt> as&#107;s the client's permis&#115;ion to change a property, an&#100; r&#101;tu&#114;ns <tt>true</tt> if &#116;he client allows t&#104;e change. The <tt>propert&#121;Changed()</tt> function notifies the clien&#116; that the property has been changed.</p>
<p class="docText">The <tt>s&#101;tSpeed()</tt> and <tt>setRadius()</tt> setters also follow this patter&#110;, a&#110;d &#115;o do the <tt>&#115;tart()</tt> an&#100; <tt>stop()</tt> slots, &#115;ince they change t&#104;e value of the <tt>running</tt> prop&#101;rt&#121;.</p>
<p class="docText">On&#101; interestin&#103; <tt>AxBouncer</tt> memb&#101;r function is left:</p>
<div class="docText"><pre>QAxAggregated *AxBouncer::createAggregate()
{
    return new ObjectSafetyImpl;
}</pre></div><br />
<p class="docText">The <tt>createAggreg&#97;te()</tt> function is reimplement&#101;d from <tt>QAxBindable</tt>. It allows us to imple&#109;ent COM interfaces that the <span class="docEmphasis">QAxServer</span> module doesn'&#116; already &#105;mpleme&#110;t &#111;r t&#111; bypass <span class="docEmphasis">&#81;AxServer</span>'s defa&#117;lt COM interfaces. Here, we do it to pro&#118;ide the <tt>IOb&#106;ectSafe&#116;y</tt><a name="the standard"></a> interface, which I&#110;tern&#101;t Explorer uses to ac&#99;ess a component's safety options. Thi&#115; is the standard trick to get rid of Int&#101;rnet Explorer's infamous &quot;Object not safe for scr&#105;pting&quot; e&#114;ror me&#115;sage.</p>
<p class="docText"><a name="the class"></a>He&#114;e's the &#100;efini&#116;ion of the class that im&#112;lements the <tt>IObjectSafety</tt> interf&#97;ce:</p>
<div class="docText"><pre>class ObjectSafetyImpl : public QAxAggregated, public IObjectSafety
{
public:
    long queryInterface(const QUuid &amp;iid, void **iface);

    QAXAGG_IUNKNOWN

    HRESULT WINAPI GetInterfaceSafetyOptions(REFIID riid,
            DWORD *pdwSupportedOptions, DWORD *pdwEnabledOptions);
    HRESULT WINAPI SetInterfaceSafetyOptions(REFIID riid,
            DWORD pdwSupportedOptions, DWORD pdwEnabledOptions);
};</pre></div><br />
<p class="docText">The <tt>Obj&#101;ct&#83;afetyIm&#112;l</tt><a name="derived from"></a> class is deri&#118;ed from both <tt>QAxAggregated</tt><a name="and"></a> and <tt>IO&#98;jectSafety</tt>. The <tt>QAxAggreg&#97;ted</tt><a name="an abstract"></a> class is an abstract base class for implementatio&#110;s of additional COM interfaces. The COM object th&#97;t the <tt>QAxA&#103;greg&#97;ted</tt><a name="is accessible"></a> exten&#100;s &#105;s accessible th&#114;ough <tt>controllin&#103;Unknown()</tt>. The <span class="docEmphasis">QAxServer</span> modul&#101; cr&#101;at&#101;s this COM &#111;bject &#98;ehind the scenes.</p>
<p class="docText">The <tt>QAXAGG_IUNKNOWN</tt> macro p&#114;ovides standard implement&#97;tions of <tt>QueryInterface()</tt>, <tt>AddRef()</tt>, and <tt>Rele&#97;se()</tt><a name="controlling COM"></a>. These implementations simply call the same func&#116;ions on t&#104;e cont&#114;ollin&#103; COM o&#98;ject.</p>
<div class="docText"><pre>long ObjectSafetyImpl::queryInterface(const QUuid &amp;iid, void **iface)
{
    *iface = 0;
    if (iid == IID_IObjectSafety) {
        *iface = static_cast&lt;IObjectSafety *&gt;(this);
    } else {
        return E_NOINTERFACE;
    }
    AddRef();
    return S_OK;
}</pre></div><br />
<p class="docText"><a name="iddle2683"></a><a name="iddle2914"></a><a name="iddle4766"></a><a name="iddle7250"></a>The <tt>query&#73;nterface()</tt><a name="function of"></a> func&#116;ion is a pure virtual function of <tt>QAxAggrega&#116;ed</tt><a name="give access"></a>. It is c&#97;lled by th&#101; cont&#114;olling COM o&#98;ject to give access to the interfaces &#112;rovided by the <tt>QAxAggregated</tt> subcl&#97;ss. We must return <tt>E_NOINTERFACE</tt> for interfaces that we don't &#105;mplement and for <tt>IUnknown</tt>.</p>
<div class="docText"><pre>HRESULT WINAPI ObjectSafetyImpl::GetInterfaceSafetyOptions(
        REFIID /* riid */, DWORD *pdwSupportedOptions,
        DWORD *pdwEnabledOptions)
{
    *pdwSupportedOptions = INTERFACESAFE_FOR_UNTRUSTED_DATA
                           | INTERFACESAFE_FOR_UNTRUSTED_CALLER;
    *pdwEnabledOptions = *pdwSupportedOptions;
    return S_OK;
}

HRESULT WINAPI ObjectSafetyImpl::SetInterfaceSafetyOptions(
        REFIID /* riid */, DWORD /* pdwSupportedOptions */,
        DWORD /* pdwEnabledOptions */)
{
    return S_OK;
}</pre></div><br />
<p class="docText">The <tt>GetInterf&#97;ceSafety&#79;ptions()</tt> and <tt>S&#101;tI&#110;t&#101;rfaceSafety&#79;ptions()</tt> functions are de&#99;lared in <tt>IObjectSafety</tt><a name="that our"></a>. We implement &#116;hem to te&#108;l the world &#116;hat our object is saf&#101; for scrip&#116;ing.</p>
<p class="docText">Let's now review <tt>main.cpp</tt>:</p>
<div class="docText"><pre>#include &lt;QAxFactory&gt;

#include"axbouncer.h"

QAXFACTORY_DEFAULT(AxBouncer,
                   "{5e2461aa-a3e8-4f7a-8b04-307459a4c08c}",
                   "{533af11f-4899-43de-8b7f-2ddf588d1015}",
                   "{772c14a5-a840-4023-b79d-19549ece0cd9}",
                   "{dbce1e56-70dd-4f74-85e0-95c65d86254d}",
                   "{3f3db5e0-78ff-4e35-8a5d-3d3b96c83e09}")</pre></div><br />
<p class="docText">The <tt>QAXFA&#67;TORY_DEFAULT()</tt><a name="servers that"></a> macro exports an Acti&#118;eX control. We can use it for ActiveX servers that export only &#111;ne control. The next example in this section will &#115;how how &#116;o export &#109;any ActiveX &#99;ontrols.</p>
<p class="docText"><a name="to"></a>The &#102;irst argumen&#116; to <tt>QAXFACTORY_DEFAULT()</tt><a name="name of"></a> is th&#101; name of the Qt class to export. This is also t&#104;e name &#117;nder whic&#104; the cont&#114;ol is exp&#111;rted. The other five <a name="iddle1117"></a><a name="iddle1118"></a><a name="iddle1735"></a><a name="iddle2053"></a><a name="iddle2563"></a><a name="iddle2564"></a><a name="iddle3081"></a><a name="iddle3129"></a><a name="iddle3390"></a><a name="iddle3745"></a><a name="iddle3816"></a><a name="iddle4468"></a><a name="iddle4512"></a><a name="iddle4582"></a><a name="iddle5324"></a><a name="iddle5339"></a><a name="iddle6746"></a><a name="iddle6827"></a><a name="iddle7003"></a><a name="iddle7851"></a><a name="iddle8467"></a><a name="arguments are"></a>a&#114;guments are the class ID, the interf&#97;ce ID, the event interface ID, the type library ID, and &#116;he application ID. We can use standard tools such as <tt>guidg&#101;n</tt> o&#114; <tt>uuidg&#101;n</tt><a name="these identifiers"></a> t&#111; ge&#110;erate th&#101;se identifiers. Bec&#97;use the server is a library, we don't &#110;e&#101;d a <tt>&#109;ain()</tt> function.</p>
<p class="docText">H&#101;re's the <tt>.pro</tt><a name="for our"></a> &#102;ile for our in-process Activ&#101;X server:</p>
<div class="docText"><pre>TEMPLATE       = lib
CONFIG        += dll qaxserver
HEADERS        = axbouncer.h \
                 objectsafetyimpl.h
SOURCES        = axbouncer.cpp \
                 main.cpp \
                 objectsafetyimpl.cpp
RC_FILE        = qaxserver.rc
DEF_FILE       = qaxserver.def</pre></div><br />
<p class="docText">The <tt>qaxserv&#101;r.rc</tt> and <tt>qaxserver.def</tt> files referr&#101;d to in the <tt>.pro</tt> file are standard files that can be copied fr&#111;m Q&#116;'s <tt>src\act&#105;veqt\co&#110;t&#114;ol</tt> direct&#111;ry.</p>
<p class="docText">The makefi&#108;e or Visual C++ project file generated by <tt>qm&#97;ke</tt><a name="To register"></a> contai&#110;s &#114;ules to re&#103;ister the se&#114;ver in the Windows registry. To re&#103;ister the server on end-user machi&#110;es, we can use the <tt>regsvr32</tt> tool available &#111;n all Windows systems.</p>
<p class="docText"><a name="Bouncer component"></a>We can then include the Bounc&#101;r c&#111;mp&#111;ne&#110;t &#105;n an HTML page usi&#110;g the <tt>&lt;object&gt;</tt> tag:</p>
<div class="docText"><pre>&lt;object id="AxBouncer"
        classid="clsid:5e2461aa-a3e8-4f7a-8b04-307459a4c08c"&gt;
&lt;b&gt;The ActiveX control is not available. Make sure you have built and
registered the component server.&lt;/b&gt;
&lt;/object&gt;</pre></div><br />
<p class="docText">We ca&#110; create buttons that invoke slots:</p>
<div class="docText"><pre>&lt;input type="button" value="Start" onClick="AxBouncer.start()"&gt;
&lt;input type="button" value="Stop" onClick="AxBouncer.stop()"&gt;</pre></div><br />
<p class="docText"><a name="just like"></a>We can m&#97;nipulate &#116;he widge&#116; using JavaScript or &#86;BScript just like &#97;ny other ActiveX control. See t&#104;e <tt>demo.html</tt><a name="rudimentary page"></a> file included with the book's exampl&#101;s for a rudimentary page that uses the &#65;ctiveX server.</p>
<p class="docText"><a name="can serve"></a>Our last example is a scriptable Address Book &#97;pplicati&#111;n. T&#104;e appl&#105;cation &#99;an serve as a standar&#100; Qt/Windows applicati&#111;n or an out-of-process ActiveX &#115;erver. T&#104;e latt&#101;r poss&#105;bility allows us t&#111; script the applic&#97;tion using, say, Visual Basic.</p>
<div class="docText"><div class="codeSegmentsExpansionLinks">
              Code View:</div><pre class="">class AddressBook : public QMainWindow
{
    Q_OBJECT
    Q_PROPERTY(int count READ count)
    Q_CLASSINFO("ClassID", "{588141ef-110d-4beb-95ab-ee6a478b576d}")
    Q_CLASSINFO("InterfaceID", "{718780ec-b30c-4d88-83b3-79b3d9e78502}")
    Q_CLASSINFO("ToSuperClass", "AddressBook")
public:
    AddressBook(QWidget *parent = 0);
    ~AddressBook();

    int count() const;

public slots:
    ABItem *createEntry(const QString &amp;contact);
    ABItem *findEntry(const QString &amp;contact) const;
    ABItem *entryAt(int index) const;

private slots:
    void addEntry();
    void editEntry();
    void deleteEntry();

private:
    void createActions();
    void createMenus();

    QTreeWidget *treeWidget;
    QMenu *fileMenu;
    QMenu *editMenu;
    QAction *exitAction;
    QAction *addEntryAction;
    QAction *editEntryAction;
    QAction *deleteEntryAction;
};

					  </pre></div><br />
<p class="docText"><a name="iddle2684"></a><a name="iddle4760"></a><a name="iddle4763"></a><a name="iddle4767"></a><a name="iddle4768"></a><a name="iddle4770"></a><a name="iddle4775"></a>The <tt>Add&#114;essBook</tt><a name="main window"></a> widget is the application's main window. The wi&#100;get's property and its public &#115;lots wi&#108;l be availa&#98;le for scri&#112;tin&#103;. The <tt>Q_CLASSINFO()</tt><a name="used to"></a> &#109;acro is used to specify th&#101; class and interface IDs associ&#97;ted with t&#104;e clas&#115;. These were &#103;enerated using &#97; tool such as <tt>guid</tt><a name="or"></a> or <tt>uuid</tt>.</p>
<p class="docText"><a name="previous example"></a>In the previou&#115; example, we specified the clas&#115; and interface IDs when we export&#101;d the <tt>QAxBouncer</tt><a name="using the"></a> class using the <tt>QAXFACTORY_DEFA&#85;LT()</tt><a name="cannot use"></a> macr&#111;. In &#116;his exam&#112;le, w&#101; want &#116;o export several classes, so we &#99;annot use <tt>QAXFACTORY_DEFAULT()</tt>. Two optio&#110;s &#97;re availa&#98;le to us:</p>
<ul><li><p class="docList">We can subclas&#115; <tt>QAxFactory</tt><a name="provide information"></a>, reim&#112;lement its virtual functi&#111;ns to provide information abou&#116; the types we want to export, and use the <tt>QAXFA&#67;TORY_EXPORT()</tt> macro to register the factory.</p></li><li><p class="docList">We can use t&#104;e <tt>QAXF&#65;CTORY_B&#69;GIN()</tt>, <tt>QAXFACT&#79;RY_END()</tt>, <tt>QAXCL&#65;SS()</tt>, and <tt>QAXTYPE()</tt><a name="us to"></a> m&#97;cros to declare and register th&#101; factory. This approach requires us to spec&#105;fy the c&#108;ass and int&#101;rface IDs usi&#110;g <tt>Q_CL&#65;SSINFO()</tt>.</p></li></ul>
<p class="docText">Back to the <tt>Addr&#101;ssBook</tt> class definition: The third oc&#99;urrence of <tt>Q_CLASSINFO()</tt><a name="expose not"></a> may seem a bit mysterious. By defaul&#116;, ActiveX controls expose not only their own prope&#114;ties, s&#105;gnals, a&#110;d &#115;lots to &#99;lients, but also those of &#116;heir ancestors &#117;p to <tt>QWidget</tt>. The <tt>ToSuperClass</tt><a name="tree that"></a> attrib&#117;te lets us &#115;pecify &#116;he highest ances&#116;or in the inherit&#97;nce tree that we want to expose. Here, w&#101; specify the class name of &#116;he component (<tt>AddressBook</tt><a name="ancestor to"></a>) as the hi&#103;hest ancestor to export, meaning that <a name="iddle1045"></a><a name="iddle1082"></a><a name="iddle1693"></a><a name="iddle3657"></a><a name="iddle5442"></a><a name="iddle6408"></a><a name="iddle6826"></a><a name="iddle7854"></a><a name="iddle7867"></a><a name="iddle8316"></a><a name="inherited from"></a>propert&#105;es, sign&#97;ls, and slo&#116;s inheri&#116;ed from <tt>A&#100;dressBo&#111;k</tt><a name="own ancestors"></a>'s own ancestors &#119;ill not be exported.</p>
<div class="docText"><pre>class ABItem : public QObject, public QTreeWidgetItem
{
    Q_OBJECT
    Q_PROPERTY(QString contact READ contact WRITE setContact)
    Q_PROPERTY(QString address READ address WRITE setAddress)
    Q_PROPERTY(QString phoneNumber READ phoneNumber
               WRITE setPhoneNumber)
    Q_CLASSINFO("ClassID", "{bc82730e-5f39-4e5c-96be-461c2cd0d282}")
    Q_CLASSINFO("InterfaceID", "{c8bc1656-870e-48a9-9937-fbe1ceff8b2e}")
    Q_CLASSINFO("ToSuperClass", "ABItem")

public:
    ABItem(QTreeWidget *treeWidget);

    void setContact(const QString &amp;contact);
    QString contact() const { return text(0); }
    void setAddress(const QString &amp;address);
    QString address() const { return text(1); }
    void setPhoneNumber(const QString &amp;number);
    QString phoneNumber() const { return text(2); }

public slots:
    void remove();
};</pre></div><br />
<p class="docText">The <tt>ABItem</tt><a name="one entry"></a> c&#108;ass repres&#101;nt&#115; one entry in th&#101; addr&#101;ss book. It is derived from <tt>QTr&#101;eWidgetItem</tt><a name="that it"></a> so that it can be &#115;hown in a <tt>QTreeWidget</tt> and from <tt>QObject</tt> so th&#97;t it can be exported as a COM object.</p>
<div class="docText"><pre>int main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    if (!QAxFactory::isServer()) {
        AddressBook addressBook;
        addressBook.show();
        return app.exec();
    }
    return app.exec();
}</pre></div><br />
<p class="docText">In <tt>main()</tt><a name="as a"></a>, we che&#99;k whether th&#101; ap&#112;lic&#97;tion is be&#105;ng run stand-alon&#101; or as a server. The <tt>-act&#105;vex</tt> command-line option is recognized by <tt>QApplica&#116;ion</tt><a name="as a"></a> and m&#97;kes the ap&#112;lication run a&#115; a server. If the &#97;pplication isn't run as a serve&#114;, we create the main widget and s&#104;ow it as we would normally do in any &#115;tand-alone Qt application.</p>
<p class="docText">In addition to <tt>-activex</tt>, Ac&#116;iveX ser&#118;ers unders&#116;and the f&#111;ll&#111;wing &#99;ommand-line options:</p>
<ul><li><p class="docList"><tt>-reg&#115;erver</tt> registers the server in &#116;he syste&#109; registry.</p></li><li><p class="docList"><tt>-un&#114;egserver</tt> unregis&#116;ers the serv&#101;r from the system regi&#115;try.</p></li><li><p class="docList"><a name="iddle1736"></a><a name="iddle2313"></a><a name="iddle2685"></a><a name="iddle3139"></a><a name="iddle3256"></a><a name="iddle4469"></a><a name="iddle4761"></a><a name="iddle4764"></a><a name="iddle4769"></a><a name="iddle4776"></a><a name="iddle6747"></a><a name="iddle7120"></a><a name="iddle8616"></a><a name="iddle8688"></a><tt>-dumpidl</tt> <span class="docEmphasis"><tt>file.idl</tt></span> writes t&#104;e server's IDL to the specified file.</p></li></ul>
<p class="docText"><a name="export the"></a>&#87;hen the application is run as a server, we must export t&#104;e <tt>Addr&#101;ss&#66;ook</tt> and <tt>A&#66;Item</tt> cla&#115;ses as COM component&#115;:</p>
<div class="docText"><pre>QAXFACTORY_BEGIN("{2b2b6f3e-86cf-4c49-9df5-80483b47f17b}",
                 "{8e827b25-148b-4307-ba7d-23f275244818}")
QAXCLASS(AddressBook)
QAXTYPE(ABItem)
QAXFACTORY_END()</pre></div><br />
<p class="docText"><a name="creating COM"></a>The preceding macros export &#97; factory for creating COM objects. Sinc&#101; we &#119;ant to expor&#116; two types of COM o&#98;jects, we cann&#111;t simply use <tt>QAXFACTORY_DE&#70;AULT()</tt> as we did in t&#104;e previous example.</p>
<p class="docText">The first argument to <tt>QAXFACTORY_BEGI&#78;()</tt><a name="Between"></a> is the type library ID; the second argument is the application ID. &#66;etween <tt>Q&#65;XFACTO&#82;Y_BE&#71;IN()</tt> &#97;nd <tt>QAXFACTORY_EN&#68;()</tt><a name="the classes"></a>, we specify all the classes tha&#116; can be instantiated and all the data types t&#104;at we w&#97;nt to make &#97;ccessible as &#67;OM objects.</p>
<p class="docText"><a name="the"></a>This is &#116;he <tt>.pro</tt><a name="file for"></a> file for our out-of-process Activ&#101;X server:</p>
<div class="docText"><pre>TEMPLATE      = app
CONFIG       += qaxserver
HEADERS       = abitem.h \
                addressbook.h \
                editdialog.h
SOURCES       = abitem.cpp \
                addressbook.cpp \
                editdialog.cpp \
                main.cpp
FORMS         = editdialog.ui
RC_FILE       = qaxserver.rc</pre></div><br />
<p class="docText">The <tt>qaxserv&#101;r.rc</tt><a name="to in"></a> file referred to in the <tt>.pro</tt><a name="is a"></a> file is a stand&#97;rd file that can be copied from Qt's <tt>src\activeqt\contro&#108;</tt> directory.</p>
<p class="docText">&#76;ook in th&#101; ex&#97;mple's <tt>vb</tt><a name="Address Book"></a> d&#105;rectory fo&#114; a Visual Basic proje&#99;t that uses the Address Book server.</p>
<p class="docText"><a name="the ActiveQt"></a>T&#104;is com&#112;let&#101;s our overvie&#119; of the ActiveQt &#102;ramework. The Qt distrib&#117;tion includes additional examples, and the docum&#101;ntation contains information about how to build the <span class="docEmphasis">QA&#120;Container</span> and <span class="docEmphasis">QAxServer</span> modules and &#104;ow to s&#111;lv&#101; co&#109;mon interop&#101;rability issu&#101;s.</p>

</div></div>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch23lev1sec1.html><img src="images/prev.gif" width="20" height="20" border="0" align="absmiddle" alt="Previous Page"></a>
<a href=ch23lev1sec3.html><img src="images/next.gif" width="20" height="20" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>