<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 3.4.&nbsp; Basic Style Guidelines</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch03lev1sec3.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch03lev1sec5.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><TD valign="top"><a href="14051536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a><a name="ch03lev1sec4"></a>
<h3 id="title-IDA3IJ3D" class="docSection1Title">3.4. Basic Style Guidelines</H3>
<p class="docText"><span class="docEmphStrong"><span class="docEmphasis">Comments</span></span></p>
<p class="docText">You do not need to be reminded that comments are useful both to you and those who come after you. This is especially true for code that has been untouched by man (or woman) for a time (that <a name="iddle1752"></a><a name="iddle2341"></a><a name="iddle2346"></a><a name="iddle2406"></a>means several months in software development time). Comments should not be absent, nor should there be novellas. Keep the comments explanatory, clear, short, and concise, but get them <span class="docEmphasis">in</span> there. In the end, it saves time and energy for everyone. Above all, make sure they stay accurate!</P>
<p class="docText"><span class="docEmphStrong"><span class="docEmphasis">Documentation</span></span></P>
<p class="docText">Python also provides a mechanism whereby documentation strings can be retrieved dynamically through the <tt>__doc__</tt> special variable. The first unassigned string in a module, class declaration, or function declaration can be accessed using the attribute <span class="docEmphasis"><tt>obj</tt></span>.<tt>__doc__</tt> where <span class="docEmphasis"><tt>obj</tt></span> is the module, class, or function name. This works during runtime too!</P>
<p class="docText"><span class="docEmphStrong"><span class="docEmphasis">Indentation</span></span></P>
<p class="docText">Since indentation plays a major role, you will have to decide on a spacing style that is easy to read as well as the least confusing. Common sense also plays a role in choosing how many spaces or columns to indent.</p>
<p><table cellspacing="0" FRAME="void" RULES="none" cellpadding="5"><colgroup align="left" span="2"><col width="100"><col width="300"></colgroup><thead></thead><tr><TD class="docTableCell" align="left" valign="top"><p class="docText">1 or 2</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Probably not enough; difficult to determine which block of code statements belong to</P></td></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText">8 to 10</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">May be too many; code that has many embedded levels will wrap around, causing the source to be difficult to read</P></td></tr></table></P><br>
<p class="docText">Four spaces is very popular, not to mention being the preferred choice of Python's creator. Five and six are not bad, but text editors usually do <span class="docEmphasis">not</span> use these settings, so they are not as commonly used. Three and seven are borderline cases.</p>
<p class="docText">As far as tabs go, bear in mind that different text editors have different concepts of what tabs are. It is advised not to use tabs if your code will live and run on different systems or be accessed with different text editors.</p>
<p class="docText"><span class="docEmphStrong"><span class="docEmphasis">Choosing Identifier Names</span></span></P>
<p class="docText">The concept of good judgment also applies in choosing logical identifier names. Decide on short yet meaningful identifiers for variables. Although variable length is no longer an issue with programming languages of today, it is still a good idea to keep name sizes reasonable length. The same applies for naming your modules (Python files).</P>
<a name="ch03lev2sec15"></a>

<h4 id="title-IDAHNJ3D" class="docSection2Title">Python Style Guide(s)</h4>
<p class="docText"><a name="iddle1745"></a><a name="iddle2972"></a><a name="iddle3406"></a>Guido van Rossum wrote up a Python Style Guide ages ago. It has since been replaced by no fewer than three PEPs: 7 (Style Guide for C Code), 8 (Style Guide for Python Code), and 257 (DocString Conventions). These PEPs are archived, maintained, and updated regularly.</p>
<p class="docText">Over time, you will hear the term &quot;Pythonic,&quot; which describes the Python way of writing code, organizing logic, and object behavior. Over more time, you will come to understand what that means. There is also another PEP, PEP 20, which lists the Zen of Python, starting you on your journey to discover what Pythonic really means. If you are not online and need to see this list, then use <span class="docEmphStrong"><tt>import</tt></span> <tt>this</tt> from your interpreter. Here are some links:</p>
<p class="docText"><a class="docLink" target="_blank" href="http://www.python.org/doc/essays/styleguide.html">www.python.org/doc/essays/styleguide.html</a></p>
<p class="docText"><a class="docLink" target="_blank" href="http://www.python.org/dev/peps/pep-0007/">www.python.org/dev/peps/pep-0007/</a></p>
<p class="docText"><a class="docLink" target="_blank" href="http://www.python.org/dev/peps/pep-0008/">www.python.org/dev/peps/pep-0008/</a></p>
<p class="docText"><a class="docLink" target="_blank" href="http://www.python.org/dev/peps/pep-0020/">www.python.org/dev/peps/pep-0020/</a></p>
<p class="docText"><a class="docLink" target="_blank" href="http://www.python.org/dev/peps/pep-0257/">www.python.org/dev/peps/pep-0257/</a></p>

<a name="ch03lev2sec16"></a>
<h4 id="title-IDAJPJ3D" class="docSection2Title">3.4.1. Module Structure and Layout</h4>
<p class="docText">Modules are simply physical ways of logically organizing all your Python code. Within each file, you should set up a consistent and easy-to-read structure. One such layout is the following:</p>
<div class="docText"><pre># (1) startup line (Unix)
# (2) module documentation
# (3) module imports
# (4) variable declarations
# (5) class declarations
# (6) function declarations
# (7) "main" body</pre></div><BR>
<p class="docText"><a class="docLink" href="#ch03fig01">Figure 3-1</a> illustrates the internal structure of a typical module.</p>
<a name="ch03fig01"></a><P><center>

<h5 class="docFigureTitle">Figure 3-1. Typical Python file structure</H5>

<p class="docText">
<img border="0" alt="" width="500" height="505" SRC="images/chun_fig03_01.jpg"></p>


</center></P><br>
<a name="ch03pro01"></a>







<table border="0" class="docText"><TR><TD width="25" valign="top"><div class="docText"><B>1. </b></div></TD><td><div class="docText">Startup line<br><br>
<blockquote>
<p class="docText">Generally used only in Unix environments, the startup line allows for script execution by name only (invoking the interpreter is not required).</P>
</blockquote>
</div></td></TR><tr><TD width="25" valign="top"><div class="docText"><b>2. </b></div></TD><TD><div class="docText">Module documentation<br><br>
<blockquote>
<p class="docText">Summary of a module's functionality and significant global variables; accessible externally as <span class="docEmphasis"><tt>module</tt></span>.<tt>__doc__.</tt></p>
</blockquote>
</div></td></TR><tr><td></TD><td></td></tr><TR><TD width="25" valign="top"><div class="docText"><b>3. </b></div></td><td><div class="docText"><a name="iddle1385"></a><a name="iddle1746"></a><a name="iddle2144"></a><a name="iddle2401"></a><a name="iddle4436"></a>Module imports<br><br>
<blockquote>
<p class="docText">Import all the modules necessary for all the code in current module; modules are imported once (when this module is loaded); imports within functions are not invoked until those functions are called.</p>
</blockquote>
</div></td></tr><tr><td width="25" valign="top"><div class="docText"><b>4. </b></div></td><TD><div class="docText">Variable declarations<br><BR>
<blockquote>
<p class="docText">Declare here (global) variables that are used by multiple functions in this module. We favor the use of local variables over globals, for good programming style mostly, and to a lesser extent, for improved performance and less memory usage.</p>
</blockquote>
</div></TD></tr><TR><td width="25" valign="top"><div class="docText"><B>5. </b></div></TD><TD><div class="docText">Class declarations<BR><br>
<blockquote>
<p class="docText">Any classes should be declared here. A class is defined when this module is imported and the <span class="docEmphStrong"><tt>class</tt></span> statement executed. Documentation variable is <span class="docEmphasis"><tt>class</tt></span><tt>.__doc__.</tt></p>
</blockquote>
</div></td></TR><tr><TD></td><TD></td></TR><TR><td width="25" valign="top"><div class="docText"><b>6. </b></div></td><td><div class="docText"><a name="iddle1904"></a><a name="iddle2145"></a><a name="iddle2381"></a><a name="iddle2766"></a><a name="iddle3031"></a>Function declarations<BR><br>
<blockquote>
<p class="docText">Functions that are declared here are accessible externally as <span class="docEmphasis"><tt>module.function()</tt></span>; function is defined when this module is imported and the <span class="docEmphStrong"><tt>def</tt></span> statement executed. Documentation variable is <span class="docEmphasis"><tt>function</tt></span><tt>.__doc__</tt>.</p>
</blockquote>
</div></TD></tr><tr><td width="25" valign="top"><div class="docText"><B>7. </b></div></TD><td><div class="docText">&quot;main&quot; body<br><br>
<blockquote>
<p class="docText">All code at this level is executed, whether this module is imported or started as a script; generally does not include much functional code, but rather gives direction depending on mode of execution.</p>
</blockquote>
</div></td></tr></table>
<a name="ch03note03"></a><div class="docNote"><p class="docNoteTitle">Core Style: &quot;main&quot; calls <tt>main( )</tt></p><p><table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><img border="0" alt="" align="LEFT" width="50" height="46" SRC="images/core_style.jpg">


</td><td valign="top"><p class="docText"><span class="docEmphasis">The main body of code tends to contain lines such as the ones you see above, which check the</span> <tt>__name__</tt> <span class="docEmphasis">variable and take appropriate action (see Core Note on the following page). Code in the main body typically executes the class, function, and variable declarations, then checks</span> <tt>__name__</tt> <span class="docEmphasis">to see whether it should invoke another function (often called</span> <tt>main()</tt><span class="docEmphasis">), which performs the primary duties of this module. The main body usually does no more than that. (Our example above uses</span> <tt>test()</tt> <span class="docEmphasis">rather than</span> <tt>main()</tt> <span class="docEmphasis">to avoid confusion until you read this Core Style sidebar.)</span></P><p class="docText"><span class="docEmphasis">Regardless of the name, we want to emphasize that this is a great place to put a test suite in your code. As we explain in <a class="docLink" href="#ch03lev2sec17">Section 3.4.2</a>, most Python modules are created for import use only, and calling such a module directly should invoke a regression test of the code in such a module.</span></p></TD></tr></table></P></div><br>
<p class="docText">Most projects tend to consist of a single application and import any required modules. Thus it is important to bear in mind that most modules are created solely to be imported rather than to execute as scripts. We are more likely to create a Python library-style module whose sole purpose is to be imported by another module. After all, only one of the modulesthe one that houses the main applicationwill be executed, either by a user from the command line, by a batch or timed mechanism such as a Unix <tt>cron</tt> job, via a Web server call, or through a GUI callback.</P>
<p class="docText">With that fact in hand, we should also remember that all modules have the ability to execute code. All Python statements in the highest level of codethat is, the lines that are not indentedwill be executed on import, whether desired or not. Because of this &quot;feature,&quot; safer code is written such that everything is in a function except for the code that should be executed on an import of a module. Again, usually only the main application module has the bulk of the executable code at its highest level. All other imported modules <a name="iddle3032"></a><a name="iddle4153"></a>will have very little on the outside, and everything in functions or classes. (See Core Note that follows for more information.)</p>
<a name="ch03note04"></a><div class="docNote"><p class="docNoteTitle">Core Note: <tt>__name__</tt> indicates how module was loaded</P><P><table width="90%" border="0" cellspacing="0" cellpadding="1"><TR><TD width="60" valign="top"><img border="0" alt="" align="LEFT" width="50" height="50" SRC="images/core_note.jpg">


</td><td valign="top"><p class="docText"><span class="docEmphasis">Because the &quot;main&quot; code is executed whether a module is imported or executed directly, we often need to know how this module was loaded to guide the execution path. An application may wish to import the module of another application, perhaps to access useful code which will otherwise have to be duplicated (not the OO thing to do). However, in this case, you only want access to this other application's code, not necessarily to run it. So the big question is, &quot;Is there a way for Python to detect at runtime whether this module was imported or executed directly?&quot; The answer is ... (drum roll ... ) yes! The</span> <tt>__name__</tt> <span class="docEmphasis">system variable is the ticket.</span></p><UL><li><p class="docList"><tt>__name__</tt> <span class="docEmphasis">contains module name if imported</span></P></li><LI><p class="docList"><tt>__name__</tt> <span class="docEmphasis">contains</span> <tt>'__main__'</tt> <span class="docEmphasis">if executed directly</span></p></LI></UL></td></tr></table></p></div><br>

<a name="ch03lev2sec17"></a>
<H4 id="title-IDAY0J3D" class="docSection2Title">3.4.2. Create Tests in the Main Body</h4>
<p class="docText">For good programmers and engineers, providing a test suite or harness for our entire application is the goal. Python simplifies this task particularly well for modules created solely for import. For these modules, you know that they would never be executed directly. Wouldn't it be nice if they were invoked to run code that puts that module through the test grinder? Would this be difficult to set up? Not really.</p>
<p class="docText">The test software should run only when this file is executed directly, i.e., not when it is imported from another module, which is the usual case. Above and in the Core Note, we described how we can determine whether a module was imported or executed directly. We can take advantage of this mechanism by using the <tt>__name__</tt> variable. If this module was called as a script, plug the test code right in there, perhaps as part of <tt>main()</tt> or <tt>test()</tt> (or whatever you decide to call your &quot;second-level&quot; piece of code) function, which is called only if this module is executed directly.</P>
<p class="docText">The &quot;tester&quot; application for our code should be kept current along with any new test criteria and results, and it should run as often as the code is updated. These steps will help improve the robustness of our code, not to mention validating and verifying any new features or updates.</p>
<p class="docText">Tests in the main body are an easy way to provide quick coverage of your code. The Python standard library also provides the <tt>unittest</tt> module, <a name="iddle2834"></a><a name="iddle2843"></a><a name="iddle4437"></a>sometimes referred to as PyUnit, as a testing framework. Use of <tt>unittest</tt> is beyond the scope of this book, but it is something to consider when you need serious regression testing of a large system of components.</p>


<a href="14051536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a></TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch03lev1sec3.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch03lev1sec5.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>