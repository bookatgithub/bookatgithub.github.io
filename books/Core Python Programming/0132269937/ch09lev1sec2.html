<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 9.2.&nbsp; File Built-in Functions [open() and file()]</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch09lev1sec1.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch09lev1sec3.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><TD valign="top"><a href="14051536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a><a name="ch09lev1sec2"></a>
<h3 id="title-IDAOW45H" class="docSection1Title">9.2. File Built-in Functions [<tt>open()</tt> and <tt>file()</tt>]</H3>
<p class="docText">As the key to opening file doors, the <tt>open()</tt> [and <tt>file()</tt>] built-in function provides a general interface to initiate the file input/output (I/O) process. The <tt>open()</tt> BIF returns a file object on a successful opening of the file or else results in an error situation. When a failure occurs, Python generates or <span class="docEmphasis">raises</span> an <tt>IOError</tt> exceptionwe will cover errors and exceptions in the next chapter. The basic syntax of the <tt>open()</tt> built-in function is:</p>
<div class="docText"><pre>file_object = open(file_name, access_mode='r', buffering=-1)</pre></div><BR>
<p class="docText">The <span class="docEmphasis"><tt>file_name</tt></span> is a string containing the name of the file to open. It can be a relative or absolute/full pathname. The <span class="docEmphasis"><tt>access_mode</tt></span> optional variable is also a string, consisting of a set of flags indicating which mode to open the file with. Generally, files are opened with the modes <tt>'r</tt>,<tt>'</tt> <tt>'w</tt>,<tt>'</tt>or <tt>'a</tt>,<tt>'</tt> representing read, write, and append, respectively. A <tt>'U'</tt> mode also exists for universal NEWLINE support (see below).</P>
<p class="docText">Any file opened with mode <tt>'r'</tt> or <tt>'U'</tt> must exist. Any file opened with <tt>'</tt>w<tt>'</tt> will be truncated first if it exists, and then the file is (re)created. Any file opened with <tt>'a'</tt> will be opened for append. All writes to files opened with <tt>'a'</tt> will be from end-of-file, even if you seek elsewhere during access. If the file does not exist, it will be created, making it the same as if you opened the file in <tt>'w'</tt> mode. If you are a C programmer, these are the same file open modes used for the C library function <tt>fopen()</tt>.</P>
<p class="docText">There are other modes supported by <tt>fopen()</tt> that will work with Python's <tt>open()</tt>. These include the <tt>'+'</tt> for read-write access and <tt>'b'</tt> for binary access. One note regarding the binary flag: <tt>'b'</tt> is antiquated on all Unix systems that are POSIX-compliant (including Linux) because they treat all files as binary files, including text files. Here is an entry from the <a name="iddle1052"></a><a name="iddle1234"></a><a name="iddle1977"></a>Linux manual page for <tt>fopen()</tt>, from which the Python <tt>open()</tt> function is derived:</P>
<blockquote>
<p class="docText">The mode string can also include the letter &quot;b&quot; either as a last character or as a character between the characters in any of the two-character strings described above. This is strictly for compatibility with ANSI C3.159-1989 (&quot;ANSI C&quot;) and has no effect; the &quot;b&quot; is ignored on all POSIX conforming systems, including Linux. (Other systems may treat text files and binary files differently, and adding the &quot;b&quot; may be a good idea if you do I/O to a binary file and expect that your program may be ported to non-Unix environments.)</p>
</blockquote>
<p class="docText">You will find a complete list of file access modes, including the use of <tt>'b'</tt> if you choose to use it, in <a class="docLink" href="#ch09table01">Table 9.1</a>. If <span class="docEmphasis"><tt>access_mode</tt></span> is not given, it defaults automatically to <tt>'r</tt>.<tt>'</tt></p>
<a name="ch09table01"></a><p><table cellspacing="0" FRAME="hsides" RULES="none" cellpadding="5"><caption><H5 class="docTableTitle">Table 9.1. Access Modes for File Objects</h5></caption><colgroup align="left" span="2"><col width="100"><col width="350"></colgroup><thead><TR><th class="thead" scope="col" align="left" valign="bottom"><p class="docText"><span class="docEmphasis">File Mode</span></p></th><th class="thead" scope="col" align="left" valign="bottom"><p class="docText"><span class="docEmphasis">Operation</span></P></th></tr></thead><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>r</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Open for read</p></TD></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>rU or U</tt><sup class="docFootnote"><a class="docLink" href="#ch09tna1">[a]</a></sup></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Open for read with universal NEWLINE support (PEP 278)</P></TD></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>w</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Open for write (truncate if necessary)</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>a</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Open for append (always works from EOF, create if necessary)</P></td></TR><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>r+</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Open for read and write</P></TD></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>w+</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Open for read and write (see <tt>w</tt> above)</p></TD></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>a+</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Open for read and write (see <tt>a</tt> above)</p></TD></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>rb</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Open for binary read</P></TD></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>wb</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Open for binary write (see <tt>w</tt> above)</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>ab</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Open for binary append (see <tt>a</tt> above)</P></td></TR><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>rb+</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Open for binary read and write (see <tt>r+</tt> above)</P></TD></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>wb+</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Open for binary read and write (see <tt>w+</tt> above)</p></TD></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>ab+</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Open for binary read and write (see <tt>a+</tt> above)</p></TD></tr></table></p><BR><blockquote><p class="docFootnote"><sup><a name="ch09tna1">[a]</a></sup> New in Python 2.5.</p></blockquote>
<p class="docText">The other optional argument, <span class="docEmphasis"><tt>buffering</tt></span>, is used to indicate the type of buffering that should be performed when accessing the file. A value of 0 means <a name="iddle1235"></a><a name="iddle1974"></a><a name="iddle1985"></a><a name="iddle2016"></a><a name="iddle3077"></a><a name="iddle4315"></a><a name="iddle4358"></a>no buffering should occur, a value of 1 signals line buffering, and any value greater than 1 indicates buffered I/O with the given value as the buffer size. The lack of or a negative value indicates that the system default buffering scheme should be used, which is line buffering for any teletype or tty-like device and normal buffering for everything else. Under normal circumstances, a <span class="docEmphasis"><tt>buffering</tt></span> value is not given, thus using the system default.</p>
<p class="docText">Here are some examples for opening files:</p>
<div class="docText"><pre>fp = open('/etc/motd')        #open file for read
fp = open('test', 'w')        #open file for write
fp = open('data', 'r+')       #open file for read/write
fp = open(r'c:\io.sys', 'rb') #open binary file for read</pre></div><BR>
<a name="ch09lev2sec1"></a>
<H4 id="title-IDAGE55H" class="docSection2Title">9.2.1.  The <tt>file()</tt> Factory Function</h4>

<p class="docText">
<img border="0" alt="" width="50" height="48" SRC="images/2_2.jpg"></p>


<p class="docText">The <tt>file()</tt> built-in function came into being in <a class="docLink" href="ch05lev1sec2.html#ch05lev3sec2">Python 2.2</a>, during the types and classes unification. At this time, many built-in types that did not have associated built-in functions were given factory functions to create instances of those objects, i.e., <tt>dict()</tt>, <tt>bool()</tt>, <tt>file()</tt>, etc., to go along with those that did, i.e., <tt>list()</tt>, <tt>str()</tt>, etc.</p>
<p class="docText">Both <tt>open()</tt> and <tt>file()</tt> do exactly the same thing and one can be used in place of the other. Anywhere you see references to <tt>open()</tt>, you can mentally substitute <tt>file()</tt> without any side effects whatsoever.</p>
<p class="docText">For foreseeable versions of Python, both <tt>open()</tt> and <tt>file()</tt> will exist side by side, performing the exact same thing. Generally, the accepted style is that you use <tt>open()</tt> for reading/writing files, while <tt>file()</tt> is best used when you want to show that you are dealing with file objects, i.e., <span class="docEmphStrong"><tt>if</tt></span> <tt>instance(f, file)</tt>.</p>

<a name="ch09lev2sec2"></a>
<h4 id="title-IDAQG55H" class="docSection2Title">9.2.2. Universal NEWLINE Support (UNS)</h4>
<p class="docText">In an upcoming Core Note sidebar, we describe how certain attributes of the <tt>os</tt> module can help you navigate files across different platforms, all of which terminate lines with different endings, i.e., <tt>\n</tt>, <tt>\r</tt>, or <tt>\r\n</tt>. Well, the Python interpreter has to do the same thing, toothe most critical place is when importing modules. Wouldn't it be nicer if you just wanted Python to treat all files the same way?</p>

<p class="docText">
<img border="0" alt="" width="50" height="47" SRC="images/2_3.jpg"></p>


<p class="docText">That is the whole point of the UNS, introduced in <a class="docLink" href="ch05lev1sec2.html#ch05lev3sec3">Python 2.3</a>, spurred by PEP 278. When you use the <tt>'U'</tt> flag to open a file, all line separators (or terminators) will be returned by Python via any file input method, i.e., <tt>read*()</tt>, as a NEWLINE character ( <tt>\n</tt> ) regardless of what the line-endings are. (The <tt>'rU'</tt> mode is also supported to correlate with the <tt>'rb'</tt> option.) This feature will also <a name="iddle1981"></a><a name="iddle1994"></a><a name="iddle2009"></a><a name="iddle2010"></a><a name="iddle2011"></a><a name="iddle2436"></a><a name="iddle2883"></a><a name="iddle3550"></a><a name="iddle3555"></a><a name="iddle3557"></a><a name="iddle4520"></a>support files that have multiple types of line-endings. A <tt>file.newlines</tt> attribute tracks the types of line separation characters &quot;seen.&quot;</p>
<p class="docText">If the file has just been opened and no line-endings seen, <tt>file.newlines</tt> is <tt>None</tt>. After the first line, it is set to the terminator of the first line, and if one more type of line-ending is seen, then <tt>file.newlines</tt> becomes a tuple containing each type seen. Note that UNS only applies to reading text files. There is no equivalent handling of file output.</p>
<p class="docText">UNS is turned on by default when Python is built. If you do not wish to have this feature, you can disable it by using the <tt>--without-universal-newlines</tt> switch when running Python's <tt>configure</tt> script. If you must manage the line-endings yourself, then check out the Core Note and use those <tt>os</tt> module attributes!</p>


<a href="14051536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a></TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch09lev1sec1.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch09lev1sec3.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>