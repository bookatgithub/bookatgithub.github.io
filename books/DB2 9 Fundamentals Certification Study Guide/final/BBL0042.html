<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Understanding Constraints</title>
<link rel="STYLESHEET" type="text/css" href="images/css1.css">
<link rel="STYLESHEET" type="text/css" href="images/css2.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=BBL0041.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=BBL0043.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><div class="chapter">
<a NAME="CH06"></a>
<div CLASS="SECTION">
<h2 class="first-section-title">
<a NAME="689"></a><a NAME="CH06LEV1SEC3"></a>Understanding Constraints</h2>
<p CLASS="FIRST-PARA">Within most businesses, data often must adhere to a certain set of rules and restrictions. For example, companies typically have a specific format and numbering sequence they use when generating purchase orders. Constraints allow you to place the logic needed to enforce such business rules directly in the database rather than in applications that work with the database. Essentially, constraints are rules that govern how data values can be added to a table, as well as how those values can be modified once they have been added. The following types of constraints are available:</p>
<ul class="ITEMIZEDLIST">
<li class="first-listitem">
<p CLASS="first-para">
<span CLASS="FIXED">NOT NULL</span> constraints</p> 
</li>
<li class="LISTITEM">
<p class="first-para">Default constraints</p> 
</li>
<li CLASS="listitem">
<p class="FIRST-PARA">
<span CLASS="fixed">CHECK</span> constraints</p>
</li>
<li class="LISTITEM">
<p CLASS="first-para">
<span class="FIXED">UNIQUE</span> constraints</p> 
</li>
<li CLASS="listitem">
<p class="FIRST-PARA">Referential integrity constraints</p> 
</li>
<li CLASS="listitem">
<p CLASS="FIRST-PARA">Informational constraints</p> 
</li>
</ul>
<p CLASS="PARA">Constraints are usually defined during table creation; however, constraints can also be added to existing tables using the <span CLASS="FIXED">ALTER TABLE</span> SQL statement.</p>
<div CLASS="SECTION">
<h3 CLASS="SECT3-TITLE">
<a name="690"></a><a name="CH06LE"></a>NOT NULL Constraints</h3>
<p CLASS="first-para">With DB2, null values (not to be confused with empty strings) are used to represent missing or unknown data and/or states. By default, every column in a table will accept a null value. This allows you to add records to a table when not all of the values that pertain to the record are known. However, there may be times when this behavior is unacceptable (for example, a tax identification number might be required for every employee who works for a company). When such a situation arises, the <span class="fixed">NOT NULL</span> constraint can be used to ensure that a particular column in a base table is never assigned a null value; once the <span CLASS="FIXED">NOT NULL</span> constraint has been defined for a column, any operation that attempts to place a null value in that column will fail. <a class="internaljump" href="#ch0">Figure 6-1</a> illustrates how the <span class="FIXED">NOT NULL</span> constraint is used.</p>
<div CLASS="figure">
<a NAME="691"></a><a NAME="ch06fig01"></a><span CLASS="figuremediaobject"><a NAME="IMG_97" href="images/fig394_01_0.jpg" TARGET="_parent"><img border="0" ALT="Image from book" height="283" ID="IMG_97" TITLE="Click To expand" SRC="images/fig394_01.jpg" width="350"></a></span>
<br STYLE="line-height: 1">
<span class="FIGURE-TITLE"><span class="FIGURE-TITLELABEL">Figure 6-1: </span>How the <span CLASS="FIXED">NOT NULL</span> constraint prevents null values.</span>
</div> 
<a NAME="692"></a><a name=""></a>
<p CLASS="last-para">Because <span CLASS="FIXED">NOT NULL</span> constraints are associated with a specific column in a base table, they are usually defined during the table creation process.</p> 
</div>
<div class="section">
<h3 CLASS="SECT3-TITLE">
<a name="693"></a><a name="ch06le"></a>Default Constraints</h3>
<p CLASS="FIRST-PARA">Just as there are times when it is objectionable to accept a null value, there may be times when it is desirable to have the system provide a specific value for you (for example, you might want to automatically assign the current date to a particular column whenever a new record is added to a table). In these situations, the default constraint can be used to ensure that a particular column in a base table is assigned a predefined value (unless that value is overridden) each time a record is added to the table. The predefined value provided could be null (if the <span CLASS="FIXED">NOT NULL</span> constraint has not been defined for the column), a user-supplied value compatible with the column's data type, or a value furnished by the DB2 Database Manager. <a href="#ch06t" CLASS="INTERNALJUMP">Table 6-2</a> shows the default values that can be provided by the DB2 Database Manager for the various DB2 9 data types available.</p>
<a name="694"></a><a name="ch06t"></a>
<table class="TABLE" BORDER="1" id="ch06table02" LINKTABLETOEXCEL="yes">
<caption CLASS="table-title">
<span CLASS="table-title"><span class="TABLE-TITLELABEL">Table 6-2: </span>DB2 Database Manager-Supplied Default Values</span>
<br>
<a CLASS="OBJECT-LINK"  target="_blank"><IMG border="0" alt="" SRC="images/b24-bluearrow.gif" height="11" WIDTH="13"> Open table as spreadsheet</a>
</caption>
<thead>
<tr valign="top">
<th ALIGN="left" CLASS="th" SCOPE="col">
<p class="TABLE-PARA">
<b CLASS="BOLD">Column Data Type</b>
</p> 
</th><th ALIGN="left" class="th" scope="col">
<p CLASS="TABLE-PARA">
<b CLASS="bold">Default Value Provided</b>
</p>
</th>
</tr> 
</thead>
<tbody>
<tr valign="top">
<td CLASS="td" ALIGN="left">
<p class="TABLE-PARA">Small integer (<span class="FIXED">SMALLINT</span>)</p>
</td> <td align="left" CLASS="td">
<p class="TABLE-PARA">0</p>
</td> 
</tr>
<tr valign="top">
<td CLASS="td" align="left">
<p class="table-para">Integer (<span CLASS="fixed">INTEGER</span> or <span class="FIXED">INT</span>)</p> 
</td> <td ALIGN="left" class="td">
<p class="TABLE-PARA">0</p> 
</td> 
</tr> 
<tr VALIGN="top">
<td CLASS="TD" align="left">
<p CLASS="TABLE-PARA">Decimal (<span CLASS="fixed">DECIMAL, DEC, NUMERIC</span>, or <span class="FIXED">NUM</span>)</p> 
</td><td align="left" CLASS="td">
<p CLASS="table-para">0</p>
</td> 
</tr>
<tr VALIGN="top">
<td CLASS="td" ALIGN="left">
<p CLASS="table-para">Single-precision floating-point (<span CLASS="FIXED">REAL</span> or <span CLASS="fixed">FLOAT</span>)</p> 
</td><td align="left" class="TD">
<p class="table-para">0</p>
</td>
</tr> 
<tr valign="top">
<td class="TD" align="left">
<p class="TABLE-PARA">Double-precision floating-point (<span class="FIXED">DOUBLE, DOUBLE PRECISION</span>, or <span class="fixed">FLOAT</span>)</p> 
</td> <td class="TD" align="left">
<p class="TABLE-PARA">0</p> 
</td> 
</tr>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">Fixed-length character string (<span class="FIXED">CHARACTER</span> or <span class="FIXED">CHAR</span>)</p> 
</td><td class="td" align="left">
<p class="TABLE-PARA">A string of blank characters</p> 
</td>
</tr> 
<tr valign="top">
<td class="TD" align="left">
<p class="table-para">Varying-length character string (<span class="fixed">CHARACTER VARYING, CHAR VARYING</span>, or <span class="fixed">VARCHAR</span>)</p> 
</td> <td class="TD" ALIGN="left">
<p CLASS="table-para">A zero-length string</p>
</td> 
</tr>
<tr valign="top">
<td ALIGN="left" CLASS="td">
<p CLASS="TABLE-PARA">Long varying-length character string (<span class="fixed">LONG VARCHAR</span>)</p>
</td> <td align="left" CLASS="td">
<p CLASS="TABLE-PARA">A zero-length string</p> 
</td>
</tr> 
<tr valign="top">
<td class="td" ALIGN="left">
<p class="TABLE-PARA">Fixed-length double-byte character string (<span CLASS="fixed">GRAPHIC</span>)</p> 
</td><td align="left" CLASS="td">
<p class="TABLE-PARA">A string of blank characters</p> 
</td>
</tr>
<tr VALIGN="top">
<td class="TD" ALIGN="left">
<p CLASS="table-para">Varying-length double-byte character string (<span CLASS="FIXED">VARGRAPHIC</span>)</p> 
</td> <td ALIGN="left" CLASS="TD">
<p CLASS="table-para">A zero-length string</p>
</td> 
</tr>
<tr valign="top">
<td align="left" CLASS="td">
<p class="TABLE-PARA">Long varying-length double-byte character string (<span CLASS="FIXED">LONG VARGRAPHIC</span>)</p>
</td><td align="left" class="TD">
<p class="TABLE-PARA">A zero-length string</p> 
</td>
</tr> 
<tr VALIGN="top">
<td CLASS="TD" ALIGN="left">
<p CLASS="TABLE-PARA">Date (<span CLASS="FIXED">DATE</span>)</p> 
</td> <td class="TD" ALIGN="left">
<p class="table-para">The system date at the time the record is added to the table. (When a date column is added to an existing table, existing rows are assigned the date January 01, 0001.)</p>
</td> 
</tr>
<tr VALIGN="top">
<td class="td" ALIGN="left">
<p CLASS="table-para">Time (<span CLASS="fixed">TIME</span>)</p>
</td><td class="td" ALIGN="left">
<p class="table-para">The system time at the time the record is added to the table. (When a time column is added to an existing table, existing rows are assigned the time 00:00:00.)</p>
</td> 
</tr>
<tr valign="top">
<td CLASS="td" ALIGN="left">
<p class="table-para">Timestamp (<span CLASS="fixed">TIMESTAMP</span>)</p> 
</td><td ALIGN="left" class="td">
<p CLASS="table-para">The system date and time (including microseconds) at the time the record is added to the table. (When a timestamp column is added to an existing table, existing rows are assigned a timestamp that corresponds to January 01, 0001, 00:00:00.000000)</p> 
</td> 
</tr> 
<tr valign="top">
<td class="td" ALIGN="left">
<p CLASS="table-para">Binary large object (<span class="fixed">BLOB</span>)</p>
</td> <td ALIGN="left" class="td">
<p class="table-para">A zero-length string</p> 
</td>
</tr>
<tr valign="top">
<td CLASS="td" align="left">
<p CLASS="table-para">Character large object (<span CLASS="fixed">CLOB</span>)</p> 
</td> <td ALIGN="left" class="td">
<p CLASS="table-para">A zero-length string</p>
</td> 
</tr> 
<tr valign="top">
<td class="td" align="left">
<p class="table-para">Double-byte character large object (<span CLASS="fixed">DBCLOB</span>)</p>
</td><td class="td" ALIGN="left">
<p class="table-para">A zero-length string</p>
</td> 
</tr>
<tr VALIGN="top">
<td CLASS="td" ALIGN="left">
<p class="table-para">Double-byte character large object <span CLASS="FIXED">(DBCLOB</span>)</p>
</td> <td ALIGN="left" class="TD">
<p class="table-para">A zero-length string</p>
</td>
</tr> 
<tr VALIGN="top">
<td CLASS="TD" align="left">
<p CLASS="TABLE-PARA">XML document <span CLASS="FIXED">(XML</span>)</p>
</td> <td align="left" class="td">
<p class="table-para">Not applicable</p>
</td>
</tr> 
<tr VALIGN="top">
<td align="left" class="TD">
<p CLASS="TABLE-PARA">Any distinct user-defined data type</p> 
</td><td class="td" align="left">
<p CLASS="table-para">The default value provided for the built-in data type the distinct user-defined data type is based on (typecast to the distinct user-defined data type)</p> 
</td> 
</tr>
</tbody>
<tfoot>
<tr valign="">
<td CLASS="TD" align="left" colspan="2">
<p CLASS="table-para">Adapted from Table 11 on page 67 of the <I xmlns:crossref="http://www.jclark.com/xt/java/com.books24x7.xsl.Crossref" CLASS="CITETITLE">DB2 SQL Reference - Volume 2</I> manual</p>
</td> 
</tr> 
</tfoot>
</table> 
<a name="695"></a><a NAME="n41882"></a><a NAME="696"></a><a name="IDX-"></a>
<p class="para">
<a HREF="#ch06fig02" CLASS="INTERNALJUMP">Figure 6-2</a> illustrates how the default constraint is used.</p> 
<div CLASS="figure">
<a NAME="697"></a><a NAME="CH06FIG02"></a><span CLASS="FIGUREMEDIAOBJECT"><a NAME="IMG_98" HREF="images/fig396_01_0.jpg" target="_parent"><img alt="Image from book" border="0" id="IMG_98" height="332" src="images/fig396_01.jpg" title="Click To expand" width="350"></a></span>
<br style="line-height: 1">
<span class="FIGURE-TITLE"><span class="FIGURE-TITLELABEL">Figure 6-2: </span>How the default constraint is used to provide data values.</span>
</div> 
<a name="698"></a><a name=""></a>
<p class="last-para">Like <span class="fixed">NOT NULL</span> constraints, default constraints are associated with a specific column in a base table and are usually defined during the table creation process.</p> 
</div> 
<div class="SECTION">
<h3 class="sect3-title">
<a name="699"></a><a name="CH06LEV"></a>CHECK Constraints</h3>
<p class="first-para">Sometimes, it is desirable to control what values will be accepted for a particular item and what values will not (for example, a company might decide that all nonexempt employees must be paid, at a minimum, the federal minimum wage). When this is the case, the logic needed to determine whether a value is acceptable can be incorporated directly into the data entry program being used to collect the data. A better way to achieve the same objective is by defining a <span class="fixed">CHECK</span> constraint for the column in the base table that is to receive the data value. A <span class="fixed">CHECK</span> constraint (also known as a <i class="EMPHASIS">table check constraint</i>) can be used to ensure that a particular column in a base table is never assigned an unacceptable value-once a check constraint has been defined for a column, any operation that attempts to place a value that does not meet specific criteria into that column will fail.</p> 
<p class="PARA">
<span class="FIXED">CHECK</span> constraints consist of one or more predicates (which are connected by the keywords <span class="FIXED">AND</span> or <span class="FIXED">OR</span>) that collectively are known as the <i class="emphasis">check condition</i>. This check condition is compared with data values provided, and the result of this comparison is returned as the value <span CLASS="FIXED">TRUE, FALSE</span>, or <span CLASS="fixed">Unknown</span>. If the <span class="FIXED">CHECK</span> constraint returns the value <span CLASS="fixed">TRUE</span>, the value is acceptable, so it is added to the database. If, on the other hand, the <span CLASS="FIXED">CHECK</span> constraint returns the value <span CLASS="FIXED">FALSE</span> or <span class="FIXED">Unknown</span>, the operation attempting to place the value in the database fails, and all changes made by that operation are backed out. However, it is important to note that when the results of a particular operation are rolled back because of a <span class="fixed">CHECK</span> constraint violation, the transaction that invoked that operation is not terminated, and other operations within that transaction are unaffected. <a CLASS="INTERNALJUMP" HREF="#ch06fig03">Figure 6-3</a> illustrates how a simple <span class="fixed">CHECK</span> constraint is used.</p>
<div class="figure">
<a NAME="700"></a><a name="CH0"></a><span CLASS="FIGUREMEDIAOBJECT"><a name="img_99" HREF="images/fig398_01_0.jpg" target="_parent"><img BORDER="0" alt="Image from book" HEIGHT="270" ID="IMG_99" TITLE="Click To expand" SRC="images/fig398_01.jpg" WIDTH="350"></a></span>
<br STYLE="line-height: 1">
<span class="FIGURE-TITLE"><span class="FIGURE-TITLELABEL">Figure 6-3: </span>How a CHECK constraint is used to control what values are accepted by a column.</span>
</div>
<a NAME="701"></a><a name=""></a>
<p CLASS="LAST-PARA">Like <span class="fixed">NOT NULL</span> constraints and default constraints, <span class="fixed">CHECK</span> constraints are associated with a specific column in a base table and are usually defined during the table creation process.</p>
</div>
<div class="SECTION">
<h3 CLASS="SECT3-TITLE">
<a NAME="702"></a><a NAME="ch06lev2sec11"></a>UNIQUE Constraints</h3>
<p CLASS="FIRST-PARA">By default, records that are added to a base table can have the same values assigned to any of the columns available any number of times. As long as the records stored in the table do not contain information that should not be duplicated, this kind of behavior is acceptable. However, there are times when certain pieces of information that make up a record should be unique (for example, if an employee identification number is assigned to each individual who works for a particular company, each number used should be unique-two employees should never be assigned the same employee identification number). In these situations, the <span CLASS="fixed">UNIQUE</span> constraint can be used to ensure that the value(s) assigned to one or more columns when a record is added to a base table are always unique. Once a <span class="fixed">UNIQUE</span> constraint has been defined for one or more columns, any <a NAME="703"></a><a name=""></a>operation that attempts to place duplicate values in those columns will fail. <a CLASS="INTERNALJUMP" href="#ch0">Figure 6-4</a> illustrates how the <span CLASS="fixed">UNIQUE</span> constraint is used.</p>
<div CLASS="FIGURE">
<a NAME="704"></a><a name="CH0"></a><span CLASS="FIGUREMEDIAOBJECT"><a href="images/fig399_01_0.jpg" name="img_100" TARGET="_parent"><img ALT="Image from book" border="0" ID="IMG_100" HEIGHT="280" src="images/fig399_01.jpg" TITLE="Click To expand" width="350"></a></span>
<br style="line-height: 1">
<span CLASS="FIGURE-TITLE"><span CLASS="figure-titlelabel">Figure 6-4: </span>How the <span class="fixed">UNIQUE</span> constraint prevents the duplication of data values.</span>
</div>
<p CLASS="para">Unlike <span class="fixed">NOT NULL</span> constraints, default constraints, and <span class="FIXED">CHECK</span> constraints, which can only be associated with a single column in a base table, <span class="fixed">UNIQUE</span> constraints can be associated with an individual column or a group of columns. However, each column in a base table can only participate in one <span CLASS="FIXED">UNIQUE</span> constraint, regardless of how the columns are grouped. Like the other constraints, <span class="fixed">UNIQUE</span> constraints are usually defined during the table creation process.</p>
<p CLASS="PARA">Regardless of when a <span CLASS="FIXED">UNIQUE</span> constraint is defined, when it is created, the DB2 Database Manager looks to see whether an index for the columns to which the <span CLASS="FIXED">UNIQUE</span> constraint refers already exists. If so, that index is marked as being unique and system-required. If not, an appropriate index is created and marked as being unique and system-required. This index is then used to enforce uniqueness whenever new records are added to the column(s) for which the <span class="fixed">UNIQUE</span> constraint was defined for.</p>
<a NAME="705"></a><a name=""></a>
<table cellpadding="0" border="0" class="TIP" CELLSPACING="0">
<tr>
<td valign="top" CLASS="admon-check"></td><td class="admon-title" VALIGN="top">Tip&nbsp;</td><td VALIGN="top" CLASS="ADMON-BODY">
<p class="FIRST-PARA">Although a unique, system-required index is used to enforce a <span CLASS="fixed">UNIQUE</span> constraint, there is a distinction between defining a <span CLASS="FIXED">UNIQUE</span> constraint and creating a unique index. Even though both enforce uniqueness, a unique index allows <span class="FIXED">NULL</span> values and generally cannot be used in a referential constraint. A <span class="fixed">UNIQUE</span> constraint, on the other hand, does not allow <span CLASS="fixed">NULL</span> values, and can be referenced in a foreign key specification. (The value <span CLASS="fixed">NULL</span> means a column's value is undefined <i class="EMPHASIS">and</i> distinct from any other value, <i CLASS="emphasis">including</i> other <span CLASS="fixed">NULL</span> values.)</p>
</td>
</tr>
</table>
<p class="PARA">A <i class="emphasis">primary key</i>, which we will look at next, is a special form of <span class="fixed">UNIQUE</span> constraint. Only one primary key is allowed per table, and every column that is used to define a primary key must be assigned the <span CLASS="FIXED">NOT NULL</span> constraint. In addition to ensuring that every record added to a table has some unique characteristic, primary keys allow tables to participate in referential constraints.</p>
<p class="last-para">A table can have any number of <span class="FIXED">UNIQUE</span> constraints; however, a table cannot have more than one <span CLASS="fixed">UNIQUE</span> constraint defined on the same set of columns. And because <span class="fixed">UNIQUE</span> constraints are enforced by indexes, all the limitations that apply to indexes (for example, a maximum of 16 columns with a combined length of 255 bytes is allowed, and none of the columns used can have a large object or long character string data type) apply to <span class="FIXED">UNIQUE</span> constraints.</p>
</div>
<div CLASS="SECTION">
<h3 class="sect3-title">
<a NAME="706"></a><a name="CH06LEV"></a>Referential Integrity Constraints</h3>
<p class="FIRST-PARA">If you've worked with a relational database management system for any length of time, you are probably aware that data normalization is a technique used to ensure that there is only one way to get to a single fact. Data normalization is possible because two or more individual base tables can have some type of relationship with one another, and information stored in related base tables can be combined if necessary, using a join operation. This is where referential integrity constraints come into play. Referential integrity constraints (also known as referential constraints and foreign key constraints) are used to define required relationships between two base tables.</p>
<a NAME="707"></a><a NAME="n42202"></a>
<p class="para">To understand how referential constraints work, it helps to look at an example. Suppose you own a small auto parts store, and you use a database to keep track of the inventory you have on hand. Many of the parts you stock will only work with a specific "make" and "model" of an automobile; therefore, your database has one table named <span CLASS="FIXED">MAKE</span> to hold make information and another table named <span CLASS="FIXED">MODEL</span> to hold model information. Since these two tables are related (every model must belong to a make), a referential constraint can be used to ensure that every record that is stored in the <span class="FIXED">MODEL</span> table has a corresponding record in the <span class="FIXED">MAKE</span> table. The relationship between these two tables is established by comparing values that are to be added to the <span CLASS="FIXED">MAKE</span> column of the <span CLASS="FIXED">MODEL</span> table (known as the <i CLASS="EMPHASIS">foreign key</i> of the <i CLASS="EMPHASIS">child table</i>) with the values that currently exist for the set of columns that make up the primary key of the <span CLASS="fixed">MAKE</span> table (known as the <i CLASS="emphasis">parent key</i> of the <i CLASS="emphasis">parent</i> <i CLASS="emphasis">table</i>). To create the referential constraint just described, you would define a primary key, using one or more columns, in the <span class="fixed">MAKE</span> table; then, in the <span class="fixed">MODEL</span> table, you would define a foreign key for one or more corresponding columns that reference the <span class="fixed">MAKE</span> table's primary key. Assuming a column named <span class="fixed">MAKEID</span> is used to create the primary key for the <span class="fixed">MAKE</span> table and a column, also named <span class="fixed">MAKEID</span> is used, to create the foreign key for the <span class="fixed">MODEL</span> table, the referential constraint created would look something like the one shown in <a class="internaljump" href="#ch0">Figure 6-5</a>.</p>
<div class="figure">
<a name="708"></a><a name="ch0"></a><span class="figuremediaobject"><a href="images/fig402_01_0.jpg" name="img_101" target="_parent"><img alt="Image from book" border="0" height="441" id="IMG_101" title="Click To expand" src="images/fig402_01.jpg" width="350"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 6-5: </span>How a referential constraint is used to define a relationship between two tables.</span>
</div>
<a name="709"></a><a name="idx-"></a><a NAME="710"></a><a NAME="n42302"></a>
<p class="para">In this example, a single column is used to define the parent key and the foreign key of the referential constraint. However, as with <span CLASS="fixed">UNIQUE</span> constraints, multiple columns can be used to define both the parent and the foreign key of a referential constraint.</p>
<table BORDER="0" CELLPADDING="0" class="tip" cellspacing="0">
<tr>
<td CLASS="admon-check" VALIGN="top"></td><td valign="top" class="admon-title">Tip&nbsp;</td><td VALIGN="top" class="admon-body">
<p CLASS="first-para">The names of the columns used to create the foreign key of a referential constraint do not have to be the same as the names of the columns used to create the primary key of the constraint (as was the case in the previous example). However, the data types used for the column(s) that make up the primary key and the foreign key of a referential constraint must be identical.</p>
</td>
</tr>
</table>
<p class="para">As you can see, referential constraints are much more complex than <span CLASS="FIXED">NOT NULL </span>constraints, default constraints, <span class="FIXED">CHECK</span> constraints, and <span CLASS="fixed">UNIQUE</span> constraints. In fact, they can be so complex that a set of special terms is used to identify the individual components that can make up a single referential constraint. You may already be familiar with some of them; the complete list of terms used can be seen in <a href="#ch06t" CLASS="INTERNALJUMP">Table 6-3</a>.</p>
<a NAME="711"></a><a NAME="CH06TABLE03"></a>
<table BORDER="1" CLASS="TABLE" LINKTABLETOEXCEL="yes" id="ch06table03">
<caption class="table-title">
<span CLASS="table-title"><span class="TABLE-TITLELABEL">Table 6-3: </span>Referential Integrity Constraint Terminology</span>
<br>
<a  class="OBJECT-LINK" target="_blank"><IMG alt="" BORDER="0" HEIGHT="11" SRC="images/b24-bluearrow.gif" WIDTH="13"> Open table as spreadsheet</a>
</caption>
<thead>
<tr VALIGN="top">
<th class="th" ALIGN="left" scope="col">
<p CLASS="table-para">
<b class="BOLD">Term</b>
</p> 
</th><th CLASS="th" ALIGN="left" SCOPE="col">
<p class="TABLE-PARA">
<b CLASS="bold">Meaning</b>
</p> 
</th>
</tr>
</thead>
<tbody>
<tr valign="top">
<td align="left" CLASS="TD">
<p CLASS="table-para">Unique key</p> 
</td> <td class="TD" ALIGN="left">
<p CLASS="table-para">A column or set of columns in which every row of values is different from the values of all other rows</p> 
</td>
</tr>
<tr valign="top">
<td CLASS="TD" align="left">
<p class="TABLE-PARA">Primary key</p> 
</td> <td ALIGN="left" CLASS="TD">
<p class="TABLE-PARA">A special unique key that does not accept null values</p>
</td>
</tr> 
<tr VALIGN="top">
<td align="left" class="TD">
<p class="TABLE-PARA">Foreign key</p>
</td> <td ALIGN="left" class="td">
<p CLASS="table-para">A column or set of columns in a child table whose values must match those of a parent key in a parent table</p>
</td> 
</tr>
<tr VALIGN="top">
<td CLASS="TD" align="left">
<p CLASS="table-para">Parent key</p> 
</td><td align="left" class="TD">
<p class="table-para">A primary key or unique key in a parent table that is referenced by a foreign key in a referential constraint</p> 
</td> 
</tr> 
<tr valign="top">
<td ALIGN="left" class="td">
<p CLASS="table-para">Parent table</p> 
</td> <td class="TD" ALIGN="left">
<p CLASS="TABLE-PARA">A table that contains a parent key of a referential constraint. (A table can be both a parent table and a dependent table of any number of referential constraints.)</p> 
</td>
</tr>
<tr VALIGN="top">
<td align="left" CLASS="TD">
<p CLASS="TABLE-PARA">Parent row</p> 
</td><td align="left" class="TD">
<p CLASS="table-para">A row in a parent table that has at least one matching row in a dependent table.</p> 
</td>
</tr>
<tr VALIGN="top">
<td class="TD" ALIGN="left">
<p CLASS="table-para">Dependent or child table</p>
</td> <td align="left" class="TD">
<p class="table-para">A table that contains at least one foreign key that references a parent key in a referential constraint. (A table can be both a dependent table and a parent table of any number of referential constraints.)</p> 
</td> 
</tr> 
<tr VALIGN="top">
<td class="TD" align="left">
<p CLASS="TABLE-PARA">Dependent or child row</p> 
</td><td align="left" class="TD">
<p CLASS="table-para">A row in a dependent table that has at least one matching row in a parent table.</p> 
</td>
</tr> 
<tr valign="top">
<td ALIGN="left" class="TD">
<p class="table-para">Descendent table</p>
</td> <td CLASS="td" ALIGN="left">
<p class="TABLE-PARA">A dependent table or a descendent of a dependent table.</p> 
</td> 
</tr>
<tr VALIGN="top">
<td CLASS="TD" align="left">
<p class="table-para">Descendent row</p> 
</td><td ALIGN="left" CLASS="TD">
<p CLASS="TABLE-PARA">A dependent row or a descendent of a dependent row.</p>
</td> 
</tr> 
<tr VALIGN="top">
<td CLASS="td" ALIGN="left">
<p CLASS="TABLE-PARA">Referential cycle</p>
</td> <td CLASS="td" align="left">
<p class="table-para">A set of referential constraints defined in such a way that each table in the set is a descendent of itself.</p> 
</td>
</tr> 
<tr valign="top">
<td align="left" class="TD">
<p class="TABLE-PARA">Self-referencing table</p>
</td><td align="left" class="td">
<p class="TABLE-PARA">A table that is both a parent table and a dependant table in the same referential constraint. (The constraint is known as a self-referencing constraint.)</p> 
</td> 
</tr>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">Self-referencing row</p> 
</td><td class="td" align="left">
<p class="TABLE-PARA">A row that is a parent of itself.</p>
</td>
</tr> 
</tbody>
</table>
<a name="712"></a><a name=""></a>
<p class="PARA">The primary reason referential constraints are created is to guarantee that data integrity is maintained whenever one table object references another. As long as a referential constraint is in effect, the DB2 Database Manager guarantees that, for every row in a child table that has a value in any column that is part of a foreign key, there is a corresponding row in the parent table. So what happens when an SQL operation attempts to manipulate data in a way that would violate a referential constraint? To answer this question, let's look at what could compromise dataintegrity if the checks and balances provided by a referential constraint were not in place:</p> 
<ul class="ITEMIZEDLIST">
<li class="FIRST-LISTITEM">
<p class="first-para">An insert operation could add a row of data to a child table that does not have a matching value in the corresponding parent table. (For example, using our <span class="FIXED">MAKE/MODEL</span> scenario, a record could be added to the <span class="fixed">MODEL</span> table that does not have a corresponding value in the <span class="fixed">MAKE</span> table.)</p> 
</li>
<li class="listitem">
<p class="first-para">An update operation could change an existing value in a child table such that it no longer has a matching value in the corresponding parent table. (For example, a record could be changed in the <span class="FIXED">MODEL</span> table so that it no longer has a corresponding value in the <span CLASS="fixed">MAKE</span> table.)</p> 
</li>
<li CLASS="LISTITEM">
<p class="first-para">An update operation could change an existing value in a parent table, leaving rows in a child table with values that no longer match those in the parent table. (For example, a record could be changed in the <span CLASS="FIXED">MAKE</span> table, leaving records in the <span CLASS="FIXED">MODEL</span> table that no longer have a corresponding <span CLASS="FIXED">MAKE</span> value.)</p>
</li>
<li class="listitem">
<p class="FIRST-PARA">A delete operation could remove a value from a parent table, leaving rows in a child table with values that no longer match those in the parent table. (For example, a record could be removed from the <span CLASS="FIXED">MAKE</span> table, leaving records in the <span CLASS="fixed">MODEL</span> table that no longer have a corresponding <span class="fixed">MAKE</span> value.)</p> 
</li>
</ul>
<a name="713"></a><a NAME="N42592"></a>
<p class="PARA">The DB2 Database Manager can either prohibit (restrict) these types of operations from being performed on tables that are part of a referential constraint, or attempt to carry out these actions in a way that will safeguard data integrity. In either case, DB2 uses a set of rules to control the operation's behavior. Each referential constraint has its own set of rules (which consist of an Insert Rule, an Update Rule, and a Delete Rule), and the way each rule is to be enforced is specified as part of the referential constraint creation process.</p>
<div CLASS="section">
<h4 class="SECT4-TITLE">
<a NAME="714"></a><a name="CH06LE"></a>The Insert Rule for Referential Constraints</h4>
<p CLASS="first-para">The Insert Rule guarantees that a value can never be inserted into the foreign key of a child table unless a matching value can be found in the corresponding parent key of the associated parent table. Any attempt to insert records into a child table that violates this rule will result in an error, and the insert operation will fail. In contrast, no checking is performed when records are added to the parent key of the parent table.</p>
<p class="para">The Insert Rule for a referential constraint is implicitly created when the referential constraint itself is created. <a HREF="#ch06fig06" CLASS="internaljump">Figure 6-6</a> illustrates how a row that conforms to the Insert Rule for a referential constraint is successfully added to a child table; <a HREF="#ch06fig07" CLASS="INTERNALJUMP">Figure 6-7</a> illustrates how a row that violates the Insert Rule causes an insert operation to fail.</p>
<div CLASS="figure">
<a NAME="715"></a><a name="ch0"></a><span class="FIGUREMEDIAOBJECT"><a NAME="img_102" href="images/fig406_01_0.jpg" TARGET="_parent"><img border="0" alt="Image from book" id="IMG_102" HEIGHT="419" TITLE="Click To expand" SRC="images/fig406_01.jpg" WIDTH="350"></a></span>
<br STYLE="line-height: 1">
<span class="figure-title"><span CLASS="FIGURE-TITLELABEL">Figure 6-6: </span>An insert operation that conforms to the Insert Rule of a referential constraint.</span>
</div>
<div class="figure">
<a NAME="716"></a><a name="CH0"></a><span CLASS="figuremediaobject"><a HREF="images/fig407_01_0.jpg" NAME="img_103" target="_parent"><img ALT="Image from book" border="0" height="476" ID="IMG_103" SRC="images/fig407_01.jpg" title="Click To expand" WIDTH="350"></a></span>
<br STYLE="line-height: 1">
<span class="FIGURE-TITLE"><span CLASS="FIGURE-TITLELABEL">Figure 6-7: </span>An insert operation that violates the Insert Rule of a referential constraint.</span>
</div> 
<a name="717"></a><a name=""></a><a NAME="718"></a><a NAME="N42652"></a><a name="719"></a><a NAME="N42655"></a>
<p class="last-para">It is important to note that because the Insert Rule exists, records must be inserted in the parent key of the parent table before corresponding records can be inserted into the child table. (Going back to our <span class="fixed">MAKE/MODEL</span> example, this means that a record for a new <span class="FIXED">MAKE</span> must be added to the <span CLASS="FIXED">MAKE</span> table <i class="EMPHASIS">before</i> a record that references the new <span CLASS="FIXED">MAKE</span> can be added to the <span CLASS="FIXED">MODEL</span> table.)</p>
</div> 
<div CLASS="SECTION">
<h4 class="SECT4-TITLE">
<a NAME="720"></a><a name="CH06LE"></a>The Update Rule for Referential Constraints</h4>
<p class="first-para">The Update Rule controls how update operations performed against either table (child or parent) participating in a referential constraint are to be processed. The following two types of behaviors are possible, depending upon how the Update Rule is defined:</p>
<ul class="simple-list">
<li class="first-listitem">
<p CLASS="para">
<b><span class="fixed">ON UPDATE RESTRICT</span>:</b> This definition ensures that whenever an update operation is performed on the parent table of a referential constraint, the value for the foreign key of each row in the child table will have the same matching value in the parent key of the parent table that it had before the update operation was performed.</p> 
</li>
<li CLASS="listitem">
<p class="para">
<b><span CLASS="fixed">ON UPDATE NO ACTION</span>:</b> This definition ensures that whenever an update operation is performed on either table in a referential constraint, the value for the foreign key of each row in the child table will have a matching value in the parent key of the corresponding parent table; however, the value may not be the same as it was before the update operation occurred.</p> 
</li>
</ul>
<p CLASS="para">
<a CLASS="internaljump" href="#ch0">Figure 6-8</a> illustrates how the Update Rule is enforced when the <span CLASS="fixed">ON UPDATE RESTRICT</span> definition is used; <a CLASS="internaljump" href="#ch0">Figure 6-9</a> illustrates how the Update Rule is enforced when the <span class="fixed">ON UPDATE NO ACTION</span> definition is used.</p> 
<div CLASS="figure">
<a NAME="721"></a><a name="ch0"></a><span CLASS="figuremediaobject"><a HREF="images/fig409_01_0.jpg" name="img_104" target="_parent"><img alt="Image from book" BORDER="0" height="476" id="IMG_104" SRC="images/fig409_01.jpg" title="Click To expand" width="350"></a></span>
<br STYLE="line-height: 1">
<span class="figure-title"><span CLASS="figure-titlelabel">Figure 6-8: </span>How the <span class="fixed">ON UPDATE RESTRICT</span> Update Rule of a referential constraint is enforced.</span>
</div>
<div class="figure">
<a NAME="722"></a><a NAME="ch06fig09"></a><span class="figuremediaobject"><a HREF="images/fig410_01_0.jpg" NAME="img_105" target="_parent"><img alt="Image from book" BORDER="0" HEIGHT="419" ID="IMG_105" SRC="images/fig410_01.jpg" TITLE="Click To expand" WIDTH="350"></a></span>
<br STYLE="line-height: 1">
<span CLASS="figure-title"><span class="figure-titlelabel">Figure 6-9: </span>How the <span class="fixed">ON UPDATE NO ACTION</span> Update Rule of a referential constraint is enforced.</span>
</div> 
<a name="723"></a><a name=""></a><a name="724"></a><a name=""></a>
<p class="PARA">Like the Insert Rule, the Update Rule for a referential constraint is implicitly created when the referential constraint itself is created. If no Update Rule definition is provided, the <span class="fixed">ON UPDATE NO ACTION</span> definition is used by default. Regardless of which Update Rule definition is used, if the condition of the rule is not met, the update operation will fail, an error message will be displayed, and any changes made to the data in either table participating in the referential constraint will be backed out.</p> 
<a name="725"></a><a name=""></a>
</div>
<div class="SECTION">
<h4 class="SECT4-TITLE">
<a name="726"></a><a name="ch06le"></a>The Delete Rule for Referential Constraints</h4>
<p class="first-para">The Delete Rule controls how delete operations performed against the parent table of a referential constraint are to be processed. The following four types of behaviors are possible, depending upon how the Delete Rule is defined:</p>
<ul class="SIMPLE-LIST">
<li class="FIRST-LISTITEM">
<p class="para">
<b><span class="fixed">ON DELETE CASCADE</span>:</b> This definition ensures that when a parent row is deleted from the parent table of a referential constraint, all dependent rows in the child table that have matching primary key values in their foreign key are deleted as well.</p> 
</li>
<li class="LISTITEM">
<p class="para">
<b><span class="FIXED">ON DELETE SET NULL</span>:</b> This definition ensures that when a parent row is deleted from the parent table of a referential constraint, all dependent rows in the child table that have matching primary key values in their foreign key are located, and their foreign key values are changed to <span class="fixed">NULL</span> (provided the foreign key columns are nullable). Other values for the dependent row are not affected.</p> 
</li>
<li class="LISTITEM">
<p class="para">
<b><span class="FIXED">ON DELETE RESTRICT</span>:</b> This definition ensures that whenever a delete operation is performed on the parent table of a referential constraint, the value for the foreign key of each row in the child table will have the same matching value in the parent key of the parent table that it had before the delete operation was performed.</p>
</li>
<li class="listitem">
<p class="PARA">
<b><span CLASS="FIXED">ON DELETE NO ACTION</span>:</b> This definition ensures that whenever a delete operation is performed on the parent table of a referential constraint, the value for the foreign key of each row in the child table will have a matching value in the parent key of the parent table after the other referential constraints have been enforced.</p> 
</li>
</ul>
<p CLASS="PARA">
<a class="INTERNALJUMP" HREF="#ch06fig10">Figure 6-10</a> illustrates how the Delete Rule is enforced when the <span CLASS="FIXED">ON DELETE CASCADE</span> definition is used; <a CLASS="INTERNALJUMP" href="#ch0">Figure 6-11</a> illustrates how the Delete Rule is enforced when the <span class="fixed">ON DELETE SET NULL</span> definition is used;</p> 
<div CLASS="figure">
<a NAME="727"></a><a name="CH0"></a><span class="figuremediaobject"><a HREF="images/fig412_01_0.jpg" name="IMG_106" TARGET="_parent"><img alt="Image from book" BORDER="0" height="419" ID="IMG_106" src="images/fig412_01.jpg" TITLE="Click To expand" WIDTH="350"></a></span>
<br STYLE="line-height: 1">
<span CLASS="figure-title"><span CLASS="figure-titlelabel">Figure 6-10: </span>How the <span CLASS="fixed">ON DELETE CASCADE</span> Delete Rule of a referential constraint is enforced.</span>
</div>
<div class="FIGURE">
<a name="728"></a><a NAME="CH06FIG11"></a><span class="FIGUREMEDIAOBJECT"><a HREF="images/fig413_01_0.jpg" name="IMG_107" target="_parent"><img alt="Image from book" BORDER="0" HEIGHT="419" ID="IMG_107" SRC="images/fig413_01.jpg" TITLE="Click To expand" width="350"></a></span>
<br STYLE="line-height: 1">
<span class="FIGURE-TITLE"><span CLASS="figure-titlelabel">Figure 6-11: </span>How the <span class="FIXED">ON DELETE SET NULL</span> Delete Rule of a referential constraint is enforced.</span>
</div>
<p CLASS="para">
<a CLASS="INTERNALJUMP" HREF="#ch06fig12">Figure 6-12</a> illustrates how the Delete Rule is enforced when the <span class="fixed">ON DELETE RESTRICT</span> definition is used; and <a CLASS="INTERNALJUMP" href="#ch0">Figure 6-13</a> illustrates how the Delete Rule is enforced when the <span class="FIXED">ON DELETE NO ACTION</span> definition is used.</p>
<div CLASS="FIGURE">
<a NAME="729"></a><a name="ch0"></a><span CLASS="FIGUREMEDIAOBJECT"><a HREF="images/fig414_01_0.jpg" name="img_108" TARGET="_parent"><img alt="Image from book" border="0" ID="IMG_108" HEIGHT="474" title="Click To expand" SRC="images/fig414_01.jpg" width="350"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span CLASS="FIGURE-TITLELABEL">Figure 6-12: </span>How the <span class="FIXED">ON DELETE RESTRICT</span> Delete Rule of a referential constraint is enforced.</span>
</div> 
<div CLASS="figure">
<a NAME="730"></a><a NAME="CH06FIG13"></a><span class="FIGUREMEDIAOBJECT"><a HREF="images/fig415_01_0.jpg" name="img_109" target="_parent"><img border="0" alt="Image from book" ID="IMG_109" height="476" TITLE="Click To expand" src="images/fig415_01.jpg" WIDTH="350"></a></span>
<br STYLE="line-height: 1">
<span CLASS="FIGURE-TITLE"><span class="figure-titlelabel">Figure 6-13: </span>How the <span CLASS="fixed">ON DELETE NO ACTION</span> Delete Rule of a referential constraint is enforced.</span>
</div>
<a NAME="731"></a><a name=""></a><a name="732"></a><a NAME="N42975"></a><a NAME="733"></a><a name=""></a><a NAME="734"></a><a NAME="N42981"></a><a name="735"></a><a name=""></a>
<p class="para">Like the Insert Rule and the Update Rule, the Delete Rule for a referential constraint is implicitly created when the referential constraint itself is created. If no Delete Rule definition is provided, the <span CLASS="fixed">ON DELETE NO ACTION</span> definition is used by default. No matter which form of the Delete Rule is used, if the condition of the rule is not met, an error message will be displayed, and the delete operation will fail.</p>
<p class="LAST-PARA">If the <span class="fixed">ON DELETE CASCADE</span> Delete Rule is used and the deletion of a parent row in a parent table causes one or more dependent rows to be deleted from the corresponding child table, the delete operation is said to have been <i CLASS="EMPHASIS">propagated</i> to the child table. In such a situation, the child table is said to be <i class="EMPHASIS">delete-connected</i> to the parent table. Because a delete-connected child table can also be the parent table in another referential constraint, a delete operation that is propagated to one child table can, in turn, be propagated to another child table, and so on. Thus, the deletion of one parent row from a single parent table can result in the deletion of several hundred rows from any number of tables, depending upon how tables are delete-connected. Therefore, the <span class="FIXED">ON DELETE CASCADE</span> Delete Rule should be used with extreme caution when a hierarchy of referential constraints permeates a database.</p> 
</div>
</div>
<div CLASS="section">
<h3 class="SECT3-TITLE">
<a NAME="736"></a><a name="ch06lev"></a>Informational Constraints</h3>
<p class="first-para">The DB2 Database Manager automatically enforces all of the constraints that we have looked at so far whenever new data values are added to a table or existing data values are modified or deleted. As you might imagine, if a large number of constraints have been defined, a large amount of system overhead can be required to enforce those constraints, particularly when large amounts of data are loaded into a table.</p> 
<p CLASS="para">If an application is coded in such a way that it validates data before inserting it into a DB2 database, it may be more efficient to create one or more <i CLASS="emphasis">informational</i> <i class="EMPHASIS">constraint</i>s, as opposed to creating any of the other constraints available. Unlike other constraints, informational constraints are not enforced during insert and update processing. However, the DB2 SQL Optimizer will evaluate information provided by an informational constraint when considering the best access plan to use to resolve a query. (Informational constraints are defined by appending the keywords <span CLASS="fixed">NOT ENFORCED ENABLE QUERY OPTIMIZATION</span> to a normal constraint definition.) As a result, an informational constraint may result in better query performance even though the constraint itself will not be used to validate data entry/modification. <a CLASS="INTERNALJUMP" href="#ch0">Figure 6-14</a> illustrates the behavior of a simple informational constraint.</p>
<div class="figure">
<a NAME="737"></a><a NAME="CH06FIG14"></a><span CLASS="FIGUREMEDIAOBJECT"><a HREF="images/fig417_01_0.jpg" NAME="IMG_110" TARGET="_parent"><img BORDER="0" ALT="Image from book" id="IMG_110" height="266" src="images/fig417_01.jpg" title="Click To expand" width="350"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="FIGURE-TITLELABEL">Figure 6-14: </span>Behavior of a simple informational constraint.</span>
</div> 
<a name="738"></a><a name=""></a>
<p class="last-para">It is important to note that because the DB2 Optimizer evaluates informational constraints when selecting the best data access plan to use to resolve a query, records that have been inserted into a table that violate one or more informational constraints may not be returned by some queries. For example, if the query "<span class="fixed">SELECT * FROM employee WHERE tax_id = 90</span>" were to be executed against the <span class="FIXED">EMPLOYEE</span> table shown in <a class="INTERNALJUMP" href="#ch0">Figure 6-14</a>, no records would be returned because the access plan chosen would assume that no records with a <span class="fixed">TAX_ID</span> value that is less than 1000 exist in the table.</p>
</div>
<div class="SECTION">
<h3 class="SECT3-TITLE">
<a name="739"></a><a name="ch06lev"></a>Temporarily Suspending Constraint Checking with the SET INTEGRITY SQL Statement</h3>
<p class="first-para">Although constraints provide a means of ensuring that some level of integrity is maintained as data is manipulated within a base table, their enforcement can prevent some types of operations from executing successfully. For example, suppose you want to bulk-load 10,000 rows of data into a base table using the <span class="fixed">LOAD</span> utility. If the data that is to be loaded contains values that will violate a constraint that has been defined for the table into which the data is to be loaded, the operation will fail. Or suppose you wish to add a new constraint to an existing <a name="740"></a><a name=""></a>table that already contains several hundred rows of data. If one or more rows in the table contain data values that violate the constraint you wish to add, any attempt to add the constraint will fail. In situations like these, it can be advantageous to suspend constraint checking just long enough to perform the desired operation. However when constraint checking is suspended, at some point it must be resumed, and at that time, rows in the table that cause a constraint to be violated must be located and dealt with.</p> 
<p class="para">Constraint checking for a table can be suspended temporarily by executing the <span class="fixed">SET INTEGRITY</span> SQL statement. When used to suspend constraint checking, the syntax for the simplest form of this statement is:</p> 
<div class="INFORMALEXAMPLE">
<pre class="literallayout">
SET INTEGRITY FOR [<i CLASS="emphasis">TableName</i>, ...] OFF &lt;<i CLASS="EMPHASIS">AccessMode</i>&gt;
</pre>
</div> 
<p class="para">where:</p> 
<div CLASS="INFORMALTABLE">
<table BORDER="0">
<tbody>
<tr VALIGN="top">
<td class="td" align="left">
<p CLASS="table-para">
<i CLASS="EMPHASIS">TableName</i>
</p>
</td><td align="left" class="TD">
<p CLASS="table-para">Identifies the name of one or more base tables that constraint checking is to be temporarily suspended for.</p> 
</td> 
</tr> 
<tr valign="top">
<td CLASS="TD" align="left">
<p CLASS="TABLE-PARA">
<i class="emphasis">AccessMode</i>
</p> 
</td> <td ALIGN="left" class="td">
<p CLASS="TABLE-PARA">Specifies whether or not the table(s) specified can be accessed in read-only mode while constraint checking is suspended. The following values are valid for this parameter: <span CLASS="FIXED">NO ACCESS</span> and <span CLASS="FIXED">READ ACCESS</span>-if no access mode is specified, <span CLASS="FIXED">NO ACCESS</span> is used as the default.</p> 
</td> 
</tr> 
</tbody>
</table>
</div>
<p CLASS="PARA">Thus, if you wanted to suspend constraint checking for a table named <span CLASS="FIXED">EMPLOYEES</span> temporarily and deny read-only access to that table while constraint checking is turned off, you could do so by executing a <span class="FIXED">SET INTEGRITY</span> statement that looks something like this:</p>
<div class="INFORMALEXAMPLE">
<pre CLASS="literallayout">
SET INTEGRITY FOR employees OFF
</pre>
</div>
<p class="para">When constraint checking is suspended for a particular table, that table is placed in "Check Pending" state to indicate that it contains data that has not been checked (and that it may not be free of constraint violations). While a table is in "Check Pending" state, it cannot be used in insert, update, or delete operations, nor can it be used by any DB2 utility that needs to perform these types of operations. Indexes cannot be created for a table while it is in "Check Pending" state, and data <a NAME="741"></a><a name=""></a>stored in the table can only be retrieved if the access mode specified when the <span class="fixed">SET INTEGRITY</span> statement was used to place the table in "Check Pending" state allows read-only access.</p>
<p class="para">Just as one form of the <span CLASS="fixed">SET INTEGRITY</span> statement is used to suspend constraint checking temporarily, another form is used to resume it. In this case, the syntax for the simplest form of the <span CLASS="fixed">SET INTEGRITY</span> statement is:</p>
<div CLASS="informalexample">
<pre CLASS="literallayout">
SET INTEGRITY FOR [<i CLASS="emphasis">TableName</i>] IMMEDIATE CHECKED FOR EXCEPTION
[IN [<i class="emphasis">TableName</i>] USE [<i CLASS="emphasis">ExceptionTable</i>], ...]
</pre>
</div>
<p class="para">or</p>
<div CLASS="informalexample">
<pre class="literallayout">
SET INTEGRITY FOR [[<i CLASS="emphasis">TableName</i>][<i CLASS="emphasis">ConstraintType</i>], ...] IMMEDIATE UNCHECKED
</pre>
</div>
<p CLASS="para">where:</p>
<div class="informaltable">
<table BORDER="0">
<tbody>
<tr valign="top">
<td class="td" ALIGN="left">
<p CLASS="table-para">
<i class="emphasis">TableName</i>
</p>
</td><td ALIGN="left" CLASS="td">
<p class="table-para">Identifies the name of one or more base tables for which suspended constraint checking is to be resumed. These are also the base tables from which all rows that are in violation of a referential constraint or a <span CLASS="fixed">CHECK</span> constraint are to be copied.</p>
</td>
</tr>
<tr valign="top">
<td class="td" ALIGN="left">
<p CLASS="table-para">
<i class="emphasis">ExceptionTable</i>
</p>
</td><td ALIGN="left" class="TD">
<p class="TABLE-PARA">Identifies the name of a base table to which all rows that are in violation of a referential constraint or a <span class="fixed">CHECK</span> constraint are to be copied.</p>
</td>
</tr>
<tr VALIGN="top">
<td class="TD" ALIGN="left">
<p CLASS="TABLE-PARA">
<i CLASS="EMPHASIS">ConstaintType</i>
</p>
</td><td class="td" ALIGN="left">
<p class="table-para">Identifies the type of constraint checking that is to be resumed. The following values are valid for this parameter: <span class="FIXED">FOREIGN KEY, CHECK, MATERILIZED QUERY, GENERATED COLUMN, STAGING</span>, and <span class="FIXED">ALL</span>.</p>
</td>
</tr>
</tbody>
</table> 
</div> 
<p class="para">Thus, if you wanted to resume constraint checking for the <span CLASS="fixed">EMPLOYEES</span> table that constraint checking was suspended for in the previous example, you could do so by executing a <span class="FIXED">SET INTEGRITY</span> statement that looks something like this:</p>
<div CLASS="informalexample">
<pre class="LITERALLAYOUT">
SET INTEGRITY FOR employees
IMMEDIATE CHECKED
<a NAME="742"></a><a NAME="n43331"></a>
</pre> 
</div> 
<p CLASS="PARA">When this particular form of the <span class="fixed">SET INTEGRITY</span> statement is executed, the table named <span CLASS="FIXED">EMPLOYEES</span> is taken out of the "Check Pending" state, and each row of data stored in the table is checked for constraint violations. If an offensive row is found, constraint checking is stopped, and the <span CLASS="fixed">EMPLOYEES</span> table is returned to the "Check Pending" state.</p> 
<p class="PARA">If you want to be able to see the offending rows at a glance, the following form of the <span class="FIXED">SET INTEGRITY</span> statement can be executed:</p>
<div CLASS="INFORMALEXAMPLE">
<pre CLASS="LITERALLAYOUT">
SET INTEGRITY FOR employees
IMMEDIATE CHECKED
FOR EXCEPTION IN employees USE bad_rows
</pre>
</div> 
<p class="PARA">With this form, each row found that violates one or more of the constraints that have been defined for the <span CLASS="FIXED">EMPLOYEES</span> table will be copied to a table named <span CLASS="fixed">BAD_ROWS</span>, where it can be corrected and copied back to the <span class="fixed">EMPLOYEES</span> table if so desired.</p> 
<p class="PARA">And finally, if this form of the <span class="fixed">SET INTEGRITY</span> statement is executed:</p>
<div CLASS="INFORMALEXAMPLE">
<pre class="literallayout">
SET INTEGRITY FOR employees ALL
IMMEDIATE UNCHECKED
</pre>
</div> 
<p class="last-para">the table named <span CLASS="fixed">EMPLOYEES</span> is taken out of the "Check Pending" state, and no constraint checking is performed. However, this is a very hazardous thing to do and should be done only if you have some independent means of ensuring that the <span class="FIXED">EMPLOYEES</span> table does not contain data that violates one or more constraints defined for the <span class="FIXED">EMPLOYEES</span> table.</p>
</div> 
</div>
</div> </div>
</DIV>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=BBL0041.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=BBL0043.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>