<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Programming and Development</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="app07lev1sec2.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="app07lev1sec4.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="app07lev1sec3"></A><H3 class="docSection1Title">Programming and Development</H3>
<P class="docText">Numerous SQL and programming features are being added to DB2 V8 that will make the job of programming both easier, but at the same time, more complex. This might sound like a paradox, but it is true. Great new features will make programming simpler once they are learned, but it will take time and effort to train the legions of DB2 developers on this new functionality, and when and how best to use it.<A NAME="app07index54"></A><A NAME="app07index55"></A><A NAME="app07index56"></A></P>
<A NAME="app07lev2sec8"></A><H4 class="docSection2Title">Common Table Expressions and Recursion</H4>
<P class="docText">One big improvement in V8 is the ability to code <span class="docEmphasis">common table expressions (CTEs)</span>. A common table expression can be thought of as a named temporary table within a SQL statement that is retained for the duration of a SQL statement. There can be many CTEs in a single SQL statement but each must have a unique name and be defined only once. A CTE is defined at the beginning of a query using the <TT>WITH</TT> clause.<A NAME="app07index57"></A><A NAME="app07index58"></A><A NAME="app07index59"></A><A NAME="app07index60"></A><A NAME="app07index61"></A><A NAME="app07index62"></A></P>
<P class="docText">CTEs are an important new feature of DB2 for several reasons. First, in some situations they can be used to reduce the number of views that are needed. Instead of creating a view, you can code a CTE right into your query. But second, and more importantly, CTEs enable recursive SQL.</P>
<P class="docText">A recursive query is one that refers to itself. I think the best way to quickly grasp the concept of recursion is to think about a mirror that is reflected into another mirror and when you look into it you get never-ending reflections of yourself. This is recursion in action.<A NAME="app07index63"></A><A NAME="app07index64"></A><A NAME="app07index65"></A><A NAME="app07index66"></A></P>
<P class="docText">Recursive SQL can be very elegant and efficient. However, because of the difficulty developers can have understanding recursion, it is sometimes thought of as "too inefficient to use frequently." But, if you have a business need to walk or explode hierarchies in DB2, recursive SQL will likely be your most efficient option. Recursion is covered in more depth in <A class="docLink" HREF="ch02.html#ch02">Chapter 2</A> of this book.</P>
<A NAME="app07lev2sec9"></A><H4 class="docSection2Title">Architecture Changes Impacting Application Programming</H4>
<P class="docText">V8 offers significant changes to the SQL system limits. First, as we have already mentioned, DB2 will now offer long name support for database objects. But it does not stop there. DB2 V8 expands the maximum length of SQL statements to support up to 2 megabytes. This is a major change that permits much more complex SQL statements to be written, optimized, and run within DB2. Additionally, V8 increases the length of literals and predicates to 32K and will support joining up to 255 tables in a single SQL statement. This last one has been promised before, but is finally delivered properly in V8.<A NAME="app07index67"></A><A NAME="app07index68"></A><A NAME="app07index69"></A><A NAME="app07index70"></A></P>
<P class="docText">Also, as noted in the initial architecture section, 64-bit virtual addressing will greatly increase the amount of memory available to DB2. And IBM is making major enhancements to the internal SQL control block structures, so that DB2 will use memory more efficiently. So more memory, used more efficiently, should translate into the more efficient execution of DB2 SQL.</P>
<A NAME="app07lev2sec10"></A><H4 class="docSection2Title">Java and XML Improvements</H4>
<P class="docText">For Java programmers DB2 V8 offers expanded functionality in the form of support for both Type 2 and Type 4 Java drivers. Both will be updated to support the JDBC/SQLJ 3.0 standard which brings enhanced support for things such as <TT>SAVEPOINT</TT>s and <TT>WITH HOLD</TT> cursors, as well as improvements to connection pooling, and a long list of other expanded features.<A NAME="app07index71"></A><A NAME="app07index72"></A><A NAME="app07index73"></A><A NAME="app07index74"></A></P>
<P class="docText">DB2 V8 pushes more XML support into the DB2 engine. This includes support for some built-in XML publishing functions such as <TT>XMLELEMENT</TT> and <TT>XML2CLOB</TT> (among others).<A NAME="app07index75"></A><A NAME="app07index76"></A><A NAME="app07index77"></A><A NAME="app07index78"></A></P>
<A NAME="app07lev2sec11"></A><H4 class="docSection2Title">Additional V8 Programming Improvements</H4>
<P class="docText">But there are many more application-related improvements in DB2 V8 than just CTEs and recursion. For example, DB2 V8 removes one of the biggest SQL performance impediments of all-time by handling most unlike data types in Stage 1. Previously, if the data type and length of the columns and variables did not match exactly, the predicate was evaluated at Stage 2. DB2 V8 will compare unlike data types in Stage 1 as long as the data types are compatible (that is, number to number, or character to character, and so on).<A NAME="app07index79"></A><A NAME="app07index80"></A><A NAME="app07index81"></A></P>
<P class="docText">And there are more application enhancements worth noting in DB2 V8. Consider all of these new features:</P>
<UL><LI><P class="docList">A new statement, <TT>GET DIAGNOSTICS</TT>, is added that improves the ability to get diagnostic information.</P></LI><LI><P class="docList"><TT>SEQUENCE</TT> objects and sequence expressions.</P></LI><LI><P class="docList">New MQSeries functions to read and receive from queues.</P></LI><LI><P class="docList">Dynamic scrollable cursors that no longer require temporary tables to implement.</P></LI><LI><P class="docList">Scalar fullselect, which means that a <TT>SELECT</TT> statement that returns a single can be used wherever an expression is allowed.</P></LI><LI><P class="docList">More than one <TT>DISTINCT</TT> clause can now be specified per SQL statement.</P></LI><LI><P class="docList">The ability to mix EBCDIC, ASCII, and Unicode columns in a single SQL statement.</P></LI><LI><P class="docList">Qualified column names on the <TT>SET</TT> clause of <TT>INSERT</TT> and <TT>UPDATE</TT> statements.</P></LI><LI><P class="docList">Grouping expressions can be used in search conditions in <TT>HAVING</TT> clauses, in the <TT>SELECT</TT> clause, and in sort key expressions of an <TT>ORDER BY</TT> clause.</P></LI><LI><P class="docList">The ability to <TT>SELECT</TT> from an <TT>INSERT</TT> statement.</P></LI><LI><P class="docList">Multi-row <TT>FETCH</TT> and <TT>INSERT</TT> statements where more than one row can be fetched or inserted by a single statement.</P></LI></UL>
<P class="docText">And, as with every previous new DB2 version, IBM is making significant enhancements to improve application performance. DB2 V8 optimization enhancements are scheduled to include sophisticated query rewrite capabilities to support materialized query tables, sparse indexing to improve star join performance, support for parallel sort, and better support for queries with data type and length mismatches which would have caused less efficient access paths in previous releases.<A NAME="app07index82"></A><A NAME="app07index83"></A><A NAME="app07index84"></A></P>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="app07lev1sec2.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="app07lev1sec4.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
