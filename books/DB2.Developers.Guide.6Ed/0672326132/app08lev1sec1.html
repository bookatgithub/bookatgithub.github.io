<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>When Should the DB2 Catalog and Directory Be Reorganized?</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="app08.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="index.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="app08lev1sec1"></A><H3 class="docSection1Title" >When Should the DB2 Catalog and Directory Be Reorganized?</H3>
<P class="docText">To determine when to reorganize the system catalog, DBAs can use most of the same basic indicators used to determine whether application table spaces should be reorganized. Although it always has been a wise course of action to execute <TT>RUNSTATS</TT> on the DB2 Catalog table spaces, it becomes even more important now that these table spaces can be reorganized. These statistics can be analyzed to determine when a <TT>REORG</TT> should be run. When <TT>RUNSTATS</TT> is run for a catalog table space, the statistics about that system catalog table space are gathered and then stored in the DB2 Catalog tables themselves.<A NAME="app08index01"></A><A NAME="app08index02"></A><A NAME="app08index03"></A></P>
<P class="docText">In general, the following indicators and situations should be reviewed when determining when to reorganize your system catalog table spaces and indexes:</P>
<UL><LI><P class="docList">An increase in the value of the near- and far-off position indicators (<TT>NEAROFFPOSF</TT> and <TT>FAROFFPOSF</TT> in <TT>SYSINDEXPART</TT>)</P></LI><LI><P class="docList">An increase in the value of the near and far indirect reference indicators (<TT>NEARINDREF</TT> and <TT>FARINDREF</TT> in <TT>SYSTABLEPART</TT>)</P></LI><LI><P class="docList">A decrease in cluster ratio (<TT>CLUSTERRATIOF</TT> in <TT>SYSINDEXES</TT>)</P></LI><LI><P class="docList">An increase in leaf distance (<TT>LEAFDIST</TT> in <TT>SYSINDEXPART</TT>)</P></LI><LI><P class="docList">When the DB2 Catalog and Directory data sets are not using a significant portion of their allocated disk space (<TT>PRIQTY</TT>)</P></LI><LI><P class="docList">When the DB2 catalog and directory data sets contain a large number of secondary extents</P></LI></UL>
<P class="docText">For the <TT>SYSDBASE</TT>, <TT>SYSVIEWS</TT>, and <TT>SYSPLAN</TT> catalog table spaces, the value for the<TT>FAROFFPOSF</TT> and <TT>NEAROFFPOSF</TT> columns of <TT>SYSINDEXPART</TT> can be higher than for other table spaces before they need to be reorganized. Additionally, you can use <TT>REORG</TT> when it is necessary to move the DB2 Catalog and Directory to a different disk device.<A NAME="app08index04"></A><A NAME="app08index05"></A><A NAME="app08index06"></A></P>
<A NAME="app08lev2sec1"></A><H4 class="docSection2Title">Synchronizing System Catalog Reorganization</H4>
<P class="docText">It is a more difficult prospect to determine when the DB2 Directory table spaces should be reorganized. The <TT>RUNSTATS</TT> utility does not maintain statistics for these "table spaces" like it can for the DB2 Catalog. However, it is possible to base the reorganization of the DB2 Directory table spaces on the reorganization schedule of the DB2 Catalog table spaces. In fact, in certain situations, it is imperative that specific DB2 Directory table spaces are reorganized when a "companion" DB2 Catalog table space is reorganized. The chart in <A class="docLink" HREF="#app08table01">Table H.1</A> provides information on keeping the DB2 catalog and DB2 directory table spaces "in sync."<A NAME="app08index07"></A><A NAME="app08index08"></A><A NAME="app08index09"></A><A NAME="app08index10"></A></P>
<A NAME="app08table01"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table H.1. DB2 Directory Reorganization Indicators</h5></CAPTION><COLGROUP><COL width="275"><COL width="275"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">When You</span> <TT>REORG</TT><span class="docEmphStrong">&#8230;</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Be Sure to Also</span> <TT>REORG</TT><span class="docEmphStrong">&#8230;</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB06.SYSDBASE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB01.DBD01</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB06.SYSPKAGE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB01.SPT01</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB06.SYSPLAN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB01.SCT02</TT></P></TD></TR></TABLE></P><br>
<P class="docText">These table spaces are logically related. DB2 requires that you reorganize them at the same time to keep them synchronized.<A NAME="app08index11"></A><A NAME="app08index12"></A><A NAME="app08index13"></A><A NAME="app08index14"></A></P>
<A NAME="app08lev2sec2"></A><H4 class="docSection2Title">DB2 Catalog Reorganization Details</H4>
<P class="docText">There are 20 DB2 Catalog table spaces and six DB2 Directory table spaces (refer to <A class="docLink" HREF="#app08table02">Tables H.2</A> and <A class="docLink" HREF="#app08table03">H.3</A>). DB2 has different rules for different sets of these table spaces. There are three groupings of table spaces:<A NAME="app08index15"></A><A NAME="app08index16"></A><A NAME="app08index17"></A><A NAME="app08index18"></A></P>
<UL><LI><P class="docList">Cannot be reorganized at all</P></LI><LI><P class="docList">Can be reorganized using normal <TT>REORG</TT> procedures</P></LI><LI><P class="docList">Can be reorganized using special <TT>REORG</TT> procedures</P></LI></UL>
<A NAME="app08table02"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table H.2. DB2 Catalog Table Spaces (<TT>DSNDB06</TT>)</h5></CAPTION><COLGROUP><COL width="115.5"><COL width="434.5"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Table Space</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Definition</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSCOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains image copy information (2 tables)<A NAME="app08index19"></A><A NAME="app08index20"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSDBASE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains database object information (13 tables)<A NAME="app08index21"></A><A NAME="app08index22"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSDBAUT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains database and database authority information (2 tables)<A NAME="app08index23"></A><A NAME="app08index24"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSDDF</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains information about distributed DB2 connections (8 tables)<A NAME="app08index25"></A><A NAME="app08index26"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSGPAUT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains resource authority information (1 table)<A NAME="app08index27"></A><A NAME="app08index28"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSGROUP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains storage group information (2 tables)<A NAME="app08index29"></A><A NAME="app08index30"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0"  width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"> <TT>SYSGRTNS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains information about DB2 routines, such as functions and procedures (2 tables)<A NAME="app08index31"></A><A NAME="app08index32"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0"  width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"> <TT>SYSHIST</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains historical statistics (8 tables)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0"  width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"> <TT>SYSJAUXA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">LOB table space for Java JAR BLOB data (1 table)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0"  width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"> <TT>SYSJAUXB</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">LOB table space for Java source CLOB data (1 table)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0"  width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"> <TT>SYSJAVA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains information about Java programs (3 tables)<A NAME="app08index33"></A><A NAME="app08index34"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSOBJ</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains object/relational and routine information (10 tables)<A NAME="app08index35"></A><A NAME="app08index36"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSPKAGE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains package and stored procedure information (8 tables)<A NAME="app08index37"></A><A NAME="app08index38"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSPLAN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains plan information (5 tables)<A NAME="app08index39"></A><A NAME="app08index40"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0"  width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"> <TT>SYSSEQ</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains sequence information (pre-V8) (1 table)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0"  width="30" height="18" SRC="images/0672326132/graphics/V8_icon.gif" ALT="graphics/V8_icon.gif"> <TT>SYSSEQ2</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains sequence information (V8) (2 tables)<A NAME="app08index41"></A><A NAME="app08index42"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSSTATS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains optimization statistics (6 tables)<A NAME="app08index43"></A><A NAME="app08index44"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSSTR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains translation and check constraint information (4 tables)<A NAME="app08index45"></A><A NAME="app08index46"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSUSER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains user authority information (1 table)<A NAME="app08index47"></A><A NAME="app08index48"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSVIEWS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains view information (4 tables)<A NAME="app08index49"></A><A NAME="app08index50"></A><A NAME="app08index51"></A><A NAME="app08index52"></A><A NAME="app08index53"></A><A NAME="app08index54"></A></P></TD></TR></TABLE></P><br>
<A NAME="app08table03"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table H.3. DB2 Directory Table Spaces (<TT>DSNDB01</TT>)</h5></CAPTION><COLGROUP><COL width="115.5"><COL width="434.5"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Table Space</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Definition</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DBD01</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains database descriptor information (one table)<A NAME="app08index59"></A><A NAME="app08index60"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SCT01</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains skeleton cursor table information (one table)<A NAME="app08index61"></A><A NAME="app08index62"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SPT02</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains skeleton package table information (one table)<A NAME="app08index63"></A><A NAME="app08index64"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSLGRNX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains recovery log range information (one table)<A NAME="app08index65"></A><A NAME="app08index66"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSUTILX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains utility processing information (one table)<A NAME="app08index67"></A><A NAME="app08index68"></A></P></TD></TR></TABLE></P><br>
<P class="docText">There are only two table spaces in the first grouping of table spaces that cannot be reorganized at all: <TT>DSNDB01.SYSUTILX</TT> and <TT>DSNDB01.SYSLGRNX</TT>. Do not attempt to reorganize these table spaces as DB2 will not permit it.</P>
<P class="docText">The second grouping of table spaces must be processed differently than other table spaces:</P>
<UL><LI><P class="docList"><TT>DSNDB06.SYSDBASE</TT></P></LI><LI><P class="docList"><TT>DSNDB06.SYSDBAUT</TT></P></LI><LI><P class="docList"><TT>DSNDB06.SYSGROUP</TT></P></LI><LI><P class="docList"><TT>DSNDB06.SYSPLAN</TT></P></LI><LI><P class="docList"><TT>DSNDB06.SYSVIEWS</TT></P></LI><LI><P class="docList"><TT>DSNDB01.DBD01</TT></P></LI></UL>
<P class="docText">These six table spaces require special "handling and care." Because they have a different internal configuration than most other table spaces, a different calculation is required for the size of the unload data set (<TT>SYSREC</TT>) used during the <TT>REORG</TT> utility. These table spaces contain internal links. Links are internal pointers that tie the information in their tables together hierarchically. A link can be thought of as a type of parent-child relationship in which, due to these links, the <TT>BUILD</TT> and <TT>SORT</TT> phases of the <TT>REORG</TT> utility are not executed.</P>
<P class="docText">The <TT>WORKDDN</TT>, <TT>SORTDATA</TT>, <TT>SORTDEVT</TT>, and <TT>SORTNUM</TT> options are ignored when reorganizing these table spaces. Also, the <TT>REORG</TT> utility cannot be restarted from the last checkpoint when used against these six table spaces. Instead, it must be restarted from the beginning of the phase. Finally, as mentioned before, a different set of steps must be executed during reorganization for these table spaces.</P>
<P class="docText">All other DB2 Catalog and DB2 Directory table spaces can be reorganized like any other DB2 table space. Keep in mind that the LOB table spaces in the DB2 Catalog are under the same restrictions as any other LOB table space regarding DB2 utilities.<A NAME="app08index69"></A><A NAME="app08index70"></A><A NAME="app08index71"></A><A NAME="app08index72"></A></P>
<A NAME="app08lev3sec1"></A><H5 class="docSection3Title">Steps to <TT>REORG</TT> the Six "Special" Table Spaces</H5>
<P class="docText">The following steps should be used when reorganizing the six "special" table spaces:<A NAME="app08index73"></A><A NAME="app08index74"></A><A NAME="app08index75"></A><A NAME="app08index76"></A></P>
<A NAME="app08pr01"></A>








<div style="font-weight:bold"><OL class="docList" START="1"><LI value="1"><div style="font-weight:normal">Calculate the size of the unload data set (<TT>SYSREC</TT>).<BR><BR>
The <TT>SYSREC</TT> data set for the "special" table spaces has a different format than the other table spaces. This causes a special calculation to be required to determine its size. The equation to use is<BR><BR>
<pre>

</pre><BR><pre>
DATA SET SIZE IN BYTES = (28 + LONGROW) * NUMROWS
</pre><BR>
<TT>NUMROWS</TT> is the number of rows to be contained in the data set and <TT>LONGROW</TT> is the length of the longest in the table space. For <TT>DSNDB06</TT> table spaces, the value for <TT>LONGROW</TT> can be determined by running the following SQL statement:<BR><BR>
<pre>

</pre><BR><pre>
SELECT  MAX(RECLENGTH)
FROM    SYSIBM.SYSTABLES
WHERE   DBNAME = 'DSNDB06'
AND     TSNAME = 'name of table space to REORG'
AND     CREATOR = 'SYSIBM';
</pre><BR></div></LI><LI value="2"><div style="font-weight:normal">Ensure incompatible operations are not executing.<BR><BR></div></LI><LI value="3"><div style="font-weight:normal">Start database <TT>DSNDB01</TT> and <TT>DSNDB06</TT> for read only access.<BR><BR></div></LI><LI value="4"><div style="font-weight:normal">Run <TT>QUIESCE</TT> and <TT>DSN1CHKR</TT> utilities.<BR><BR></div></LI><LI value="5"><div style="font-weight:normal">Take a full image copy of entire DB2 catalog and directory table spaces.<BR><BR></div></LI><LI value="6"><div style="font-weight:normal">Start <TT>DSNDB01</TT> and <TT>DSNDB06</TT> for utility access.<BR><BR></div></LI><LI value="7"><div style="font-weight:normal">Execute <TT>REORG</TT> utility.<BR><BR></div></LI><LI value="8"><div style="font-weight:normal">Take a full image copy of entire DB2 catalog and directory table spaces.<BR><BR></div></LI><LI value="9"><div style="font-weight:normal">Start table space and associated indexes for read/write access.<BR><BR></div></LI></OL></div>
<P class="docText">Furthermore, keep in mind that these six table spaces cannot be reorganized using specifying <TT>SHRLEVEL CHANGE</TT>. And finally, the <TT>SORTDATA</TT>, <TT>SORTDEVT</TT>, <TT>SORTNUM</TT>, and <TT>SORTKEYS</TT> options are ignored for these table spaces.<A NAME="app08index77"></A><A NAME="app08index78"></A><A NAME="app08index79"></A><A NAME="app08index80"></A></P>
<A NAME="app08lev3sec2"></A><H5 class="docSection3Title">Steps to <TT>REORG</TT> Regular Table Spaces</H5>
<P class="docText">The following steps should be used when reorganizing the remaining "regular" system catalog and directory table spaces:<A NAME="app08index81"></A><A NAME="app08index82"></A><A NAME="app08index83"></A><A NAME="app08index84"></A></P>
<A NAME="app08pr02"></A>








<div style="font-weight:bold"><OL class="docList" START="1"><LI value="1"><div style="font-weight:normal">Calculate the size of the unload data set (<TT>SYSREC</TT>) using the normal calculation:<BR><BR>
<pre>

</pre><BR><pre>
DATA SET SIZE IN BYTES = LONGROW * NUMROWS
</pre><BR>
In this case it is unnecessary to add the additional 28 bytes to the length of the longest row. This is because these system catalog table spaces do not utilize links.<BR><BR></div></LI><LI value="2"><div style="font-weight:normal">Ensure that incompatible operations are not concurrently executing (see the next section for an explanation of incompatible operations).<BR><BR></div></LI><LI value="3"><div style="font-weight:normal">Start the table space and its associated indexes for read-only access.<BR><BR></div></LI><LI value="4"><div style="font-weight:normal">Run <TT>CHECK INDEX</TT> on all indexes associated with the table space that is being reorganized.<BR><BR></div></LI><LI value="5"><div style="font-weight:normal">Take a full image copy of the entire DB2 catalog and directory table spaces.<BR><BR></div></LI><LI value="6"><div style="font-weight:normal">Start the table space and its associated indexes for utility access.<BR><BR></div></LI><LI value="7"><div style="font-weight:normal">Execute the <TT>REORG</TT> utility.<BR><BR></div></LI><LI value="8"><div style="font-weight:normal">Take a full image copy of the entire DB2 catalog and directory table spaces.<BR><BR></div></LI><LI value="9"><div style="font-weight:normal">Start the table space and any associated indexes for read/write access.<BR><BR></div></LI></OL></div>
<P class="docText">These steps should be familiar to you because they closely follow the steps executed during the reorganization of an application data table space. There are several additional required steps added as precautions because of the critical nature of the DB2 catalog and directory.<A NAME="app08index85"></A><A NAME="app08index86"></A><A NAME="app08index87"></A><A NAME="app08index88"></A></P>
<A NAME="app08note01"></A><div class="docNote"><p class="docNoteTitle">NOTE</p>

<P class="docText">It is important to take a full image copy before and after reorganizing any DB2 catalog or directory table space.</P></div><br>
<A NAME="app08lev2sec3"></A><H4 class="docSection2Title">Catalog Reorganization Restrictions</H4>
<P class="docText">In addition to the procedures outlined previously, there are several restrictions on the manner in which the <TT>REORG TABLESPACE</TT> utility can be used with system catalog table spaces. First, recall that the <TT>SYSUTILX</TT> and <TT>SYSLGRNX</TT> table spaces in the DB2 Directory cannot be reorganized.<A NAME="app08index89"></A><A NAME="app08index90"></A><A NAME="app08index91"></A></P>
<P class="docText">When reorganizing the DB2 Catalog (<TT>DSNDB06</TT>) and DB2 Directory (<TT>DSNDB01</TT>) table spaces, the following options cannot be used:</P>
<UL><LI><P class="docList">The <TT>UNLOAD ONLY</TT> option is not permitted.</P></LI><LI><P class="docList">Online <TT>REORG</TT> is not permitted for catalog and directory table spaces with links.</P></LI><LI><P class="docList">The <TT>LOG YES</TT> option is not permitted as image copies are explicitly required following a catalog and/or directory reorganization.</P></LI></UL>
<P class="docText">Also, the reorganization of two specific table spaces are treated differently than any other in the manner in which they are tracked by DB2. Generally, DB2 records the reorganization of any table space in the <TT>SYSIBM.SYSCOPY</TT> system catalog table. However, DB2 records the reorganization of the <TT>DSNSB06.SYSCOPY</TT> and <TT>DSNDB01.DBD01</TT> table spaces in the log instead.</P>
<P class="docText">You cannot collect inline statistics on the following DB2 Catalog and DB2 Directory table spaces:</P>
<P><TABLE CELLSPACING="0" FRAME="void" RULES="none" CELLPADDING="5"><COLGROUP><COL width="165"><COL width="385"></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB06.SYSDBASE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB06.SYSDBAUT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB06.SYSGROUP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB06.SYSPLAN</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB06.SYSVIEWS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSBDB06.SYSSTATS</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB06.SYSHIST</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNDB01.DBD01</TT></P></TD></TR></TABLE></P><br>
<P class="docText">Finally, in many 24x7 environments, it may be necessary to reorganize the system catalog and dictionary while it is being accessed. However, because of the central nature of the system catalog and directory to the operation of DB2, the following restrictions apply to concurrent activity during catalog reorganization:</P>
<UL><LI><P class="docList"><TT>ALTER</TT>, <TT>DROP</TT>, and <TT>CREATE</TT> statements cannot be executed during the reorganization of any DB2 catalog or DB2 directory table space with the exception of <TT>SYSIBM.SYSSTR</TT> and <TT>SYSIBM.SYSCOPY</TT>.</P></LI><LI><P class="docList">The <TT>BIND</TT> and <TT>FREE</TT> commands cannot be issued when the following table spaces are being reorganized: <TT>SYSIBM.SYSDBAUT</TT>, <TT>SYSIBM.SYSDBASE</TT>, <TT>SYSIBM.SYSGPAUT</TT>, <TT>SYSIBM.SYSPKAGE</TT>, <TT>SYSIBM.SYSPLAN</TT>, <TT>SYSIBM.SYSSTATS</TT>, <TT>SYSIBM.SYSUSER</TT>, and <TT>SYSIBM.SYSVIEWS</TT>.</P></LI><LI><P class="docList">No DB2 utility can be running while <TT>SYSIBM.SYSCOPY</TT>, <TT>SYSIBM.SYSDBASE</TT>, <TT>SYSIBM.SYSDBAUT</TT>, <TT>SYSIBM.SYSSTATS</TT>, and/or <TT>SYSIBM.SYSUSER</TT> are being reorganized.</P></LI><LI><P class="docList">No plan or package may be executed during the reorganization of <TT>SYSIBM.SYSPLAN</TT> and <TT>SYSIBM.SYSPKAGE</TT>.</P></LI><LI><P class="docList">The <TT>GRANT</TT> and <TT>REVOKE</TT> statements cannot be issued when <TT>REORG</TT> is being run on <TT>SYSIBM.SYSDBASE</TT>, <TT>SYSIBM.SYSDBAUT</TT>, <TT>SYSIBM.SYSGPAUT</TT>, <TT>SYSIBM.SYSPKAGE</TT>, <TT>SYSIBM.SYSPLAN</TT>, and/or <TT>SYSIBM.SYSUSER</TT>.<A NAME="app08index92"></A><A NAME="app08index93"></A><A NAME="app08index94"></A></P></LI></UL>
<P class="docText">The ability to reorganize the DB2 catalog and directory table spaces provides the DBA with a potent tool for his or her system tuning arsenal.</P>
<A NAME="app08lev3sec3"></A><H5 class="docSection3Title">Take the Proper Image Copies</H5>
<P class="docText">Finally, be sure to take a full image copy both before and after reorganizing any DB2 Catalog or DB2 Directory object. Failure to do so can result in an unrecoverable system table—a situation which is best avoided at all costs.<A NAME="app08index95"></A><A NAME="app08index96"></A><A NAME="app08index97"></A><A NAME="app08index98"></A></P>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="app08.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="index.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
