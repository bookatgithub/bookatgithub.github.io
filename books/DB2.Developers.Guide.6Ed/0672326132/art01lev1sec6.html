<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Stored Procedure Registration</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="art01lev1sec5.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="art01lev1sec7.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="art01lev1sec6"></A><H3 class="docSection1Title">Stored Procedure Registration</H3>
<P class="docText">Prior to DB2 Version 6, after coding a stored procedure, you must register information about that stored procedures in the DB2 system catalog. This process is in sharp contrast to the manner in which other database objects are recorded in the system catalog. Typically, when an object is created, DB2 automatically stores the metadata description of that object in the appropriate DB2 catalog tables. For example, to create a new table, the <TT>CREATE TABLE</TT> statement is issued and DB2 automatically records the information in multiple system catalog tables (<TT>SYSIBM.SYSTABLES</TT>, <TT>SYSIBM.SYSCOLUMNS</TT>, <TT>SYSIBM.SYSTABLESPACE</TT>, and possibly <TT>SYSIBM.SYSFIELDS</TT>, <TT>SYSIBM.SYSCHECKS</TT>, <TT>SYSIBM.SYSCHECKDEP</TT>, <TT>SYSIBM.SYSRELS</TT>, and <TT>SYSIBM.SYSFOREIGNKEYS</TT>). Because stored procedures were not created within DB2, nor were they created using DDL, the database administrator had to use SQL <TT>INSERT</TT> statements to populate the <TT>SYSIBM.SYSPROCEDURES</TT> system catalog table with the metadata for the stored procedure.<A NAME="art01index41"></A><A NAME="art01index42"></A><A NAME="art01index43"></A><A NAME="art01index44"></A></P>
<P class="docText">The following SQL provides an example of an <TT>INSERT</TT> to register a stored procedure:</P>
<pre>

</pre><BR><pre>
INSERT INTO SYSIBM.SYSPROCEDURES
  (PROCEDURE, AUTHID, LUNAME, LOADMOD, LINKAGE,
   COLLID, LANGUAGE, ASUTIME, STAYRESIDENT,
   IBMREQD, RUNOPTS, PARMLIST, RESULT_SETS,
   WLM_ENV, PGM_TYPE, EXTERNAL_SECURITY,
   COMMIT_ON_RETURN)
 VALUES
  ('PROCNAME', ' ', ' ', 'LOADNAME', ' ',
   'COLL0001', 'COBOL', 0, 'Y',
   'N', ' ', 'NAME CHAR(20) INOUT', 1,
   ' ', 'M', 'N', 'N');
</pre><BR>
<P class="docText">This SQL statement registers a stored procedure written in COBOL and named <TT>PROCNAME</TT> with a load module named <TT>LOADNAME</TT>. It uses a package with a collection ID of <TT>COLL0001</TT>. Any location can execute this procedure. The program stays resident and uses the DB2 SPAS (not Workload Manager), and no limit is set on the amount of time it can execute before being canceled. Furthermore, the stored procedure uses one input/output parameter, and the parameter cannot be null.</P>
<P class="docText">This method of registering stored procedures changed in DB2 V6. Instead of the <TT>INSERT</TT> statement, <TT>CREATE</TT> and <TT>ALTER</TT> statements are provided for registering stored procedures to the DB2 system catalog. Additionally, a new catalog table named <TT>SYSIBM.SYSROUTINES</TT> replaces <TT>SYSIBM.SYSPROCEDURES</TT>. This new table will store information on triggers, user-defined functions, and stored procedures. The metadata for all of these "routines" will be provided to the system catalog by means of DDL statements.</P>
<P class="docText">Many organizations have procedures for creating and updating stored procedures that include registration. These procedures will need to be modified to work with DB2 V6 and later releases.<A NAME="art01index45"></A><A NAME="art01index46"></A><A NAME="art01index47"></A><A NAME="art01index48"></A></P>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="art01lev1sec5.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="art01lev1sec7.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
