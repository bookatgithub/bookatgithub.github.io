<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Dynamic SQL</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch01lev1sec3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch01lev1sec5.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch01lev1sec4"></A><H3 class="docSection1Title">Dynamic SQL</H3>
<P class="docText"><span class="docEmphasis">Dynamic SQL</span> is embedded in an application program and can change during the program's execution. Dynamic SQL statements are coded explicitly in host-language variables, prepared by the application program, and then executed. <TT>QMF</TT> and <TT>SPUFI</TT> are two examples of programs that execute dynamic SQL statements.<A NAME="ch01index332"></A><A NAME="ch01index333"></A><A NAME="ch01index334"></A></P>
<P class="docText">Recall that the two types of SQL are static SQL and dynamic SQL. The primary difference between static and dynamic SQL is described capably by their names. A static SQL statement is hard-coded and unchanging. The columns, tables, and predicates are known beforehand and cannot be changed. Only host variables that provide values for the predicates can be changed.</P>
<P class="docText">A dynamic SQL statement, conversely, can change throughout a program's execution. The algorithms in the program can alter the SQL before issuing it. Based on the class of dynamic SQL being used, the columns, tables, and complete predicates can be changed "on the fly."</P>
<P class="docText">As might be expected, dynamic SQL is dramatically different from static SQL in the way you code it in the application program. Additionally, when dynamic SQL is bound, the application plan or package that is created does not contain the same information as a plan or package for a static SQL program.</P>
<P class="docText">The access path for dynamic SQL statements cannot be determined before execution. When you think about it, this statement makes sense. If the SQL is not completely known until the program executes, how can it be verified and optimized beforehand? For this reason, dynamic SQL statements are not bound, but are prepared at execution. The <TT>PREPARE</TT> statement is functionally equivalent to a dynamic <TT>BIND</TT>. The program issues a <TT>PREPARE</TT> statement before executing dynamic SQL (with the exception of <TT>EXECUTEIMMEDIATE</TT>, which implicitly prepares SQL statements). <TT>PREPARE</TT> verifies, validates, and determines access paths dynamically.</P>
<P class="docText">A program containing dynamic SQL statements still must be bound into an application plan or package. The plan or package, however, does not contain access paths for the dynamic SQL statements.</P>
<P class="docText">DB2 provides four classes of dynamic SQL: <TT>EXECUTE IMMEDIATE</TT>, non-<TT>SELECT PREPARE</TT> and <TT>EXECUTE</TT>, fixed-list <TT>SELECT</TT>, and varying-list <TT>SELECT</TT>. The first two classes do not allow <TT>SELECT</TT> statements, whereas the last two are geared for <TT>SELECT</TT> statements.<A NAME="ch01index335"></A><A NAME="ch01index336"></A><A NAME="ch01index337"></A></P>
<P class="docText">Dynamic SQL is a complex topic that can be difficult to comprehend and master. It is important that you understand all aspects of dynamic SQL before deciding whether to use it. Dynamic SQL is covered in depth in <A class="docLink" HREF="ch12.html#ch12">Chapter 12</A>.</P>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch01lev1sec3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch01lev1sec5.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
