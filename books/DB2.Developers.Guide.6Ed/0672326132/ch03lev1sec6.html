<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Built-in Function Guidelines</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch03lev1sec5.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch04.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch03lev1sec6"></A><H3 class="docSection1Title">Built-in Function Guidelines</H3>
<P class="docText">Use the following guidelines to implement an effective strategy for deploying built-in functions in your DB2 applications.</P>
<A NAME="ch03lev2sec9"></A><H4 class="docSection2Title">Use Functions Instead of Program Logic</H4>
<P class="docText">Use the built-in functions provided by DB2 instead of coding your own application logic to perform the same tasks. You can be sure the DB2 built-in functions will perform the correct tasks with no bugs. But you will have to take the time to code, debug, and test your application code. This is time you can better spend on developing application-specific functionality.<A NAME="ch03index449"></A><A NAME="ch03index450"></A></P>
<A NAME="ch03lev2sec10"></A><H4 class="docSection2Title">Avoid Function Synonyms</H4>
<P class="docText">Several of the built-in functions have synonymous names that perform the same function. For example, <TT>VALUES</TT> and <TT>COALESCE</TT> perform the same exact function. You should standardize on one of the forms in your applications. By using only one of the forms your SQL will be easier to understand and maintain. Of course, your purchased applications may use any of the forms.<A NAME="ch03index451"></A><A NAME="ch03index452"></A></P>
<P class="docText">The following are my recommendations, but of course, yours may differ:</P>
<P><TABLE CELLSPACING="0" FRAME="void" RULES="groups" CELLPADDING="5"><COLGROUP><COL width="187"><COL width="363"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Use This</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Instead of This</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CEILING</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CEIL</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COALESCE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VALUES</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DAY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DAYOFMONTH</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DECIMAL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DEC</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DOUBLE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FLOAT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GREATEST</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MAX</TT> (scalar)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INTEGER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LEAST</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MIN</TT> (scalar)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOG</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LN</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOWER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LCASE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TIMESTAMP_FORMAT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TO_DATE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TRUNCATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TRUNC</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UPPER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UCASE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VARIANCE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VAR</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VARIANCE_SAMP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VAR_SAMP</TT></P></TD></TR></TABLE></P><br>
<P class="docText">In general, it is better to use the long form of the function instead of the abbreviated form because it is easier to quickly understand the purpose of the function. For example, one might easily assume that <TT>VAR</TT> is short for the <TT>VARCHAR</TT> function, instead of the <TT>VARIANCE</TT> function.</P>
<P class="docText">I suggest using <TT>DAY</TT> instead of <TT>DAYOFMONTH</TT> because <TT>DAYOFMONTH</TT> does not support using a date duration or a timestamp duration as an argument. However, if you do not use durations in your applications you might want to standardize on <TT>DAYOFMONTH</TT> instead of <TT>DAY</TT> because it is similar in name to other related functions such as <TT>DAYOFWEEK</TT> and <TT>DAYOFYEAR</TT>.</P>
<P class="docText">I suggest using <TT>DOUBLE</TT> instead of <TT>FLOAT</TT> because one might confuse <TT>FLOAT</TT> with <TT>REAL</TT>. If there were a synonym for <TT>REAL</TT>, such as <TT>SINGLE</TT>, I would suggest using <TT>SINGLE</TT>. But there is not.<A NAME="ch03index453"></A><A NAME="ch03index454"></A></P>
<table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"></td><td valign="top"><P class="docText"> I suggest using the scalar functions <TT>LEAST</TT> and <TT>GREATEST</TT> instead of the scalar functions <TT>MIN</TT> and <TT>MAX</TT> to avoid possible confusion with the column functions <TT>MIN</TT> and <TT>MAX</TT>.</P></td></tr></table><br>
<A NAME="ch03lev2sec11"></A><H4 class="docSection2Title">Use <TT>UPPER</TT> instead of <TT>TRANSLATE</TT></H4>
<P class="docText">Using the <TT>TRANSLATE</TT> function with a single argument serves the same purpose as the <TT>UPPER</TT> function—to convert a character string into uppercase. However, the <TT>UPPER</TT> function should be used for this purpose instead of <TT>TRANSLATE</TT> because<A NAME="ch03index455"></A><A NAME="ch03index456"></A><A NAME="ch03index457"></A><A NAME="ch03index458"></A><A NAME="ch03index459"></A></P>
<UL><LI><P class="docList">The <TT>UPPER</TT> function can be used only for the purpose of converting character strings to uppercase.</P></LI><LI><P class="docList">The <TT>TRANSLATE</TT> function is not as easily identified by developers as converting text to uppercase and is therefore more difficult to debug, maintain, and test SQL changes.</P></LI></UL>
<A NAME="ch03lev2sec12"></A><H4 class="docSection2Title">Use <TT>HAVING</TT> to Search Column Function Results</H4>
<P class="docText">When using column functions, remember that the <TT>WHERE</TT> clause applies to the data prior to modification. To remove results after the data has been modified by the function, you must use the <TT>HAVING</TT> clause in conjunction with a <TT>GROUP BY</TT> clause.</P>
<P class="docText">The <TT>GROUP BY</TT> clause collates the resultant rows after the column function(s) have been applied. When the data is grouped, users can eliminate non-pertinent groups of data with the <TT>HAVING</TT> clause.<A NAME="ch03index460"></A><A NAME="ch03index461"></A><A NAME="ch03index462"></A><A NAME="ch03index463"></A></P>
<P class="docText">For example, the following query groups employee data by department, returning the aggregate salary for each department, unless the average salary is $10,000 or less:</P>
<pre>

</pre><BR><pre>
SELECT   WORKDEPT, SUM(SALARY)
FROM     DSN8810.EMP
GROUP BY WORKDEPT
HAVING   AVG(SALARY) &gt; 10000 ;
</pre><BR>
<P class="docText">The <TT>HAVING</TT> clause eliminates groups of non-required data after the data is summarized.</P>
<A NAME="ch03lev2sec13"></A><H4 class="docSection2Title">Be Aware of <TT>NULL</TT>s When Using Column Functions</H4>
<P class="docText">Nulls can be one of the more difficult features of DB2 to understand and master. This is especially so when using certain built-in DB2 column functions. In some cases, you can write a query against a column using a built-in function and have the result be <TT>NULL</TT>—even if the column itself is defined as <TT>NOT NULL</TT>. Don't believe it? Run this query:<A NAME="ch03index464"></A><A NAME="ch03index465"></A></P>
<pre>

</pre><BR><pre>
SELECT SUM(ACTNO)
FROM   DSN8810.EMPPROJACT
WHERE  PROJNO = 'QRSTUV';
</pre><BR>
<P class="docText"><TT>ACTNO</TT> is defined as <TT>NOT NULL</TT>, yet this query returns a <TT>NULL</TT> (unless someone inserted a row with the value of <TT>'QRSTUV'</TT> for <TT>PROJNO</TT>). Why? The sum of all <TT>ACTNO</TT> values for project <TT>'QRSTUV'</TT> is not zero, but is not applicable—at least as defined by DB2.</P>
<P class="docText">Basically, if there are no results that apply to the predicate, the result of using a function such as <TT>SUM</TT> or <TT>AVG</TT> is <TT>NULL</TT> because the sum or average of no rows is not zero, but undefined.</P>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch03lev1sec5.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch04.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
