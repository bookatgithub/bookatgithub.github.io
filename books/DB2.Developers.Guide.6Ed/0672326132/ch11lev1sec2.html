<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Embedded SQL Guidelines</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch11lev1sec1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch11lev1sec3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch11lev1sec2"></A><H3 class="docSection1Title">Embedded SQL Guidelines</H3>
<P class="docText"><A class="docLink" HREF="#ch11table02">Table 11.2</A> outlines the differences between a DB2 program with embedded SQL statements and an application program accessing flat files. Flat files and DB2 tables, however, are not synonymous. The functionality of the two types of data storage objects are quite dissimilar.<A NAME="ch11index13"></A><A NAME="ch11index14"></A><A NAME="ch11index15"></A><A NAME="ch11index16"></A></P>
<A NAME="ch11table02"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 11.2. DB2 Programming Versus Flat File Programming</h5></CAPTION><COLGROUP><COL width="231"><COL width="319"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">DB2 Programming Considerations</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Flat File Programming Considerations</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">No <TT>FD</TT> required for DB2 tables; DB2 tables must be declared</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FD</TT> is required for each flat file to be processed by the program</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">No <TT>DD</TT> card needed in execution JCL for programs accessing DB2 tables</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DD</TT> card required (unless the flat file is allocated dynamically)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">DB2 tables need not be opened; instead, cursors are opened for each SQL statement<sup class="docFootnote"><A class="docLink" HREF="#ch11tn02">[*]</A></sup></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Flat files must be opened before being processed</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">DB2 tables need not be closed; instead, cursors are closed for each SQL statement<SUP><A class="docLink" HREF="#ch11tn02">[*]</A></SUP></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Flat files must be closed (if opened)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Set-level processing</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Record-level processing</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Access to tables can be specified at the column (field element) level</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Access to files based on reading a full record; all fields are always read or written</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Success or failure of data is indicated by SQL</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">VSAM return code indicates success or failure return code</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">No more data indicated by <TT>+100</TT> SQL return code</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">End of file is reported to the program</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Cursors used to mimic record-level processing (see the section on cursors)</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>READ</TT> and <TT>WRITE</TT> statements are used to implement record-level processing<A NAME="ch11index17"></A><A NAME="ch11index18"></A><A NAME="ch11index19"></A></P></TD></TR></TABLE></P><br><blockquote><p class="docFootnote"><sup><A NAME="ch11tn02">[*]</A></sup> <span class="docEmphasis">DB2 opens and closes the VSAM data sets that house DB2 table spaces "behind the scenes."</span></p></blockquote>
<A NAME="ch11lev4sec1"></A><H4 class="docSection2Title">Delimit All SQL Statements</H4>
<P class="docText">You must enclose all embedded SQL statements in an <TT>EXEC SQL</TT> block. This way, you can delimit the SQL statements so that the DB2 precompiler can efficiently parse the embedded SQL. The format of this block is<A NAME="ch11index20"></A><A NAME="ch11index21"></A></P>
<pre>

</pre><BR><pre>
EXEC SQL
   <span class="docEmphasis">put text of SQL statement here</span>
END-EXEC.
</pre><BR>
<P class="docText">For COBOL programs, you must code the <TT>EXEC SQL</TT> and <TT>END-EXEC</TT> delimiter clauses in your application program starting in column 12.</P>
<A NAME="ch11lev4sec2"></A><H4 class="docSection2Title">Explicitly <TT>DECLARE</TT> All DB2 Tables</H4>
<P class="docText">Although you are not required to declare DB2 tables in your application program, doing so is good programming practice. Therefore, explicitly <TT>DECLARE</TT> all tables to be used by your application program. You should place the <TT>DECLARE TABLE</TT> statements in the <TT>WORKING-STORAGE</TT> section of your program, and they should be the first DB2-related variables defined in <TT>WORKING-STORAGE</TT>. This way, you can reduce the precompiler's work and make the table definitions easier to find in the program source code.<A NAME="ch11index22"></A><A NAME="ch11index23"></A><A NAME="ch11index24"></A><A NAME="ch11index25"></A><A NAME="ch11index26"></A><A NAME="ch11index27"></A></P>
<P class="docText">Additionally, standard <TT>DECLARE TABLE</TT> statements should be generated for every DB2 table. Create them with the <TT>DCLGEN</TT> command (covered in <A class="docLink" HREF="ch13.html#ch13">Chapter 13</A>, "Program Preparation"), and then include them in your application program.</P>
<A NAME="ch11lev4sec3"></A><H4 class="docSection2Title">Comment Each SQL Statement</H4>
<P class="docText">Make liberal use of comments to document the nature and purpose of each SQL statement embedded in your program. You should code all comments pertaining to embedded SQL in the comment syntax of the program's host language. Code COBOL comments as shown in the following example:<A NAME="ch11index28"></A><A NAME="ch11index29"></A><A NAME="ch11index30"></A></P>
<pre>

</pre><BR><pre>
Column Numbers
         111
123456789012
      **
      **  Retrieve department name and manager from the
      **  DEPT table for a particular department number.
      **
           EXEC SQL
               SELECT   DEPTNAME, MGRNO
               INTO     :HOSTVAR-DEPTNAME,
                        :HOSTVAR-MGRNO
               FROM     DEPT
               WHERE    DEPTNO = :HOSTVAR-DEPTNO
           END-EXEC.
</pre><BR>
<A NAME="ch11lev4sec4"></A><H4 class="docSection2Title">Include the <TT>SQLCA</TT></H4>
<P class="docText">You must include a structure called the <TT>SQLCA</TT> (SQL Communication Area) in each DB2 application program. You do so by coding the following statement in your <TT>WORKING-STORAGE</TT> section:<A NAME="ch11index31"></A><A NAME="ch11index32"></A><A NAME="ch11index33"></A><A NAME="ch11index34"></A><A NAME="ch11index35"></A></P>
<pre>

</pre><BR><pre>
EXEC SQL
     INCLUDE SQLCA
END-EXEC.
</pre><BR>
<P class="docText">The COBOL layout of the expanded <TT>SQLCA</TT> follows:</P>
<pre>

</pre><BR><pre>
01  SQLCA.
    05  SQLCAID                   PIC X(8).
    05  SQLCABC                   PIC S9(9) COMPUTATIONAL.
    05  SQLCODE                   PIC S9(9) COMPUTATIONAL.
    05  SQLERRM.
        49  SQLERRML              PIC S9(4) COMPUTATIONAL.
        49  SQLERRMC              PIC X(70).
    05  SQLERRP                   PIC X(8).
    05  SQLERRD                   OCCURS 6 TIMES
                                  PIC S9(9) COMPUTATIONAL.
    05  SQLWARN.
        10  SQLWARN0              PIC X(1).
        10  SQLWARN1              PIC X(1).
        10  SQLWARN2              PIC X(1).
        10  SQLWARN3              PIC X(1).
        10  SQLWARN4              PIC X(1).
        10  SQLWARN5              PIC X(1).
        10  SQLWARN6              PIC X(1).
        10  SQLWARN7              PIC X(1).
    05  SQLEXT.
        10  SQLWARN8              PIC X(1).
        10  SQLWARN9              PIC X(1).
        10  SQLWARNA              PIC X(1).
        10  SQLSTATE              PIC X(5).
</pre><BR>
<P class="docText">The <TT>SQLCA</TT> is used to communicate information describing the success or failure of the execution of an embedded SQL statement. The following list defines each <TT>SQLCA</TT> field:<A NAME="ch11index36"></A><A NAME="ch11index37"></A></P>
<P><TABLE CELLSPACING="0" FRAME="void" RULES="none" CELLPADDING="5"><COLGROUP><COL width="115.5"><COL width="434.5"></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLCAID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Set to the constant value <TT>SQLCA</TT> to enable easy location of the <TT>SQLCA</TT> in a dump.<A NAME="ch11index38"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLCABC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains the value <TT>136</TT>, the length of the <TT>SQLCA</TT>.<A NAME="ch11index39"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLCODE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains the return code passed by DB2 to the application program. The return code provides information about the execution of the last SQL statement. A value of zero indicates successful execution, a positive value indicates successful execution but with an exception, and a negative value indicates that the statement failed.<A NAME="ch11index40"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERRM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">This group-level field consists of a length and a message. <TT>SQLERRML</TT> contains the length of the message in <TT>SQLERRMC</TT>. The message contains additional information about any encountered error condition. Usually, only technical support personnel use this field for complex debugging situations, when the value of <TT>SQLCODE</TT> is not sufficient. Note that if <TT>SQLERRML</TT> is set to 70 the message may have been truncated.<A NAME="ch11index41"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERRP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains the name of the <TT>CSECT</TT> that detected the error reported by the <TT>SQLCODE</TT>. This information is not typically required by application programmers.<A NAME="ch11index42"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERRD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">This array contains six values used to diagnose error conditions. Only <TT>SQLERRD(3)</TT> and <TT>SQLERRD(5)</TT> are of use to most application programmers:<A NAME="ch11index43"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERRD(1)</TT> is the relational data system error code.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERRD(2)</TT> is the Data Manager error code.<A NAME="ch11index44"></A><A NAME="ch11index45"></A><A NAME="ch11index46"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0" width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"> <TT>SQLERRD(1)</TT> and <TT>SQLERRD(2)</TT> can contain the number of rows in a result table when the cursor position is after the last row for a sensitive static cursor when the <TT>SQLCODE</TT> is <TT>+100</TT>.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERRD(3)</TT> is the number of rows inserted, deleted, or updated by the SQL statement.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0" width="30" height="18" SRC="images/0672326132/graphics/V8_icon.gif" ALT="graphics/V8_icon.gif"> <TT>SQLERRD(3)</TT> also will contain the number of rows in a rowset for a multirow <TT>FETCH</TT> and the number of rows inserted by a <TT>REFRESH TABLE</TT>.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERRD(4)</TT> is the estimate of resources required for the SQL statement (timerons).</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERRD(5)</TT> is the column (position) of the syntax error for a dynamic SQL statement.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERRD(6)</TT> is the Buffer Manager error code.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN0</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> if any other <TT>SQLWARN</TT> field is set to <TT>W</TT>.<A NAME="ch11index47"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN1</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> if a character column is truncated when it is assigned to a host variable by the SQL statement.<A NAME="ch11index48"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN2</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> when a null-valued column is eliminated by built-in function processing.<A NAME="ch11index49"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN3</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> when the number of columns retrieved does not match the number of fields in the host variable structure into which they are being selected.<A NAME="ch11index50"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN4</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> when the SQL statement is an <TT>UPDATE</TT> or <TT>DELETE</TT> without a <TT>WHERE</TT> clause.<A NAME="ch11index51"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><IMG BORDER="0" width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"> For a scrollable cursor, <TT>SQLWARN4</TT> contains a <TT>D</TT> for sensitive dynamic cursors, <TT>I</TT> for insensitive cursors, and <TT>S</TT> for sensitive static cursors after the <TT>OPEN CURSOR</TT>, <TT>ALLOCATE CURSOR</TT>, or <TT>DESCRIBE CURSOR</TT> statement; blank if cursor is not scrollable.<A NAME="ch11index52"></A><A NAME="ch11index53"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN5</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> when an SQL statement that applies only to SQL/DS is issued.<A NAME="ch11index54"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN6</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> when a <TT>DATE</TT> or <TT>TIMESTAMP</TT> conversion is performed during date arithmetic. For example, if 4 months are added to <TT>2003-01-31</TT>, the result is <TT>2003-04-31</TT>. Because April does not have 31 days, the results are converted to <TT>2003-04-30</TT>.<A NAME="ch11index55"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN7</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> when non-zero digits are dropped from the fractional part of a number used as the operand of a divide or multiply operation.<A NAME="ch11index56"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN8</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> if a substitute character is used when a conversion routine cannot convert the character.<A NAME="ch11index57"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARN9</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> when <TT>COUNT DISTINCT</TT> processing ignores an arithmetic exception.<A NAME="ch11index58"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARNA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains <TT>W</TT> when any form of character conversion error is encountered.<A NAME="ch11index59"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLSTATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains a return code indicating the status of the most recent SQL statement.<A NAME="ch11index60"></A><A NAME="ch11index61"></A><A NAME="ch11index62"></A><A NAME="ch11index63"></A><A NAME="ch11index64"></A><A NAME="ch11index65"></A></P></TD></TR></TABLE></P><br>
<A NAME="ch11lev4sec5"></A><H4 class="docSection2Title">Check <TT>SQLCODE</TT> or <TT>SQLSTATE</TT></H4>
<P class="docText"><TT>SQLCODE</TT> contains the SQL return code, which indicates the success or failure of the last SQL statement executed. <TT>SQLSTATE</TT> is similar to <TT>SQLCODE</TT> but is consistent across DB2 (and ANSI-compliant SQL) platforms.<A NAME="ch11index66"></A><A NAME="ch11index67"></A><A NAME="ch11index68"></A><A NAME="ch11index69"></A></P>
<P class="docText">Code a COBOL <TT>IF</TT> statement immediately after every SQL statement to check the value of the <TT>SQLCODE</TT>. In general, gearing your application programs to check for <TT>SQLCODE</TT>s is easier because a simple condition can be employed to check for negative values.</P>
<P class="docText">If the <TT>SQLCODE</TT> returned by the <TT>SQLCA</TT> is less than zero, an SQL "error" was encountered. The term <span class="docEmphasis">error</span>, in this context, is confusing. A value less than zero could indicate a condition that is an error using SQL's terminology but is fine given the nature of your application. Thus, certain negative SQL codes are acceptable depending on their context.</P>
<P class="docText">For example, suppose that you try to insert a row into a table and receive an SQL code of <TT>-803</TT>, indicating a duplicate key value. (The row cannot be inserted because it violates the constraints of a unique index.) In this case, you might want to report the fact (and some details) and continue processing. You can design your application programs to check <TT>SQLCODE</TT> values like this instead of first checking to make sure that the insert does not violate a unique constraint, and only then inserting the row.</P>
<P class="docText">Check the <TT>SQLSTATE</TT> value, however, when you must check for a group of <TT>SQLCODE</TT>s associated with a single <TT>SQLSTATE</TT> or when your program runs on multiple platforms. <TT>SQLSTATE</TT> values consist of five characters: a two-character class code and a three-character subclass code. The class code indicates the type of error, and the subclass code details the explicit error within that error type.<A NAME="ch11index70"></A><A NAME="ch11index71"></A><A NAME="ch11index72"></A><A NAME="ch11index73"></A></P>
<P class="docText">You can find a complete listing of <TT>SQLCODE</TT>s, <TT>SQLSTATE</TT>s, and <TT>SQLSTATE</TT> class codes in the IBM DB2 Messages and Codes manual. Some of the most common DB2 <TT>SQLCODE</TT> values are listed on the inside back cover of this book.</P>
<A NAME="ch11lev4sec6"></A><p><table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" width="30" height="18" SRC="images/0672326132/graphics/V8_icon.gif" ALT="graphics/V8_icon.gif"></td><td valign="top"><H4 class="docSection2Title">Consider Using <TT>GET DIAGNOSTICS</TT></H4></td></tr></table></p>

<P class="docText">DB2 Version 8 augments DB2 error handling with the new <TT>GET DIAGNOSTICS</TT> statement. <TT>GET DIAGNOSTICS</TT> complements and extends the diagnostics available in the SQLCA. This is necessary because some error messages will not fit into the 70-byte <TT>SQLERRRC</TT> field.<A NAME="ch11index74"></A><A NAME="ch11index75"></A><A NAME="ch11index76"></A><A NAME="ch11index77"></A></P>
<P class="docText"><TT>GET DIAGNOSTICS</TT> provides additional information than is provided in the SQLCA. The information it provides can be broken down into several areas: statement information, condition information, connection information, and combined information. Combined information contains a text representation of all the information gathered about the execution of the SQL statement. <A class="docLink" HREF="#ch11table03">Table 11.3</A> delineates the many different types of diagnostic information that can be returned with <TT>GET DIAGNOSTICS</TT>.</P>
<P class="docText">You use <TT>GET DIAGNOSTICS</TT> similarly to how you check the <TT>SQLCODE</TT>: You issue it after executing an SQL statement, and it returns information about the execution of the last statement, along with at least one instance of condition information.</P>
<P class="docText"><TT>GET DIAGNOSTICS</TT> is particularly useful for checking each condition when multiple conditions can occur—such as with multiple row processing. <TT>GET DIAGNOSTICS</TT> also supports SQL error message tokens larger than the 70-byte limit of the SQLDA.</P>
<P class="docText">A quick example using <TT>GET DIAGNOSTICS</TT> follows:</P>
<pre>

</pre><BR><pre>
GET DIAGNOSTICS :RC = ROW_COUNT;
</pre><BR>
<P class="docText">After executing this statement the <TT>:RC</TT> host variable will be set to the number of rows that were affected by the last SQL statement that was executed.<A NAME="ch11index78"></A><A NAME="ch11index79"></A><A NAME="ch11index80"></A><A NAME="ch11index81"></A></P>
<A NAME="ch11table03"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 11.3. <TT>GET DIAGNOSTICS</TT> Details</h5></CAPTION><COLGROUP><COL width="82.5"><COL width="242"><COL width="225.5"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Type</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Specific Name</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Description</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Statement</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_GET_DIAGNOSTICS_DIAGNOSTICS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Textual information about errors or warnings in the execution of the <TT>GET DIAGNOSTICS</TT> statement.<A NAME="ch11index82"></A><A NAME="ch11index83"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_LAST_ROW</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For a multiple-row <TT>FETCH</TT> statement, contains a value of <TT>+100</TT> if the last row currently in the table is in the set of rows that have been fetched.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_NUMBER_PARAMETER_MARKERS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For a <TT>PREPARE</TT> statement, contains the number of parameter markers in the prepared statement.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_NUMBER_RESULT_SETS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For a <TT>CALL</TT> statement, contains the actual number of result sets returned by the procedure.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_RETURN_STATUS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Identifies the status value returned from the previous <TT>CALL</TT> statement (for SQL procdures).</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_SQL_ATTR_CURSOR _HOLD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For an <TT>ALLOCATE</TT> or <TT>OPEN</TT> statement, indicates whether a cursor can be held open across multiple units of work.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_SQL_ATTR_CURSOR_ROWSET</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For an <TT>ALLOCATE</TT> or <TT>OPEN</TT> statement, indicates whether a cursor can be accessed using rowset positioning.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_SQL_ATTR_CURSOR_SCROLLABLE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For an <TT>ALLOCATE</TT> or <TT>OPEN</TT> statement, indicates whether a cursor can be scrolled forward and backward.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_SQL_ATTR_CURSOR_SENSITIVITY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For an <TT>ALLOCATE</TT> or <TT>OPEN</TT> statement, indicates whether a cursor does or does not show updates to cursor rows made by other connections.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_SQL_ATTR_CURSOR_TYPE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For an <TT>ALLOCATE</TT> or <TT>OPEN</TT> statement, indicates the type of cursor: normal, scrollable static, or scrollable dynamic.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MORE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Indicates whether there are more warning and errors than could be stored (or whether all the warnings and errors are stored).</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NUMBER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns the number of errors and warnings detected by the execution of the previous SQL statement.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ROW_COUNT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Identifies the number of rows associated with the previous SQL statement.<A NAME="ch11index84"></A><A NAME="ch11index85"></A><A NAME="ch11index86"></A><A NAME="ch11index87"></A><A NAME="ch11index88"></A><A NAME="ch11index89"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Condition</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CATALOG_NAME</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns the name of the constraint or table that caused the error.<A NAME="ch11index90"></A><A NAME="ch11index91"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONDITION_NUMBER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns the number of the diagnostic returned.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CURSOR_NAME</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns the name of the cursor.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_ERROR_CODE1</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns an internal error code.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_ERROR_CODE2</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns an internal error code.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_ERROR_CODE3</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns an internal error code.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_ERROR_CODE4</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns an internal error code.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_INTERNAL_ERROR_POINTER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For some errors, this is a negative value that is an internal error pointer.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_LINE_NUMBER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For a <TT>CREATE PROCEDURE</TT> (for SQL procedures), contains the line number where an error possibly occurred in the procedure code.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_MODULE_DETECTING_ERROR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns an identifier indicating which module detected the error.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_ORDINAL_TOKEN_</TT><span class="docEmphasis"><TT>n</TT></span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns the <span class="docEmphasis"><TT>n</TT></span>th token, where <span class="docEmphasis"><TT>n</TT></span> is a value between 1 and 100.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_REASON_CODE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains the reason code for errors that have a reason code token in their message text.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_RETURNED_SQLCODE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns the <TT>SQLCODE</TT> for the specified diagnostic.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_ROW_NUMBER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For a statement involving multiple rows, the row number where DB2 detected the exception.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_TOKEN_COUNT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns the number of tokens available for the specified diagnostic ID.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MESSAGE_OCTET_LENGTH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The length of the message text (in bytes).</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MESSAGE_TEXT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The message text associated with the <TT>SQLCODE</TT> (including substituted tokens).</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RETURNED_SQLSTATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns the <TT>SQLSTATE</TT> for the specified diagnostic.<A NAME="ch11index92"></A><A NAME="ch11index93"></A><A NAME="ch11index94"></A><A NAME="ch11index95"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SERVER_NAME</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">For <TT>CONNECT</TT>, <TT>DISCONNECT</TT>, or <TT>SET CONNECTION</TT> statements, the name of the server; otherwise, the name of the server where the statement executes is returned.<A NAME="ch11index96"></A><A NAME="ch11index97"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Connection</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_AUTHENTICATION_TYPE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains the authentication type: server, client, DB2 Connect, DCE security services, or blank.<A NAME="ch11index98"></A><A NAME="ch11index99"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_AUTHORIZATION_ID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Authorization ID used by connected server.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_CONNECTION_STATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Whether the connection is unconnected, local, or remote.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_CONNECTION_STATUS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Whether committable updates can be performed on the connection for this unit of work.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_SERVER_CLASS_NAME</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Contains a value specifying the platform of the server.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_ENCRYPTION_TYPE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The level of encryption.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2_PRODUCT_ID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Returns a product signature.<A NAME="ch11index100"></A><A NAME="ch11index101"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Combined</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ALL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">All of the diagnostic items combined into a single string.<A NAME="ch11index102"></A><A NAME="ch11index103"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STATEMENT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">All statement diagnostic items combined into a single string.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONNECTION</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">All connection diagnostic items combined into a single string.<A NAME="ch11index104"></A><A NAME="ch11index105"></A><A NAME="ch11index106"></A><A NAME="ch11index107"></A></P></TD></TR></TABLE></P><br>
<A NAME="ch11lev4sec7"></A><H4 class="docSection2Title">Standardize Your Shop's Error Routine</H4>
<P class="docText">Consider using a standardized error-handling paragraph, one that can be used by all DB2 programs in your shop. The programs should load values to an error record that can be interpreted by the error-handling paragraph. When a severe error is encountered, the programs invoke the error-handling paragraph.<A NAME="ch11index108"></A><A NAME="ch11index109"></A><A NAME="ch11index110"></A><A NAME="ch11index111"></A></P>
<P class="docText">The error-handling paragraph should do the following:</P>
<div style="font-weight:bold"><OL class="docList" TYPE="1"><LI><div style="font-weight:normal"><P class="docList">Call the <TT>DSNTIAR</TT> module, a program provided with DB2 that returns standard, textual error messages for <TT>SQLCODE</TT>s.</P></div></LI><LI><div style="font-weight:normal"><P class="docList">Display, print, or record the following information: the error record identifying the involved table, the paragraph, and pertinent host variables; the error text returned by <TT>DSNTIAR</TT>; and the current values in the <TT>SQLCA</TT>.</P></div></LI><LI><div style="font-weight:normal"><P class="docList">Issue a <TT>ROLLBACK</TT>. (This action is not absolutely required because an implicit rollback occurs if one is not requested.)</P></div></LI><LI><div style="font-weight:normal"><P class="docList">Call an <TT>ABEND</TT> module to generate a dump.</P></div></LI></OL></div>
<P class="docText">Your error-handling paragraph can be as complex and precise as you want. Depending on the SQL code, different processing can occur; for example, you might not want to abend the program for every <TT>SQLCODE</TT>.</P>
<P class="docText"><A class="docLink" HREF="#ch11list01">Listing 11.1</A> shows sample COBOL code with an error-handling paragraph as just described. You can tailor this code to meet your needs.</P>
<A NAME="ch11list01"></A><H5 class="docExampleTitle">Listing 11.1. Sample COBOL Error-Handling Paragraph</H5><A NAME="ch11index112"></A><A NAME="ch11index113"></A>

<PRE>
       .
       .
       .
WORKING-STORAGE SECTION.
       .
       .
       .
77  ERROR-TEXT-LENGTH           PIC S9(9)   COMP VALUE +960.
01  ERROR-RECORD.
    05  FILLER                  PIC X(11)   VALUE 'SQLCODE IS '.
    05  SQLCODE-DISP            PIC -999.
    05  FILLER                  PIC X(05)   VALUE SPACES.
    05  ERROR-TABLE             PIC X(18).
    05  ERROR-PARA              PIC X(30).
    05  ERROR-INFO              PIC X(40).
01  ERROR-MESSAGE.
    05  ERROR-MSG-LENGTH        PIC S9(9)   COMP VALUE +960.
    05  ERROR-MSG-TEXT          PIC X(120)  OCCURS 8 TIMES
                                            INDEXED BY ERROR-INDEX.
01  ERROR-ROLLBACK.
    05  FILLER          PIC X(20)   VALUE 'ROLLBACK SQLCODE IS '.
    05  SQLCODE-ROLLBACK        PIC -999.
       .
       .
PROCEDURE DIVISION.
       .
       .
1000-SAMPLE-PARAGRAPH.
    EXEC SQL
        <span class="docEmphasis">SQL statement here</span>
    END-EXEC.
    IF SQLCODE IS LESS THAN ZERO
       MOVE SQLCODE                 TO SQLCODE-DISP
       MOVE '<span class="docEmphasis">Table_Name</span>'            TO ERR-TABLE
       MOVE '1000-SAMPLE-PARAGRAPH' TO ERR-PARA
       MOVE 'Misc info, host variables, etc.'     TO ERR-INFO
       PERFORM 9999-SQL-ERROR
    ELSE
       <span class="docEmphasis">Resume normal processing.</span>
       .
       .
9990-SQL-ERROR.
    DISPLAY ERR-RECORD.
    CALL 'DSNTIAR' USING SQLCA,
                         ERROR-MESSAGE,
                         ERROR-TEXT-LENGTH.
    IF RETURN-CODE IS EQUAL TO ZERO
       PERFORM 9999-DISP-DSNTIAR-MSG
           VARYING ERROR-INDEX FROM 1 BY 1
           UNTIL ERROR-INDEX &gt; 8
    ELSE
       DISPLAY 'DSNTIAR ERROR'
       CALL <span class="docEmphasis">'abend module'</span>.
    DISPLAY 'SQLERRMC   ', SQLERRMC.
    DISPLAY 'SQLERRD1   ', SQLERRD(1).
    DISPLAY 'SQLERRD2   ', SQLERRD(2).
    DISPLAY 'SQLERRD3   ', SQLERRD(3).
    DISPLAY 'SQLERRD4   ', SQLERRD(4).
    DISPLAY 'SQLERRD5   ', SQLERRD(5).
    DISPLAY 'SQLERRD6   ', SQLERRD(6).
    DISPLAY 'SQLWARN0   ', SQLWARN0.
    DISPLAY 'SQLWARN1   ', SQLWARN1.
    DISPLAY 'SQLWARN2   ', SQLWARN2.
    DISPLAY 'SQLWARN3   ', SQLWARN3.
    DISPLAY 'SQLWARN4   ', SQLWARN4.
    DISPLAY 'SQLWARN5   ', SQLWARN5.
    DISPLAY 'SQLWARN6   ', SQLWARN6.
    DISPLAY 'SQLWARN7   ', SQLWARN7.
    DISPLAY 'SQLWARN8   ', SQLWARN8.
    DISPLAY 'SQLWARN9   ', SQLWARN9.
    DISPLAY 'SQLWARNA   ', SQLWARNA.
    EXEC SQL
       ROLLBACK<A NAME="ch11index114"></A><A NAME="ch11index115"></A><A NAME="ch11index116"></A>
    END-EXEC.
    IF SQLCODE IS NOT EQUAL TO ZERO
        DISPLAY 'INVALID ROLLBACK'
        MOVE SQLCODE      TO SQLCODE-ROLLBACK
        DISPLAY ERROR-ROLLBACK.
    CALL <span class="docEmphasis">'abend module'</span>.

9990-EXIT.
    EXIT.
9999-DISP-DSNTIAR-MSG.
    DISPLAY ERROR-MSG-TEXT(ERROR-INDEX).
9999-EXIT.
    EXIT.<A NAME="ch11index117"></A><A NAME="ch11index118"></A>
</PRE><BR>

<P class="docText">When a negative <TT>SQLCODE</TT> is encountered—in paragraph 1000, for example—an error message is formatted and an error paragraph is performed. The error paragraph displays the error message returned by <TT>DSNTIAR</TT>, dumps the contents of the <TT>SQLCA</TT>, and rolls back all updates, deletes, and inserts since the last <TT>COMMIT</TT> point.</P>
<A NAME="ch11note01"></A><div class="docNote"><p class="docNoteTitle">NOTE</p>

<P class="docText">Use a formatted <TT>WORKING-STORAGE</TT> field to display the <TT>SQLCODE</TT>; otherwise, the value will be unreadable.</P></div><br>
<P class="docText">You can code the error-handling paragraph in <A class="docLink" HREF="#ch11list01">Listing 11.1</A> in a copy book that can then be included in each DB2 program. This way, you can standardize your shop's error processing and reduce the amount of code that each DB2 programmer must write.<A NAME="ch11index119"></A><A NAME="ch11index120"></A><A NAME="ch11index121"></A></P>
<A NAME="ch11lev4sec8"></A><H4 class="docSection2Title">Handle Errors and Move On When Possible</H4>
<P class="docText">Certain <TT>SQLCODE</TT> and/or <TT>SQLSTATE</TT> error conditions are not disastrous, and sometimes your program can continue to process after receiving an error code. Of course, it depends on the type of error and the type of work your program is performing. Consider coding your program to handle the "problem" codes, such as the common errors that are outlined in <A class="docLink" HREF="#ch11table04">Table 11.4</A>.<A NAME="ch11index122"></A><A NAME="ch11index123"></A><A NAME="ch11index124"></A></P>
<A NAME="ch11table04"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 11.4. Handling SQL Errors</h5></CAPTION><COLGROUP><COL width="82.5"><COL width="93.5"><COL width="126.5"><COL width="247.5"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><TT>SQLCODE</TT></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><TT>SQLSTATE</TT></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Meaning</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Response</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>-904</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>57011</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Resource unavailable</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Try again (once), then attempt alternate processing; inform user and write out error message.<A NAME="ch11index125"></A><A NAME="ch11index126"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>-911</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>40000</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Timeout or deadlock</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Retry several times and try to continue processing; if multiple failures, inform user and write out error message.<A NAME="ch11index127"></A><A NAME="ch11index128"></A><A NAME="ch11index129"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>-53x</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>235xx</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">RI problem</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Inform user, write out error message, and reverify data.<A NAME="ch11index130"></A><A NAME="ch11index131"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>-551</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>42501</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Authorization<A NAME="ch11index132"></A><A NAME="ch11index133"></A></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Inform user of lack of authority to perform the function and write a log to record the attempted access.</P></TD></TR></TABLE></P><br>
<A NAME="ch11lev4sec9"></A><H4 class="docSection2Title">Avoid Using <TT>WHENEVER</TT></H4>
<P class="docText">SQL has an error trapping statement called <TT>WHENEVER</TT> that you can embed in an application program. When the <TT>WHENEVER</TT> statement is processed, it applies to all subsequent SQL statements issued by the application program in which it is embedded. <TT>WHENEVER</TT> directs processing to continue or to branch to an error handling routine based on the <TT>SQLCODE</TT> returned for the statement. Several examples follow.<A NAME="ch11index134"></A><A NAME="ch11index135"></A><A NAME="ch11index136"></A><A NAME="ch11index137"></A><A NAME="ch11index138"></A></P>
<P class="docText">The following example indicates that processing will continue when an <TT>SQLCODE</TT> of <TT>+100</TT> is encountered:</P>
<pre>

</pre><BR><pre>
EXEC SQL
    WHENEVER NOT FOUND
        CONTINUE
END-EXEC.
</pre><BR>
<P class="docText">When a warning is encountered, the second example of the <TT>WHENEVER</TT> statement causes the program to branch to a paragraph (in this case, <TT>ERROR-PARAGRAPH</TT>) to handle the warning:</P>
<pre>

</pre><BR><pre>
EXEC SQL
    WHENEVER SQLWARNING
        GO TO ERROR-PARAGRAPH
END-EXEC.
</pre><BR>
<P class="docText">When any negative <TT>SQLCODE</TT> is encountered, the next <TT>WHENEVER</TT> statement branches to a paragraph (once again, <TT>ERROR-PARAGRAPH</TT>) to handle errors:</P>
<pre>

</pre><BR><pre>
EXEC SQL
    WHENEVER SQLERROR
        GO TO ERROR-PARAGRAPH
END-EXEC.
</pre><BR>
<P class="docText">Each of the three types of the <TT>WHENEVER</TT> statement can use the <TT>GO TO</TT> or <TT>CONTINUE</TT> option, at the discretion of the programmer. These types of the <TT>WHENEVER</TT> statements trap three "error" conditions:</P>
<P><TABLE CELLSPACING="0" FRAME="void" RULES="none" CELLPADDING="5"><COLGROUP><COL width="137.5"><COL width="412.5"></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NOT FOUND</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The <TT>SQLCODE</TT> is equal to <TT>+100</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLWARNING</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The <TT>SQLCODE</TT> is positive but not <TT>+100</TT> or <TT>SQLWARN0</TT> equal to <TT>W</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SQLERROR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The <TT>SQLCODE</TT> is negative</P></TD></TR></TABLE></P><br>
<P class="docText">Avoid using the <TT>WHENEVER</TT> statement. It is almost always safer to code specific <TT>SQLCODE</TT> checks after each SQL statement and process accordingly. Additionally, you should avoid coding the <TT>GO TO</TT> verb as used by the <TT>WHENEVER</TT> statement. The <TT>GO TO</TT> construct is generally avoided in structured application programming methodologies.<A NAME="ch11index139"></A><A NAME="ch11index140"></A><A NAME="ch11index141"></A><A NAME="ch11index142"></A><A NAME="ch11index143"></A></P>
<A NAME="ch11lev4sec10"></A><H4 class="docSection2Title">Name DB2 Programs, Plans, Packages, and Variables Cautiously</H4>
<P class="docText">Use caution when naming DB2 programs, plans, packages, and variables used in SQL statements. Do not use the following:<A NAME="ch11index144"></A><A NAME="ch11index145"></A><A NAME="ch11index146"></A><A NAME="ch11index147"></A><A NAME="ch11index148"></A><A NAME="ch11index149"></A><A NAME="ch11index150"></A><A NAME="ch11index151"></A><A NAME="ch11index152"></A><A NAME="ch11index153"></A></P>
<UL><LI><P class="docList">The characters <span class="docEmphasis">DB2, SQL, DSN</span>, and <span class="docEmphasis">DSQ</span></P></LI><LI><P class="docList">SQL reserved words</P></LI></UL>
<P class="docText">You should avoid the listed character combinations for the following reasons. <span class="docEmphasis">DB2</span> is too generic and could be confused with a DB2 system component. Because <TT>SQLCA</TT> fields are prefixed with <span class="docEmphasis">SQL</span>, using these letters with another variable name can cause confusion with <TT>SQLCA</TT> fields. IBM uses the three-character prefix <span class="docEmphasis">DSN</span> to name DB2 system programs and <span class="docEmphasis">DSQ</span> to name QMF system programs.</P>
<P class="docText">If SQL reserved words are used for host variables (covered in the next section) and are not preceded by a colon, an error is returned. However, you should not use these words even if all host variables are preceded by a colon. Avoiding these words in your program, plan, and variable names reduces confusion and ambiguity. <A class="docLink" HREF="#ch11table05">Table 11.5</A> lists all DB2 SQL reserved words.</P>
<A NAME="ch11table05"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="none" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 11.5. SQL Reserved Words</h5></CAPTION><COLGROUP><COL width="127.77777777777777"><COL width="133.33333333333331"><COL width="122.22222222222221"><COL width="166.66666666666666"></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ADD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AFTER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ALL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ALLOCATE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ALLOW</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ALTER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AND</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ANY</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ASSOCIATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ASUTIME</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AUDIT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AUX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AUXILIARY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>BEFORE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>BEGIN</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>BETWEEN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>BUFFERPOOL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>BY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CALL</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CAPTURE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CASCADED</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CASE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CAST</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CCSID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CHAR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CHARACTER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CHECK</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CLOSE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CLUSTER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COLLECTION</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COLLID</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COLUMN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COMMENT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COMMIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONCAT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONDITION</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONNECT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONNECTION</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONSTRAINT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONTAINS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONTINUE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CREATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CURRENT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CURRENT_DATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CURRENT_LC_CTYPE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CURRENT_PATH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CURRENT_TIME</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CURRENT_TIMESTAMP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CURSOR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DATA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DATABASE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DAY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DAYS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DBINFO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2SQL</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DECLARE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DEFAULT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DELETE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DESCRIPTOR</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DETERMINISTIC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DISALLOW</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DISTINCT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DO</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DOUBLE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DROP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNHATTR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSSIZE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DYNAMIC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EDITPROC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ELSE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ELSEIF</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ENCODING</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>END</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>END-EXEC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ERASE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ESCAPE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EXCEPT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EXECUTE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EXISTS</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EXIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EXTERNAL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FENCED</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FETCH</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FIELDPROC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FINAL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FOR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FROM</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FULL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FUNCTION</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GENERAL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GENERATED</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GET</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GLOBAL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GOTO</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GRANT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GROUP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HANDLER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HAVING</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HOUR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HOURS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>IF</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>IMMEDIATE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>IN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INDEX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INHERIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INNER</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INOUT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INSENSITIVE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INSERT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INTO</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>IS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ISOBID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>JAR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>JAVA</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>JOIN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>KEY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LABEL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LANGUAGE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LC_CTYPE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LEAVE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LEFT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LIKE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOCAL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOCALE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOCATOR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOCATORS</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOCK</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOCKMAX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOCKSIZE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LONG</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOOP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MICROSECOND</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MICROSECONDS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MINUTE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MINUTES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MODIFIES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MONTH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MONTHS</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NOT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NULL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NULLS</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NUMPARTS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>OBID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>OF</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ON</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>OPEN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>OPTIMIZATION</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>OPTIMIZE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>OR</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ORDER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>OUT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>OUTER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PACKAGE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PARAMETER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PART</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PATH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PIECESIZE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLAN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PRECISION</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PREPARE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PRIQTY</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PRIVILEGES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PROCEDURE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PROGRAM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PSID</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>QUERYNO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>READS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REFERENCES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RELEASE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RENAME</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REPEAT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RESTRICT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RESULT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RESULT_SET_LOCATOR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RETURN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RETURNS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REVOKE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RIGHT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ROLLBACK</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RUN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SAVEPOINT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SCHEMA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SCRATCHPAD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SECOND</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SECONDS</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SECQTY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SECURITY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SELECT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SENSITIVE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SET</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SIMPLE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SOME</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SOURCE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SPECIFIC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STANDARD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STATIC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STAY</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STOGROUP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STORES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STYLE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SUBPAGES</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYNONYM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSFUN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSPROC</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSTEM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TABLE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TABLESPACE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THEN</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TRIGGER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UNDO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UNION</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UNIQUE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UNTIL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UPDATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>USER</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>USING</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VALIDPROC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VALUE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VALUES</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VARIANT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VCAT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VIEW</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VOLUMES</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>WHEN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>WHERE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>WHILE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>WITH</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>WLM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YEAR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YEARS</TT><A NAME="ch11index156"></A><A NAME="ch11index157"></A><A NAME="ch11index158"></A><A NAME="ch11index159"></A><A NAME="ch11index160"></A><A NAME="ch11index161"></A><A NAME="ch11index162"></A><A NAME="ch11index163"></A><A NAME="ch11index164"></A><A NAME="ch11index165"></A><A NAME="ch11index166"></A><A NAME="ch11index167"></A></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR></TABLE></P><br>
<A NAME="ch11note02"></A><div class="docNote"><p class="docNoteTitle">NOTE</p>

<table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"></td><td valign="top"><P class="docText"> As of DB2 V7, <TT>APPLICATION</TT>, <TT>NAME</TT>, and <TT>TYPE</TT> are no longer reserved words.</P></td></tr></table><br></div><br>
<P class="docText">Additionally, IBM SQL reserves additional words. Using these words will not result in an error, but you should avoid their use to eliminate confusion. Additionally, these words are good candidates for future status as DB2 SQL reserved words when functionality is added to DB2. <A class="docLink" HREF="#ch11table06">Table 11.6</A> lists all IBM SQL reserved words that are not also SQL reserved words. Therefore, <A class="docLink" HREF="#ch11table05">Tables 11.5</A> and <A class="docLink" HREF="#ch11table06">11.6</A> collectively list all the IBM and DB2 SQL database reserved words.</P>
<A NAME="ch11table06"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="none" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 11.6. IBM SQL Reserved Words</h5></CAPTION><COLGROUP><COL width="138.88888888888889"><COL width="144.44444444444443"><COL width="266.66666666666663"></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ACQUIRE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ASC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AUTHORIZATION</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AVG</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CASCADE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COUNT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CROSS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DBA</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DBSPACE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DECIMAL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DESC</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EXCEPTION</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EXCLUSIVE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EXPLAIN</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FOREIGN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GRAPHIC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>IDENTIFIED</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INDICATOR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INTERSECT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MAX</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MIN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MODE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NAMED</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NHEADER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ONLY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>OPTION</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PAGE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PAGES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PCTFREE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PCTINDEX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PRIMARY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PRIVATE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PUBLIC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RESET</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RESOURCE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ROW</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ROWS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RRN</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SCHEDULE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SHARE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STATISTICS</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STORPOOL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SUBSTRING</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SUM</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TRANSACTION</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TRIM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>VARIABLE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>WORK</TT><A NAME="ch11index171"></A><A NAME="ch11index172"></A><A NAME="ch11index173"></A></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR></TABLE></P><br>
<A NAME="ch11note03"></A><div class="docNote"><p class="docNoteTitle">NOTE</p>

<P class="docText">You also should avoid using any ANSI SQL reserved words (that are not already included in the previous two lists) in your program, plan, and variable names. Refer to the ANSI SQL standard for a list of the ANSI reserved words.</P>
<P class="docText">You can search for and order documentation on the ANSI SQL standard (and any other ANSI standard) at <A class="docLink" target="_blank" HREF="http://web.ansi.org/default.htm">http://web.ansi.org/default.htm</A>.</P></div><br>
<P class="docText">The guidelines in this section are applicable to every type of DB2 application program. <A class="docLink" HREF="ch12.html#ch12">Chapters 12</A> through <A class="docLink" HREF="ch14.html#ch14">14</A> present guidelines for programming techniques used by specific types of DB2 application programs. Additionally, <A class="docLink" HREF="ch15.html#ch15">Chapter 15</A>, "Using DB2 Stored Procedures," contains programming guidelines to follow when writing stored procedures.<A NAME="ch11index174"></A><A NAME="ch11index175"></A><A NAME="ch11index176"></A><A NAME="ch11index177"></A><A NAME="ch11index178"></A><A NAME="ch11index179"></A><A NAME="ch11index180"></A><A NAME="ch11index181"></A><A NAME="ch11index182"></A><A NAME="ch11index183"></A></P>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch11lev1sec1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch11lev1sec3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
