<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Using XML and DB2</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch17lev1sec2.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch17lev1sec4.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch17lev1sec3"></A><H3 class="docSection1Title" >Using XML and DB2</H3>
<P class="docText">Another newer technology vexing DBAs these days is XML. XML is getting a lot of publicity and, if you believe everything you read, then XML is going to solve all of our interoperability problems, completely replace SQL, and possibly even deliver world peace. Realistically, XML won't do any of those things. But XML does allow designers to create their own customized tags, thereby enabling the definition, transmission, validation, and interpretation of data between applications and organizations.</P>
<P class="docText">XML stands for Extensible Markup Language. Like HTML, XML is based upon SGML (Standard Generalized Markup Language). HTML uses tags to describe how data appears on a Web page. But XML uses tags to describe the data itself. XML retains the key SGML advantage of self-description, while avoiding the complexity of full-blown SGML. XML allows tags to be defined by users that describe the data in the document. This capability gives users a means for describing the structure and nature of the data in the document. In essence, the document becomes self-describing.<A NAME="ch17index98"></A><A NAME="ch17index99"></A><A NAME="ch17index100"></A><A NAME="ch17index101"></A><A NAME="ch17index102"></A><A NAME="ch17index103"></A></P>
<P class="docText">The simple syntax of XML makes it easy to process by machine while remaining understandable to people. Once again, let's use HTML as a metaphor to help us understand XML. HTML uses tags to describe the appearance of data on a page. For example the tag, "text", would specify that the "text" data should appear in bold face. XML uses tags to describe the data itself, instead of its appearance. For example, consider the following XML describing a customer address:<A NAME="ch17index104"></A></P>
<pre>

</pre><BR><pre>
&lt;CUSTOMER&gt;
   &lt;first_name&gt;Craig&lt;/first_name&gt;
   &lt;middle_initial&gt;S.&lt;/middle_initial&gt;
   &lt;last_name&gt;Mullins&lt;/last_name&gt;
   &lt;company_name&gt;BMC Software, Inc.&lt;/company_name&gt;
   &lt;street_address&gt;2101 CityWest Blvd.&lt;/street_address&gt;
   &lt;city&gt;Houston&lt;/city&gt;
   &lt;state&gt;TX&lt;/state&gt;
   &lt;zip_code&gt;77042&lt;/zip_code&gt;
   &lt;country&gt;USA&lt;/country&gt;
&lt;/CUSTOMER&gt;
</pre><BR>
<P class="docText">XML is actually a meta-language—that is, a language for defining other markup languages. These languages are collected in dictionaries called Document Type Definitions (DTDs). The DTD stores definitions of tags for specific industries or fields of knowledge. So, the meaning of a tag must be defined in a "document type declaration" (DTD), such as:<A NAME="ch17index105"></A><A NAME="ch17index106"></A><A NAME="ch17index107"></A></P>
<pre>

</pre><BR><pre>
&lt;!DOCTYPE CUSTOMER [
&lt;!ELEMENT CUSTOMER (first_name, middle_initial, last_name,
           company_name, street_address, city, state,
           zip_code, country)&gt;
&lt;!ELEMENT first_name (#PCDATA)&gt;
&lt;!ELEMENT middle_initial (#PCDATA)&gt;
&lt;!ELEMENT last_name (#PCDATA)&gt;
&lt;!ELEMENT company_name (#PCDATA)&gt;
&lt;!ELEMENT street_address (#PCDATA)&gt;
&lt;!ELEMENT city (#PCDATA)&gt;
&lt;!ELEMENT state (#PCDATA)&gt;
&lt;!ELEMENT zip_code (#PCDATA)&gt;
&lt;!ELEMENT country (#PCDATA)&gt;
]
</pre><BR>
<P class="docText">The DTD for an XML document can either be part of the document or stored in an external file. The XML code samples shown are meant to be examples only. By examining them, you can quickly see how the document itself describes its contents.</P>
<P class="docText">For data management professionals, this is a plus because it eliminates the trouble of tracking down the meaning of data elements. One of the biggest problems associated with database management and processing is finding and maintaining the meaning of stored data. If the data can be stored in documents using XML, the documents themselves will describe their data content. Of course, the DTD is a rudimentary vehicle for defining data semantics. Standards committees are working on the definition of the XML Schema to replace the DTD for defining XML tags. The XML Schema will allow for more precise definition of data, such as data types, lengths, and scale.</P>
<P class="docText">The important thing to remember about XML is that it solves a different problem than HTML. HTML is a markup language, but XML is a meta-language. In other words, XML is a language that generates other kinds of languages. The idea is to use XML to generate a language specifically tailored to each requirement you encounter. It is essential to understand this paradigm shift in order to understand the power of XML.<A NAME="ch17index108"></A><A NAME="ch17index109"></A></P>
<A NAME="ch17note03"></A><div class="docNote"><p class="docNoteTitle">NOTE</p>

<P class="docText">XSL, or Extensible Stylesheet Language, can be used with XML to format XML data for display.</P></div><br>
<P class="docText">In short, XML allows designers to create their own customized tags, thereby enabling the definition, transmission, validation, and interpretation of data between applications and between organizations. So, the most important reason to learn XML is that it is quickly becoming the de facto standard for application interfaces.</P>
<P class="docText">There are, however, some problems with XML. The biggest problem with XML lies largely in market hype. Throughout the industry, there is plenty of confusion surrounding XML. Some believe that XML will provide metadata where none currently exists, or that XML will replace SQL as a data access method for relational data. Neither of these assertions is true.<A NAME="ch17index110"></A></P>
<P class="docText">There is no way that any technology, XML included, can conjure up information that does not exist. People must create the metadata tags in XML for the data to be described. XML enables self-describing documents; it doesn't describe your data for you.</P>
<P class="docText">Moreover, XML doesn't perform the same functions as SQL. As a result, XML can't replace it. As the standard access method for relational data, SQL is used to "tell" a relational DBMS what data is to be retrieved. XML, on the other hand, is a document description language that describes the contents of data. XML might be useful for defining databases, but not for accessing them.</P>
<P class="docText">DB2, as well as most of the other popular DBMS products, now provides built-in support for XML. By integrating XML into DB2 databases, you can more directly and quickly access the XML documents, as well as search and store entire XML documents using SQL. Integration can involve simply storing XML in a large <TT>VARCHAR</TT> or <TT>CLOB</TT> column or breaking down the XML into multiple columns in one or more DB2 tables.</P>
<P class="docText">When you store or compose a document, you can use the capabilities of the DB2 XML extender, which provides functions and tools to help integrate XML with DB2. The user-defined distinct types <TT>XMLVARCHAR</TT>, <TT>XMLCLOB</TT>, and <TT>XMLFILE</TT> are delivered to help store XML data in DB2 tables.<A NAME="ch17index111"></A></P>
<table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0"  width="30" height="18" SRC="images/0672326132/graphics/V8_icon.gif" ALT="graphics/V8_icon.gif"></td><td valign="top"><P class="docText"> DB2 also provides several functions to facilitate XML storage, retrieval, extraction, and updating. These functions are documented in <A class="docLink" HREF="ch03.html#ch03">Chapter 3</A>, "Using DB2 Functions."</P></td></tr></table><br>
<A NAME="ch17lev2sec9"></A><H4 class="docSection2Title">XML Access Methods</H4>
<P class="docText">When storing XML documents in DB2, you will have to decide on either the <span class="docEmphasis">column</span> or <span class="docEmphasis">collection</span> access method. Once you choose a method you will need to tell DB2 how you plan on storing and retrieving the documents. This is done through a Data Access Definition (DAD) file. The DAD is a file used by DB2 to define the access method needed to process an XML document as either a column or a collection.<A NAME="ch17index112"></A><A NAME="ch17index113"></A></P>
<A NAME="ch17lev3sec1"></A><H5 class="docSection3Title">XML Column Access Method</H5>
<P class="docText">The column access method stores and retrieves XML documents as DB2 column data. This means the entire XML document is stored in a single DB2 column.<A NAME="ch17index114"></A><A NAME="ch17index115"></A><A NAME="ch17index116"></A></P>
<P class="docText">Consider choosing this method in the following situations:</P>
<UL><LI><P class="docList">The XML document already exists and you just want to store it in DB2 for integrity, archival, or auditing purposes.</P></LI><LI><P class="docList">The XML document is usually read, but not modified.</P></LI><LI><P class="docList">The document has large text paragraphs and you want to use DB2 Text Extender capabilities to search the document.</P></LI><LI><P class="docList">You want to store the XML document in the native file system and use DB2 to manage and search the documents.</P></LI></UL>
<A NAME="ch17lev3sec2"></A><H5 class="docSection3Title">XML Collection Access Method</H5>
<P class="docText">The column access method composes XML documents from a collection of DB2 tables and columns, or decomposes XML documents into a collection of DB2 tables and columns. This means that the XML document is broken apart and stored in various tables and columns.<A NAME="ch17index117"></A><A NAME="ch17index118"></A><A NAME="ch17index119"></A></P>
<P class="docText">Consider choosing this method in the following situations:</P>
<UL><LI><P class="docList">You have an existing database that you would like to compose XML documents from based on a given document type definition (DTD).</P></LI><LI><P class="docList">The data will need to be accessed using SQL and treated like relational data more than it will need to be treated like XML data.</P></LI><LI><P class="docList">The XML document needs to be updated often and performance is critical.</P></LI></UL>
<A NAME="ch17lev3sec3"></A><H5 class="docSection3Title">The Data Access Definition File</H5>
<P class="docText">The DAD file is an XML document that is used to map the structure of an XML document to how it is stored in DB2. The DAD file is used when storing XML documents in a column and when composing or decomposing XML data.<A NAME="ch17index120"></A><A NAME="ch17index121"></A><A NAME="ch17index122"></A><A NAME="ch17index123"></A><A NAME="ch17index124"></A></P>
<P class="docText">This is where DB2 stores the information pertaining to the method of XML storage (column versus collection).</P>
<A NAME="ch17lev2sec10"></A><H4 class="docSection2Title">XML-DB2 Administration</H4>
<P class="docText">DB2 also provides some administration tools. But remember, the XML Extender requires IBM USS (Unix System Services). But, you can use either an administration wizard from a Windows or Unix client, or from z/OS using the USS command line and HFS, or TSO. You can avoid using a non-mainframe platform for XML administration tasks by using either the USS command line and <TT>odb2</TT>, or TSO and batch to perform administration tasks.<A NAME="ch17index125"></A><A NAME="ch17index126"></A></P>
<P class="docText">The XML Extender installation creates sample files and executable files in partitioned data sets. After these partitioned data sets are installed, it is recommended that you create HFS files in your USS environment by running the <TT>DXXGPREP</TT> batch job. The <TT>DXXGPREP</TT> JCL executes the needed <TT>BIND</TT>s, creates sample DB2 tables, and copies sample files to HFS.<A NAME="ch17index127"></A><A NAME="ch17index128"></A><A NAME="ch17index129"></A></P>
<P class="docText">Keep in mind that all the XML Extender facilities supplied for application programs run in the z/OS MVS environment as stored procedures or user-defined functions (UDFs). Some of the UDFs that refer to the <TT>XMLFILE</TT> data type require access to an HFS system.</P>
<P class="docText">When you use the <TT>odb2</TT> command line to enter DB2 commands from USS, DB2 uses the Call Attach Facility to execute dynamic SQL and commands from the z/OS Unix shell.</P>
<P class="docText">To start the <TT>odb2</TT> command line, simply type the following from the USS command shell:</P>
<pre>

</pre><BR><pre>
odb2
</pre><BR>
<P class="docText">A command prompt will be displayed and you will be able to enter DB2 commands.<A NAME="ch17index130"></A><A NAME="ch17index131"></A></P>
<A NAME="ch17lev3sec4"></A><H5 class="docSection3Title">XML Administration Support Tables</H5>
<P class="docText">The XML Extender creates two administration support tables to manage your XML-DB2 environment.<A NAME="ch17index132"></A><A NAME="ch17index133"></A><A NAME="ch17index134"></A><A NAME="ch17index135"></A></P>
<P class="docText">The first table is the DTD repository table, or <TT>DB2XML.DTD_REF</TT>. This table is used to validate XML data in an XML column or XML collection.<A NAME="ch17index136"></A><A NAME="ch17index137"></A><A NAME="ch17index138"></A><A NAME="ch17index139"></A></P>
<P class="docText">Each DTD in the <TT>DTD_REF</TT> table has a unique ID. The XML Extender creates the <TT>DTD_REF</TT> table when you enable a database for XML. The columns of the DTD repository table are as follows:</P>
<BLOCKQUOTE><P><p class="docText"><span class="docEmphStrong"><TT>DTDID</TT></span>— 
Used to identify the DTD. This primary key is defined as <TT>VARCHAR(128)</TT>, must be unique, and is not nullable. It must be the same as the <TT>SYSTEM ID</TT> on the <TT>DOCTYPE</TT> line in each XML document, when validation is used.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>CONTENT</TT></span>— 
Contains the content of the DTD in an <TT>XMLCLOB</TT> column.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>USAGE_COUNT</TT></span>— 
Contains the number (<TT>INTEGER</TT>) of XML columns and XML collections in the database that are using this DTD to define a <TT>DAD</TT>.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>AUTHOR</TT></span>— 
Specifies the author of the DTD. The column is defined as <TT>VARCHAR(128)</TT> and is optional.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>CREATOR</TT></span>— 
Specifies the user ID that does the first insertion (<TT>VARCHAR(128)</TT>).</p></P><P><p class="docText"><span class="docEmphStrong"><TT>UPDATOR</TT></span>— 
Specifies the user ID that does the last update (<TT>VARCHAR(128)</TT>).<A NAME="ch17index140"></A><A NAME="ch17index141"></A><A NAME="ch17index142"></A><A NAME="ch17index143"></A></p></P></BLOCKQUOTE>
<P class="docText">The second XML administration support table is the XML usage table, or <TT>DB2XML.XML_USAGE</TT>. This table stores common information for each XML-enabled column.<A NAME="ch17index144"></A><A NAME="ch17index145"></A><A NAME="ch17index146"></A><A NAME="ch17index147"></A></P>
<P class="docText">The XML Extender maintains the <TT>XML_USAGE</TT> table as XML is stored in your DB2 tables. The columns of the <TT>XML-USAGE</TT> table are as follows:</P>
<BLOCKQUOTE><P><p class="docText"><span class="docEmphStrong"><TT>TABLE_SCHEMA</TT></span>— 
Contains the schema name of the user table that contains an XML column (for XML column) or a value of <TT>DXX_COLL</TT> as the default schema name (for XML collection).</p></P><P><p class="docText"><span class="docEmphStrong"><TT>TABLE_NAME</TT></span>— 
Contains the name of the user table that contains an XML column (for XML column) or a value <TT>DXX_COLLECTION</TT>, which identifies the entity as a collection (for XML collection).</p></P><P><p class="docText"><span class="docEmphStrong"><TT>COL_NAME</TT></span>— 
Contains the name of the XML column or XML collection. It is part of the composite key along with the <TT>TABLE_NAME</TT>.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>DTDID</TT></span>— 
Contains a string associating a DTD inserted into <TT>DTD_REF</TT> with a DTD specified in a <TT>DAD</TT> file. The value of this column must match the value of the <TT>DTDID</TT> element in the <TT>DAD</TT>.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>DAD</TT></span>— 
The content of the <TT>DAD</TT> file that is associated with the column or collection.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>ROW_ID</TT></span>— 
An identifier of the row.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>ACCESS_MODE</TT></span>— 
Specifies which access mode is used: <TT>1</TT> indicates XML collection; <TT>0</TT> indicates XML column.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>DEFAULT_VIEW</TT></span>— 
Stores the default view name if there is one.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>TRIGGER_SUFFIX</TT></span>— 
Used for unique trigger names.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>VALIDATION</TT></span>— 
Will be <TT>1</TT> for yes, or <TT>0</TT> for no.<A NAME="ch17index148"></A><A NAME="ch17index149"></A><A NAME="ch17index150"></A><A NAME="ch17index151"></A><A NAME="ch17index152"></A><A NAME="ch17index153"></A><A NAME="ch17index154"></A><A NAME="ch17index155"></A></p></P></BLOCKQUOTE>
<A NAME="ch17lev2sec11"></A><H4 class="docSection2Title">XML-DB2 Guidelines</H4>
<P class="docText">Consider the following guidelines as you embark on using XML with your DB2 databases.</P>
<A NAME="ch17lev4sec11"></A><H5 class="docSection3Title">Use the Sample Scripts to Get Started</H5>
<P class="docText">IBM supplies a set of sample scripts you can use as a guideline for setting up your DB2-XML environment. You can find these files in the following directory:<A NAME="ch17index156"></A></P>
<pre>

</pre><BR><pre>
<span class="docEmphasis">dxx_install</span>/samples/cmd
</pre><BR>
<P class="docText">For <span class="docEmphasis"><TT>dxx_install</TT></span>, substitute the USS directory name where the sample DTD, DAD, and XML files were copied by your <TT>DXXGPREP</TT> job.</P>
<A NAME="ch17lev4sec12"></A><H5 class="docSection3Title">Validate Your XML</H5>
<P class="docText">You can use a DTD to validate XML data in an XML column. The XML Extender creates a table in the XML-enabled database, called <TT>DTD_REF</TT>. The table is known as the DTD reference and is available for you to store DTDs. When you validate XML documents, you must store the DTD in this repository.<A NAME="ch17index157"></A><A NAME="ch17index158"></A></P>
<A NAME="ch17lev4sec13"></A><H5 class="docSection3Title">Backup the XML Administration Support Tables</H5>
<P class="docText">The XML administration support tables, <TT>XML_USAGE</TT> and <TT>DTD_REF</TT>, are required for many XML Extender activities. Be sure that you consistently backup these tables to. ensure recoverability of your XML-DB2 environment.<A NAME="ch17index159"></A><A NAME="ch17index160"></A><A NAME="ch17index161"></A><A NAME="ch17index162"></A><A NAME="ch17index163"></A></P>
<A NAME="ch17lev4sec14"></A><H5 class="docSection3Title">Learn All You Can About XML</H5>
<P class="docText">Before you begin to mix XML and DB2, be sure that you have a solid grasp of XML. The short introduction in this section is merely the tip of the iceberg. You will need to understand that XML is truly hierarchical and, as such, will not match up well with your relational, DB2 way of thinking and processing data.<A NAME="ch17index164"></A><A NAME="ch17index165"></A></P>
<P class="docText">Additional information on XML and the DB2 XML Extender can be found at the following Web sites:<A NAME="ch17index166"></A></P>
<P class="docText"><A class="docLink" target="_blank" HREF="http://www.ibm.com/software/data/db2/extenders/xmlext/index.html">http://www.ibm.com/software/data/db2/extenders/xmlext/index.html</A></P>
<P class="docText"><A class="docLink" target="_blank" HREF="http://www.ibm.com/developer/">http://www.ibm.com/developer/</A></P>
<P class="docText"><A class="docLink" target="_blank" HREF="http://www.sswug.org/centerxml/">http://www.sswug.org/centerxml/</A></P>
<P class="docText"><A class="docLink" target="_blank" HREF="http://www.oasis-open.org">http://www.oasis-open.org</A></P>
<P class="docText"><A class="docLink" target="_blank" HREF="http://www.xml.org">http://www.xml.org</A></P>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch17lev1sec2.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch17lev1sec4.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
