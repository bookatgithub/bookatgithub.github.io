<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>CICS (Customer Information Control System)</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch18lev1sec1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch18lev1sec3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch18lev1sec2"></A><H3 class="docSection1Title">CICS (Customer Information Control System)</H3>
<P class="docText">The second of the four "doors to DB2" is CICS (Customer Information Control System). CICS is a teleprocessing monitor that enables programmers to develop online, transaction-based programs. By means of BMS (Basic Mapping Support) and the data communications facilities of CICS, programs can display formatted data on screens and receive formatted data from users for further processing. A typical scenario for the execution of a CICS transaction follows:<A NAME="ch18index258"></A><A NAME="ch18index259"></A><A NAME="ch18index260"></A></P>
<A NAME="ch18pr05"></A>










<div style="font-weight:bold"><OL class="docList" START="1"><LI value="1"><div style="font-weight:normal">The operator enters data on a terminal, including a transaction ID, and presses Enter. The data can simply be a transaction ID entered by the operator or a formatted BMS screen with the transaction ID.<BR><BR></div></LI><LI value="2"><div style="font-weight:normal">CICS reads the data into the terminal I/O area, and a task is created.<BR><BR></div></LI><LI value="3"><div style="font-weight:normal">CICS checks that the transaction ID is valid.<BR><BR></div></LI><LI value="4"><div style="font-weight:normal">If the program for this transaction is not in main storage, the program is loaded.<BR><BR></div></LI><LI value="5"><div style="font-weight:normal">The task is placed into the queue, waiting to be dispatched.<BR><BR></div></LI><LI value="6"><div style="font-weight:normal">When the task is dispatched, the appropriate application program is run.<BR><BR></div></LI><LI value="7"><div style="font-weight:normal">The program requests BMS to read data from the terminal.<BR><BR></div></LI><LI value="8"><div style="font-weight:normal">BMS reads the data, and the program processes it.<BR><BR></div></LI><LI value="9"><div style="font-weight:normal">The program requests BMS to display the data to a terminal.<BR><BR></div></LI><LI value="10"><div style="font-weight:normal">BMS displays the data.<BR><BR></div></LI><LI value="11"><div style="font-weight:normal">The task is terminated.<BR><BR></div></LI></OL></div>
<P class="docText">When DB2 data is accessed using CICS, multiple threads can be active simultaneously, giving multiple users concurrent access to a DB2 subsystem of a single CICS region. Contrast this functionality with the TSO environment, in which only one thread can be active for any given TSO address space.</P>
<P class="docText">A mechanism named the CICS Attach Facility connects CICS with DB2. Using the CICS Attach Facility, you can connect each CICS region to only one DB2 subsystem at a time. You can connect each DB2 subsystem, however, to more than one CICS region at one time, as you can see in <A class="docLink" HREF="#ch18fig22">Figure 18.22</A>.<A NAME="ch18index261"></A><A NAME="ch18index262"></A></P>
<A NAME="ch18fig22"></A><p><CENTER><H5 class="docFigureTitle">Figure 18.22. CICS region to DB2 subsystem relationship.</H5>
<p class="docText"><IMG BORDER="0" width="400" height="383" SRC="images/0672326132/graphics/18fig22.gif" ALT="graphics/18fig22.gif"></p></CENTER></p><br>
<P class="docText">DB2 provides services to CICS via MVS TCBs. All of these TCBs reside in the CICS address space and perform cross-memory instructions to execute the SQL code in the DB2 database services address space (<TT>DSNDBM1</TT>). Before you delve too deeply into the specifics of the CICS Attach Facility, you should explore the basics of CICS further.<A NAME="ch18index263"></A></P>
<A NAME="ch18lev2sec9"></A><H4 class="docSection2Title">CICS Terminology and Operation</H4>
<P class="docText">To fully understand the manner in which CICS controls the execution of an application program, you must first understand the relationships among tasks, transactions, and programs. These three terms define separate entities that function together, under the control of CICS, to create an online processing environment.</P>
<P class="docText">A <span class="docEmphasis">task</span> is simply a unit of work scheduled by the operating system. CICS, a batch job, DB2, and TSO are examples of tasks. CICS, however, can schedule tasks under its control, much like the way an operating system schedules tasks. A <span class="docEmphasis">CICS task</span>, therefore, is a unit of work, composed of one or more programs, scheduled by CICS.<A NAME="ch18index264"></A><A NAME="ch18index265"></A></P>
<P class="docText">The purpose of a <span class="docEmphasis">transaction</span> is to initiate a task. A transaction is initiated by a 1- to 4-byte identifier that is defined to CICS through a control table. Generally, a one-to-one correspondence exists between CICS transactions and CICS tasks, but one transaction can initiate more than one task.<A NAME="ch18index266"></A><A NAME="ch18index267"></A></P>
<P class="docText">Finally, a <span class="docEmphasis">program</span> is an organized set of instructions that accomplishes an objective in a given unit of work. A CICS program can perform one or many CICS tasks.<A NAME="ch18index268"></A><A NAME="ch18index269"></A></P>
<A NAME="ch18lev2sec10"></A><H4 class="docSection2Title">CICS Tables</H4>
<P class="docText">Older versions of CICS use tables, maintained by a systems programmer, to administer its online environment. These tables control the availability of CICS resources and direct CICS to operate in specific ways. Based on the values registered in these tables, CICS can be customized for each user site. The major tables that affect CICS-DB2 application programs are outlined in the subsections that follow.<A NAME="ch18index270"></A><A NAME="ch18index271"></A></P>
<A NAME="ch18lev3sec10"></A><H5 class="docSection3Title">PPT (Processing Program Table)</H5>
<P class="docText">CICS programs and BMS maps must be registered in the PPT (Processing Program Table). If the program or map has not been recorded in the PPT, CICS cannot execute the program or use the map. This is true for all CICS programs, including those with embedded SQL. For programs, the name recorded in the PPT must be the name of the program load module as it appears in the load library.<A NAME="ch18index272"></A><A NAME="ch18index273"></A><A NAME="ch18index274"></A><A NAME="ch18index275"></A><A NAME="ch18index276"></A></P>
<A NAME="ch18lev3sec11"></A><H5 class="docSection3Title">PCT (Program Control Table)</H5>
<P class="docText">The PCT (Program Control Table) is used to register CICS transactions. CICS reads this table to identify and initialize transactions. Therefore, all transactions must be registered in the PCT before they can be initiated in CICS.<A NAME="ch18index277"></A><A NAME="ch18index278"></A><A NAME="ch18index279"></A><A NAME="ch18index280"></A></P>
<A NAME="ch18lev3sec12"></A><H5 class="docSection3Title">FCT (File Control Table)</H5>
<P class="docText">Every file that will be read from or written to using CICS operations must be registered in the FCT (File Control Table). This requirement does not apply to DB2 tables, however. The underlying VSAM data sets for DB2 table spaces and indexes do not need to be registered in the FCT before CICS-DB2 programs read from them. DB2 data access is accomplished through SQL, and the DB2 subsystem performs the I/O necessary to access the data in DB2 data sets. A CICS-DB2 program that reads any file using conventional methods (that is, non-SQL), however, must ensure that the file has been registered in the FCT before accessing its data.<A NAME="ch18index281"></A><A NAME="ch18index282"></A><A NAME="ch18index283"></A><A NAME="ch18index284"></A></P>
<A NAME="ch18lev3sec13"></A><H5 class="docSection3Title">RCT (Resource Control Table)</H5>
<P class="docText">When a DB2 program will be run under CICS, an additional table called the RCT (Resource Control Table) is used to control the interface. The RCT applies only to CICS transactions that access DB2 data; it defines the manner in which DB2 resources will be used by CICS transactions. In particular, the RCT defines a plan for each transaction that can access DB2. Additionally, it defines parameters detailing the number and type of threads available for application plans and the DB2 command processor.<A NAME="ch18index285"></A><A NAME="ch18index286"></A><A NAME="ch18index287"></A><A NAME="ch18index288"></A></P>
<A NAME="ch18lev3sec14"></A><H5 class="docSection3Title">Other Tables</H5>
<P class="docText">Other tables used by CICS control resource security, terminal definitions, logging and journaling, and the automatic invocation of program at CICS startup. A discussion of these tables is beyond the scope of this book.<A NAME="ch18index289"></A><A NAME="ch18index290"></A></P>
<A NAME="ch18lev2sec11"></A><H4 class="docSection2Title">RDO (Resource Definition Online)</H4>
<P class="docText">As of CICS V4, the manner in which the interface between CICS and a DB2 subsystem is defined began to change. Instead of populating tables and updating the configuration using macros, a new method of changing parameters online is available. This new method is known as <span class="docEmphasis">Resource Definition Online</span>, or <span class="docEmphasis">RDO</span>. Whether you use the RCT or the RDO depends on the version of CICS that you are using:<A NAME="ch18index291"></A><A NAME="ch18index292"></A><A NAME="ch18index293"></A><A NAME="ch18index294"></A></P>
<UL><LI><P class="docList">For CICS/ESA Version 4 (and prior releases) and CICS/TS Version 1 Release 1, the CICS-DB2 interface is defined using the RCT.</P></LI><LI><P class="docList">For CICS/TS Version 1 Release 2, the CICS-DB2 interface can be defined using the RCT or using RDO.</P></LI><LI><P class="docList">For CICS/TS Version 1 Release 3 and subsequent releases, the CICS-DB2 interface must be defined using RDO.</P></LI></UL>
<A NAME="ch18note02"></A><div class="docNote"><p class="docNoteTitle">NOTE</p>

<P class="docText">Most shops using CICS will have already converted to using the RDO, or will need to convert soon. The most current release of CICS (circa early 2004) is CICS Transaction Server for z/OS V2.3.</P></div><br>
<P class="docText">The RDO is simply a new mechanism for defining the interface. It offers several benefits and it is relatively easy to migrate from using the RCT to using RDO. IBM provides a utility named DFHCSDUP that can be used to migrate RCT parameters to RDO names.</P>
<P class="docText">The benefits RDO provides over the RCT are:</P>
<UL><LI><P class="docList">You can add, delete, or change RDO definitions without stopping the CCIS-DB2 connection.</P></LI><LI><P class="docList">You can use wildcarding to specify groups of transactions and thereby simplify the setup of your CICS-DB2 transactions.</P></LI><LI><P class="docList">The CICS-DB2 control blocks are moved above the 16MB line.</P></LI></UL>
<P class="docText">Additionally, conversion is not difficult because the RCT parameters and RDO names are similar. You can find more details about the RCT and RDO in the section "<A class="docLink" HREF="#ch18lev2sec17">CICS-DB2 Connection Guidelines</A>" later in this chapter.<A NAME="ch18index295"></A><A NAME="ch18index296"></A></P>
<A NAME="ch18lev2sec12"></A><H4 class="docSection2Title">CICS-DB2 Program Preparation</H4>
<P class="docText">Another consideration when you're using CICS is the program preparation process. When CICS programs are prepared for execution, a step is added to the process to prepare the embedded CICS commands: the execution of the CICS command language translator (see <A class="docLink" HREF="#ch18fig23">Figure 18.23</A>). You can think of the CICS command language translator as a precompiler for CICS commands. The CICS command language translator comments out the code embedded between <TT>EXEC CICS</TT> and <TT>END-EXEC</TT> and replaces it with standard COBOL <TT>CALL</TT> statements.<A NAME="ch18index297"></A><A NAME="ch18index298"></A></P>
<A NAME="ch18fig23"></A><p><CENTER><H5 class="docFigureTitle">Figure 18.23. CICS/DB2 program preparation.</H5>
<p class="docText"><div class="v1"><a target="_blank" href="images/0672326132/graphics/18fig23_alt.gif">[View full size image]</a></div><IMG BORDER="0" width="500" height="591" SRC="images/0672326132/graphics/18fig23.gif" ALT="graphics/18fig23.gif"></p></CENTER></p><br>
<P class="docText">The rest of the program preparation procedure is essentially unchanged. One notable exception is that you must link the CICS language interface (<TT>DSNCLI</TT>), rather than the TSO language interface (<TT>DSNELI</TT>), to the load module.<A NAME="ch18index299"></A><A NAME="ch18index300"></A></P>
<P class="docText">When embedded CICS commands are encountered, the DB2 precompiler bypasses them, but the CICS command language translator returns warning messages. Thus, you might want to run the DB2 precompiler before running the CICS command language translator. Functionally, which precompiler is run first does not matter. Running the DB2 precompiler first, however, eliminates a host of unwanted messages and speeds up program preparation somewhat because the CICS command language translator needs to perform less work.<A NAME="ch18index301"></A><A NAME="ch18index302"></A></P>
<A NAME="ch18lev2sec13"></A><H4 class="docSection2Title">CICS Attach Facility</H4>
<P class="docText">As mentioned, CICS must be attached to DB2 before any transaction can access DB2 data. This is accomplished with the CICS Attach Facility. <A class="docLink" HREF="#ch18fig24">Figure 18.24</A> depicts the basic operation of the CICS Attach Facility.<A NAME="ch18index303"></A><A NAME="ch18index304"></A></P>
<A NAME="ch18fig24"></A><p><CENTER><H5 class="docFigureTitle">Figure 18.24. The CICS Attach Facility.</H5>
<p class="docText"><IMG BORDER="0" width="500" height="389" SRC="images/0672326132/graphics/18fig24.gif" ALT="graphics/18fig24.gif"></p></CENTER></p><br>
<P class="docText">The CICS Attach Facility provides support for multiple transactions using multiple threads to access data in a single DB2 subsystem. CICS transactions requiring DB2 resources are routed to DB2 by <TT>DSNCLI</TT> each time an SQL statement is encountered. The routing is accomplished using the functionality of the CICS Task Related User Exit (TRUE). The TRUE formats the request for DB2 data and passes it to the CICS Attach Facility, which creates a new thread or reuses an existing one.</P>
<P class="docText">The following activities occur when a thread is created:</P>
<A NAME="ch18pr06"></A>





<div style="font-weight:bold"><OL class="docList" START="1"><LI value="1"><div style="font-weight:normal">A DB2 sign-on is initiated, whereby the authorization ID identifying the user of the thread is established based on a parameter specified in the RCT.<BR><BR></div></LI><LI value="2"><div style="font-weight:normal">A DB2 accounting record is written.<BR><BR></div></LI><LI value="3"><div style="font-weight:normal">Authorization is checked for the user.<BR><BR></div></LI><LI value="4"><div style="font-weight:normal">The executable form of the plan is loaded into memory as follows. The header portion of the SKCT is loaded into the EDM Pool, if it is not already there. This SKCT header is then copied to an executable form called a <span class="docEmphasis">cursor table</span>, which is also placed in the EDM Pool. (These terms are fully defined in <A class="docLink" HREF="ch22.html#ch22">Chapter 22</A>, "The Table-Based Infrastructure of DB2.")<BR><BR></div></LI><LI value="5"><div style="font-weight:normal">If <TT>VALIDATE(RUN)</TT> was specified at bind time for the plan, an incremental bind is performed. Avoid incremental binds by specifying <TT>VALIDATE(BIND)</TT>.<BR><BR></div></LI><LI value="6"><div style="font-weight:normal">If <TT>ACQUIRE(ALLOCATE)</TT> was specified at bind time for the plan, the following occurs. Locks are acquired for all table spaces used by the plan, all DBDs are loaded into memory (EDM Pool) referenced by the plan, and all data sets to be used by the plan are opened, if they are not already open.<BR><BR></div></LI></OL></div>
<P class="docText">After the thread is created, the plan corresponding to the transaction being executed is allocated, and the SQL statement is processed. When the request for DB2 resources is satisfied, the data is passed back to the requesting CICS program through the TRUE. The thread is placed in an MVS-wait state until it is needed again. When the next SQL statement is encountered, the CICS program repeats the entire process except the thread creation because the thread has already been allocated and is waiting to be used.<A NAME="ch18index305"></A><A NAME="ch18index306"></A></P>
<P class="docText">When the CICS task is terminated or a CICS <TT>SYNCPOINT</TT> is issued, the thread is terminated and the following actions occur:</P>
<A NAME="ch18pr07"></A>





<div style="font-weight:bold"><OL class="docList" START="1"><LI value="1"><div style="font-weight:normal">The CICS Attach Facility performs a two-phase commit, which synchronizes the updates and commits made to all defined CICS resources (for example, IMS databases, VSAM files, and sequential files) and DB2 tables. This process is described in more detail in the "<A class="docLink" HREF="#ch18lev2sec18">Two-Phase Commit</A>" section, later in this chapter.<BR><BR></div></LI><LI value="2"><div style="font-weight:normal">A DB2 accounting record is written.<BR><BR></div></LI><LI value="3"><div style="font-weight:normal">Table space locks are released.<BR><BR></div></LI><LI value="4"><div style="font-weight:normal">The executable form of the plan is freed from the EDM Pool.<BR><BR></div></LI><LI value="5"><div style="font-weight:normal">Memory used for working storage is freed.<BR><BR></div></LI><LI value="6"><div style="font-weight:normal">If <TT>CLOSE(YES)</TT> was specified for table spaces or indexes used by the thread, the underlying VSAM data sets are closed (provided no other resources are accessing them).<BR><BR></div></LI></OL></div>
<P class="docText">The CICS Attach Facility is started using the <TT>DSNC STRT</TT> command, indicating the RCT to use.</P>
<P class="docText">The CICS attachment facility is provided on the CICS product tape starting with CICS V4. The CICS attachment that shipped on the DB2 product tape is for versions of CICS prior to V4.</P>
<P class="docText">The CICS attachment facility programs are named like <TT>DSN</TT><span class="docEmphStrong"><TT>2</TT></span><TT>xxxx</TT> for CICS V4 and subsequent releases; for prior versions of CICS the programs were named like <TT>DSN</TT><span class="docEmphStrong"><TT>C</TT></span><TT>xxxx</TT>.<A NAME="ch18index307"></A><A NAME="ch18index308"></A></P>
<A NAME="ch18note03"></A><div class="docNote"><p class="docNoteTitle">CAUTION</p>

<P class="docText">If you switch CICS attachment facilities due to moving to CICS V4, be sure to check your CSD definitions, Program List Tables (PLTs), and CICS application programs for references to all old attachment facility programs named like <TT>DSNCxxxx</TT>, and change them to the new <TT>DSN2xxxx</TT> name.</P></div><br>
<A NAME="ch18lev2sec14"></A><H4 class="docSection2Title">Types of Threads</H4>
<P class="docText">You will use the RCT or RDO to define the attachment of CICS to DB2 and to assign threads to each CICS-DB2 transaction. CICS transactions can use three types of threads to access DB2: command threads, entry threads, and pool threads.<A NAME="ch18index309"></A><A NAME="ch18index310"></A></P>
<P class="docText"><span class="docEmphasis">Command threads</span> can be used only by the <TT>DSNC</TT> command processor. If no command threads are available, pool threads are used.<A NAME="ch18index311"></A><A NAME="ch18index312"></A></P>
<P class="docText"><span class="docEmphasis">Entry threads,</span> also called dedicated threads, are associated with a single application plan. Multiple transactions can be assigned to an entry thread grouping, but each transaction must use the same application plan. Subsequent CICS transactions that use the same application plan can reuse entry threads. This can result in decreased runtime because you avoid the cost of establishing the thread.<A NAME="ch18index313"></A><A NAME="ch18index314"></A></P>
<P class="docText">You can define entry threads to be either protected or unprotected. A protected thread remains available for a preset time, waiting for transactions that can reuse the thread to be run. An unprotected thread is terminated upon completion unless another transaction is already waiting to use it.</P>
<P class="docText">Finally, if an entry thread is not available for a transaction's use, it may be diverted to the pool, where it will utilize a pool thread. Any transaction specifically defined to the pool can use the <span class="docEmphasis">pool threads</span>. In addition, you can define any transaction to be divertable. A divertable transaction is one defined to an entry or command thread that, when no appropriate threads are available, will be diverted to use a pool thread. A pool thread is not reusable and is always terminated when the transaction using it is finished.<A NAME="ch18index315"></A><A NAME="ch18index316"></A><A NAME="ch18index317"></A><A NAME="ch18index318"></A></P>
<P class="docText">You define command, entry, and pool threads by specifying the appropriate parameters in the RCT or RDO. The following list summarizes the capabilities of the thread types:</P>
<P><TABLE CELLSPACING="0" FRAME="void" RULES="none" CELLPADDING="5"><COLGROUP><COL width="99"><COL width="451"></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COMD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Used solely for <TT>DSNC</TT> commands.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ENTRY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Used primarily for high-volume or high-priority transactions. Entry threads can be protected, reused, or diverted to the pool.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>POOL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Used primarily for low-priority and low-volume transactions. Pool threads cannot be protected and cannot be diverted. Very limited thread reuse is available with pool threads (only when the first transaction in the queue requests the same plan as the one used by the thread being released—a rare occurrence indeed).</P></TD></TR></TABLE></P><br>
<P class="docText">The next several sections discuss the specific parameters used by the two methods of configuring a DB2-CICS connection: the RCT and RDO.<A NAME="ch18index319"></A><A NAME="ch18index320"></A></P>
<A NAME="ch18lev2sec15"></A><H4 class="docSection2Title">The RCT Parameters</H4>
<P class="docText">The RCT is one method to define the relationship environment between CICS transactions and DB2 plans. In essence, it defines the working environment for CICS/DB2 applications. Keep in mind, though, that it will soon be obsolete and replaced by the RDO as you move to later versions of CICS.<A NAME="ch18index321"></A><A NAME="ch18index322"></A><A NAME="ch18index323"></A></P>
<P class="docText">Each CICS region can have only one RCT active at any time. Typically, the CICS or DB2 systems programmer handles RCT changes, but application programmers, systems analysts, and DBAs should understand what is contained in the RCT. A sample RCT is shown in <A class="docLink" HREF="#ch18list02">Listing 18.2</A>.</P>
<A NAME="ch18list02"></A><H5 class="docExampleTitle">Listing 18.2. A Sample Resource Control Table (RCT)</H5><A NAME="ch18index324"></A><A NAME="ch18index325"></A><A NAME="ch18index326"></A><A NAME="ch18index327"></A>

<PRE>
*
*    DEFINE DEFAULTS IN INIT, A COMMAND MACRO, AND A POOL MACRO
*
     DSNCRCT TYPE=INIT,SUBID=DB2T,SUFFIX=1,SIGNID=XXXXXX,           X
            THRDMAX=22,TOKENI=YES

     DSNCRCT TYPE=COMD,THRDM=2,THRDA=1,THRDS=1,TWAIT=POOL

     DSNCRCT TYPE=POOL,THRDM=4,THRDA=4,PLAN=POOLPLAN
*
*    DEFINE AN ENTRY MACRO FOR PROTECTED THREADS
*
     DSNCRCT TYPE=ENTRY,TXID=TXN1,THRDM=4,THRDA=2,                  X
            THRDS=2,PLAN=TXN1PLAN,TWAIT=YES,AUTH=(TXID,*,*)
*
*    DEFINE AN ENTRY MACRO FOR HIGH-PRIORITY UNPROTECTED THREADS
*
     DSNCRCT TYPE=ENTRY,TXID=(TXN2,TXN3),THRDM=2,THRDA=2,           X
            THRDS=0,PLAN=MULTPLAN,TWAIT=POOL,AUTH=(TXID,*,*)
*
*    DEFINE AN ENTRY MACRO FOR LOW-PRIORITY UNPROTECTED THREADS
*
     DSNCRCT TYPE=ENTRY,TXID=TXN4,THRDM=1,THRDA=0,                  X
            THRDS=0,PLAN=TXN4PLAN,TWAIT=POOL,AUTH=(TXID,*,*)
*
*    DEFINE AN ENTRY MACRO FOR A MENUING SYSTEM BOUND TO A
*           SINGLE, LARGE PLAN
*
     DSNCRCT TYPE=ENTRY,TXID=(MENU,OPT1,OPT2,OPT3,OPT4),            X
            THRDM=4,THRDA=4,THRDS=3,PLAN=APPLPLAN,                  X
            TWAIT=POOL,AUTH=(SIGNID,*,*)
*
*    DEFINE AN ENTRY MACRO THAT WILL ABEND IF NO THREADS
*           ARE AVAILABLE (TWAIT=NO)
*
     DSNCRCT TYPE=ENTRY,TXID=SAMP,THRDM=1,THRDA=1,THRDS=1,          X
            PLAN=SAMPPLAN,TWAIT=NO,AUTH=(TXID,*,*)
*
*    DEFINE AN ENTRY THREAD FOR DYNAMIC PLAN SELECTION
*
     DSNCRCT TYPE=ENTRY,TXID=TXNS,THRDM=1,THRDA=1,                  X
            PLNEXIT=YES,PLNPGME=DSNCUEXT,AUTH=(CONSTANT,*,*)

     DSNCRCT TYPE=FINAL

     END<A NAME="ch18index328"></A><A NAME="ch18index329"></A><A NAME="ch18index330"></A><A NAME="ch18index331"></A>
</PRE><BR>

<P class="docText">You can code five types of entries, known as macros, in the RCT. Each macro defines a portion of the CICS-DB2 attachment. The valid RCT <TT>TYPE</TT> entries follow:</P>
<P><TABLE CELLSPACING="0" FRAME="void" RULES="none" CELLPADDING="5"><COLGROUP><COL width="77"><COL width="473"></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the basic parameters affecting the attachment of DB2 to CICS and the setup of defaults for threads</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COMD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the setup parameters for <TT>DSNC</TT> commands</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ENTRY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the dedicated threads</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>POOL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the parameters for defining pool threads</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>FINAL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies that no more RCT entries follow</P></TD></TR></TABLE></P><br>
<P class="docText">Consult <A class="docLink" HREF="#ch18table02">Tables 18.2</A> through <A class="docLink" HREF="#ch18table06">18.6</A> for the parameters that you can code for the RCT <TT>INIT</TT>, <TT>COMD</TT>, <TT>POOL</TT>, and <TT>ENTRY</TT> types of macros. No parameters are specified for the RCT <TT>FINAL</TT> macro.</P>
<A NAME="ch18table02"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 18.2. RCT <TT>INIT</TT> Macro Parameters</h5></CAPTION><COLGROUP><COL width="137.5"><COL width="137.5"><COL width="137.5"><COL width="137.5"></COLGROUP><THEAD><TR><TH class="thead" align="left" valign="top" colspan="4"><P class="docText"><span class="docEmphStrong">RCT</span> <TT>INIT</TT> <span class="docEmphStrong">Macro Parameters</span></P></TH></TR><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Parameter</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Default</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Valid Values</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Description</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DPMODI</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HIGH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HIGH</TT>, <TT>EQ</TT>, <TT>LOW</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the default for the <TT>DPMODE</TT> parameter if it is not coded on subsequent <TT>ENTRY</TT> and <TT>POOL</TT> macros.<A NAME="ch18index336"></A><A NAME="ch18index337"></A><A NAME="ch18index338"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">ERRDEST</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">(CSMT,*,*)</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Valid transient</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies destinations data destinations for unsolicited messages.<A NAME="ch18index339"></A><A NAME="ch18index340"></A><A NAME="ch18index341"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PCTEROP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AEY9</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AEY9</TT>, <TT>N906</TT>, <TT>N906D</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the type of processing to occur following a create thread error.<A NAME="ch18index342"></A><A NAME="ch18index343"></A><A NAME="ch18index344"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLANI</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Entry <TT>PLAN</TT> or <TT>TXID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">plan name</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the default name of any plan not using dynamic plan selection. If not specified, the plan name must be specified in each subsequent RCT <TT>ENTRY</TT> macro; otherwise, it will default to the transaction ID.<A NAME="ch18index345"></A><A NAME="ch18index346"></A><A NAME="ch18index347"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLNPGMI</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNCUEXT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">- - -</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the default value for the <TT>PLNPGME</TT> parameter if it is not coded on subsequent <TT>ENTRY</TT> and <TT>POOL</TT> macros for transactions using the dynamic plan selection.<A NAME="ch18index348"></A><A NAME="ch18index349"></A><A NAME="ch18index350"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLNXTR1</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>193</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>1</TT> to <TT>200</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the trace ID for the dynamic plan entry.<A NAME="ch18index351"></A><A NAME="ch18index352"></A><A NAME="ch18index353"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLNXTR2</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>194</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>1</TT> to <TT>200</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the trace ID for the dynamic plan exit.<A NAME="ch18index354"></A><A NAME="ch18index355"></A><A NAME="ch18index356"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PURGEC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>(0,30)</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>(0,30)</TT> thru <TT>(59,59)</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the purge cycle for a protected thread. The first value indicates minutes; the second indicates seconds.<A NAME="ch18index357"></A><A NAME="ch18index358"></A><A NAME="ch18index359"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ROLBI</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the default value for the <TT>ROLBE</TT> parameter if it is not coded on subsequent <TT>ENTRY</TT> and <TT>POOL</TT> macros.<A NAME="ch18index360"></A><A NAME="ch18index361"></A><A NAME="ch18index362"></A><A NAME="ch18index363"></A><A NAME="ch18index364"></A><A NAME="ch18index365"></A><A NAME="ch18index366"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SHDDEST</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CSSL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Valid transient</span> destination <span class="docEmphasis">data</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies a <span class="docEmphasis">destinations</span> for the statistical report during CICS shutdown.<A NAME="ch18index367"></A><A NAME="ch18index368"></A><A NAME="ch18index369"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SIGNID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">application name of CICS subsystem</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">8-character string</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the authorization ID used by the CICS Attach Facility when signing on to DB2.<A NAME="ch18index370"></A><A NAME="ch18index371"></A><A NAME="ch18index372"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SNAP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>A</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Valid</span> <TT>SYSOUT </TT><span class="docEmphasis">classes</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the <TT>SYSOUT</TT> class to be used by the CICS Attach Facility for snap dumps.<A NAME="ch18index373"></A><A NAME="ch18index374"></A><A NAME="ch18index375"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STANDBY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ABEND</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ABEND</TT>, <TT>SQLCODE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Indicates how the CICS Attach Facility will respond to SQL requests when it is not connected to DB2. <TT>ABEND</TT> causes the attachment to disable the <TT>TRUE</TT> when in stand by mode (usually results in <TT>AEY9</TT> abends); <TT>SQLCODE</TT> causes a <TT>–923</TT> or <TT>–924 SQLCODE</TT> to be issued instead of an <TT>ABEND</TT>.<A NAME="ch18index376"></A><A NAME="ch18index377"></A><A NAME="ch18index378"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STRTWT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT>, <TT>AUTO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies action to be taken by the CICS Attach Facility during startup if DB2 is not operational. <TT>YES</TT> directs the CICS Attach Facility to wait for DB2 to come up and then attach. <TT>NO</TT> indicates that the CICS Attach Facility startup will fail. <TT>AUTO</TT> indicates that the CICS Attach Facility will be automatically restarted when DB2 is stopped and started.<A NAME="ch18index379"></A><A NAME="ch18index380"></A><A NAME="ch18index381"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SUBID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">4-character DB2 ID</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the DB2 subsystem to which this RCT will be attached.<A NAME="ch18index382"></A><A NAME="ch18index383"></A><A NAME="ch18index384"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SUFFIX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>0</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">1 byte</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies an identifier for the RCT. It is the identifier <span class="docEmphasis"><TT>x</TT></span>, as supplied in the <TT>DSNC STRT </TT><span class="docEmphasis"><TT>x</TT></span> command.<A NAME="ch18index385"></A><A NAME="ch18index386"></A><A NAME="ch18index387"></A><A NAME="ch18index388"></A><A NAME="ch18index389"></A><A NAME="ch18index390"></A><A NAME="ch18index391"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDMAX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>12</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Any integer</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the <span class="docEmphasis">greater than 4</span> absolute maximum number of threads that can be created by this Attach Facility.<A NAME="ch18index392"></A><A NAME="ch18index393"></A><A NAME="ch18index394"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TRACEID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>192</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Any valid CICS trace ID</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies a userid to be used by the CICS Attach Facility to be used for tracing.<A NAME="ch18index395"></A><A NAME="ch18index396"></A><A NAME="ch18index397"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TWAITI</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT>, <TT>POOL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the default for the <TT>TWAIT</TT> parameter if it is not coded on subsequent <TT>ENTRY</TT> and <TT>POOL</TT> macros.<A NAME="ch18index398"></A><A NAME="ch18index399"></A><A NAME="ch18index400"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TOKENI</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the default for the <TT>TOKENE</TT> parameter if it is not coded on a subsequent <TT>ENTRY</TT> macro.<A NAME="ch18index401"></A><A NAME="ch18index402"></A><A NAME="ch18index403"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TXIDSO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies whether sign-ons are to be suppressed during thread reuse for pool threads and threads with multiple <TT>TXID</TT>s.<A NAME="ch18index404"></A><A NAME="ch18index405"></A><A NAME="ch18index406"></A><A NAME="ch18index407"></A><A NAME="ch18index408"></A><A NAME="ch18index409"></A><A NAME="ch18index410"></A></P></TD></TR></TABLE></P><br>
<A NAME="ch18note04"></A><div class="docNote"><p class="docNoteTitle">NOTE</p>

<P class="docText">The <TT>STANDBY</TT> option and the <TT>AUTO</TT> parameter of the <TT>STARTWT</TT> option are available as of CICS Transaction Server V1.1. You must specify <TT>STARTWT=AUTO</TT> to specify <TT>STANDBY=SQLCODE</TT>.</P></div><br>
<A NAME="ch18table03"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 18.3. RCT <TT>COMD</TT> Macro Parameters</h5></CAPTION><COLGROUP><COL width="88.88888888888889"><COL width="66.66666666666666"><COL width="166.66666666666666"><COL width="227.77777777777777"></COLGROUP><THEAD><TR><TH class="thead" align="left" valign="top" colspan="4"><P class="docText"><span class="docEmphStrong">RCT</span> <TT>COMD</TT> <span class="docEmphStrong">Macro Parameters</span></P></TH></TR><TR><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Parameter</span></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Default Value</span></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Valid Values</span></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Description</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AUTH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>(USER,TERM,TXID)</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Character string</span>, <TT>GROUP</TT>, <TT>SIGNID</TT>, <TT>TERM</TT>, <TT>TXID</TT>, <TT>USER</TT>, <TT>USERID</TT>, <TT>* AUTH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the authorization scheme to be used for the given transaction. As many as three values can be specified. The attachment facility tries to use them in the order specified from left to right. For the default values, it first tries to use the CICS sign-on ID, and then the CICS transaction ID. For a description of each <TT>AUTH</TT> value, see <A class="docLink" HREF="#ch18table06">Table 18.6</A>.<A NAME="ch18index415"></A><A NAME="ch18index416"></A><A NAME="ch18index417"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ROLBE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the action to be taken if this transaction will be the victim in the resolution of a deadlock. If <TT>YES</TT> is coded, a CICS <TT>SYNCPOINT ROLLBACK</TT> is issued and a <TT>-911 SQLCODE</TT> is returned to the program. If <TT>NO</TT> is coded, a CICS <TT>SYNCPOINT ROLLBACK</TT> is not issued and the <TT>SQLCODE</TT> is set to <TT>-913</TT>.<A NAME="ch18index418"></A><A NAME="ch18index419"></A><A NAME="ch18index420"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>1</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Positive integer or zero</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the maximum number of threads that can be connected for the transaction, group of transactions, or pool. When the limit is reached, action is taken according to the values coded in the <TT>TWAIT</TT> parameter.<A NAME="ch18index421"></A><A NAME="ch18index422"></A><A NAME="ch18index423"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>1</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Positive integer or zero</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the absolute maximum number of threads that can ever be connected for the transaction, group of transactions, or the pool. This number must be equal to or greater than the value of <TT>THRDA</TT>. If it is greater than <TT>THRDA</TT>, you can issue the <TT>DSNC MODIFY TRANSACTION</TT> command to change the value of <TT>THRDA</TT> to a greater value but not a value greater than <TT>THRDM</TT>.<A NAME="ch18index424"></A><A NAME="ch18index425"></A><A NAME="ch18index426"></A><A NAME="ch18index427"></A><A NAME="ch18index428"></A><A NAME="ch18index429"></A><A NAME="ch18index430"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>1</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Positive integer or zero</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the number of protected threads. The value cannot exceed <TT>THRDA</TT> or <TT>99</TT>, whichever is greater.<A NAME="ch18index431"></A><A NAME="ch18index432"></A><A NAME="ch18index433"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TWAIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT>, <TT>POOL</TT>*</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the action to be taken when a thread is required but the limit (<TT>THRDA</TT>) has been reached. <TT>YES</TT> indicates that the transaction should wait until a thread is available. <TT>NO</TT> causes the transaction to abend. <TT>POOL</TT> diverts the transaction to the pool, causing a pool thread to be used.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TXID</TT><A NAME="ch18index434"></A><A NAME="ch18index435"></A><A NAME="ch18index436"></A></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the transaction ID for DB2 command threads. It should always be set to <TT>DSNC</TT>.<A NAME="ch18index437"></A><A NAME="ch18index438"></A><A NAME="ch18index439"></A><A NAME="ch18index440"></A></P></TD></TR></TABLE></P><br>
<A NAME="ch18table04"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 18.4. RCT <TT>ENTRY</TT> Macro Parameters</h5></CAPTION><COLGROUP><COL width="81.68316831683168"><COL width="136.13861386138615"><COL width="136.13861386138615"><COL width="196.03960396039605"></COLGROUP><THEAD><TR><TH class="thead" align="left" valign="top" colspan="4"><P class="docText"><span class="docEmphStrong">RCT</span> <TT>ENTRY</TT> <span class="docEmphStrong">Macro Parameters</span></P></TH></TR><TR><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Parameter</span></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Default Value</span></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText">Valid Values</P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText">Description</P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AUTH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>(USER,TERM,TXID)</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Character string</span>, <TT>SIGNID</TT>, <TT>TERM</TT>,<TT>USERID</TT>, <TT>*</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the <TT>GROUP</TT> authorization scheme to be used for the given transaction. You can specify as many as three values. The attachment facility tries to use them in the order specified from left to right. For the default values, it tries to use first the CICS sign-on ID, and then the CICS terminal ID, and then the CICS transaction ID. For a description of each <TT>AUTH</TT> value, see <A class="docLink" HREF="#ch18table06">Table 18.6</A>.<A NAME="ch18index445"></A><A NAME="ch18index446"></A><A NAME="ch18index447"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DPMODE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HIGH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HIGH</TT>, <TT>EQ</TT>, <TT>LOW</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the dispatching priority limit that can be assigned to the task. This limit overrides the <TT>DPMODI</TT> parameter if it was coded on the <TT>INIT</TT> macro.<A NAME="ch18index448"></A><A NAME="ch18index449"></A><A NAME="ch18index450"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLAN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TXID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Plan name</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the name of the plan to use for the transaction or transactions being defined. If it is not specified, the plan name defaults to the transaction ID.<A NAME="ch18index451"></A><A NAME="ch18index452"></A><A NAME="ch18index453"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLNEXIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Indicates whether the dynamic plan selection will be used.<A NAME="ch18index454"></A><A NAME="ch18index455"></A><A NAME="ch18index456"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLNPGME</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNCUEXT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Program name</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the name of the exit program used to assign a plan name when the dynamic plan selection is used. This name overrides the <TT>PLNPGMI</TT> parameter if it was coded on the <TT>INIT</TT> macro.<A NAME="ch18index457"></A><A NAME="ch18index458"></A><A NAME="ch18index459"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ROLBE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the action to be taken if this transaction will be the victim in the resolution of a deadlock. If <TT>YES</TT> is coded, a CICS <TT>SYNCPOINT ROLLBACK</TT> is issued and a <TT>-911 SQLCODE</TT> is returned to the program. If <TT>NO</TT> is coded, a CICS <TT>SYNCPOINT ROLLBACK</TT> is not issued and the <TT>SQLCODE</TT> is set to <TT>-913</TT>.<A NAME="ch18index460"></A><A NAME="ch18index461"></A><A NAME="ch18index462"></A><A NAME="ch18index463"></A><A NAME="ch18index464"></A><A NAME="ch18index465"></A><A NAME="ch18index466"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TASKREQ</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">- - -</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PA1-PA3</TT>,</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">This parameter is <TT>PF1-PF24</TT>, used when a <TT>OPID</TT>, <TT>LPA</TT>, transaction will be <TT>MSRE</TT> started by a <TT>3270</TT> function key.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>0</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Positive integer or zero</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the maximum number of threads that can be connected for the transaction, group of transactions, or pool. When the limit is reached, action is taken according to the values coded in the <TT>TWAIT</TT> parameter.<A NAME="ch18index467"></A><A NAME="ch18index468"></A><A NAME="ch18index469"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>0</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Positive integer or zero</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the absolute maximum number of threads that can ever be connected for the transaction, group of transactions, or the pool. This number must be equal to or greater than the value of <TT>THRDA</TT>. If it is greater than <TT>THRDA</TT>, you can issue the <TT>DSNC MODIFY TRANSACTION</TT> command to change the value of <TT>THRDA</TT> to a greater value but not a value greater than <TT>THRDM</TT>.<A NAME="ch18index470"></A><A NAME="ch18index471"></A><A NAME="ch18index472"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>0</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Positive integer or zero</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the number of protected threads. The value cannot exceed <TT>THRDA</TT> or <TT>99</TT>, whichever is greater.<A NAME="ch18index473"></A><A NAME="ch18index474"></A><A NAME="ch18index475"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TWAIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT>, <TT>POOL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the action to be taken when a thread is required but the limit (<TT>THRDA</TT>) has been reached. <TT>YES</TT> indicates that the transaction should wait until a thread is available. <TT>NO</TT> causes the transaction to abend. <TT>POOL</TT> diverts the transaction to the pool, causing a pool thread to be used.<A NAME="ch18index476"></A><A NAME="ch18index477"></A><A NAME="ch18index478"></A><A NAME="ch18index479"></A><A NAME="ch18index480"></A><A NAME="ch18index481"></A><A NAME="ch18index482"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TOKENE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NO</TT>, <TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies whether the CICS attachment facility will produce an accounting trace record for every transaction.<A NAME="ch18index483"></A><A NAME="ch18index484"></A><A NAME="ch18index485"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TXID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">- - -</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Transaction ID or list of transaction IDs</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the transaction for this entry.<A NAME="ch18index486"></A><A NAME="ch18index487"></A><A NAME="ch18index488"></A><A NAME="ch18index489"></A><A NAME="ch18index490"></A><A NAME="ch18index491"></A><A NAME="ch18index492"></A></P></TD></TR></TABLE></P><br>
<A NAME="ch18table05"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 18.5. RCT <TT>POOL</TT> Macro Parameters</h5></CAPTION><COLGROUP><COL width="77"><COL width="137.5"><COL width="143"><COL width="192.5"></COLGROUP><THEAD><TR><TH class="thead" align="left" valign="top" colspan="4"><P class="docText"><span class="docEmphStrong">RCT</span> <TT>POOL</TT> <span class="docEmphStrong">Macro Parameters</span><A NAME="ch18index493"></A><A NAME="ch18index494"></A><A NAME="ch18index495"></A><A NAME="ch18index496"></A></P></TH></TR><TR><TH class="rightBorder bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Parameter</span></P></TH><TH class="rightBorder bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Default Value</span></P></TH><TH class="rightBorder bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Valid Values</span></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Description</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AUTH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>(USER,TERM,TXID)</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Character string</span>,<TT>GROUP</TT>,<TT>SIGNID</TT>, <TT>TERM</TT>,<TT>TXID</TT>, <TT>USER</TT>,<TT>USERID</TT>, <TT>*AUTH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the authorization scheme to be used for the given transaction. You can specify as many as three values. The attachment facility tries to use them in the order specified from left to right. For the default values, it tries to use first the CICS sign-on ID, the CICS terminal ID, and then the CICS transaction ID. For a description of each value, see <A class="docLink" HREF="#ch18table06">Table 18.6</A>.<A NAME="ch18index497"></A><A NAME="ch18index498"></A><A NAME="ch18index499"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DPMODE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HIGH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HIGH</TT>, <TT>EQ</TT>, <TT>LOW</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the dispatching priority limit that can be assigned to the task. This limit overrides the <TT>DPMODI</TT> parameter if it was coded on the <TT>INIT</TT> macro.<A NAME="ch18index500"></A><A NAME="ch18index501"></A><A NAME="ch18index502"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLAN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DEFAULT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Plan name</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the name of the plan to use for the transaction or transactions being defined. If it is not specified, the plan name defaults to the character string <TT>DEFAULT</TT>.<A NAME="ch18index503"></A><A NAME="ch18index504"></A><A NAME="ch18index505"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLNEXIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Indicates whether the dynamic plan selection will be used.<A NAME="ch18index506"></A><A NAME="ch18index507"></A><A NAME="ch18index508"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLNPGME</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DSNCUEXT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Program name</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the name of the exit program used to assign a plan name when the dynamic plan selection is used. This name overrides the <TT>PLNPGMI</TT> parameter if it was coded on the <TT>INIT</TT> macro.<A NAME="ch18index509"></A><A NAME="ch18index510"></A><A NAME="ch18index511"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ROLBE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the action to be taken if this transaction will be the victim in the resolution of a deadlock. If <TT>YES</TT> is coded, a CICS <TT>SYNCPOINT ROLLBACK</TT> is issued and a <TT>-911 SQLCODE</TT> is returned to the program. If <TT>NO</TT> is coded, a CICS <TT>SYNCPOINT ROLLBACK</TT> is not issued and the <TT>SQLCODE</TT> is set to <TT>-913</TT>.<A NAME="ch18index512"></A><A NAME="ch18index513"></A><A NAME="ch18index514"></A><A NAME="ch18index515"></A><A NAME="ch18index516"></A><A NAME="ch18index517"></A><A NAME="ch18index518"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TASKREQ</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">- - -</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PA1-PA3</TT>,<TT>PF1-PF24</TT>,<TT>OPID</TT>, <TT>LPA</TT>,<TT>MSRE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">This parameter is used when a transaction will be started by a <TT>3270</TT> function key.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>3</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Positive integer or zero</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the maximum number of threads that can be connected for the transaction, group of transactions, or pool. When the limit is reached, action is taken according to the values coded in the <TT>TWAIT</TT> parameter.<A NAME="ch18index519"></A><A NAME="ch18index520"></A><A NAME="ch18index521"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>3</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Positive integer or zero</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Defines the absolute maximum number of threads that can ever be connected for the transaction, group of transactions, or the pool. This number must be the value of <TT>THRDA</TT>. If it is greater than <TT>THRDA</TT>, you can issue the <TT>DSNC MODIFY TRANSACTION</TT> command to change the value of <TT>THRDA</TT> to a greater value but not a value greater than <TT>THRDM</TT>.<A NAME="ch18index522"></A><A NAME="ch18index523"></A><A NAME="ch18index524"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>0</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Positive integer or zero</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the number of protected threads. The value cannot exceed <TT>THRDA</TT> or <TT>99</TT>, whichever is greater.<A NAME="ch18index525"></A><A NAME="ch18index526"></A><A NAME="ch18index527"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TWAIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>YES</TT>, <TT>NO</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the action to be taken when a thread is required but the limit (<TT>THRDA</TT>) has been reached. <TT>YES</TT> indicates that the transaction should wait until a thread is available. <TT>NO</TT> causes the transaction to abend.<A NAME="ch18index528"></A><A NAME="ch18index529"></A><A NAME="ch18index530"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TXID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>POOL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Transaction ID or list of transaction IDs</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies the transaction for this entry.</P></TD></TR></TABLE></P><br>
<A NAME="ch18table06"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 18.6. RCT <TT>AUTH</TT> Values</h5></CAPTION><COLGROUP><COL width="137.5"><COL width="412.5"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>AUTH</TT> <span class="docEmphStrong">Value</span></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><span class="docEmphStrong">Description</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><span class="docEmphasis">Character string</span></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The character string specified is used for the authorization ID.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GROUP</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The RACF group ID is used for the authorization ID.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SIGNID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The <TT>SIGNID</TT> specified in the <TT>INIT</TT> RCT macro is used for the authorization ID.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TERM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The CICS terminal ID is used for the authorization ID.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TXID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The CICS transaction ID is used for the authorization ID.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>USER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The CICS sign-on ID is used for the authorization ID.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>USERID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">This value is similar to the <TT>USER</TT> option but can be extended using <TT>DSN3@SGN</TT> to work with RACF to send a secondary authid.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>*</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Null. You can specify this value only for the second and third values. It Indicates that no additional authorization scheme will be used.</P></TD></TR></TABLE></P><br>
<A NAME="ch18lev2sec16"></A><H4 class="docSection2Title">RDO Parameters</H4>
<P class="docText">When using RDO there are similar parameters for defining transactions as in the RCT. However, as the name implies, RDO (or Resource Definition Online) parameters are set using an online interface.<A NAME="ch18index534"></A><A NAME="ch18index535"></A><A NAME="ch18index536"></A></P>
<P class="docText">RDO uses three sets of parameters to define the DB2-CICS connection. These parameters are grouped into the following definitions:</P>
<UL><LI><P class="docList"><TT>DB2CONN</TT></P></LI><LI><P class="docList"><TT>DB2ENTRY</TT></P></LI><LI><P class="docList"><TT>DB2TRAN</TT></P></LI></UL>
<A NAME="ch18lev3sec15"></A><H5 class="docSection3Title"><TT>DB2CONN</TT></H5>
<P class="docText">The first set of parameters to understand is used to define the global attributes of the DB2-CICS connection, as well as the attributes of pool threads and command threads. These parameters are referred to as the <TT>DB2CONN</TT> definitions.<A NAME="ch18index537"></A><A NAME="ch18index538"></A><A NAME="ch18index539"></A><A NAME="ch18index540"></A></P>
<P class="docText">Only one <TT>DB2CONN</TT> can be installed in a CICS system at any one time. If you attempt to install a second <TT>DB2CONN</TT>, the existing <TT>DB2CONN</TT> will be discarded along with its associated <TT>DB2ENTRY</TT> and <TT>DB2TRAN</TT> definitions. The <TT>DB2CONN</TT> must be installed before any <TT>DB2ENTRY</TT> or <TT>DB2TRAN</TT> definitions can be set up.</P>
<P class="docText">A definition of each of the <TT>DB2CONN</TT> parameters follows. The definitions are broken up into three sections because DB2CONN is used to defined connection attributes, pool thread attributes, and command thread attributes.</P>
<A NAME="ch18lev4sec9"></A><H5 class="docSection4Title">Connection Attributes</H5>
<P class="docText">The following <TT>DB2CONN</TT> parameters are used to define basic DB2-CICS connection attributes:<A NAME="ch18index541"></A><A NAME="ch18index542"></A><A NAME="ch18index543"></A><A NAME="ch18index544"></A><A NAME="ch18index545"></A><A NAME="ch18index546"></A><A NAME="ch18index547"></A></P>
<BLOCKQUOTE><P><p class="docText"><span class="docEmphStrong"><TT>DB2CONN</TT></span>— 
Specifies a name of up to eight characters used to identify this <TT>DB2CONN</TT> definition.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>CONNECTERROR(SQLCODE | ABEND)</TT></span>— 
Indicates how the CICS Attach Facility responds to SQL requests when it is not connected to DB2. <TT>ABEND</TT> causes the attachment to return an <TT>AEY9</TT> abend; <TT>SQLCODE</TT> causes a <TT>–923 SQLCODE</TT> to be issued instead of an abend.<A NAME="ch18index548"></A><A NAME="ch18index549"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>DB2ID</TT></span>— 
The name of the DB2 subsystem to which the CICS-DB2 attachment facility is to connect.<A NAME="ch18index550"></A><A NAME="ch18index551"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>DESCRIPTION</TT></span>— 
Up to 58 characters describing the resource that is being defined.<A NAME="ch18index552"></A><A NAME="ch18index553"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>MSGQUEUE1</TT></span>— 
Specifies the first transient data destination to which unsolicited messages from the CICS-DB2 attachment facility are sent. The first destination cannot be blank.<A NAME="ch18index554"></A><A NAME="ch18index555"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>MSGQUEUE2</TT></span>— 
Specifies a second transient data destination.<A NAME="ch18index556"></A><A NAME="ch18index557"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>MSGQUEUE3</TT></span>— 
Specifies a third transient data destination.<A NAME="ch18index558"></A><A NAME="ch18index559"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>NONTERMREL(YES | NO)</TT></span>— 
Specifies whether or not a non-terminal transaction releases threads for reuse at intermediate syncpoints.<A NAME="ch18index560"></A><A NAME="ch18index561"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>PURGECYCLE(</TT></span><span class="docEmphBoldItalic"><TT>x,y</TT></span><span class="docEmphStrong"><TT>)S</TT></span>— 
Specifies the duration of the purge cycle for protected threads in minutes and seconds. The default is 0, 30; that is, 0 minutes and 30 seconds.<A NAME="ch18index562"></A><A NAME="ch18index563"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>SIGNID</TT></span>— 
Specifies the authorization ID to be used by the CICS-DB2 attachment facility when signing on to DB2 for pool and <TT>DB2ENTRY</TT> threads specified using <TT>AUTHTYPE(SIGN)</TT>.<A NAME="ch18index564"></A><A NAME="ch18index565"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>STANDBYMODE(RECONNECT | CONNECT | NOCONNECT)</TT></span>— 
Indicates that action the CICS-DB2 attachment facility will take if DB2 is not active CICS attempts to connect to DB2.<A NAME="ch18index566"></A><A NAME="ch18index567"></A></p></P><P><P class="docList">Specifying <TT>CONNECT</TT> causes the CICS-DB2 attachment facility to wait in standby mode for DB2 to become active. If the connection is made and then DB2 fails, the CICS-DB2 attachment facility terminates.</P></P><P><P class="docList">Specifying <TT>NOCONNECT</TT> causes the CICS DB2 attachment facility to terminate.</P></P><P><P class="docList">Specifying <TT>RECONNECT</TT> causes the CICS DB2 attachment facility to wait in standby mode for DB2 to become active. If DB2 subsequently fails after the connection is made, the CICS DB2 attachment facility reverts to standby mode again.</P></P><P><p class="docText"><span class="docEmphStrong"><TT>STATSQUEUE(CDB2 | name)</TT></span>— 
Specifies the transient data destination for CICS-DB2 attachment statistics that are produced when the attachment facility is shut down.<A NAME="ch18index568"></A><A NAME="ch18index569"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>THREADERROR(N906D | N906 | ABEND)</TT></span>— 
Specifies the processing that is to occur following a create thread error.<A NAME="ch18index570"></A><A NAME="ch18index571"></A></p></P><P><P class="docList">Specifying <TT>ABEND</TT> causes CICS to take a transaction dump for <TT>AD2S</TT>, <TT>AD2T</TT>, and <TT>AD2U</TT> errors. For the first error, no abend occurs; but an abend will occur for subsequent errors. The transaction must be terminated and reinitialized before another SQL request can succeed.</P></P><P><P class="docList">Specifying <TT>N906D</TT> indicates that CICS will take a transaction dump. The transaction receives a <TT>-906 SQLCODE</TT> if another SQL is issued, unless the transaction issues <TT>SYNCPOINT ROLLBACK</TT>.</P></P><P><P class="docList">Specifying <TT>N906</TT> indicates that CICS will not take a transaction dump. The transaction receives a <TT>-906 SQLCODE</TT> if another SQL is issued, unless the transaction issues <TT>SYNCPOINT ROLLBACK</TT>.</P></P><P><p class="docText"><span class="docEmphStrong"><TT>TCBLIMIT</TT></span>— 
Specifies the maximum number of subtask TCBs that can be attached by the CICS-DB2 attachment facility to process DB2 requests. The default is 12. The minimum number is 4 and the maximum is 2000.<A NAME="ch18index572"></A><A NAME="ch18index573"></A><A NAME="ch18index574"></A><A NAME="ch18index575"></A><A NAME="ch18index576"></A><A NAME="ch18index577"></A><A NAME="ch18index578"></A><A NAME="ch18index579"></A><A NAME="ch18index580"></A></p></P></BLOCKQUOTE>
<A NAME="ch18lev4sec10"></A><H5 class="docSection4Title">Pool Thread Attributes</H5>
<P class="docText">The following <TT>DB2CONN</TT> parameters are used to define pool thread attributes:<A NAME="ch18index581"></A><A NAME="ch18index582"></A><A NAME="ch18index583"></A><A NAME="ch18index584"></A><A NAME="ch18index585"></A><A NAME="ch18index586"></A><A NAME="ch18index587"></A></P>
<BLOCKQUOTE><P><p class="docText"><span class="docEmphStrong"><TT>ACCOUNTREC(NONE | TASK | TXID | UOW)</TT></span>— Specifies the minimum amount of DB2 accounting required for transactions using pool threads.<A NAME="ch18index588"></A><A NAME="ch18index589"></A></p></P><P><P class="docList">Specifying <TT>NONE</TT> indicates that no accounting records are required for transactions using pool threads. DB2 will produce at least one accounting record for each thread when the thread is terminated.</P></P><P><P class="docList">Specifying <TT>TASK</TT> indicates that a minimum of one accounting record for each CICS task will be produced. A transaction with multiple units-of-work (UOWs) may use a different thread for each of its UOWs. This can result in an accounting record being produced for each UOW.</P></P><P><P class="docList">Specifying <TT>TXID</TT> causes an accounting record to be produced when the transid using the thread changes. Once again, there is a chance that a transaction containing multiple UOWs will use a different thread for each UOW causing an accounting record to be produced per UOW.</P></P><P><P class="docList">Specifying <TT>UOW</TT> causes an accounting record to be produced for each UOW, assuming that the thread is released at the end of the UOW.</P></P><P><p class="docText"><span class="docEmphStrong"><TT>AUTHID</TT></span>— Specifies the ID that should be used for security checking when using pool threads.<A NAME="ch18index590"></A><A NAME="ch18index591"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>AUTHTYPE(USERID | OPID | GROUP | SIGN | TERM | TX)</TT></span>— Specifies the type of ID that can be used for pool threads.<A NAME="ch18index592"></A><A NAME="ch18index593"></A></p></P><P><P class="docList">Specifying <TT>USERID</TT> indicates that the 1 to 8-character <TT>USERID</TT> associated with the CICS transaction is used as the authorization ID.</P></P><P><P class="docList">Specifying <TT>OPID</TT> indicates that the operator identification associated with the user of the CICS transaction is used as the authorization ID.</P></P><P><P class="docList">Specifying <TT>GROUP</TT> indicates that the 1 to 8-character <TT>USERID</TT> and the connected group name is used as the authorization ID. To use the <TT>GROUP</TT> option, the CICS system must have <TT>SEC=YES</TT> specified in the CICS system initialization table (SIT).</P></P><P><P class="docList">Specifying <TT>SIGN</TT> indicates that the <TT>SIGNID</TT> parameter of the <TT>DB2CONN</TT> is used as the resource authorization ID.</P></P><P><P class="docList">Specifying <TT>TERM</TT> indicates that the terminal identification is used as the authorization ID.</P></P><P><P class="docList">Specifying <TT>TX</TT> indicates that the transaction identification is used as the authorization ID.</P></P><P><p class="docText"><span class="docEmphStrong"><TT>DROLLBACK(YES | NO)</TT></span>— Specifies whether or not the CICS DB2 attachment facility should initiate a <TT>SYNCPOINT ROLLBACK</TT> if a transaction is selected as the victim of a deadlock resolution.<A NAME="ch18index594"></A><A NAME="ch18index595"></A></p></P><P><P class="docList">Specifying <TT>YES</TT> indicates that the attachment facility will issue a <TT>SYNCPOINT ROLLBACK</TT> before returning control to the application. This causes a <TT>-911</TT> to be returned to the program.</P></P><P><P class="docList">Specifying <TT>NO</TT> indicates that the attachment facility will not issue a rollback for the transaction. This causes a <TT>-911</TT> to be returned to the program.</P></P><P><p class="docText"><span class="docEmphStrong"><TT>PLAN</TT></span>— Specifies the name of the plan to be used for pool threads.<A NAME="ch18index596"></A><A NAME="ch18index597"></A></p></P><P><P class="docList"><span class="docEmphStrong"><TT>PLANEXITNAME</TT></span>—Specifies the name of the dynamic plan exit to be used for pool threads. If <TT>PLANEXITNAME</TT> is specified, PLAN may not be specified (and vice versa). The default plan exit name is <TT>DSNCUEXT</TT>.<A NAME="ch18index598"></A><A NAME="ch18index599"></A></P></P><P><p class="docText"><span class="docEmphStrong"><TT>PRIORITY(HIGH | EQUAL | LOW)</TT></span>— Specifies the priority of the pool thread subtasks relative to the CICS main task.<A NAME="ch18index600"></A><A NAME="ch18index601"></A><A NAME="ch18index602"></A><A NAME="ch18index603"></A><A NAME="ch18index604"></A><A NAME="ch18index605"></A><A NAME="ch18index606"></A><A NAME="ch18index607"></A><A NAME="ch18index608"></A></p></P><P><P class="docList">Specifying <TT>HIGH</TT> indicates that subtasks will have a higher priority than the CICS main task.</P></P><P><P class="docList">Specifying <TT>EQUAL</TT> indicates that subtasks and the CICS main task will have equal priority.</P></P><P><P class="docList">Specifying <TT>LOW</TT> indicates that subtasks will have a lower priority than the CICS main task.</P></P><P><p class="docText"><span class="docEmphStrong"><TT>THREADLIMIT</TT></span>— Specifies the maximum number of pool threads that can be active before requests are forced to wait or are rejected (depending on the value of the <TT>THREADWAIT</TT> parameter). The default thread limit is 3, which is also the minimum; the maximum cannot exceed the value of <TT>TCBLIMIT</TT>.<A NAME="ch18index609"></A><A NAME="ch18index610"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>THREADWAIT(YES | NO)</TT></span>— Specifies whether or not transactions will wait for a pool thread or fail if the number of active pool threads reaches the <TT>THREADLIMIT</TT>.<A NAME="ch18index611"></A><A NAME="ch18index612"></A></p></P><P><P class="docList">Specifying <TT>YES</TT> causes a transaction to wait until a thread becomes available when all threads are busy.</P></P><P><P class="docList">Specifying <TT>NO</TT> causes the transaction to terminate with an error code of <TT>AD2T</TT> or <TT>AD3T</TT>.<A NAME="ch18index613"></A><A NAME="ch18index614"></A><A NAME="ch18index615"></A><A NAME="ch18index616"></A><A NAME="ch18index617"></A><A NAME="ch18index618"></A><A NAME="ch18index619"></A></P></P></BLOCKQUOTE>
<A NAME="ch18lev4sec11"></A><H5 class="docSection4Title">Command Thread Attributes</H5>
<P class="docText">The following <TT>DB2CONN</TT> parameters are used to define command thread attributes:<A NAME="ch18index620"></A><A NAME="ch18index621"></A><A NAME="ch18index622"></A><A NAME="ch18index623"></A><A NAME="ch18index624"></A><A NAME="ch18index625"></A><A NAME="ch18index626"></A></P>
<BLOCKQUOTE><P><p class="docText"><span class="docEmphStrong"><TT>COMAUTHID</TT></span>— Specifies the ID for the CICS-DB2 attachment facility to use for security checking when using command threads. If <TT>COMAUTHID</TT> is specified, <TT>COMAUTHTYPE</TT> may not be specified, and vice versa.<A NAME="ch18index627"></A><A NAME="ch18index628"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>COMAUTHTYPE(USERID | OPID | GROUP | SIGN | TERM | TX)</TT></span>— Specifies the type of ID to be used for security checking when using command threads.<A NAME="ch18index629"></A><A NAME="ch18index630"></A></p></P><P><P class="docList">Specifying <TT>USERID</TT> indicates that the 1 to 8-character <TT>USERID</TT> associated with the CICS transaction is used as the authorization ID.</P></P><P><P class="docList">Specifying <TT>OPID</TT> indicates that the operator identification associated with the user of the CICS transaction is used as the authorization ID.</P></P><P><P class="docList">Specifying <TT>GROUP</TT> indicates that the 1 to 8-character <TT>USERID</TT> and the connected group name is used as the authorization ID. To use the <TT>GROUP</TT> option, the CICS system must have <TT>SEC=YES</TT> specified in the CICS system initialization table (SIT).</P></P><P><P class="docList">Specifying <TT>SIGN</TT> indicates that the <TT>SIGNID</TT> parameter of the <TT>DB2CONN</TT> is used as the resource authorization ID.</P></P><P><P class="docList">Specifying <TT>TERM</TT> indicates that the terminal identification is used as the authorization ID.</P></P><P><P class="docList">Specifying <TT>TX</TT> indicates that the transaction identification is used as the authorization ID.</P></P><P><p class="docText"><span class="docEmphStrong"><TT>COMTHREADLIMIT</TT></span>— Specifies the maximum number of command threads that can be attached before requests overflow to the pool. The default is 1, but the value can range from 0 to 2000.<A NAME="ch18index631"></A><A NAME="ch18index632"></A><A NAME="ch18index633"></A><A NAME="ch18index634"></A><A NAME="ch18index635"></A><A NAME="ch18index636"></A><A NAME="ch18index637"></A><A NAME="ch18index638"></A><A NAME="ch18index639"></A></p></P></BLOCKQUOTE>
<A NAME="ch18lev3sec16"></A><H5 class="docSection3Title"><TT>DB2ENTRY</TT></H5>
<P class="docText">After defining a <TT>DB2CONN</TT>, you can then define <TT>DB2ENTRY</TT> definitions. A <TT>DB2ENTRY</TT> specification can apply to one specific transaction or a group of transactions using wildcard characters. And, as we will learn in the next section, additional transactions can be associated with a <TT>DB2ENTRY</TT> by defining <TT>DBTRAN</TT> specifications.<A NAME="ch18index640"></A><A NAME="ch18index641"></A><A NAME="ch18index642"></A><A NAME="ch18index643"></A></P>
<P class="docText">You can install a <TT>DB2ENTRY</TT> only if you have previously installed a <TT>DB2CONN</TT>.</P>
<P class="docText">A definition of each of the <TT>DB2ENTRY</TT> parameters follows. The definitions are broken up into two sections because <TT>DB2ENTRY</TT> is used to select threads and control thread operations.</P>
<A NAME="ch18lev4sec12"></A><H5 class="docSection4Title">Thread Selection Attributes</H5>
<P class="docText">The following <TT>DB2ENTRY</TT> parameters are used to define thread selection attributes:<A NAME="ch18index644"></A><A NAME="ch18index645"></A><A NAME="ch18index646"></A><A NAME="ch18index647"></A><A NAME="ch18index648"></A><A NAME="ch18index649"></A><A NAME="ch18index650"></A></P>
<BLOCKQUOTE><P><p class="docText"><span class="docEmphStrong"><TT>DB2ENTRY</TT></span>— 
Specifies a name of up to eight characters used to identify this <TT>DB2ENTRY</TT> definition.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>TRANSID</TT></span>— 
Specifies the transaction ID associated with the entry. Wildcards can be used to make this specification apply to multiple transactions. Additionally, more transactions can be defined for this entry by defining a <TT>DB2TRAN</TT> that refers to this <TT>DB2ENTRY</TT>. <TT>TRANSID</TT> is optional; if it is not specified all transactions are associated with a <TT>DB2ENTRY</TT> using <TT>DB2TRAN</TT> definitions instead.<A NAME="ch18index651"></A><A NAME="ch18index652"></A></p></P></BLOCKQUOTE>
<A NAME="ch18lev4sec13"></A><H5 class="docSection4Title">Thread Operation Attributes</H5>
<P class="docText">The following <TT>DB2ENTRY</TT> parameters are used to define thread operation attributes:<A NAME="ch18index653"></A><A NAME="ch18index654"></A><A NAME="ch18index655"></A><A NAME="ch18index656"></A><A NAME="ch18index657"></A><A NAME="ch18index658"></A><A NAME="ch18index659"></A></P>
<BLOCKQUOTE><P><p class="docText"><span class="docEmphStrong"><TT>ACCOUNTREC(NONE | TASK | TXID | UOW)</TT></span>— 
Specifies the minimum amount of DB2 accounting required for transactions using this <TT>DB2ENTRY</TT>.<A NAME="ch18index660"></A><A NAME="ch18index661"></A></p></P><P><P class="docList">Specifying <TT>NONE</TT> indicates that no accounting records are required for transactions using threads from this <TT>DB2ENTRY</TT>.</P></P><P><P class="docList">Specifying <TT>TASK</TT> indicates that a minimum of one accounting record for each CICS task is to be produced. A transaction containing multiple UOWs can use a different thread for each UOW, resulting in an accounting record being produced for each UOW.</P></P><P><P class="docList">Specifying <TT>TXID</TT> indicates that an accounting record is to be produced when the transaction ID using the thread changes. This option applies to <TT>DB2ENTRY</TT>s that are used by more than one transaction ID. A transaction with multiple UOWs can use a different thread for each UOW, resulting in an accounting record being produced for each UOW.</P></P><P><P class="docList">Specifying <TT>UOW</TT> indicates that an accounting is to be produced for each UOW (if the thread is released at the end of the UOW).</P></P><P><p class="docText"><span class="docEmphStrong"><TT>AUTHID</TT></span>— 
Specifies the ID to be used for security checking when using this <TT>DB2ENTRY</TT>. If <TT>AUTHID</TT> is specified, <TT>AUTHTYPE</TT> may not be specified, and vice versa.<A NAME="ch18index662"></A><A NAME="ch18index663"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>AUTHTYPE(USERID | OPID | GROUP | SIGN | TERM | TX)</TT></span>— 
Specifies the type of ID that can be used for threads on this <TT>DB2ENTRY</TT>. The options mean the same as those specified for <TT>AUTHTYPE</TT> on a <TT>DB2CONN</TT> specification as discussed in the previous section.<A NAME="ch18index664"></A><A NAME="ch18index665"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>DROLLBACK(YES | NO)</TT></span>— 
Specifies whether the CICS DB2 attachment should initiate a <TT>SYNCPOINT</TT> rollback in the event of a transaction being selected as victim of a deadlock resolution. The options mean the same as those specified for <TT>DROLLBACK</TT> on a <TT>DB2CONN</TT> specification as discussed in the previous section.<A NAME="ch18index666"></A><A NAME="ch18index667"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>PLAN</TT></span>— 
Specifies the name of the plan to be used for this entry. If <TT>PLAN</TT> is specified, <TT>PLANEXITNAME</TT> cannot be specified.<A NAME="ch18index668"></A><A NAME="ch18index669"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>PLANEXITNAME</TT></span>— 
Specifies the name of the dynamic plan exit to be used for this <TT>DB2ENTRY</TT>.<A NAME="ch18index670"></A><A NAME="ch18index671"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>PRIORITY(HIGH | MEDIUM | LOW)</TT></span>— 
Specifies the priority of the thread subtasks in this <TT>DB2ENTRY</TT> relative to the CICS main task.<A NAME="ch18index672"></A><A NAME="ch18index673"></A></p></P><P><P class="docList">Specifying <TT>HIGH</TT> indicates that subtasks will have a higher priority than the CICS main task.</P></P><P><P class="docList">Specifying <TT>EQUAL</TT> indicates that subtasks and the CICS main task will have equal priority.</P></P><P><P class="docList">Specifying <TT>LOW</TT> indicates that subtasks will have a lower priority than the CICS main task.</P></P><P><p class="docText"><span class="docEmphStrong"><TT>PROTECTNUM</TT></span>— 
Specifies the maximum number of protected threads allowed for this <TT>DB2ENTRY</TT>.<A NAME="ch18index674"></A><A NAME="ch18index675"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>THREADLIMIT</TT></span>— 
Specifies the maximum number of threads for this <TT>DB2ENTRY</TT> that can be active before requests are forced to overflow to the pool, wait, or be rejected (depending on the value of the <TT>THREADWAIT</TT> parameter).<A NAME="ch18index676"></A><A NAME="ch18index677"></A></p></P><P><p class="docText"><span class="docEmphStrong"><TT>THREADWAIT(POOL | YES | NO)</TT></span>— 
Specifies whether or not transactions should wait for a <TT>DB2ENTRY</TT> thread, terminate, or overflow to the pool when the number of active <TT>DB2ENTRY</TT> threads reach the <TT>THREADLIMIT</TT>.<A NAME="ch18index678"></A><A NAME="ch18index679"></A></p></P><P><P class="docList">Specifying <TT>POOL</TT> causes a transaction to use a thread from the pool if the maximum number of threads is reached and they are all busy. If the pool is also busy, and <TT>NO</TT> has been specified for the <TT>THREADWAIT</TT> parameter on the <TT>DB2CONN</TT>, the transaction is terminated with an <TT>AD3T</TT> error code.</P></P><P><P class="docList">Specifying <TT>YES</TT> causes a transaction to wait until a thread becomes available when all threads are busy.</P></P><P><P class="docList">Specifying <TT>NO</TT> causes the transaction to terminate with an error code of <TT>AD2P</TT> when all threads are busy.<A NAME="ch18index680"></A><A NAME="ch18index681"></A><A NAME="ch18index682"></A><A NAME="ch18index683"></A><A NAME="ch18index684"></A><A NAME="ch18index685"></A><A NAME="ch18index686"></A></P></P></BLOCKQUOTE>
<A NAME="ch18lev3sec17"></A><H5 class="docSection3Title"><TT>DB2TRAN</TT></H5>
<P class="docText">The final RDO category for defining DB2-CICS transactions is the <TT>DB2TRAN</TT>. A <TT>DB2TRAN</TT> resource definition defines additional transactions to be associated with a particular <TT>DB2ENTRY</TT> definition. You can use <TT>DB2TRAN</TT> to enable a <TT>DB2ENTRY</TT> to have an unrestricted number of transactions associated with it, including names using wildcard characters. Multiple <TT>DB2TRAN</TT> definitions can be associated with a single <TT>DB2ENTRY</TT> definition.<A NAME="ch18index687"></A><A NAME="ch18index688"></A><A NAME="ch18index689"></A><A NAME="ch18index690"></A></P>
<P class="docText">You can install a <TT>DB2TRAN</TT> only if you have previously installed a <TT>DB2ENTRY</TT>. A definition of each of the <TT>DB2TRAN</TT> parameters follows:</P>
<BLOCKQUOTE><P><p class="docText"><span class="docEmphStrong"><TT>DB2TRAN</TT></span>— 
Specifies a one to eight character name to identify this <TT>DB2TRAN</TT>.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>ENTRY</TT></span>— 
Specifies the name of the <TT>DB2ENTRY</TT> to which this <TT>DB2TRAN</TT> definition applies.</p></P><P><p class="docText"><span class="docEmphStrong"><TT>TRANSID</TT></span>— 
Specifies the transaction ID to be associated with the entry. If the <TT>TRANSID</TT> is not specified, it defaults to the first four characters of the <TT>DB2TRAN</TT> name. The following wildcard characters can be used:</p><BLOCKQUOTE><P><P class="docList">The asterisk (<TT>*</TT>) character can be used to indicate one or more characters.</P></P><P><P class="docList">The plus sign (<TT>+</TT>) can be used in any position to indicate any single character.<A NAME="ch18index691"></A><A NAME="ch18index692"></A><A NAME="ch18index693"></A><A NAME="ch18index694"></A></P></P></BLOCKQUOTE></P></BLOCKQUOTE>
<A NAME="ch18lev3sec18"></A><H5 class="docSection3Title">Comparing the RCT and RDO</H5>
<P class="docText">There are many similarities between the older RCT parameters and the newer RDO parameters. Before embarking on a mission to move from the RCT to RDO, take some time to examine the parameters in each method and note the differences and similarities. A quick comparison chart of the major parameters is provided in <A class="docLink" HREF="#ch18table07">Table 18.7</A>.<A NAME="ch18index695"></A><A NAME="ch18index696"></A><A NAME="ch18index697"></A><A NAME="ch18index698"></A></P>
<A NAME="ch18table07"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 18.7. RCT versus RDO: The Major Parameters</h5></CAPTION><COLGROUP><COL width="183.33333333333331"><COL width="183.33333333333331"><COL width="183.33333333333331"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">RCT Parameter</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">RDO Option</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Description</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TYPE=INIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2CONN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">To define connection limits and default values</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TYPE=COMD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2CONN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">To define DB2 command threads</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TYPE=POOL</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2CONN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">To define threads that are not associated with a specific transaction</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TYPE=ENTRY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DB2ENTRY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">To define threads that are associated with specific transaction(s)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TXID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TRANSID</TT> or <TT>DB2TRAN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Transaction(s) associated with entry threads</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLAN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PLAN</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">DB2 plan associated with transaction(s)</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AUTH</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>AUTHID</TT> or <TT>AUTHTYPE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Primary authid for a thread</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DPMODE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PRIORITY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Relative dispatching priority for the thread TCB</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THREADLIMIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Maximum number of threads for entry or pool</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PROTECTNUM</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Number of protected threads for entry</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TWAIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THREADWAIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Action to take when all threads for an entry are busy</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TOKENE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ACCOUNTREC</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies when a DB2 accounting record is to be cut</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ROLBE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DROLLBACK</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Controls whether a <TT>SYNCPOINT ROLLBACK</TT> is issued and whether <TT>–911</TT> or <TT>–913</TT> is issued.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SIGNID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SIGNID</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Authid used by the CICS attached for DB2 signon</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STANDBY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CONNECTERROR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Specifies error to return when DB2-CICS connection is down.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDMAX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TCBLIMIT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Maximum number of thread TCBs for the CICS region<A NAME="ch18index699"></A><A NAME="ch18index700"></A><A NAME="ch18index701"></A><A NAME="ch18index702"></A></P></TD></TR></TABLE></P><br>
<A NAME="ch18lev2sec17"></A><H4 class="docSection2Title">CICS-DB2 Connection Guidelines</H4>
<P class="docText">The following guidelines provide helpful advice for generating an efficient CICS-DB2 connection using the RCT or RDO. This section also offers guidance on using CICS commands and features with DB2.</P>
<A NAME="ch18lev4sec14"></A><H5 class="docSection3Title">Migrate RCTs to RDO</H5>
<P class="docText">If you are currently using the RCT to define your DB2-CICS connection, you will eventually have to migrate to using RDO. The RCT is being phased out and is no longer supported as of CICS/TS Version 1 Release 3. Fortunately, existing RCTs can be migrated easily to RDO resource definitions using the <TT>DFHCSDUP</TT> utility.<A NAME="ch18index703"></A><A NAME="ch18index704"></A><A NAME="ch18index705"></A></P>
<A NAME="ch18lev4sec15"></A><H5 class="docSection3Title">Use Caution Before Grouping Transactions</H5>
<P class="docText">Grouping a set of transaction identifiers together using wildcard characters can reduce the number of <TT>DB2ENTRY</TT> and <TT>DB2TRAN</TT> definitions you will need, but this diminishes your ability to collect statistics by transaction. CICS-DB2 resource statistics are collected for each <TT>DB2ENTRY</TT>. If you want separate CICS-DB2 statistics for a specific transaction, you need to give that transaction its own definition.<A NAME="ch18index706"></A><A NAME="ch18index707"></A><A NAME="ch18index708"></A></P>
<A NAME="ch18lev4sec16"></A><H5 class="docSection3Title">Specify DB2 Subsystem ID</H5>
<P class="docText">Which DB2 subsystem CICS connects to is controlled using the <TT>DB2ID</TT> parameter when using RDO. But this <TT>DB2ID</TT> can be overridden by specifying a DB2 subsystem on the <TT>DSNC STRT</TT> command, by a <TT>DB2ID</TT> specified on a <TT>SET DB2CONN</TT> command, or by a subsystem ID specified using <TT>INITPARM</TT>.<A NAME="ch18index709"></A><A NAME="ch18index710"></A><A NAME="ch18index711"></A></P>
<P class="docText">If you do not override the subsystem in any of these manners, the <TT>DB2ID</TT> value is used. If <TT>DB2ID</TT> is not specified the default value is blanks. This causes the connection to be attempted to the default DB2 subsystem identifier, which is <TT>DSN</TT>.</P>
<A NAME="ch18lev4sec17"></A><H5 class="docSection3Title">Allow for an Appropriate Number of CICS TCBs</H5>
<P class="docText">The <TT>THRDMAX</TT> (RCT) or <TT>TCBLIMIT</TT> (RDO) parameters are used to control the maximum number of subtask TCBs that can be attached by the CICS-DB2 attachment facility to process DB2 requests. Specify this value with care. A good rule of thumb is to set the parameter to the sum of all the thread limit values, up to a limit of 2,000. For the RCT, add up all the <TT>THRDA</TT> values and for the RDO add up all the <TT>THREADLIMIT</TT> values and the <TT>COMTHREADLIMIT</TT> value.<A NAME="ch18index712"></A><A NAME="ch18index713"></A></P>
<A NAME="ch18note05"></A><div class="docNote"><p class="docNoteTitle">CAUTION</p>

<P class="docText">If the sum of your thread limit values exceed the number of TCBs, it is possible that a task could acquire a thread and then find that there is no available TCB. This will cause the task to be suspended.</P>
<P class="docText">Also, when specifying a value for the maximum number of TCBs, be sure to take into account the value specified for the <TT>CTHREAD</TT> DSNZPARM system parameter. The maximum number of TCBs for the CICS-DB2 attach should not exceed the <TT>CTHREAD</TT> value.</P></div><br>
<A NAME="ch18lev4sec18"></A><H5 class="docSection3Title">Avoid <TT>AUTHID</TT> with RACF Authorization</H5>
<P class="docText">Do not use <TT>AUTHID</TT> if you are using RACF (or another external security product) for some or all of your DB2 security. This is because threads using an <TT>AUTHID</TT> do not pass the required RACF access control environment element to DB2.<A NAME="ch18index714"></A><A NAME="ch18index715"></A><A NAME="ch18index716"></A></P>
<P class="docText">Instead, use <TT>AUTHTYPE</TT> with the <TT>USERID</TT> or <TT>GROUP</TT> options.</P>
<A NAME="ch18lev4sec19"></A><H5 class="docSection3Title">Implement Security Without Sacrificing Performance</H5>
<P class="docText">While you're planning your security needs, keep performance in mind. If all security can be implemented with CICS transaction security, for each transaction specify <TT>AUTH=(TXID,*,*)</TT> in the RCT or use <TT>AUTHID</TT> for the RDO. In DB2, grant <TT>EXECUTE</TT> authority on the plan to the transaction name. This way, you can reduce the amount of authorization checking overhead.<A NAME="ch18index717"></A><A NAME="ch18index718"></A></P>
<A NAME="ch18lev4sec20"></A><H5 class="docSection3Title">Simplify Administration Using RDO Parameter Wildcarding</H5>
<P class="docText">Consider using the wildcarding capabilities of RDO when setting up your CICS-DB2 transactions. For example, examine the following RDO specification:<A NAME="ch18index719"></A><A NAME="ch18index720"></A><A NAME="ch18index721"></A></P>
<pre>

</pre><BR><pre>
TRANSID(TX*)
</pre><BR>
<P class="docText">This is equivalent to the following RCT specification:</P>
<pre>

</pre><BR><pre>
TXID=(TX01,TX02,TX03,TX04,TX05,TX06,TX07,TX08,TX09)
</pre><BR>
<P class="docText">Which one is easier to code? Of course, this approach is workable only if all of the transactions can be defined the same.</P>
<A NAME="ch18lev4sec21"></A><H5 class="docSection3Title">Consider Protected Threads for High Volume Transactions</H5>
<P class="docText">Protected threads can improve the performance of high-volume CICS-DB2 transactions because a new instance of a transaction might not have to wait for a thread to be created. Instead, it can reuse a previously allocated thread.<A NAME="ch18index722"></A><A NAME="ch18index723"></A><A NAME="ch18index724"></A><A NAME="ch18index725"></A></P>
<P class="docText">A protected thread is not terminated immediately when it is released. It is terminated only after two completed purge cycles, if it has not been reused in the meantime. Therefore, if the purge cycle is set to 30 seconds, a protected thread is purged 30 to 60 seconds after it is released. The first purge cycle after the attachment facility starts is always 5 minutes. After that the purge cycle values are applied as specified in the RDO parameters. The parameters for setting the purge cycle are <TT>PURGECYCLE</TT> (RDO) and <TT>PURGEC</TT> (RCT).</P>
<P class="docText">An unprotected thread is terminated when it is released (at a <TT>SYNCPOINT</TT> or at the end of the task) if there are no other transactions waiting for a thread on that <TT>DB2ENTRY</TT>. Only entry threads can be protected; pool and command threads cannot be protected.</P>
<P class="docText">You can control the number of protected threads using the <TT>PROTECTNUM</TT> parameter (RDS) or <TT>THRDS</TT> (RCT).</P>
<A NAME="ch18lev4sec22"></A><H5 class="docSection3Title">Explicitly Code a <TT>COMD</TT> Entry</H5>
<P class="docText">When using the RCT, be sure to explicitly code a <TT>COMD</TT> entry. A command thread is generated regardless of whether it is specified in the RCT. Coding a <TT>COMD</TT> macro for command threads rather than using defaults, however, is a good idea. This way, you can track and change the parameters for command threads more easily.<A NAME="ch18index726"></A><A NAME="ch18index727"></A><A NAME="ch18index728"></A></P>
<A NAME="ch18lev4sec23"></A><H5 class="docSection3Title">Ensure a Sufficient Number of Pool Threads</H5>
<P class="docText">Be sure to plan for an appropriate number of pool threads on the <TT>POOL</TT> entry (RCT) or using <TT>DB2CONN</TT> (RDO). The pool is used not only for threads defined as <TT>TYPE=POOL</TT>, but also for entry threads defined as <TT>TWAIT=POOL</TT>. Protected threads can also use the pool if no protected threads are available.<A NAME="ch18index729"></A><A NAME="ch18index730"></A><A NAME="ch18index731"></A></P>
<P class="docText">Use your knowledge of your transaction workflow to arrive at a reasonable number for the thread limit for pool threads. Attempt to determine the number of each of the following types of threads that will be running at one time, and use that number (plus a little buffer) for pool threads:</P>
<UL><LI><P class="docList">Explicitly defined pool threads (<TT>TYPE=POOL</TT>)</P></LI><LI><P class="docList">Overflow threads</P></LI></UL>
<A NAME="ch18lev4sec24"></A><H5 class="docSection3Title">Favor Overflowing Entry Threads to the Pool</H5>
<P class="docText">When you're coding the <TT>ENTRY</TT> macro (RCT), favor the use of <TT>TWAIT=POOL</TT> to avoid an excessive wait time or abends. For the RDO the same specification is accomplished by setting <TT>THREADWAIT</TT> to <TT>POOL</TT>.<A NAME="ch18index732"></A><A NAME="ch18index733"></A><A NAME="ch18index734"></A></P>
<P class="docText">Avoid specifying <TT>TWAIT=NO</TT> (RCT) or <TT>THREADWAIT(NO)</TT> (RDO) because it increases the number of abends.</P>
<A NAME="ch18lev4sec25"></A><H5 class="docSection3Title">Code <TT>THRDM</TT> Greater Than <TT>THRDA</TT></H5>
<P class="docText">When setting up the DB2-CICS attach using the RCT, code the <TT>THRDM</TT> parameter to be at least one greater than the <TT>THRDA</TT> parameter. This provides a buffer of at least one additional thread for tuning if additional entry threads are required.<A NAME="ch18index735"></A><A NAME="ch18index736"></A><A NAME="ch18index737"></A><A NAME="ch18index738"></A><A NAME="ch18index739"></A><A NAME="ch18index740"></A></P>
<A NAME="ch18lev4sec26"></A><H5 class="docSection3Title">Favor Rolling Back Automatically</H5>
<P class="docText">Use <TT>ROLBE=YES</TT> (RCT) or <TT>DROLLBACK(YES)</TT> (RDO) to roll back changes automatically in the event of a deadlock or timeout. Specifying <TT>NO</TT> to <TT>ROLBE</TT> or <TT>DROLLBACK</TT> places the onus on the application program to decide whether to back out changes. Specifying <TT>YES</TT> can reduce the amount of coding needed in CICS programs.<A NAME="ch18index741"></A><A NAME="ch18index742"></A></P>
<A NAME="ch18lev4sec27"></A><H5 class="docSection3Title">Favor Dispatching Priorities that are Equal or High</H5>
<P class="docText">Use <TT>DPMODE=HIGH</TT> (RCT) or <TT>PRIORITY(HIGH)</TT> (RDO) for only a few very high-priority transactions. Use <TT>DPMODE=EQ</TT> (RCT) or <TT>PRIORITY(EQUAL)</TT> (RDO) for most transactions.</P>
<P class="docText">Avoid <TT>DPMODE=LOW</TT> (RCT) and <TT>PRIORITY(LOW)</TT> (RDO) unless someone you hate will be using transactions assigned to those threads. You <span class="docEmphasis">might</span> also choose to specify a low <TT>DPMODE</TT> or <TT>PRIORITY</TT> for new transactions if your mainframe is very heavily utilized.</P>
<A NAME="ch18lev4sec28"></A><H5 class="docSection3Title">Matching CICS and DB2 Accounting Records</H5>
<P class="docText">To make it easier to manage the performance of CICS-DB2 applications, it is beneficial to match DB2 accounting records with CICS accounting records. To help match CICS and DB2 accounting records, specify <TT>ACCOUNTREC(UOW)</TT> or <TT>ACCOUNTREC(TASK)</TT> in the <TT>DB2ENTRY</TT> definition when using RDO. By specifying <TT>UOW</TT> or <TT>TASK</TT> for <TT>ACCOUNTREC</TT>, the CICS LU 6.2 token is included in the DB2 trace records (in field <TT>QWHCTOKN</TT> of the correlation header).<A NAME="ch18index743"></A><A NAME="ch18index744"></A><A NAME="ch18index745"></A></P>
<P class="docText">When using the RCT, accounting records are not cut when threads are reused, unless the <TT>TOKENE=YES</TT> parameter is coded on an <TT>ENTRY</TT> macro (or <TT>TOKENI=YES</TT> is coded on the <TT>INIT</TT> macro). Failure to specify <TT>TOKENE=YES</TT> might cause your performance monitor to report multiple transactions as a single transaction. DB2 checks the token and, when the token changes, DB2 creates a new trace record.</P>
<P class="docText">Specifying <TT>TOKENE=YES</TT> also causes the CICS attachment facility to pass the CICS LU6.2 token to the DB2 accounting trace record. This capability is important because CICS produces accounting records at the transaction level, whereas DB2 produces accounting records at the thread level. If you include the token in the accounting records, DB2 and CICS accounting records can be easily correlated. This token is contained in the DB2 trace correlation header field (<TT>IFCID 148</TT>).</P>
<A NAME="ch18lev4sec29"></A><H5 class="docSection3Title">Consider Coding Threads to Avoid <TT>AEY9</TT> Abends</H5>
<P class="docText">When using the RCT, code <TT>STARTWT=AUTO</TT> and <TT>STANDBY=SQLCODE</TT> to avoid the <TT>AEY9</TT> abend when the CICS attachment is not available. You must be using CICS Transaction Server V1.1 or later to specify these options.<A NAME="ch18index746"></A><A NAME="ch18index747"></A><A NAME="ch18index748"></A></P>
<P class="docText">Be sure to check for <TT>–923</TT> and <TT>–924 SQLCODEs</TT> in your application programs that use threads defined with <TT>STARTWT=AUTO</TT> and <TT>STANDBY=SQLCODE</TT>. A <TT>–923</TT> indicates that the CICS Attachment Facility is not up; a <TT>–924</TT> indicates that the DB2 error translator is not at a late enough level.</P>
<P class="docText">When using RDO, the <TT>CONNECTERROR</TT> parameter is used to control how the DB2-CICS attachment responds to SQL requests when it is not connected to DB2. Specifying <TT>CONNECTERROR(SQLCODE)</TT> causes a <TT>–923 SQLCODE</TT> to be issued instead of an <TT>AEY9</TT> abend.</P>
<A NAME="ch18lev4sec30"></A><H5 class="docSection3Title">Use the Appropriate Thread Type</H5>
<P class="docText"><A class="docLink" HREF="#ch18table08">Table 18.8</A> suggests the types of threads to use for different transaction requirements. These are general rule of thumb guidelines only; define your transactions to achieve optimal performance in your environment. In general, transactions requiring high availability or throughput should have dedicated and protected threads. Low-volume or low-priority threads can be diverted to the pool.<A NAME="ch18index749"></A><A NAME="ch18index750"></A></P>
<A NAME="ch18table08"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 18.8. Thread Specification by the Type of Transaction</h5></CAPTION><COLGROUP><COL width="147.02970297029705"><COL width="168.81188118811883"><COL width="234.15841584158417"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Transaction</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Thread Type to Use</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Other Recommendations</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Very high volume</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">High priority</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Entry</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDM &gt; THRDA</TT></P>
<P class="docText"><TT>THRDA &gt; 3</TT></P>
<P class="docText"><TT>THRDS &gt; 1</TT></P>
<P class="docText"><TT>TWAIT = POOL</TT> (or <TT>YES</TT>)</P>
<P class="docText"><TT>DPMODE = HIGH</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Moderate to high volume</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">High priority</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Entry</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDM &gt; THRDA</TT></P>
<P class="docText"><TT>THRDA &gt; 0</TT></P>
<P class="docText"><TT>THRDS &gt; 0</TT></P>
<P class="docText"><TT>TWAIT = POOL</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Low volume</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">High priority</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Entry</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDM = 2</TT></P>
<P class="docText"><TT>THRDA = 1</TT></P>
<P class="docText"><TT>THRDS = 0</TT></P>
<P class="docText"><TT>TWAIT = POOL</TT></P>
<P class="docText"><TT>DPMODE = HIGH</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Low volume</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Moderate priority</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Entry</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDM = THRDA = 1</TT></P>
<P class="docText"><TT>THRDS = 0</TT></P>
<P class="docText"><TT>TWAIT = POOL</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Low volume</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Low priority</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Entry</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDM = THRDA = THRDS = 0</TT></P>
<P class="docText"><TT>TWAIT = POOL</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Very low volume</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Pool</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>THRDM &gt; 3</TT></P>
<P class="docText"><TT>THRDA &gt; 2</TT></P>
<P class="docText"><TT>TWAIT = YES</TT><A NAME="ch18index751"></A><A NAME="ch18index752"></A></P></TD></TR></TABLE></P><br>
<P class="docText">Consider specifying transactions explicitly to the pool if you cannot accurately gauge their volume and priority. You can usually get better performance by explicitly defining entry threads and specifying the appropriate parameters for the performance and importance of the transactions. Even if all of your transactions are defined as entry threads, always define the pool to allow for overflow.</P>
<A NAME="ch18lev4sec31"></A><H5 class="docSection3Title">Use <TT>DSNC</TT></H5>
<P class="docText">Use the <TT>DSNC DISPLAY STATISTICS</TT> command to monitor the CICS environment. You can find details on this command in <A class="docLink" HREF="ch36.html#ch36">Chapter 36</A>.<A NAME="ch18index753"></A><A NAME="ch18index754"></A><A NAME="ch18index755"></A></P>
<A NAME="ch18lev4sec32"></A><H5 class="docSection3Title">Plan Management and Dynamic Plan Selection</H5>
<P class="docText">In the CICS environment, multiple programs can be executed in a single task. For CICS, the task defines the unit of work. For DB2, the application plan defines the unit of work. The scope of the unit of work for these two environments must be synchronized for them to operate in harmony. DB2 provides this synchronization in two ways:<A NAME="ch18index756"></A><A NAME="ch18index757"></A><A NAME="ch18index758"></A><A NAME="ch18index759"></A><A NAME="ch18index760"></A><A NAME="ch18index761"></A></P>
<UL><LI><P class="docList">You can bind all programs that can be initiated in a single CICS task to a single plan specified in the RCT for each transaction that can invoke any of the programs. An example was shown in <A class="docLink" HREF="#ch18list02">Listing 18.2</A> for the menuing application.</P></LI><LI><P class="docList">You can specify that dynamic plan selection is to be used. <A class="docLink" HREF="#ch18list02">Listing 18.2</A> shows an example of this synchronization also.</P></LI></UL>
<P class="docText">Dynamic plan selection uses an exit routine, specified in the RCT by coding <TT>PLNEXIT=YES</TT> and <TT>PLNPGME=exit-routine</TT>. If using the RDO, you will code the exit routine name using the <TT>PLANEXITNAME</TT> parameter. The exit routine determines the plan that should be used for the program being run. IBM supplies a sample exit routine called <TT>DSNCUEXT</TT> with DB2. This exit routine assigns the plan name to be the same as the program name. This approach is usually adequate, but you can code exit routines to assign plan names as your installation sees fit. Exit routines cannot contain SQL statements.</P>
<P class="docText">The first SQL statement executed after a CICS <TT>SYNCPOINT</TT> signals to DB2 that a new plan name must be selected. When you're using dynamic plan selection, your CICS programs must heed the following rules:</P>
<UL><LI><P class="docList">Use the CICS <TT>LINK</TT> or <TT>XCTL</TT> command to call one program from another.</P></LI><LI><P class="docList">Issue a CICS <TT>SYNCPOINT</TT> before the <TT>LINK</TT> or <TT>XCTL</TT>. Otherwise, the first SQL statement in the new program receives an <TT>SQLCODE</TT> of <TT>-805</TT>.</P></LI><LI><P class="docList">Design your programs so that a complete application unit of work is completed in a single program. Failure to do so results in logical units of work that span physical units of work. Data integrity problems can result.</P></LI></UL>
<P class="docText">The second option for the synchronization of DB2 plans to CICS tasks is to create large plans consisting of the DBRMs or packages of all programs that can be called in a single CICS task. Prior to DB2 V2.3, this could not be achieved with packages, so all DBRMs had to be bound into a single plan. This approach had the following negative effects.</P>
<P class="docText">When a program changed, a new DBRM was created, which caused the large plan to be bound again. You could not use the <TT>REBIND</TT> command, and you had no way of simply adding or replacing a single DBRM. As the number of DBRMs added to a plan increased, the time to bind that plan increased. As the plan was being bound, execution of the CICS transactions using that plan was not permitted. Therefore, program changes effectively took the entire application offline. When dynamic plan selection or packages were used, however, only the programs being changed were unavailable.</P>
<P class="docText">A second negative effect was that as the plan's size increased, it used more virtual storage. Even though DB2 uses techniques to load only those portions of the plan needed to execute the SQL at hand, performance suffers somewhat as plans increase in size. When you use dynamic plan selection, however, plans are generally much smaller. When packages are used, the plan is broken into smaller pieces that the system can manage more easily.</P>
<P class="docText">The recommendation is to create plans using packages, not DBRMs. This technique should be easier to manage and more efficient than either large plans composed of DBRMs or dynamic plan selection. Packages, instead of DBRMs bound directly into plans, should be the standard for all DB2 shops. Yet, many shops still avoid packages because they avoid (or fear) change or simply have not had the time to convert older applications. So, if your installation has stubbornly shunned packages (or, heaven forbid, is running a version of DB2 prior to V2.3), the recommendations change. Use dynamic plan selection for very large applications. Doing so decreases downtime due to program changes. For small applications (four or fewer programs), use a large plan composed of the DBRMs of each program.<A NAME="ch18index762"></A><A NAME="ch18index763"></A><A NAME="ch18index764"></A><A NAME="ch18index765"></A><A NAME="ch18index766"></A><A NAME="ch18index767"></A></P>
<A NAME="ch18lev2sec18"></A><H4 class="docSection2Title">Two-Phase Commit</H4>
<P class="docText">As I already mentioned, changes made in a CICS program are committed by the CICS <TT>SYNCPOINT</TT> command. Likewise, you can invoke the <TT>SYNCPOINT ROLLBACK</TT> command to back out unwanted changes. You code these commands as follows:<A NAME="ch18index768"></A><A NAME="ch18index769"></A><A NAME="ch18index770"></A></P>
<pre>

</pre><BR><pre>
EXEC CICS
    SYNCPOINT
END-EXEC.

EXEC CICS
    SYNCPOINT
    ROLLBACK
END-EXEC.
</pre><BR>
<P class="docText">The SQL <TT>COMMIT</TT> and <TT>ROLLBACK</TT> verbs are not valid in CICS programs. An implicit commit is performed when a CICS transaction ends with the <TT>EXEC CICS RETURN</TT> command.</P>
<P class="docText">When a CICS <TT>SYNCPOINT</TT> is requested in a CICS-DB2 program, a two-phase commit is performed. The commit is done in two phases because CICS must commit changes made to resources under its jurisdiction (such as changes made to VSAM files), and DB2 must control the commit for changes made with SQL <TT>UPDATE</TT>, <TT>INSERT</TT>, and <TT>DELETE</TT> statements.</P>
<P class="docText"><A class="docLink" HREF="#ch18fig25">Figure 18.25</A> shows the two-phase commit process for CICS. CICS acts as the coordinator of the process, and DB2 acts as a participant. The first phase consists of CICS informing DB2 that a <TT>SYNCPOINT</TT> was requested. DB2 updates its log but retains all locks because the commit is not complete. When the log update is finished, DB2 informs CICS that it has completed phase 1. CICS then updates its log, retaining all locks.</P>
<A NAME="ch18fig25"></A><p><CENTER><H5 class="docFigureTitle">Figure 18.25. The CICS two-phase commit process.</H5>
<p class="docText"><IMG BORDER="0" width="500" height="472" SRC="images/0672326132/graphics/18fig25.gif" ALT="graphics/18fig25.gif"></p></CENTER></p><br>
<P class="docText">CICS signals DB2 to begin phase 2, in which DB2 logs the commit and releases its locks. If successful, DB2 sends control back to CICS so that CICS can release its locks and record the success of the <TT>SYNCPOINT</TT>.</P>
<P class="docText">The two-phase commit process virtually ensures the integrity of DB2 data modified by CICS transactions. If changes cannot be committed in either environment for any reason, they are rolled back in both. In a connection failure or a system crash, however, the commit status of some transactions may be in doubt. These transactions are referred to as <span class="docEmphasis">in-doubt threads.</span> After a system failure, when DB2 and CICS are started and the connection is reestablished, most in-doubt threads are resolved automatically. If any in-doubt threads exist, you can use the <TT>RECOVER INDOUBT</TT> command to commit or roll back the changes pending for these threads.<A NAME="ch18index771"></A><A NAME="ch18index772"></A><A NAME="ch18index773"></A><A NAME="ch18index774"></A><A NAME="ch18index775"></A></P>
<A NAME="ch18lev2sec19"></A><H4 class="docSection2Title">CICS Design Guidelines</H4>
<P class="docText">When designing CICS transactions that access DB2 data, keep the following tips, tricks, and techniques in mind.<A NAME="ch18index776"></A><A NAME="ch18index777"></A></P>
<A NAME="ch18lev4sec33"></A><H5 class="docSection3Title">Bind CICS Plans for Performance</H5>
<P class="docText">When you're binding plans for CICS transactions, follow these <TT>BIND</TT> guidelines:<A NAME="ch18index778"></A><A NAME="ch18index779"></A><A NAME="ch18index780"></A><A NAME="ch18index781"></A></P>
<P><TABLE CELLSPACING="0" FRAME="void" RULES="none" CELLPADDING="5"><COLGROUP><COL width="148.5"><COL width="401.5"></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">High volume</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ACQUIRE(ALLOCATE)</TT>, <TT>RELEASE(DEALLOCATE)</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">All others</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ACQUIRE(USE)</TT>, <TT>RELEASE(COMMIT)</TT></P></TD></TR></TABLE></P><br>
<P class="docText">Binding high-volume transactions in this manner reduces overhead by ensuring that all resources are acquired before they are accessed. Why is this so? Consider the ramifications of binding a plan for high-volume CICS transaction with <TT>RELEASE(COMMIT)</TT>. Say the transaction uses a protected thread and that thread is reused 200 times by the same transaction. Each time the transaction ends (causing a <TT>COMMIT</TT>), DB2 would release the table space locks acquired during the course of the program, and then reacquire them again when the transaction runs again and the thread is reused—200 times. With <TT>RELEASE(DEALLOCATE)</TT>, resources are not released until the thread is deallocated. So, the table space locks would not need to be released and reacquired 200 times as long as the purge cycle is not met and the thread keeps getting reused. This can save a significant amount of CPU—perhaps up to 10%.</P>
<A NAME="ch18note06"></A><div class="docNote"><p class="docNoteTitle">CAUTION</p>

<P class="docText">Be aware that using protected threads and binding with <TT>RELEASE(DEALLOCATE)</TT> can cause administrative issues. You will probably need to increase the size of your EDM pool, because utilization will increase as more pages become non-stealable due to reuse.</P>
<P class="docText">Additionally, rebinding plans may become difficult. You cannot rebind while the plan is in use. But the plan will be in use as long as the thread used to execute the program is allocated. So, binding your CICS-DB2 plans will likely become something that is done only during off hours.</P></div><br>
<A NAME="ch18lev4sec34"></A><H5 class="docSection3Title">Avoid Conditional Table Access</H5>
<P class="docText">Additionally, high-volume transactions should eliminate (or minimize) built-in conditional table access and should be as small as possible.<A NAME="ch18index782"></A><A NAME="ch18index783"></A><A NAME="ch18index784"></A><A NAME="ch18index785"></A></P>
<A NAME="ch18lev4sec35"></A><H5 class="docSection3Title">Decrease the Size of Your CICS Programs</H5>
<P class="docText">The smaller the executable load module for a CICS program, the more efficient it will be. Therefore, CICS programmers should strive to reduce the size of their code. One way to do so is to increase the amount of reuseable code. For example, modularize your program and use common modules rather than recode modules everywhere they are needed.<A NAME="ch18index786"></A><A NAME="ch18index787"></A><A NAME="ch18index788"></A></P>
<P class="docText">A second way to increase your reuseable code is to use the COBOL <TT>REDEFINES</TT> clause to reduce the number of <TT>WORKING-STORAGE</TT> variables defined by the program. For example, consider a program requiring three text variables all used by different portions of the code. The first variable is 3 bytes long, the second is 8 bytes long, and another is 15 bytes long. Consider defining them as follows:</P>
<pre>

</pre><BR><pre>
01  COMMON-VARS-1.
    05  THREE-BYTE-VAR     PIC X(3).
    05  FILLER             PIC X(12).

01  COMMON-VARS-2 REDEFINES COMMON-VARS-1.
    05  EIGHT-BYTE-VAR     PIC X(8).
    05  FILLER             PIC X(7).

01  COMMON-VARS-3 REDEFINES COMMON-VARS-1.
    05  FIFTEEN-BYTE-VAR   PIC X(15).
</pre><BR>
<P class="docText">This way, you can save space. Before deciding to use this approach, however, you should consider the following factors:</P>
<UL><LI><P class="docList">The readability of the code is reduced when you use <TT>REDEFINES</TT>.</P></LI><LI><P class="docList">The program cannot use redefined variables concurrently. Ensure that any variable redefined as another variable can never be used by the program at the same time as another variable assigned for the same redefined group.</P></LI></UL>
<P class="docText">Another way to increase reuseable code is to use explicit constants in the program code to reduce the number of <TT>WORKING-STORAGE</TT> variables required. This approach can enhance performance, but it usually makes maintaining the program more difficult.<A NAME="ch18index789"></A><A NAME="ch18index790"></A><A NAME="ch18index791"></A></P>
<A NAME="ch18lev4sec36"></A><H5 class="docSection3Title">Avoid COBOL File Processing</H5>
<P class="docText">Do not use the COBOL file processing verbs <TT>READ</TT>, <TT>WRITE</TT>, <TT>OPEN</TT>, and <TT>CLOSE</TT> to access non-DB2 data sets required by your CICS/DB2 programs. If you use these functions in a CICS program, an MVS wait results, causing severe performance degradation. Instead, use the corresponding CICS file processing services (see <A class="docLink" HREF="#ch18table09">Table 18.9</A>).<A NAME="ch18index792"></A><A NAME="ch18index793"></A><A NAME="ch18index794"></A></P>
<A NAME="ch18table09"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="none" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 18.9. CICS File Processing Commands</h5></CAPTION><COLGROUP><COL width="242"><COL width="308"></COLGROUP><THEAD><TR><TH class="thead" align="left" valign="top" colspan="2"><P class="docText"><span class="docEmphStrong">Random Access Commands</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>READ</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Reads a specific record<A NAME="ch18index798"></A><A NAME="ch18index799"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>WRITE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Writes a specific record<A NAME="ch18index800"></A><A NAME="ch18index801"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REWRITE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Updates a specific record<A NAME="ch18index802"></A><A NAME="ch18index803"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DELETE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Deletes a specific record<A NAME="ch18index804"></A><A NAME="ch18index805"></A></P></TD></TR><COLGROUP><COL width="242"><COL width="308"></COLGROUP><THEAD><TR><TH class="thead" align="left" valign="top" colspan="2"><P class="docText"><span class="docEmphStrong">Sequential Access Commands</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STARTBR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Establishes sequential positioning in the file<A NAME="ch18index806"></A><A NAME="ch18index807"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>READNEXT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Reads the next record sequentially<A NAME="ch18index808"></A><A NAME="ch18index809"></A></P></TD></TR><COLGROUP><COL width="242"><COL width="308"></COLGROUP><THEAD><TR><TH class="thead" align="left" valign="top" colspan="2"><P class="docText"><span class="docEmphStrong">Sequential Access Commands</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>READPREV</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Reads the previous record sequentially<A NAME="ch18index810"></A><A NAME="ch18index811"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RESETBR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Resets positioning in the file<A NAME="ch18index812"></A><A NAME="ch18index813"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>ENDBR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Ends sequential file access<A NAME="ch18index814"></A><A NAME="ch18index815"></A></P></TD></TR></TABLE></P><br>
<A NAME="ch18lev4sec37"></A><H5 class="docSection3Title">Avoid Resource-Intensive COBOL Verbs</H5>
<P class="docText">Avoid the following COBOL verbs and features in CICS programs because they use a large amount of system resources:<A NAME="ch18index816"></A><A NAME="ch18index817"></A><A NAME="ch18index818"></A><A NAME="ch18index819"></A></P>
<BLOCKQUOTE><P><P class="docList"><TT>ACCEPT</TT></P></P><P><P class="docList"><TT>DISPLAY</TT></P></P><P><P class="docList"><TT>EXAMINE</TT></P></P><P><P class="docList"><TT>EXHIBIT</TT></P></P><P><P class="docList"><TT>SORT</TT></P></P><P><P class="docList"><TT>TRACE</TT></P></P><P><P class="docList"><TT>UNSTRING</TT></P></P><P><P class="docList"><TT>VARIABLE MOVE</TT></P></P></BLOCKQUOTE>
<A NAME="ch18lev4sec38"></A><H5 class="docSection3Title">Use <TT>WORKING-STORAGE</TT> to Initialize Variables</H5>
<P class="docText">To initialize variables, use the <TT>VALUES</TT> clause in <TT>WORKING-STORAGE</TT> rather than the <TT>MOVE</TT> and <TT>INITIALIZE</TT> statements.<A NAME="ch18index820"></A><A NAME="ch18index821"></A><A NAME="ch18index822"></A><A NAME="ch18index823"></A></P>
<A NAME="ch18lev4sec39"></A><H5 class="docSection3Title">Avoid Excessive <TT>PERFORM</TT>s and <TT>GOTO</TT>s</H5>
<P class="docText">Design your programs to execute paragraphs sequentially as much as possible. The fewer <TT>PERFORM</TT>s and <TT>GOTO</TT>s you use, the better the program performance will be in CICS.<A NAME="ch18index824"></A><A NAME="ch18index825"></A><A NAME="ch18index826"></A></P>
<A NAME="ch18lev4sec40"></A><H5 class="docSection3Title">Avoid Conversational Programs</H5>
<P class="docText">A conversational program receives data from a terminal, acts on the data, sends a response to the terminal, and waits for the terminal operator to respond. This process ties up a thread for the duration of the conversation.<A NAME="ch18index827"></A><A NAME="ch18index828"></A><A NAME="ch18index829"></A><A NAME="ch18index830"></A></P>
<P class="docText">Instead, use pseudo-conversational techniques for your CICS-DB2 programs. <span class="docEmphasis">Pseudo-conversational</span> programs appear to the operator as a continuous "conversation" consisting of requests and responses, but they are actually a series of separate tasks.<A NAME="ch18index831"></A><A NAME="ch18index832"></A></P>
<A NAME="ch18lev4sec41"></A><H5 class="docSection3Title">Favor Transfer Control Over Linking</H5>
<P class="docText">Favor the use of the <TT>XCTL</TT> command over the <TT>LINK</TT> command to pass control from one program to another. <TT>LINK</TT> acquires extra storage, and <TT>XCTL</TT> does not.<A NAME="ch18index833"></A><A NAME="ch18index834"></A><A NAME="ch18index835"></A></P>
<A NAME="ch18lev4sec42"></A><H5 class="docSection3Title">Reduce the Overhead of Sequential Number Assignment</H5>
<P class="docText">Consider using counters in main storage to assign sequential numbers. This way, you can reduce the overhead associated with other forms of assigning sequential numbers, such as reading a table containing the highest number. Remember that a rollback does not affect main storage. Therefore, rolling back a transaction can cause gaps in the numbering sequence.<A NAME="ch18index836"></A><A NAME="ch18index837"></A><A NAME="ch18index838"></A><A NAME="ch18index839"></A></P>
<table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" width="30" height="18" SRC="images/0672326132/graphics/V8_icon.gif" ALT="graphics/V8_icon.gif"></td><td valign="top"><P class="docText"> AS of DB2 V8, consider using sequence objects to assign sequential numbers. Sequence objects are covered in <A class="docLink" HREF="ch05.html#ch05">Chapter 5</A>.</P></td></tr></table><br>
<A NAME="ch18lev4sec43"></A><H5 class="docSection3Title">Plan for Locking Problems</H5>
<P class="docText">Plan for deadlocks and timeouts, and handle them accordingly in your program. If the RCT specifies <TT>ROLBE=YES</TT> or RDO specifies <TT>DROLLBACK(YES)</TT> all changes are backed out automatically and a <TT>-911</TT> SQLCODE is returned to your program. For <TT>ROLBE=NO</TT> (RCT) or <TT>DROLLBACK(NO)</TT> (RDO), <TT>-913</TT> is passed to the SQLCODE and automatic backout does not occur. In this case, the application program must decide whether to issue a CICS <TT>SYNCPOINT ROLLBACK</TT> to back out the changes.<A NAME="ch18index840"></A><A NAME="ch18index841"></A><A NAME="ch18index842"></A></P>
<A NAME="ch18lev4sec44"></A><H5 class="docSection3Title">Synchronize Programs and RCT/RDO Entries</H5>
<P class="docText">You must know the RCT or RDO parameters for your transaction before coding your program. Specifically, coding <TT>NO</TT> for <TT>ROLBE</TT> (RCT) or <TT>DROLLBACK</TT> (RDO) parameters affects the program design significantly by adding a great deal of code to handle rollbacks. Also, coding NO for <TT>TWAIT</TT> (RCT) or <TT>THREADWAIT</TT> (RDO) requires additional programming to handle abends.<A NAME="ch18index843"></A><A NAME="ch18index844"></A><A NAME="ch18index845"></A></P>
<A NAME="ch18lev4sec45"></A><H5 class="docSection3Title">Place SQL As Deep in the Program As Possible</H5>
<P class="docText">Minimize thread use by placing all SQL statements as far as possible into the transaction. A thread is initiated when the first SQL call is encountered. The later in the execution that the SQL statement is encountered, the shorter the time during which the thread is used.<A NAME="ch18index846"></A><A NAME="ch18index847"></A><A NAME="ch18index848"></A></P>
<A NAME="ch18lev4sec46"></A><H5 class="docSection3Title">Avoid DDL</H5>
<P class="docText">Avoid issuing DDL from a CICS program. DDL execution is time intensive and acquires locks on the DB2 Catalog and DB2 Directory. Because CICS programs should be quick, they should avoid DDL.<A NAME="ch18index849"></A><A NAME="ch18index850"></A><A NAME="ch18index851"></A></P>
<A NAME="ch18lev4sec47"></A><H5 class="docSection3Title">Check the Availability of the Attach Facility</H5>
<P class="docText">You must start the CICS Attach Facility for the appropriate DB2 subsystem before you execute CICS transactions that will run programs requiring access to DB2 data. If the CICS-to-DB2 connection is unavailable, the task abends with a CICS abend code of <TT>AEY9</TT>.<A NAME="ch18index852"></A><A NAME="ch18index853"></A><A NAME="ch18index854"></A></P>
<P class="docText">To avoid this type of abend, consider using the CICS <TT>HANDLE CONDITION</TT> command to check whether DB2 is available, as shown in <A class="docLink" HREF="#ch18list03">Listing 18.3</A>. This COBOL routine tests whether the CICS-to-DB2 connection has been started before issuing any SQL.</P>
<A NAME="ch18list03"></A><H5 class="docExampleTitle">Listing 18.3. Checking for DB2 Availability</H5><A NAME="ch18index855"></A>

<PRE>
WORKING-STORAGE.
        .
        .
        .
    77  WS-LGTH     PIC 9(8)  COMP.
    77  WS-PTR      PIC 9(4)  COMP.
        .
        .
        .
PROCEDURE DIVISION.
0000-MAINLINE.
        .
        .
        .
    EXEC CICS
        HANDLE CONDITION
        INVEXITREQ(9900-DB2-UNAVAILABLE)
    END-EXEC.

    EXEC CICS
        EXTRACT EXIT
        PROGRAM('DSNCEXT1')
        ENTRYNAME('DSNCSQL')
        GASET(WS-PTR)
        GALENGTH(WS-LGTH)
    END-EXEC.
        .
        .
        .
9900-DB2-UNAVAILABLE.

    <span class="docEmphasis">Inform the user that DB2 is unavailable</span>

    <span class="docEmphasis">Perform exception processing</span><A NAME="ch18index856"></A><A NAME="ch18index857"></A><A NAME="ch18index858"></A>
</PRE><BR>

<A NAME="ch18lev4sec48"></A><H5 class="docSection3Title">Use Debugging Tools</H5>
<P class="docText">Use CICS debugging facilities such as EDF to view CICS commands before and after their execution.<A NAME="ch18index859"></A><A NAME="ch18index860"></A><A NAME="ch18index861"></A><A NAME="ch18index862"></A></P>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch18lev1sec1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch18lev1sec3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
