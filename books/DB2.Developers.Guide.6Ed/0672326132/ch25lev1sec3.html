<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Cost Estimates and the DSN_STATEMNT_TABLE</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch25lev1sec2.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch25lev1sec4.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch25lev1sec3"></A><H3 class="docSection1Title" >Cost Estimates and the <TT>DSN_STATEMNT_TABLE</TT></H3>
<P class="docText">At the same time <TT>EXPLAIN</TT> populates the <TT>PLAN_TABLE</TT> with access path information, it also can populate cost estimate information into another table, <TT>DSN_STATEMNT_TABLE</TT>. The <TT>DSN_STATEMNT_TABLE</TT> is also referred to simply as the <span class="docEmphasis">statement table</span>. You can use the DDL in <A class="docLink" HREF="#ch25list02">Listing 25.2</A> to create a <TT>DSN_STATEMNT_TABLE.</TT><A NAME="ch25index214"></A><A NAME="ch25index215"></A><A NAME="ch25index216"></A><A NAME="ch25index217"></A></P>
<A NAME="ch25list02"></A><H5 class="docExampleTitle">Listing 25.2. DDL to Create the <TT>DSN_STATEMNT_TABLE</TT></H5><A NAME="ch25index218"></A><A NAME="ch25index219"></A><A NAME="ch25index220"></A><A NAME="ch25index221"></A><A NAME="ch25index222"></A>

<PRE>
CREATE TABLE <span class="docEmphasis">creator</span>.DSN_STATEMNT_TABLE
 (
 QUERYNO               INTEGER        NOT NULL WITH DEFAULT,
 APPLNAME              CHAR(128)      NOT NULL WITH DEFAULT,
 PROGNAME              CHAR(128)      NOT NULL WITH DEFAULT,
 COLLID                CHAR(128)       NOT NULL WITH DEFAULT,
 GROUP_MEMBER          CHAR(8)        NOT NULL WITH DEFAULT,
 EXPLAIN_TIME          TIMESTAMP      NOT NULL WITH DEFAULT,
 STMT_TYPE             CHAR(6)        NOT NULL WITH DEFAULT,
 COST_CATEGORY         CHAR(1)        NOT NULL WITH DEFAULT,
 PROCMS                INTEGER        NOT NULL WITH DEFAULT,
 PROCSU                INTEGER        NOT NULL WITH DEFAULT,
 REASON                VARCHAR(254)   NOT NULL WITH DEFAULT,
 STMT_ENCODE           CHAR(1)        NOT NULL WITH DEFAULT
) IN <span class="docEmphasis">database.tablespace</span>;
</PRE><BR>

<P class="docText">An <TT>EXPLAIN</TT> provides cost estimates, in service units and in milliseconds, for static and dynamic <TT>SELECT</TT>, <TT>INSERT</TT>, <TT>UPDATE</TT>, and <TT>DELETE</TT> statements. Keep in mind that the estimates are indeed just estimates. DB2 does not factor parallel processing, triggers, or user-defined functions into the cost estimation process.</P>
<P class="docText">The cost estimate information is useful in helping you to determine general performance characteristics of an application. You can use the cost estimates to determine roughly whether or not your programs can execute within planned service levels.</P>
<P class="docText">The cost estimates determined by DB2 will be tagged with a category. The category represents the confidence DB2 has in the estimate. There are two categories—category A and category B. Category A estimates were formulated based on sufficient information. Estimates in category A are more likely to be closer to reality than estimates in category B. A cost estimate is tagged as category B if DB2 must use default values when formulating the estimate. This can occur when <TT>RUNSTATS</TT> has not been run or when host variables are used in a query.<A NAME="ch25index223"></A><A NAME="ch25index224"></A><A NAME="ch25index225"></A><A NAME="ch25index226"></A></P>
<A NAME="ch25lev2sec5"></A><H4 class="docSection2Title">Changes for DB2 Version 8</H4>
<table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0"  width="30" height="18" SRC="images/0672326132/graphics/V8_icon.gif" ALT="graphics/V8_icon.gif"></td><td valign="top"><P class="docText"> The <TT>STMT_ENCODE</TT> column was added to the <TT>DSN_STATEMNT_TABLE</TT> as of DB2 Version 8 (to support multiple encoding schemes).<A NAME="ch25index227"></A><A NAME="ch25index228"></A><A NAME="ch25index229"></A><A NAME="ch25index230"></A></P></td></tr></table><br>
<A NAME="ch25lev2sec6"></A><H4 class="docSection2Title">The <TT>DSN_STATEMNT_TABLE</TT> Columns</H4>
<P class="docText">When <TT>EXPLAIN</TT> is run and an appropriate statement table exists, DB2 populates that table with SQL cost estimates. To review these estimates, you need to understand the meaning of the <TT>DSN_STATEMNT_TABLE</TT> columns. A description of every column of the <TT>DSN_STATEMNT_TABLE</TT> is provided in <A class="docLink" HREF="#ch25table02">Table 25.2</A>.<A NAME="ch25index231"></A><A NAME="ch25index232"></A><A NAME="ch25index233"></A><A NAME="ch25index234"></A><A NAME="ch25index235"></A></P>
<A NAME="ch25table02"></A><P><TABLE CELLSPACING="0" FRAME="above" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 25.2. <TT>DSN_STATEMNT_TABLE</TT> Columns</h5></CAPTION><COLGROUP><COL width="110"><COL width="330"><COL width="110"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Column</span></P></TH><TH class="bottomBorder thead" align="left" valign="top" colspan="2"><P class="docText"><span class="docEmphStrong">Description</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>QUERYNO</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">Indicates an integer value assigned by the user issuing the <TT>EXPLAIN</TT>, or by DB2. Enables the user to differentiate between <TT>EXPLAIN</TT> statements.<A NAME="ch25index236"></A><A NAME="ch25index237"></A><A NAME="ch25index238"></A><A NAME="ch25index239"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>APPLNAME</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">Contains the plan name for rows inserted as a result of running <TT>BIND PLAN</TT> specifying <TT>EXPLAIN(YES)</TT>. Contains the package name for rows inserted as a result of running <TT>BIND PACKAGE</TT> with <TT>EXPLAIN(YES)</TT>. Otherwise, contains blanks for rows inserted as a result of dynamic <TT>EXPLAIN</TT> statements.<A NAME="ch25index240"></A><A NAME="ch25index241"></A><A NAME="ch25index242"></A><A NAME="ch25index243"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PROGNAME</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">Contains the name of the program in which the SQL statement is embedded. If a dynamic <TT>EXPLAIN</TT> is issued from QMF, this column contains <TT>DSQIESQL</TT>.<A NAME="ch25index244"></A><A NAME="ch25index245"></A><A NAME="ch25index246"></A><A NAME="ch25index247"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COLLID</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">Contains the collection ID for the package.<A NAME="ch25index248"></A><A NAME="ch25index249"></A><A NAME="ch25index250"></A><A NAME="ch25index251"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>GROUP_MEMBER</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">Indicates the member name of the DB2 that executed <TT>EXPLAIN</TT>. The column is blank if the DB2 subsystem was not in a data sharing environment when <TT>EXPLAIN</TT> was executed.<A NAME="ch25index252"></A><A NAME="ch25index253"></A><A NAME="ch25index254"></A><A NAME="ch25index255"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>EXPLAIN_TIME</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">Indicates the time the plan or package for the statement or query block was explained. The time is the same as the <TT>BIND_TIME</TT> column in the <TT>PLAN_TABLE</TT>.<A NAME="ch25index256"></A><A NAME="ch25index257"></A><A NAME="ch25index258"></A><A NAME="ch25index259"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top" rowspan="8"><P class="docText"><TT>STMT_TYPE</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">The type of statement being explained. Possible values are as follow:<A NAME="ch25index260"></A><A NAME="ch25index261"></A><A NAME="ch25index262"></A><A NAME="ch25index263"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SELECT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SELECT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INSERT</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>INSERT</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UPDATE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UPDATE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DELETE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DELETE</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SELUPD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SELECT</TT> with <TT>FOR UPDATE OF</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DELCUR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>DELETE WHERE CURRENT OF CURSOR</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UPDCUR</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UPDATE WHERE CURRENT OF CURSOR</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top" rowspan="3"><P class="docText"><TT>COST_CATEGORY</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">Indicates whether the estimate is in category A or B. Informs as to whether DB2 had to use default values when formulating cost estimates. Valid values are as follow:<A NAME="ch25index264"></A><A NAME="ch25index265"></A><A NAME="ch25index266"></A><A NAME="ch25index267"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>A</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">DB2 had enough information to make a cost estimate without using default values.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>B</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">At least one condition existed forcing DB2 to use default values. The <TT>REASON</TT> column outlines why DB2 was unable to put this estimate in cost category A.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PROCMS</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">The cost estimate in milliseconds, for the SQL statement (rounded up to the next whole integer). The maximum value is 2,147,483,647 milliseconds (the equivalent of about 24.8 days). If the estimated value exceeds this maximum, the maximum value is reported.<A NAME="ch25index268"></A><A NAME="ch25index269"></A><A NAME="ch25index270"></A><A NAME="ch25index271"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>PROCSU</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">The cost estimate in service units, for the SQL statement (rounded up to the next whole integer). The maximum value for this cost is 2,147,483,647 service units. If the estimated value exceeds this maximum, the maximum value is reported.<A NAME="ch25index272"></A><A NAME="ch25index273"></A><A NAME="ch25index274"></A><A NAME="ch25index275"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top" rowspan="6"><P class="docText"><TT>REASON</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">A character string representing the reasons a cost estimate was tagged as category B.<A NAME="ch25index276"></A><A NAME="ch25index277"></A><A NAME="ch25index278"></A><A NAME="ch25index279"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>HOST VARIABLES</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The statement uses host variables, parameter markers, or special registers.<A NAME="ch25index280"></A><A NAME="ch25index281"></A><A NAME="ch25index282"></A><A NAME="ch25index283"></A><A NAME="ch25index284"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TABLE CARDINALITY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The cardinality statistics are missing for one or more of the tables that are used in the statement (or, the statement required materialization of views or nested table expressions).</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UDF</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">The statement uses user-defined functions.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>TRIGGERS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Triggers are defined on the target table of an <TT>INSERT</TT>, <TT>UPDATE</TT>, or <TT>DELETE</TT> statement.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REFERENTIAL</TT></P>
<P class="docText"><TT>CONSTRAINTS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CASCADE</TT> or <TT>SET NULL</TT> referential constraints exist on the target table of a <TT>DELETE</TT> statement</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top" rowspan="5"><P class="docText"><TT>STMT_ENCODE</TT></P></TD><TD class="docTableCell" align="left" valign="top" colspan="2"><P class="docText">Indicates the encoding scheme for the statement, as follows:<A NAME="ch25index285"></A><A NAME="ch25index286"></A><A NAME="ch25index287"></A><A NAME="ch25index288"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>A</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">ASCII</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>E</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">ENCDIC</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>U</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Unicode</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>M</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Multiple CCSID sets<A NAME="ch25index289"></A><A NAME="ch25index290"></A><A NAME="ch25index291"></A><A NAME="ch25index292"></A><A NAME="ch25index293"></A></P></TD></TR></TABLE></P><br>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch25lev1sec2.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch25lev1sec4.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
