<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>The Causes of DB2 Performance Problems</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch28lev1sec3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch29.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch28lev1sec4"></A><H3 class="docSection1Title">The Causes of DB2 Performance Problems</H3>
<P class="docText">All performance problems are caused by change. Change can take many forms, including the following:<A NAME="ch28index713"></A><A NAME="ch28index714"></A></P>
<UL><LI><P class="docList">Physical changes to the environment, such as a new CPU, new DASD devices, or different tape drives.</P></LI><LI><P class="docList">Installing a new version or release of the operating system.</P></LI><LI><P class="docList">Changes to system software, such as a new release of a product (for example, QMF, CICS, or GDDM), the alteration of a product (for example, the addition of more or fewer CICS regions or an IMS SYSGEN), or a new product (for example, implementation of DFHSM). Also included is the installation of a new release or version of DB2, which can result in changes in access paths and the utilization of features new to DB2.</P></LI><LI><P class="docList">Changes to the DB2 engine from maintenance releases, which can change the optimizer.</P></LI><LI><P class="docList">Changes in system capacity. More or fewer jobs could be executing concurrently when the performance problem occurs.</P></LI><LI><P class="docList">Environment changes, such as the implementation of client/server programs or the adoption of data sharing.</P></LI><LI><P class="docList">Database changes. This involves changes to any DB2 object, and ranges from adding a new column or an index to dropping and re-creating an object.</P></LI><LI><P class="docList">Changes to the application development methodology, such as usage of check constraints instead of application logic or the use of stored procedures.</P></LI><LI><P class="docList">Changes to application code.</P></LI></UL>
<P class="docText">Performance problems are not caused by magic. Something tangible changes, creating a performance problem in the application. The challenge of tuning is to find the source of the change, gauge its impact, and formulate a solution.</P>
<P class="docText">See <A class="docLink" HREF="#ch28fig05">Figure 28.5</A>. This hierarchy shows the order of magnitude by which each type of resource can affect DB2 performance. The resource with the highest potential for affecting performance is at the top. This does not mean that the bulk of your problems will be at the highest level. Although the operating system packs the largest wallop in terms of its potential for degrading performance when improperly tuned, it consists of only approximately 5% of the tuning opportunity.<A NAME="ch28index715"></A><A NAME="ch28index716"></A><A NAME="ch28index717"></A><A NAME="ch28index718"></A></P>
<A NAME="ch28fig05"></A><p><CENTER><H5 class="docFigureTitle">Figure 28.5. The tuning hierarchy in terms of impact.</H5>
<p class="docText"><IMG BORDER="0" width="350" height="542" SRC="images/0672326132/graphics/28fig05.gif" ALT="graphics/28fig05.gif"></p></CENTER></p><br>
<P class="docText">Although the majority of your problems will be application-oriented, you must explore the tuning opportunities presented in the other environments when application tuning has little effect.</P>
<P class="docText">The following is a quick reference of the possible tuning options for each environment.</P>
<P><TABLE CELLSPACING="0" FRAME="void" RULES="groups" CELLPADDING="5"><COLGROUP><COL width="550"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">To tune OS/390, z/OS:</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Change the dispatching priority.<A NAME="ch28index719"></A><A NAME="ch28index720"></A><A NAME="ch28index721"></A><A NAME="ch28index722"></A></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Modify swappability.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Add memory.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Upgrade CPU.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Implement data sharing.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Use an active performance monitor (enables tuning on the fly).</P></TD></TR><COLGROUP><COL width="550"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">To tune the teleprocessing environments:</span><A NAME="ch28index723"></A><A NAME="ch28index724"></A><A NAME="ch28index725"></A></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Change the system generation parameters.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Tune the program definition (PSBs and PPT entries).</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Modify the Attachment Facility parameters.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Add or change table entries.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Use an active performance monitor (enables tuning on the fly).</P></TD></TR><COLGROUP><COL width="550"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">To tune the DB2 subsystem:</span><A NAME="ch28index726"></A><A NAME="ch28index727"></A></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Modify DSNZPARMs to increase or decrease the number of concurrent users, change lock escalation, increase EDM pool storage, and so on.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Issue <TT>SET LOG</TT> commands to change log buffers.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Issue <TT>ALTER BUFFERPOOL</TT> commands to change bufferpool sizes, increase or decrease bufferpool thresholds, and modify associated hiperpools.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Tune the DB2 Catalog, including dropping and freeing objects, executing <TT>MODIFY</TT>, reorganizing DB2 Catalog tablespaces and indexes, rebuilding the DB2 Catalog indexes, adding indexes to the DB2 Catalog, changing data set placement, moving the DB2 Catalog to a faster DASD device, and implementing data set shadowing.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Perform <TT>DSNDB07</TT> tuning.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Use a tool to change DSNZPARMs on the fly.</P></TD></TR><COLGROUP><COL width="550"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">To tune the DB2 database design:</span><A NAME="ch28index728"></A><A NAME="ch28index729"></A><A NAME="ch28index730"></A></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Modify the logical and physical model.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Modify and issue DDL.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Execute <TT>ALTER</TT> statements.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Ensure that proper parameters are specified.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Implement table changes.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Partition simple and segmented tablespaces.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Spread non-partitioned objects over multiple devices using <TT>PIECESIZE</TT>.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Add indexes.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REORG</TT> tablespaces.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REORG</TT> or <TT>REBUILD</TT> indexes.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Consider or reconsider data compression.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Denormalize the database design.</P></TD></TR><COLGROUP><COL width="550"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">To tune shared data:</span><A NAME="ch28index731"></A><A NAME="ch28index732"></A><A NAME="ch28index733"></A></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Denormalize the database design.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Add redundant tables.</P></TD></TR><COLGROUP><COL width="550"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">To tune programs:</span><A NAME="ch28index734"></A><A NAME="ch28index735"></A></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Perform SQL tuning.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Use triggers to enforce business rules.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Implement stored procedures and user-defined functions as needed.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Reduce network requests in client/server applications.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Tune the high-level language (such as COBOL or 4GL).</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Use a program restructuring tool.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Run <TT>RUNSTATS</TT>.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Execute <TT>EXPLAIN</TT>, modify your code, and <TT>REBIND</TT>.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Use the <TT>OPTIMIZE FOR </TT><span class="docEmphasis"><TT>n</TT></span> <TT>ROWS</TT> clause.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Consider activating query parallelism.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Change locking strategies.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Change the DB2 Catalog statistics and <TT>REBIND</TT>.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Implement optimization hints.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Use a testing tool to provide what if testing and tuning.</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText">Use a tool to sample the application's address space as it executes.</P></TD></TR></TABLE></P><br>
<P class="docText">It is important not to confuse the issue, so I will present another tuning hierarchy. <A class="docLink" HREF="#ch28fig06">Figure 28.6</A> outlines the order in which DB2 problems should be investigated. Start at the top and work your way down. If you are sure that your MVS environment has not changed, investigate the teleprocessing monitor. Only when you have tried all avenues of tuning at one level should you move to the next. Of course, this process should be used only when the cause of the problem is not obvious. If you just implemented a new application yesterday and the first time it runs problems occur, you most likely can assume the problem is in the new application and begin looking there.<A NAME="ch28index736"></A><A NAME="ch28index737"></A></P>
<A NAME="ch28fig06"></A><p><CENTER><H5 class="docFigureTitle">Figure 28.6. The tuning review process.</H5>
<p class="docText"><IMG BORDER="0" width="350" height="380" SRC="images/0672326132/graphics/28fig06.gif" ALT="graphics/28fig06.gif"></p></CENTER></p><br>
<A NAME="ch28sb56"></A><P><TABLE CELLSPACING="0" WIDTH="90%" BORDER="1" cellpadding="5"><TR><TD>
<H2 class="docSidebarTitle">TUNING STRATEGY</H2>
<P class="docText">Implement at your shop a standard that incorporates tuning hierarchies similar to the ones shown in <A class="docLink" HREF="#ch28fig05">Figures 28.5</A> and <A class="docLink" HREF="#ch28fig06">28.6</A>.</P>
<P class="docText">Document your tuning standard, stating that each component of the DB2 tuning hierarchies should be considered when DB2 performance problems are encountered. Include in the document all the tools that can be used. If possible, get managerial agreement from all areas involved to reduce the friction that can occur when diverse groups attempt to resolve a DB2 tuning problem.<A NAME="ch28index738"></A><A NAME="ch28index739"></A></P></TD></TR></TABLE></P><br>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch28lev1sec3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch29.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
