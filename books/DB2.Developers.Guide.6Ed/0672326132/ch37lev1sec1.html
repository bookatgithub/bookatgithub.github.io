<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Utility Guidelines</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch37.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch37lev1sec2.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch37lev1sec1"></A><H3 class="docSection1Title">Utility Guidelines</H3>
<P class="docText">The following topics provide useful guidance for the development and usage of DB2 utilities.</P>
<A NAME="ch37lev4sec1"></A><H4 class="docSection2Title">DB2 Online Utility Return Codes</H4>
<P class="docText">When an online utility runs, a return code is provided indicating the status of the utility execution. If the utility runs to normal completion, the return code is set to <TT>0</TT>.<A NAME="ch37index01"></A><A NAME="ch37index02"></A><A NAME="ch37index03"></A></P>
<P class="docText">A return code of <TT>4</TT> indicates that the utility completed running, but with warnings. Review the utility output to determine whether some type of reprocessing is required. A warning often indicates a condition that requires no additional consideration.</P>
<P class="docText">A return code of <TT>8</TT> means that the utility did not complete successfully. Determine the cause and execute the utility again.</P>
<P class="docText">A return code of <TT>12</TT> is an authorization error, which means that the user is not authorized to execute the utility. Either grant the user the proper authority or have an authorized user execute the utility.</P>
<A NAME="ch37lev4sec2"></A><H4 class="docSection2Title">DB2 Utility Work Data Sets</H4>
<P class="docText">Many DB2 online utilities require the allocation of work data sets to complete the task at hand. These work data sets were presented in the first chapters in <A class="docLink" HREF="part06.html#part06">Part VI</A>. Because a central reference often is handy, the required and optional work data sets for the DB2 online utilities are presented together in <A class="docLink" HREF="#ch37table01">Table 37.1</A>. The data sets used by DB2 utilities are listed along the top of the table. The utilities that use these data sets are listed along the left side of the table. Consult the legend to determine the necessity of coding these data sets in the JCL.<A NAME="ch37index04"></A><A NAME="ch37index05"></A><A NAME="ch37index06"></A><A NAME="ch37index07"></A></P>
<A NAME="ch37table01"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 37.1. Required Utility Data Sets</h5></CAPTION><COLGROUP><COL width="82.5"><COL width="38.5"><COL width="44"><COL width="38.5"><COL width="44"><COL width="33"><COL width="33"><COL width="33"><COL width="38.5"><COL width="44"><COL width="33"><COL width="44"><COL width="44"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top">&nbsp;</TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SORTOUT</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SORTWKxx</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SYSCOPY</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SYSDISC</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SYSERR</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SYSMAP</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SYSREC</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SYSUT1</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>UTPRINT</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SYSIN</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>SYSPRINT</TT></P></TH><TH class="bottomBorder thead" align="left" valign="bottom"><P class="docText"><TT>DSSPRINT</TT></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CHECK DATA</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">O</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CHECK INDEX</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">O</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CHECK LOB</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">O</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COPY</TT></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">O</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOAD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">X/C/K</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">B</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">O</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">O</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">O</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MERGECOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">O</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>QUIESCE</TT></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REBUILD INDEX</TT></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">O</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RECOVER</TT></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REORG INDEX</TT></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REORG TS</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">X</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">B</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">D</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">T</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">R</P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableFooter" valign="top" colspan="13"><P class="docText"><span class="docEmphasis">B = Required if the</span> <TT>COPYDDN</TT> <span class="docEmphasis">and</span> <TT>RECOVERYDDN</TT> <span class="docEmphasis">options are used to make image copies during utility processing</span></P>
<P class="docText"><span class="docEmphasis">C = Required if referential constraints exist and the</span> <TT>ENFORCE CONSTRAINTS</TT> <span class="docEmphasis">option is used</span></P>
<P class="docText"><span class="docEmphasis">D = Required if the</span> <TT>DISCARDDN</TT> <span class="docEmphasis">option is specified to purge data during a</span> <TT>REORG</TT></P>
<P class="docText"><span class="docEmphasis">K = Required if the</span> <TT>SORTKEYS</TT> <span class="docEmphasis">option is specified with no value or a value of zero</span></P>
<P class="docText"><span class="docEmphasis">O = Optional (based on utility parameters)</span></P>
<P class="docText"><span class="docEmphasis">R = Required</span></P>
<P class="docText"><span class="docEmphasis">T = Required for tables with indexes unless the</span> <TT>SORTKEYS</TT> <span class="docEmphasis">option is specified</span></P>
<P class="docText"><span class="docEmphasis">X = Required if indexes exist</span></P></TD></TR></TABLE></P><br>
<P class="docText">The <TT>COPY</TT> utility also requires a filter data set containing a list of VSAM data set names when <TT>COPY</TT> is run with the <TT>CONCURRENT</TT> and <TT>FILTERDDN</TT> options.</P>
<P class="docText">You also can specify a <TT>SYSPUNCH</TT> data set for the <TT>REORG</TT> utility to generate <TT>LOAD</TT> statement input cards. Additionally, <TT>REORG</TT> requires a data set to hold the unloaded data unless <TT>NOSYSREC</TT> or <TT>SHRLEVEL CHANGE</TT> is specified.<A NAME="ch37index08"></A><A NAME="ch37index09"></A><A NAME="ch37index10"></A><A NAME="ch37index11"></A></P>
<table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"></td><td valign="top"><P class="docText"> Of course, as of DB2 Version 7, you can use dynamic data set allocation and allow DB2 to allocate the data sets that are required for each utility. Doing so is simple and easier to manage than explicitly coding each data set allocation for each utility. For more details on dynamic data set allocation, refer to <A class="docLink" HREF="ch30.html#ch30">Chapter 30</A>, "An Introduction to DB2 Utilities."<A NAME="ch37index12"></A><A NAME="ch37index13"></A><A NAME="ch37index14"></A><A NAME="ch37index15"></A></P></td></tr></table><br>
<A NAME="ch37lev4sec3"></A><H4 class="docSection2Title">DB2 Utility Catalog Contention</H4>
<P class="docText">DB2 utilities read and update DB2 Catalog and DB2 Directory tables. This can cause contention when multiple utilities are run concurrently.</P>
<P class="docText"><A class="docLink" HREF="#ch37table02">Table 37.2</A> lists the DB2 Catalog tables that are either updated or read by the online DB2 utilities. In addition, DB2 utilities update the <TT>SYSIBM.SYSUTILX</TT> DB2 Directory table.<A NAME="ch37index16"></A><A NAME="ch37index17"></A></P>
<P class="docText">DB2 utilities rely on claim and drain processing instead of transaction locks to reduce contention and increase availability. SQL statements take claims on resources and utilities take drains.</P>
<A NAME="ch37table02"></A><P><TABLE CELLSPACING="0" FRAME="hsides" RULES="groups" CELLPADDING="5"><CAPTION><h5 class="docTableTitle">Table 37.2. Utility Contention</h5></CAPTION><COLGROUP><COL width="152.4752475247525"><COL width="196.03960396039605"><COL width="201.4851485148515"></COLGROUP><THEAD><TR><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Utility</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Updates</span></P></TH><TH class="bottomBorder thead" align="left" valign="top"><P class="docText"><span class="docEmphStrong">Reads</span></P></TH></TR></THEAD><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>CHECK</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSCHECKDEP
SYSIBM.SYSCHECKS
SYSIBM.SYSCOLUMNS
SYSIBM.SYSINDEXES
SYSIBM.SYSINDEXPART
SYSIBM.SYSTABLES
SYSIBM.SYSTABLEPART
SYSIBM.SYSTABLESPACE
</PRE><BR>
</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>COPY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSCOLUMNS
SYSIBM.SYSINDEXES
SYSIBM.SYSINDEXPART
SYSIBM.SYSTABLES
SYSIBM.SYSTABLEPAR
SYSIBM.SYSTABLESPACE
</PRE><BR>
</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>LOAD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSCHECKDEP
SYSIBM.SYSCHECKS
SYSIBM.SYSCOLUMNS
SYSIBM.SYSINDEXES
SYSIBM.SYSTABLEPART
SYSIBM.SYSTABLES
SYSIBM.SYSINDEXPART
SYSIBM.SYSTABLESPACE
</PRE><BR>
</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MERGECOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MODIFY RECOVERY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>MODIFY STATISTICS</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSCOLUMNS
SYSIBM.SYSCOLDIST
SYSIBM.SYSINDEXES
SYSIBM.SYSTABLES
SYSIBM.SYSINDEXPART
SYSIBM.SYSLOBSTATS
SYSIBM.SYSTABSTATS
SYSIBM.SYSTABLEPART
SYSIBM.SYSTABLESPACE
</PRE><BR>
</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>QUIESCE</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT><A NAME="ch37index18"></A><A NAME="ch37index19"></A></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REBUILD</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSCOLUMNS
SYSIBM.SYSINDEXES
SYSIBM.SYSINDEXPART
SYSIBM.SYSTABLES
SYSIBM.SYSTABLEPART
SYSIBM.SYSTABLESPACE
</PRE><BR>
</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RECOVER</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSCOLUMNS
SYSIBM.SYSINDEXES
SYSIBM.SYSINDEXPART
SYSIBM.SYSTABLES
SYSIBM.SYSTABLEPART
SYSIBM.SYSTABLESPACE
</PRE><BR>
</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REORG</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>SYSIBM.SYSCOPY</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSCOLUMNS
SYSIBM.SYSINDEXES
SYSIBM.SYSINDEXPART
SYSIBM.SYSTABLES
SYSIBM.SYSTABLEPART
SYSIBM.SYSTABLESPACE
</PRE><BR>
</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>REPAIR SET</TT></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NOCHCKPEND</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSTABLES
SYSIBM.SYSTABLEPART
</PRE><BR>
</TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NORCVRPEND</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">DB2 Directory</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>NOCOPYPEND</TT></P></TD><TD class="docTableCell" align="left" valign="top"><P class="docText">DB2 Directory</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>RUNSTATS</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSCOLDIST
SYSIBM.SYSCOLDIST_HIST
SYSIBM.SYSCOLDISTSTATS 
SYSIBM.SYSCOLSTATS
SYSIBM.SYSCOLUMNS
SYSIBM.SYSCOLUMNS_HIST
SYSIBM.SYSINDEXES
SYSIBM.SYSINDEXES_HIST
SYSIBM.SYSINDEXPART
SYSIBM.SYSINDEXPART_HIST
SYSIBM.SYSINDEXSTATS
SYSIBM.SYSINDEXSTATS_HIST
SYSIBM.SYSLOBSTATS
SYSIBM.SYSLOBSTATS_HIST
SYSIBM.SYSTABLES
SYSIBM.SYSTABLEPART
SYSIBM.SYSTABLEPART_HIST
SYSIBM.SYSTABLESPACE
SYSIBM.SYSTABLESPACE_HIST
SYSIBM.SYSTABSTATS
SYSIBM.SYSTABSTATS_HIST
</PRE><BR>
</TD><TD class="docTableCell" align="left" valign="top"><P class="docText">Table spaces and indexes being analyzed</P></TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>STOSPACE</TT></P></TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSINDEXES
SYSIBM.SYSTABLESPACE
SYSIBM.SYSSTOGROUP
SYSIBM.SYSTABLEPART
SYSIBM.SYSINDEXPART
</PRE><BR>
</TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD></TR><TR><TD class="docTableCell" align="left" valign="top"><P class="docText"><TT>UNLOAD</TT></P></TD><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top">
<PRE>
SYSIBM.SYSTABLES
SYSIBM.SYSCOLUMNS
</PRE><BR>

<P class="docText">Table being unloaded<A NAME="ch37index20"></A><A NAME="ch37index21"></A></P></TD></TR></TABLE></P><br>
<A NAME="ch37lev4sec4"></A><H4 class="docSection2Title">Partition Level Operation</H4>
<P class="docText">DB2 online utilities can operate at the table space partition level. The following utilities can be issued for a single partition or for all the partitions of a table space:<A NAME="ch37index22"></A><A NAME="ch37index23"></A><A NAME="ch37index24"></A></P>
<UL><LI><P class="docList"><TT>CHECK DATA</TT>, <TT>CHECK INDEX</TT>, and <TT>REPAIR</TT> data consistency utilities</P></LI><LI><P class="docList"><TT>COPY</TT>, <TT>MERGECOPY</TT>, <TT>QUIESCE</TT>, <TT>RECOVER</TT>, <TT>REBUILD INDEX</TT>, and <TT>REPORT</TT> backup and recovery utilities</P></LI><LI><P class="docList"><TT>LOAD</TT> and <TT>REORG</TT> data organization utilities</P></LI><LI><P class="docList"><TT>MODIFY</TT> and <TT>RUNSTATS</TT> catalog manipulation utility</P></LI></UL>
<A NAME="ch37lev4sec5"></A><H4 class="docSection2Title">Coding Utility Control Cards</H4>
<P class="docText">All DB2 utility control card input must be contained in 80-character record images. The utility statements must be confined to columns 1 through 72. All input in columns 73 through 80 is ignored by DB2.<A NAME="ch37index25"></A><A NAME="ch37index26"></A></P>
<A NAME="ch37lev4sec6"></A><H4 class="docSection2Title">Automatically Generate Utility Control Cards</H4>
<P class="docText">Consider using DB2 Catalog queries to generate utility control card input. By creating standard queries for each utility, you improve the accuracy of the utility input syntax. For example, the following query automatically generates input to the <TT>RECOVER</TT> utility to invoke full table space recovery for all table spaces in a given database:<A NAME="ch37index27"></A><A NAME="ch37index28"></A></P>
<pre>

</pre><BR><pre>
SELECT   'RECOVER TABLESPACE '  ||  DBNAME  ||
         '.'  ||  NAME || ' DSNUM ALL'
FROM     SYSIBM.SYSTABLESPACE
WHERE    DBNAME = '''DSN8D81A';
</pre><BR>
<P class="docText">This query generates <TT>RECOVER TABLESPACE</TT> control cards for every table space in the sample database. You can formulate queries to automatically create control card input for most of the online utilities.</P>
<A NAME="ch37lev4sec7"></A><p><table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" width="30" height="18" SRC="images/0672326132/graphics/V7_icon.gif" ALT="graphics/V7_icon.gif"></td><td valign="top"><H4 class="docSection2Title">Use <TT>LISTDEF</TT> and <TT>TEMPLATE</TT></H4></td></tr></table></p>

<P class="docText">In general, the maintenance and execution of DB2 utilities can be greatly simplified by using the <TT>LISTDEF</TT> and <TT>TEMPLATE</TT> control statements.</P>
<P class="docText"><TT>LISTDEF</TT> is used to create a database object list such that a DB2 utility can execute against multiple database objects. Wildcards can be used to automatically include objects that conform to specific naming conventions in the list. After a list is created, the utility is run against the list. Using <TT>LISTDEF</TT> and proper naming conventions, you can create utility jobs that run against all table spaces (for example) in a particular application. When new table spaces are added, if they conform to the naming convention, they will automatically be added to the list—and thereby are automatically added to the utility jobs using that list.<A NAME="ch37index29"></A><A NAME="ch37index30"></A><A NAME="ch37index31"></A><A NAME="ch37index32"></A></P>
<P class="docText">The <TT>TEMPLATE</TT> statement supports dynamic data set allocation. It provides DB2 utilities with the basic allocation information necessary to automatically generate and allocate valid data sets that are required for use as DB2 utilities are executed. Used in conjunction with <TT>LISTDEF</TT>, DB2 utility jobs can be set up to operate on multiple database objects with a single run.<A NAME="ch37index33"></A><A NAME="ch37index34"></A><A NAME="ch37index35"></A><A NAME="ch37index36"></A></P>
<A NAME="ch37lev4sec8"></A><H4 class="docSection2Title">Specify the <TT>BUFNO</TT> JCL Parameter</H4>
<P class="docText">Various guidelines in <A class="docLink" HREF="part06.html#part06">Part VI</A> recommend specific <TT>BUFNO</TT> JCL parameter settings for different utility work data sets. Each installation defines a default number of buffers adequate for the data sets used by most batch jobs. The DB2 utilities, however, can benefit by increasing the work data set buffers. Therefore, if sufficient memory is available to increase the buffering of DB2 utility work data sets, always do so. As of DB2 V4, the default for <TT>BUFNO</TT> is 20.<A NAME="ch37index37"></A><A NAME="ch37index38"></A><A NAME="ch37index39"></A></P>
<A NAME="ch37lev4sec9"></A><H4 class="docSection2Title">Allocate Sufficient Sort Work Space for <TT>DFSORT</TT></H4>
<P class="docText">The <TT>CHECK INDEX</TT>, <TT>LOAD</TT>, <TT>RECOVER INDEX</TT>, and <TT>REORG</TT> utilities require an external sort routine. DB2 uses an IBM-supplied sort utility named <TT>DFSORT</TT>. You can use the <TT>SORTDEVT</TT> and <TT>SORTNUM</TT> parameters of these utilities to allow the system to allocate the sort work area dynamically. This way, the sort work specification never needs to be adjusted or sized—the system manages the required size.<A NAME="ch37index40"></A><A NAME="ch37index41"></A><A NAME="ch37index42"></A><A NAME="ch37index43"></A><A NAME="ch37index44"></A><A NAME="ch37index45"></A><A NAME="ch37index46"></A></P>
<A NAME="ch37note01"></A><div class="docNote"><p class="docNoteTitle">CAUTION</p>

<P class="docText">For very large table spaces requiring a large amount of sort work space, consider explicit allocation of sort work data sets because the system might not be able to allocate large amounts of space during the utility execution.</P></div><br>
<P class="docText">The <TT>SORTDEVT</TT> parameter is used to specify the device type for temporary data sets to be dynamically allocated by <TT>DFSORT</TT>. The <TT>SORTNUM</TT> parameter specifies the number of temporary data sets to be dynamically allocated by the sort program. If you use <TT>SORTDEVT</TT> and omit <TT>SORTNUM</TT>, <TT>DFSORT</TT> will determine how many data sets to allocate on its own.<A NAME="ch37index47"></A><A NAME="ch37index48"></A><A NAME="ch37index49"></A><A NAME="ch37index50"></A></P>
<A NAME="ch37note02"></A><div class="docNote"><p class="docNoteTitle">NOTE</p>

<P class="docText">No sort work space is required when reorganizing type 2 indexes. No sort work space is required when loading a table with no indexes or a single index, when the data to be loaded is in order by the index key.</P></div><br>
<P class="docText">The <TT>SORTWK</TT><span class="docEmphasis"><TT>xx</TT></span> <TT>DD</TT> statement defines the characteristics and location of the intermediate storage data sets used by <TT>DFSORT</TT>. Multiple data sets can be allocated for the temporary sort work space required by <TT>DFSORT</TT>. Specify each sort work data set to a different <TT>SORTWK</TT><span class="docEmphasis"><TT>xx</TT></span> <TT>DD</TT> statement. The <span class="docEmphasis"><TT>xx</TT></span> is a two-digit indicator ranging from 00 to 99. In general, begin with 00 and work your way up. No more than 32 <TT>SORTWK</TT><span class="docEmphasis"><TT>xx</TT></span> data sets will be used by <TT>DFSORT</TT>.</P>
<P class="docText">All the data sets allocated to the <TT>SORTWK</TT><span class="docEmphasis"><TT>xx</TT></span> <TT>DD</TT> statements must be allocated on the same media type. Although <TT>DFSORT</TT> permits the allocation of work data sets to a tape unit, avoid doing this for DB2 utilities because it causes severe performance degradation. Additionally, the <TT>SORTWK</TT><span class="docEmphasis"><TT>xx</TT></span> <TT>DD</TT> statements must be allocated on the same type of unit (for example, one <TT>SORTWK</TT><span class="docEmphasis"><TT>xx</TT></span> data set cannot be allocated to a 3390 device if the others are allocated to 3380 devices).<A NAME="ch37index51"></A><A NAME="ch37index52"></A></P>
<P class="docText">Specify the <TT>SPACE</TT> allocation for the <TT>SORTWK</TT><span class="docEmphasis"><TT>xx</TT></span> data sets in cylinder increments. If you don't, <TT>DFSORT</TT> will reallocate the data sets in cylinder increments anyway.</P>
<P class="docText">For performance, specifying one or two large <TT>SORTWK</TT><span class="docEmphasis"><TT>xx</TT></span> data sets is preferable to specifying multiple smaller data sets. For more information on <TT>DFSORT</TT>, consult the <span class="docEmphasis">IBM DFSORT Application Programming Guide</span> (SC33-4035).</P>
<A NAME="ch37lev4sec10"></A><H4 class="docSection2Title">When Loading or Reorganizing, Specify <TT>LOG NO</TT></H4>
<P class="docText">To reduce the overhead associated with the <TT>LOAD</TT> and <TT>REORG</TT> job, use <TT>LOG NO</TT>. DB2 logs every modification to DB2 data, except when the <TT>LOAD</TT> and <TT>REORG</TT> utilities run with the <TT>LOG NO</TT> option. When you use <TT>LOG NO</TT>, however, an image copy must be taken after the successful completion of the <TT>LOAD</TT> or <TT>REORG</TT> job.<A NAME="ch37index53"></A><A NAME="ch37index54"></A><A NAME="ch37index55"></A><A NAME="ch37index56"></A></P>
<A NAME="ch37lev4sec11"></A><H4 class="docSection2Title">When Loading or Reorganizing, Perform Inline Utilities</H4>
<P class="docText">To eliminate the need to run subsequent <TT>RUNSTATS</TT> and <TT>COPY</TT> after a <TT>LOAD</TT> or <TT>REORG</TT>, use DB2's capability to generate statistics and make image copies as a part of the <TT>LOAD</TT> or <TT>REORG</TT> utility.</P>
<P class="docText">Use the <TT>STATISTICS</TT> clause to indicate that inline statistics are to be generated.<A NAME="ch37index57"></A><A NAME="ch37index58"></A><A NAME="ch37index59"></A><A NAME="ch37index60"></A></P>
<P class="docText">Specify <TT>COPYDDN</TT> data sets (and <TT>RECOVERYDDN</TT> data sets if off-site copies are desired) to indicate that inline image copies are to be made.</P>
<A NAME="ch37lev4sec12"></A><H4 class="docSection2Title">Back Up Data Using the <TT>COPY</TT> Utility</H4>
<P class="docText">Use the <TT>COPY</TT> utility to back up data rather than <TT>DSN1COPY</TT>. <TT>DSN1COPY</TT> operates "behind DB2's back." If you always use the <TT>COPY</TT> utility, DB2 will have an accurate record of all backup data sets.<A NAME="ch37index61"></A><A NAME="ch37index62"></A><A NAME="ch37index63"></A></P>
<A NAME="ch37lev4sec13"></A><H4 class="docSection2Title"><TT>REBUILD INDEX</TT> Versus <TT>CREATE INDEX</TT></H4>
<P class="docText">For very large existing tables, it is quicker to use the <TT>REBUILD INDEX</TT> utility to build an index than to simply issue a <TT>CREATE INDEX</TT> statement. <TT>REBUILD INDEX</TT> is more efficient because it uses an external sort. The <TT>REBUILD INDEX</TT> utility is designed to rebuild indexes, not initially build them as part of a <TT>CREATE</TT> statement.<A NAME="ch37index64"></A><A NAME="ch37index65"></A><A NAME="ch37index66"></A><A NAME="ch37index67"></A><A NAME="ch37index68"></A><A NAME="ch37index69"></A></P>
<P class="docText">The <TT>CREATE INDEX</TT> DDL provides the option to defer index population by specifying <TT>DEFER YES</TT>. This causes an index to be built as an empty shell. After the index is created, it will be put into a rebuild pending status. The <TT>REBUILD INDEX</TT> utility can then be executed to populate the index. This process is usually much more efficient for indexes on very large tables.</P>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch37.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch37lev1sec2.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
