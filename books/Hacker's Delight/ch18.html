<html xmlns="http://www.w3.org/1999/xhtml">
   
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      
      <title>Chapter 18. Formulas For Primes</title>
      
      <link href="9780133085013.css" rel="stylesheet" type="text/css" />
      
      <link href="page-template.xpgt" rel="stylesheet" type="application/vnd.adobe-page-template+xml" />
      
      <meta content="urn:uuid:767ce45a-85bb-4273-91f5-801bab42906b" name="Adept.expected.resource" />
      
   </head>
   
   <body>
      
      <h2><a id="page_391"></a><a id="ch18"></a>Chapter 18. Formulas For Primes
      </h2>
      
      <h3><a id="ch18lev1"></a><strong>18–1 Introduction</strong></h3>
      
      <p class="noindent">Like many young students, I once became fascinated with prime numbers and tried to
         find a formula for them. I didn’t know exactly what operations would be considered
         valid in a “formula,” or exactly what function I was looking for—a formula for the
         <em>n</em>th prime in terms of <em>n</em>, or in terms of the previous prime(s), or a formula that produces primes but not
         all of them, or something else. Nevertheless, in spite of these ambiguities, I would
         like to discuss a little of what is known about this problem. We will see that (a)
         there <em>are</em> formulas for primes, and (b) none of them are very satisfying.
      </p>
      
      <p class="indent">Much of this subject relates to the present work in that it deals with formulas similar
         to those of some of our programming tricks, albeit in the domain of real number arithmetic
         rather than “computer arithmetic.” Let us first review a few highlights from the history
         of this subject.
      </p>
      
      <p class="indent">In 1640, Fermat conjectured that the formula</p>
      
      <p class="center"><em>F<sub>n</sub></em> = 2<sup>2</sup><sup><em>n</em></sup> +1
      </p>
      
      <p class="noindent">always produces a prime, and numbers of this form have come to be called “Fermat numbers.”
         It is true that <em>F<sub>n</sub></em> is prime for <em>n</em> ranging from 0 to 4, but Euler found in 1732 that
      </p>
      
      <p class="center"><em>F</em><sub>5</sub> = 2<sup>2</sup><sup>5</sup> + 1 = 641 · 6700417.
      </p>
      
      <p class="noindent">(We have seen these factors before in connection with dividing by a constant on a
         32-bit machine). Then, F. Landry showed in 1880 that
      </p>
      
      <p class="center"><em>F</em><sub>6</sub> = 2<sup>2</sup><sup>6</sup> + 1 = 274177·67280421310721.
      </p>
      
      <p class="indent"><em>F<sub>n</sub></em> is now known to be composite for many larger values of <em>n</em>, such as all <em>n</em> from 7 to 16 inclusive. For no value of <em>n</em> &gt; 4 is it known to be prime [H&amp;W]. So much for rash conjectures.<sup><a id="ch18fna1"></a><a href="footnotes.html#ch18fn1">1</a></sup></p>
      
      <p class="indent">Incidentally, why would Fermat be led to the double exponential? He knew that if <em>m</em> has an odd factor other than 1, then <em>2<sup>m</sup></em> + 1 is composite. For if <em>m</em> = <em>ab</em> with <em>b</em> odd and not equal to 1, then
      </p>
      
      <p class="center">2<sup><em>ab</em></sup> + 1 = (2<sup><em>a</em></sup> + 1)(2<sup><em>a</em>(<em>b</em> – 1)</sup> –2<sup><em>a</em>(<em>b</em> – 2)</sup> +2<sup><em>a</em>(<em>b</em> – 3)</sup> –...+1.
      </p>
      
      <p class="noindent"><a id="page_392"></a>Knowing this, he must have wondered about 2<sup><em>m</em></sup> + 1 with <em>m</em> not containing any odd factors (other than 1)—that is, <em>m</em> = 2<sup><em>n</em></sup>. He tried a few values of <em>n</em> and found that 2<sup>2</sup><sup><em>n</em></sup> + 1 seemed to be prime.
      </p>
      
      <p class="indent">Certainly everyone would agree that a polynomial qualifies as a “formula.” One rather
         amazing polynomial was discovered by Leonhard Euler in 1772. He found that
      </p>
      
      <p class="center"><em>f</em>(<em>n</em>) = <em>n</em><sup>2</sup> + <em>n</em> + 41
      </p>
      
      <p class="noindent">is prime-valued for every <em>n</em> from 0 to 39. His result can be extended. Because
      </p>
      
      <p class="center"><em>f</em>(–<em>n</em>) = <em>n</em><sup>2</sup> <em>n</em> + 41 = <em>f</em>(<em>n</em> –1),
      </p>
      
      <p class="noindent"><em>f</em>(–<em>n</em>) is prime-valued for every <em>n</em> from 1 to 40; that is, <em>f</em>(<em>n</em>) is prime-valued for every <em>n</em> from –1 to –40. Therefore,
      </p>
      
      <p class="center"><em>f</em>(<em>n</em> –40) = (<em>n</em> –40)<sup>2</sup> + (<em>n</em> –40) + 41 = <em>n</em><sup>2</sup> – 79<em>n</em> + 1601
      </p>
      
      <p class="noindent">is prime-valued for every <em>n</em> from 0 to 79. (However, it is lacking in aesthetic appeal because it is nonmonotonic
         and it repeats; that is, for <em>n</em> = 0, 1, ..., 79, <em>n</em><sup>2</sup>–79 <em>n</em> + 1601 = 1601, 1523, 1447, ..., 43, 41, 41, 43, ..., 1447, 1523, 1601.)
      </p>
      
      <p class="indent">In spite of this success, it is now known that there is no polynomial <em>f(n)</em> that produces a prime for every <em>n</em> (aside from constant polynomials such as <em>f(n) =</em> 5). In fact, any nontrivial “polynomial in exponentials” is composite infinitely
         often. More precisely, as stated in [H &amp; W],
      </p>
      
      <p class="indent">THEOREM. <em>If f(n) = p(n</em>, 2<sup><em>n</em></sup>, 3<sup><em>n</em></sup>,..., <em>kn</em>) <em>is a polynomial in its arguments, with integral coefficients, and f(n) → ∞ when n
            → ∞, then f(n) is composite for an infinity of values of n</em>.
      </p>
      
      <p class="noindent">Thus, a formula such as <em>n</em><sup>2</sup> · 2<sup><em>n</em></sup> + 2<em>n</em><sup>3</sup> + <em>2n</em> + 5 must produce an infinite number of composites. On the other hand, the theorem
         says nothing about formulas containing terms such as 2<sup>2</sup><sup><em>n</em></sup>, <em>n<sup>n</sup></em>, and <em>n</em>!.
      </p>
      
      <p class="indent">A formula for the <em>n</em>th prime, in terms of <em>n</em>, can be obtained by using the floor function and a magic number
      </p>
      
      <p class="center"><em>a =</em> 0.203005000700011000013....
      </p>
      
      <p class="noindent">The number <em>a</em> is, in decimal, the first prime written in the first place after the decimal point,
         the second prime written in the next two places, the third prime written in the next
         three places, and so on. There is always room for the <em>n</em>th prime, because <em>p<sub>n</sub></em> &lt; 10<em><sup>n</sup></em>. We will not prove this, except to point out that it is known that there is always
         a prime between <em>n</em> and <em>2n</em> (for <em>n ≥ 2</em>), and hence certainly at least one between <em>n</em> and 10<em>n</em>, from which it follows that <em>p<sub>n</sub></em> &lt; 10<sup><em>n</em></sup>. The formula for the <em>n</em>th prime is
      </p>
      
      <div class="image"><a id="page_393"></a><img alt="Image" src="graphics/393equ01.jpg" /></div>
      
      <p class="noindent">where we have used the relation 1 + 2 + 3 + ... + <em>n</em> = (<em>n</em><sup>2</sup> + <em>n</em>) / 2. For example,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/393equ02.jpg" /></div>
      
      <p class="indent">This is a pretty cheap trick, as it requires knowledge of the result to define <em>a</em>. The formula would be interesting if there were some way to define <em>a</em> independent of the primes, but no one knows of such a definition.
      </p>
      
      <p class="indent">Obviously, this technique can be used to obtain a formula for many sequences, but
         it begs the question.
      </p>
      
      <h3><a id="ch18lev2"></a><strong>18–2 Willans’s Formulas</strong></h3>
      
      <p class="noindent">C. P. Willans gives the following formula for the <em>n</em>th prime [Will]:
      </p>
      
      <div class="image"><img alt="Image" src="graphics/393equ03.jpg" /></div>
      
      <p class="noindent">The derivation starts from Wilson’s theorem, which states that <em>p</em> is prime or 1 if and only if (<em>p</em> -1)! = –1(mod<em>p</em>). Thus,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/393equ04.jpg" /></div>
      
      <p class="noindent">is an integer for <em>x</em> prime or <em>x</em> = 1 and is fractional for all composite <em>x</em>. Hence,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/393equ05.jpg" /></div>
      
      <p class="noindent">Thus, if <em>π(m)</em> denotes<sup><a id="ch18fna2"></a><a href="footnotes.html#ch18fn2">2</a></sup> the number of primes ≤ <em>m</em>,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/393equ06.jpg" /></div>
      
      <p class="noindent"><a id="page_394"></a>Observe that π(<em>p<sub>n</sub></em>) = <em>n</em>, and furthermore,
      </p>
      
      <p class="center"><em>π(m)&lt;n</em>, for <em>m &lt;p<sub>n</sub></em>, and
      </p>
      
      <p class="center"><em>π(m)≥n</em>, for <em>m≥p<sub>n</sub></em>.
      </p>
      
      <p class="noindent">Therefore, the number of values of <em>m</em> from 1 to ∞ for which <em>π(m) &lt;n</em> is <em>p<sub>n</sub></em> – 1. That is,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/394equ01.jpg" /></div>
      
      <p class="noindent">where the summand is a “predicate expression” (0/1-valued).</p>
      
      <p class="indent">Because we have a formula for <em>π(m)</em>, Equation (3) constitutes a formula for the wth prime as a function of <em>n</em>. But it has two features that might be considered unacceptable: an infinite summation
         and the use of a “predicate expression,” which is not in standard mathematical usage.
      </p>
      
      <p class="indent">It has been proved that for <em>n</em> ≥ 1 there is at least one prime between <em>n</em> and <em>2n</em>. Therefore, the number of primes ≤ 2<sup><em>n</em></sup> is at least <em>n—</em> that is, π(2<sup><em>n</em></sup>) ≥ <em>n</em>. Thus, the predicate <em>π(m) &lt; n</em> is 0 for <em>m ≥</em> 2<sup><em>n</em></sup>, so the upper limit of the summation above can be replaced with 2<sup><em>n</em></sup>.
      </p>
      
      <p class="indent">Willans has a rather clever substitute for the predicate expression. Let</p>
      
      <div class="image"><img alt="Image" src="graphics/394equ02.jpg" /></div>
      
      <p class="noindent">Then, if <em>x &lt; y</em>, 1 ≤<em>y</em> /(1 +<em>x</em>) ≤<em>y</em>, so <img alt="Image" src="graphics/394fig01.jpg" />. Furthermore, if <em>x ≥ y</em>, then 0 &lt;<em>y</em> /(1 + <em>x</em>) &lt; 1, so <img alt="Image" src="graphics/394fig02.jpg" />. Applying the floor function, we have
      </p>
      
      <div class="image"><img alt="Image" src="graphics/394equ03.jpg" /></div>
      
      <p class="noindent">That is, LT(<em>x, y</em>) is the predicate <em>x</em> &lt; <em>y</em> (for <em>x</em> and <em>y</em> in the given ranges).
      </p>
      
      <p class="indent">Substituting, Equation (3) can be written</p>
      
      <div class="image"><img alt="Image" src="graphics/394equ04.jpg" /></div>
      
      <p class="noindent">Further substituting Equation (2) for <em>π(m)</em> in terms of <em>F(x)</em>, and Equation (1) for <em>F(x)</em>, gives the formula shown at the beginning of this section.
      </p>
      
      <h4><a id="page_395"></a><strong>Second Formula</strong></h4>
      
      <p class="noindent">Willans then gives another formula:</p>
      
      <div class="image"><img alt="Image" src="graphics/395equ01.jpg" /></div>
      
      <p class="noindent">Here, <em>F</em> and <em>π</em> are the functions used in his first formula. Thus, <em>mF(m) = m</em> if <em>m</em> is prime or 1, and 0 otherwise. The third factor in the summand is the predicate
         <em>π(m) = n</em>. The summand is 0 except for one term, which is the <em>n</em>th prime. For example,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/395equ02.jpg" /></div>
      
      <h4><strong>Third Formula</strong></h4>
      
      <p class="noindent">Willans goes on to present another formula for the <em>n</em>th prime that does not use any “nonanalytic”<sup><a id="ch18fna3"></a><a href="footnotes.html#ch18fn3">3</a></sup> functions such as floor and absolute value. He starts by noting that for <em>x</em> = 2, 3, ..., the function
      </p>
      
      <div class="image"><img alt="Image" src="graphics/395equ03.jpg" /></div>
      
      <p class="noindent">The first part follows from</p>
      
      <div class="image"><img alt="Image" src="graphics/395equ04.jpg" /></div>
      
      <p class="noindent">and <em>x</em> divides (<em>x</em> – 1)! + 1, by Wilson’s theorem. Thus, the predicate “<em>x</em> is prime,” for <em>x</em> ≥ 2, is given by
      </p>
      
      <div class="image"><img alt="Image" src="graphics/395equ05.jpg" /></div>
      
      <p class="noindent">From this it follows that</p>
      
      <div class="image"><img alt="Image" src="graphics/395equ06.jpg" /></div>
      
      <p class="indent"><a id="page_396"></a>This cannot be converted to a formula for <em>p<sub>n</sub></em> by the methods used in the first two formulas, because they use the floor function.
         Instead, Willans suggests the following formula<sup><a id="ch18fna4"></a><a href="footnotes.html#ch18fn4">4</a></sup> for the predicate <em>x &lt;y</em>, for <em>x, y</em> ≥ 1:
      </p>
      
      <div class="image"><img alt="Image" src="graphics/396equ01.jpg" /></div>
      
      <p class="noindent">Thus, if <em>x</em> &lt; <em>y, e</em> = <em>x</em> (<em>x</em> – 1)...(0)(–1)...(<em>x</em> –(<em>y</em> – 1)) = 0, so that <em>LT(x,y) =</em> sin(π/2) = 1. If <em>x ≥ y</em>, the product does not include 0, so <em>e</em> ≥ l, so that LT<em>(x,y) =</em> sin((π/2) · (an even number)) = 0.
      </p>
      
      <p class="indent">Finally, as in the first of Willans’s formulas,</p>
      
      <div class="image"><img alt="Image" src="graphics/396equ02.jpg" /></div>
      
      <p class="indent">Written out in full, this is the rather formidable</p>
      
      <div class="image"><img alt="Image" src="graphics/396equ03.jpg" /></div>
      
      <h4><strong>Fourth Formula</strong></h4>
      
      <p class="noindent">Willans then gives a formula for <em>p<sup>n</sup></em> + 1 in terms of <em>p<sub>n</sub></em>:
      </p>
      
      <div class="image"><img alt="Image" src="graphics/396equ04.jpg" /></div>
      
      <p class="noindent">where <em>f(x)</em> is the predicate “<em>x</em> is composite,” for <em>x</em> ≥ 2; that is,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/396equ05.jpg" /></div>
      
      <p class="noindent">Alternatively, one could use <em>f</em>(<em>x</em>) = 1 – <em>H</em>(<em>x</em>), to keep the formula free of floor functions.
      </p>
      
      <p class="indent"><a id="page_397"></a>As an example of this formula, let <em>p<sub>n</sub></em> = 7. Then,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/397equ01.jpg" /></div>
      
      <h3><a id="ch18lev3"></a><strong>18–3 Wormell’s Formula</strong></h3>
      
      <p class="noindent">C. P. Wormell [Wor] improves on Willans’s formulas by avoiding both trigonometric
         functions and the floor function. Wormell’s formula can, in principle, be evaluated
         by a simple computer program that uses only integer arithmetic. The derivation does
         not use Wilson’s theorem. Wormell starts with, for <em>x</em> ≥ 2,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/397equ02.jpg" /></div>
      
      <p class="noindent">Thus, the number of primes ≤ <em>m</em> is given by
      </p>
      
      <div class="image"><img alt="Image" src="graphics/397equ03.jpg" /></div>
      
      <p class="noindent">because the summand is the predicate “<em>x</em> is prime.”
      </p>
      
      <p class="indent">Observe that, for <em>n</em> ≥ 1, <em>a</em> ≥ 0,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/397equ04.jpg" /></div>
      
      <p class="noindent">Repeating a trick above, the predicate <em>a &lt; n</em> is
      </p>
      
      <div class="image"><img alt="Image" src="graphics/397equ05.jpg" /></div>
      
      <p class="indent">Because</p>
      
      <div class="image"><img alt="Image" src="graphics/397equ06.jpg" /></div>
      
      <p class="noindent">we have, upon factoring constants out of summations,</p>
      
      <div class="image"><a id="page_398"></a><img alt="Image" src="graphics/398equ01.jpg" /></div>
      
      <p class="indent">As promised, Wormell’s formula does not use trigonometric functions. However, as he
         points out, if the powers of -1 were expanded using (-1)<sup><em>n</em></sup> = cos <em>πn</em>, they would reappear.
      </p>
      
      <h3><a id="ch18lev4"></a><strong>18–4 Formulas for Other Difficult Functions</strong></h3>
      
      <p class="noindent">Let us have a closer look at what Willans and Wormell have done. We postulate the
         rules below as defining what we mean by the class of functions that can be represented
         by “formulas,” which we will call “formula functions.” Here, <img alt="Image" src="graphics/x-bar.jpg" /> is shorthand for <em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>,...,<em>x<sub>n</sub></em> for any <em>n</em> ≥ 1. The domain of values is the integers ... -2, -1, 0, 1, 2, ....
      </p>
      
      <p class="indenthangingN">1. The constants ... -1, 0, 1, ... are formula functions.</p>
      
      <p class="indenthangingN">2. The projection functions <img alt="Image" src="graphics/398fig01.jpg" />, for <em>1≤i≤n</em>, are formula functions.
      </p>
      
      <p class="indenthangingN">3. The expressions <em>x+y, x-y</em>, and <em>xy</em> are formula functions, if <em>x</em> and <em>y</em> are.
      </p>
      
      <p class="indenthangingN">4. The class of formula functions is closed under composition (substitution). That
         is, <img alt="Image" src="graphics/398fig02.jpg" /> is a formula function if <em>f</em> and <em>g<sub>i</sub></em> are, for <em>i</em> = 1, ..., <em>m</em>.
      </p>
      
      <p class="indenthangingN">5. Bounded sums and products, written</p>
      
      <div class="image"><img alt="Image" src="graphics/398equ02.jpg" /></div>
      
      <p class="indent">are formula functions, if <em>a, b</em>, and <em>f</em> are, and <img alt="Image" src="graphics/398fig03.jpg" />.
      </p>
      
      <p class="indent">Sums and products are required to be bounded to preserve the computational character
         of formulas; that is, formulas can be evaluated by plugging in values for the arguments
         and carrying out a finite number of calculations. The reason for the prime on the
         Σ and Π is explained later in this chapter.
      </p>
      
      <p class="indent">When forming new formula functions using composition, we supply parentheses when necessary
         according to well-established conventions.
      </p>
      
      <p class="indent">Notice that division is not included in the list above; that’s too complicated to
         be uncritically accepted as a “formula function.” Even so, the above list is not minimal.
         It might be fun to find a minimal starting point, but we won’t dwell on that here.
      </p>
      
      <p class="indent">This definition of “formula function” is close to the definition of “elementary function”
         given in [Cut]. However, the domain of values used in [Cut] is the <a id="page_399"></a>nonnegative integers (as is usual in recursive function theory). Also, [Cut] requires
         the bounds on the iterated sum and product to be 0 and <em>x</em> – 1 (where <em>x</em> is a variable), and allows the range to be vacuous (in which case the sum is defined
         as 0 and the product is defined as 1).
      </p>
      
      <p class="indent">In what follows, we show that the class of formula functions is quite extensive, including
         most of the functions ordinarily encountered in mathematics. But it doesn’t include
         every function that is easy to define and has an elementary character.
      </p>
      
      <p class="indent">Our development is slightly encumbered, compared to similar developments in recursive
         function theory, because here variables can take on negative values. The possibility
         of a value’s being negative can often be accommodated by simply squaring some expression
         that would otherwise appear in the first power. Our insistence that iterated sums
         and products not be vacuous is another slight encumbrance.
      </p>
      
      <p class="indent">Here, a “predicate” is simply a 0/1-valued function, whereas in recursive function
         theory a predicate is a true/false-valued function, and every predicate has an associated
         “characteristic function” that is 0/1-valued. We associate 1 with true and 0 with
         false, as is universally done in programming languages and in computers (in what their
         <em>and</em> and <em>or</em> instructions do); in logic and recursive function theory, the association is often
         the opposite.
      </p>
      
      <p class="indent">The following are formula functions:</p>
      
      <p class="indenthangingN">1. <em>a</em><sup>2</sup> = <em>aa, a</em><sup>3</sup> = <em>aaa</em>, and so on.
      </p>
      
      <p class="indenthangingN">2. The predicate <em>a</em> = <em>b</em>:
      </p>
      
      <div class="image"><img alt="Image" src="graphics/399equ01.jpg" /></div>
      
      <p class="indenthangingN">3. <em>(a≠b) = 1-(a = b)</em>.
      </p>
      
      <p class="indenthangingN">4. The predicate <em>a ≥ b:</em></p>
      
      <div class="image"><img alt="Image" src="graphics/399equ02.jpg" /></div>
      
      <p class="indenthanging">We can now explain why we do not use the convention that a vacuous iterated sum/product
         has the value 0/1. If we did, we would have such shams as
      </p>
      
      <div class="image"><img alt="Image" src="graphics/399equ03.jpg" /></div>
      
      <p class="indenthanging"><a id="page_400"></a>The comparison predicates are key to everything that follows, and we don’t wish to
         have them based on anything quite that artificial.
      </p>
      
      <p class="indenthangingN">5. <em>(a&gt;b) = (a ≥ b + 1)</em>.
      </p>
      
      <p class="indenthangingN">6. <em>(a ≤ b) = (b ≥ a)</em>.
      </p>
      
      <p class="indenthangingN">7. <em>(a&lt;b) = (b&gt;a)</em>.
      </p>
      
      <p class="indenthangingN">8. <em>|a| =</em> (2(<em>a</em> ≥ 0)-1)<em>a</em>.
      </p>
      
      <p class="indenthangingN">9. <em>max(a,b) = (a≥b)(a-b) + b</em>.
      </p>
      
      <p class="indenthangingN1">10. min(<em>a, b) = (a ≥ b)(b-a) +a</em>.
      </p>
      
      <p class="indenthanging">Now we can fix the iterated sums and products so that they give the conventional and
         useful result when the range is vacuous.
      </p>
      
      <p class="indenthangingN1">11. <img alt="Image" src="graphics/400fig01.jpg" />.
      </p>
      
      <p class="indenthangingN1">12. <img alt="Image" src="graphics/400fig02.jpg" />.
      </p>
      
      <p class="indenthanging">From now on we will use Σ and Π without the prime. All functions thus defined are
         total (defined for all values of the arguments).
      </p>
      
      <p class="indenthangingN1">13. <img alt="Image" src="graphics/400fig03.jpg" />.
      </p>
      
      <p class="indenthanging">This gives <em>n! =</em> 1 for <em>n</em> ≤ 0.
      </p>
      
      <p class="indenthanging">In what follows, <em>P</em> and <em>Q</em> denote predicates.
      </p>
      
      <p class="indenthangingN1">14. <img alt="Image" src="graphics/400fig04.jpg" />.
      </p>
      
      <p class="indenthangingN1">15. <img alt="Image" src="graphics/400fig05.jpg" />.
      </p>
      
      <p class="indenthangingN1">16. <img alt="Image" src="graphics/400fig06.jpg" />.
      </p>
      
      <p class="indenthangingN1">17. <img alt="Image" src="graphics/400fig07.jpg" />.
      </p>
      
      <p class="indenthangingN1">18. if <img alt="Image" src="graphics/400fig09.jpg" /> then <img alt="Image" src="graphics/400fig10.jpg" /> else <img alt="Image" src="graphics/400fig11.jpg" />.
      </p>
      
      <p class="indenthangingN1">19. <em>a<sup>n</sup></em> = if <em>n</em> ≥ 0 then <img alt="Image" src="graphics/400fig12.jpg" /> else 0.
      </p>
      
      <p class="indenthanging">This gives, arbitrarily and perhaps incorrectly for a few cases, the result 0 for
         <em>n &lt;</em> 0, and the result 1 for 0<sup>0</sup>.
      </p>
      
      <p class="indenthangingN1">20. <img alt="Image" src="graphics/400fig13.jpg" />.
      </p>
      
      <p class="indenthangingN1">21. <img alt="Image" src="graphics/400fig14.jpg" />.
      </p>
      
      <p class="indenthanging"><a id="page_401"></a>∀ is vacuously true; ∃ is vacuously false.
      </p>
      
      <p class="indenthangingN1">22. <img alt="Image" src="graphics/401fig01.jpg" />.
      </p>
      
      <p class="indenthanging">The value of this expression is the least <em>x</em> in the range <em>m to n</em> such that the predicate is true, or <em>m</em> if the range is vacuous, or <em>n</em> + 1 if the predicate is false throughout the (nonvacuous) range. The operation is
         called “bounded minimalization” and it is a very powerful tool for developing new
         formula functions. It is a sort of functional inverse, as illustrated by the next
         formula. That minimalization can be done by a sum of products is due to Goodstein
         [Good].
      </p>
      
      <p class="indenthangingN1">23. <img alt="Image" src="graphics/401fig02.jpg" />.
      </p>
      
      <p class="indenthanging">This is the “integer square root” function, which we define to be 0 for <em>n &lt;</em> 0, just to make it a total function.
      </p>
      
      <p class="indenthangingN1">24. <img alt="Image" src="graphics/401fig03.jpg" />.
      </p>
      
      <p class="indenthanging">This is the “d divides n” predicate, according to which 0|0 but ¬(0|<em>n</em>) for <em>n</em>≠0.
      </p>
      
      <p class="indenthangingN1">25. <em>n ÷ d =</em> if <em>n</em> ≥ 0 then (–<em>n</em> ≤min q≤)<img alt="Image" src="graphics/401fig04.jpg" />(<em>n</em> = <em>qd + r)</em> else <em>(n</em> ≤ min <em>q</em> ≤ – <em>n</em>)<img alt="Image" src="graphics/401fig05.jpg" />(<em>n</em> = <em>qd + r)</em>.
      </p>
      
      <p class="indenthanging">This is the conventional truncating form of integer division. For <em>d</em> = 0, it gives a result of <em>\n\</em> + 1, arbitrarily.
      </p>
      
      <p class="indenthangingN1">26. rem(<em>n, d) = n-(n ÷ d)d</em>.
      </p>
      
      <p class="indenthanging">This is the conventional remainder function. If rem (<em>n, d</em>) is nonzero, it has the sign of the numerator <em>n</em>. If <em>d =</em> 0, the remainder is <em>n</em>.
      </p>
      
      <p class="indenthangingN1">27. isprime<img alt="Image" src="graphics/401fig06.jpg" />.
      </p>
      
      <p class="indenthangingN1">28. <img alt="Image" src="graphics/401fig07.jpg" /> isprime(<em>i</em>).
      </p>
      
      <p class="indenthanging">(Number of primes ≤<em>n</em>.)
      </p>
      
      <p class="indenthangingN1">29. <em>p<sub>n</sub></em> = (1 ≤ min <em>k</em> ≤2<sup><em>n</em></sup>)(π(<em>k</em>) = <em>n</em>).
      </p>
      
      <p class="indenthangingN1">30. exponent (<em>p, n</em>) = (0 ≤ min <em>x</em> ≤ |<em>n</em> |)¬(<em>p<sup>x+1</sup></em> |<em>n</em>).
      </p>
      
      <p class="indenthanging">This is the exponent of a given prime factor <em>p</em> of <em>n</em>, for <em>n ≥</em> 1.
      </p>
      
      <p class="indenthangingN1">31. For <em>n</em> ≥ 0:
      </p>
      
      <div class="image"><img alt="Image" src="graphics/401fig08.jpg" /></div>
      
      <p class="indenthangingN1">32. The <em>n</em>th digit after the decimal point in the decimal expansion of <img alt="Image" src="graphics/401fig09.jpg" />: rem <img alt="Image" src="graphics/401fig10.jpg" />.
      </p>
      
      <p class="indent"><a id="page_402"></a>Thus, the class of formula functions is quite large. It is limited, though, by the
         following theorem (at least):
      </p>
      
      <p class="indent">T<small>HEOREM</small>. <em>If f is a formula function, then there is a constant k such that</em></p>
      
      <div class="image"><img alt="Image" src="graphics/402equ01.jpg" /></div>
      
      <p class="indent"><em>where there are k 2’s</em>.
      </p>
      
      <p class="indent">This can be proved by showing that each application of one of the rules 1–5 (on page
         <a href="ch18.html#page_398">398</a>) preserves the theorem. For example, if <img alt="Image" src="graphics/402fig03.jpg" /> (rule 1), then for some <em>h</em>,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/402equ02.jpg" /></div>
      
      <p class="noindent">where there are <em>h</em> 2’s. Therefore,
      </p>
      
      <div class="image"><img alt="Image" src="graphics/402equ03.jpg" /></div>
      
      <p class="noindent">because max(|<em>x</em><sub>1</sub>|, ..., |<em>x<sub>n</sub></em> |) ≥ 0.
      </p>
      
      <p class="indent">For <img alt="Image" src="graphics/402fig01.jpg" /> (rule 2), <img alt="Image" src="graphics/402fig02.jpg" /> max (|<em>x</em><sub>1</sub>|, ..., |<em>x<sub>n</sub></em> |), so the theorem holds with <em>k</em> = 0.
      </p>
      
      <p class="indent">For rule 3, let</p>
      
      <div class="image"><img alt="Image" src="graphics/402equ04.jpg" /></div>
      
      <p class="noindent">Then, clearly</p>
      
      <div class="image"><img alt="Image" src="graphics/402equ05.jpg" /></div>
      
      <p class="indent">Similarly, it can be shown that the theorem holds for <em>f</em>(<em>x, y</em>) = <em>xy</em>.
      </p>
      
      <p class="indent">The proofs that rules 4 and 5 preserve the theorem are a bit tedious, but not difficult,
         and are omitted.
      </p>
      
      <p class="indent">From the theorem, it follows that the function</p>
      
      <div class="image"><img alt="Image" src="graphics/402equ06.jpg" /></div>
      
      <p class="noindent">is not a formula function, because for sufficiently large <em>x</em>, Equation (4) exceeds the value of the same expression with any fixed number <em>k</em> of 2’s.
      </p>
      
      <p class="indent"><a id="page_403"></a>For those interested in recursive function theory, we point out that Equation (4)
         is primitive recursive. Furthermore, it is easy to show directly from the definition
         of primitive recursion that formula functions are primitive recursive. Therefore,
         the class of formula functions is a proper subset of the primitive recursive functions.
         The interested reader is referred to [Cut].
      </p>
      
      <p class="indent">In summary, this section shows that not only is there a formula in elementary functions
         for the <em>n</em>th prime but also for a good many other functions encountered in mathematics. Furthermore,
         our “formula functions” are not based on trigonometric functions, the floor function,
         absolute value, powers of -1, or even division. The only sneaky maneuver is to use
         the fact that the product of a lot of numbers is 0 if any one of them is 0, which
         is used in the formula for the predicate <em>a = b</em>.
      </p>
      
      <p class="indent">It is true, however, that once you see them, they are not interesting. The quest for
         “interesting” formulas for primes should go on. For example, [Rib] cites the amazing
         theorem of W. H. Mills (1947) that there exists a θ such that the expression
      </p>
      
      <div class="image"><img alt="Image" src="graphics/403fig01.jpg" /></div>
      
      <p class="noindent">is prime-valued for all <em>n</em> ≥ 1. Actually, there are an infinite number of such values (e.g., 1.3063778838+ and
         1.4537508625483+). Furthermore, there is nothing special about the “3”; the theorem
         is true if the 3 is replaced with any real number ≥2.106 (for different values of
         θ). Better yet, the 3 can be replaced with 2 if it is true that there is always a
         prime between <em>n</em><sup>2</sup> and (<em>n</em> + 1)<sup>2</sup>, which is almost certainly true, but has never been proved. And furthermore, ...
         well, the interested reader is referred to [Rib] and to [Dud] for more fascinating
         formulas of this type.
      </p>
      
      <h4><strong>Exercises</strong></h4>
      
      <p class="question"><a href="ch19_answer.html#ch18ans1" id="ch18ansa1"><strong>1</strong>.</a> Prove that for any non-constant polynomial <em>f(x)</em> with integral coefficients, |<em>f(x)</em> | is composite for an infinite number of values of <em>x</em>.
      </p>
      
      <p class="indenthanging"><em>Hint:</em> If <em>f(x</em><sub>0</sub>) = <em>k</em>, consider <em>f(x<sub>0</sub> + rk)</em>, where <em>r</em> is an integer greater than 1.
      </p>
      
      <p class="question"><a href="ch19_answer.html#ch18ans2" id="ch18ansa2"><strong>2</strong>.</a> Prove Wilson’s theorem: An integer <em>p</em> &gt; 1 is prime if and only if
      </p>
      
      <p class="center"><em>(p-</em> 1)! ≡ -1 (mod <em>p</em>).
      </p>
      
      <p class="indenthanging"><em>Hint:</em> To show that if <em>p</em> is prime, then <em>(p-1)</em>! ≡ –1 (mod <em>p)</em>, group the terms of the factorial in pairs <em>(a, b)</em> such that <em>ab ≡</em> 1 (mod <em>p)</em>. Use Theorem MI of <a href="ch10.html#ch10lev16">Section 10–16</a> on page <a href="ch10.html#page_240">240</a>.
      </p>
      
      <p class="question"><a href="ch19_answer.html#ch18ans3" id="ch18ansa3"><strong>3</strong>.</a> Show that if <em>n</em> is a composite integer greater than 4, then
      </p>
      
      <p class="center"><em>(n-1)!=0</em> (mod <em>n</em>).
      </p>
      
      <p class="question"><a id="page_404"></a><a href="ch19_answer.html#ch18ans4" id="ch18ansa4"><strong>4</strong>.</a> Calculate an estimate of the value of θ that satisfies Mills’s theorem, and in the
         process give an informal proof of the theorem. Assume that for <em>n</em> &gt; 1 there exists a prime between <em>n</em><sup>3</sup> and <em>(n</em> + 1)<sup>3</sup>. (This depends upon the Riemann Hypothesis, although it has been proved independent
         of RH for sufficiently large <em>n.)</em></p>
      
      <p class="question"><a href="ch19_answer.html#ch18ans5" id="ch18ansa5"><strong>5</strong>.</a> Consider the set of numbers of the form <img alt="Image" src="graphics/404fig01.jpg" />, where <em>a</em> and <em>b</em> are integers. Show that 2 and 3 are primes in this set; that is, they cannot be decomposed
         into factors in the set unless one of the factors is ±1 (a “unit”). Find a number
         in the set that has two distinct decompositions into products of primes. (The “fundamental
         theorem of arithmetic” states that prime decomposition is unique except for units
         and the order of the factors. Uniqueness does not hold for this set of numbers with
         multiplication and addition being that of complex numbers. It is an example of a “ring.”).
      </p>
      
   </body>
   
</html>