<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>&#9733; 4.4: Proof of the master theorem</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0026.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0028.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch04"></a>
<div class="section">
<h2 class="first-section-title">
<a name="253"></a><a name="ch04lev1sec4"></a><span class="section-titlelabel">&#9733; 4.4: </span>Proof of the master theorem</h2>
<a name="254"></a><a name="IDX-76"></a>
<p class="para">This section contains a proof of the master theorem (<a href="DDU0026.html#244" target="_parent" class="chapterjump">Theorem 4.1</a>). The proof need not be understood in order to apply the theorem.</p>
<p class="para">The proof is in two parts. The first part analyzes the "master" recurrence (<a href="DDU0026.html#242" target="_parent" class="chapterjump">4.5</a>), under the simplifying assumption that <i class="emphasis">T</i>(<i class="emphasis">n</i>) is defined only on exact powers of <i class="emphasis">b</i> <span class="unicode">&gt;</span> 1, that is, for <i class="emphasis">n</i> = 1, <i class="emphasis">b</i>, <i class="emphasis">b</i><sup>2</sup>, ..<span class="unicode">&#8229;</span> This part gives all the intuition needed to understand why the master theorem is true. The second part shows how the analysis can be extended to all positive integers <i class="emphasis">n</i> and is merely mathematical technique applied to the problem of handling floors and ceilings.</p>
<p class="para">In this section, we shall sometimes abuse our asymptotic notation slightly by using it to describe the behavior of functions that are defined only over exact powers of <i class="emphasis">b</i>. Recall that the definitions of asymptotic notations require that bounds be proved for all sufficiently large numbers, not just those that are powers of <i class="emphasis">b</i>. Since we could make new asymptotic notations that apply to the set {<i class="emphasis">b<sup>i</sup></i> : <i class="emphasis">i</i> = 0, 1,...}, instead of the nonnegative integers, this abuse is minor.</p>
<p class="para">Nevertheless, we must always be on guard when we are using asymptotic notation over a limited domain so that we do not draw improper conclusions. For example, proving that <i class="emphasis">T</i> (<i class="emphasis">n</i>) = <i class="emphasis">O</i>(<i class="emphasis">n</i>) when <i class="emphasis">n</i> is an exact power of 2 does not guarantee that <i class="emphasis">T</i> (<i class="emphasis">n</i>) = <i class="emphasis">O</i>(<i class="emphasis">n</i>). The function <i class="emphasis">T</i> (<i class="emphasis">n</i>) could be defined as</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig98_01.jpg" height="40" width="210" alt="" border="0"></span>
</div>
<p class="para">in which case the best upper bound that can be proved is <i class="emphasis">T</i> (<i class="emphasis">n</i>) = <i class="emphasis">O</i>(<i class="emphasis">n</i><sup>2</sup>). Because of this sort of drastic consequence, we shall never use asymptotic notation over a limited domain without making it absolutely clear from the context that we are doing so.</p>
<div class="section">
<h3 class="sect3-title">
<a name="255"></a><a name="ch04lev2sec1"></a><span class="section-titlelabel">4.4.1 </span>The proof for exact powers</h3>
<p class="first-para">The first part of the proof of the master theorem analyzes the recurrence (<a href="DDU0026.html#242" target="_parent" class="chapterjump">4.5</a>)</p>
<p class="para">
<i class="emphasis">T</i> (<i class="emphasis">n</i>) = <i class="emphasis">aT</i> (<i class="emphasis">n</i>/<i class="emphasis">b</i>) + <i class="emphasis">f</i> (<i class="emphasis">n</i>) ,</p>
<p class="para">for the master method, under the assumption that <i class="emphasis">n</i> is an exact power of <i class="emphasis">b</i> <span class="unicode">&gt;</span> 1, where <i class="emphasis">b</i> need not be an integer. The analysis is broken into three lemmas. The first reduces the problem of solving the master recurrence to the problem of evaluating an expression that contains a summation. The second determines bounds on this summation. The third lemma puts the first two together to prove a version of the master theorem for the case in which <i class="emphasis">n</i> is an exact power of <i class="emphasis">b</i>.<a name="256"></a><a name="IDX-77"></a>
</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 4.2</span></span><a name="257"></a><a name="ch04ex18"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">a</i> <span class="unicode">&ge;</span> 1 and <i class="emphasis">b</i> <span class="unicode">&gt;</span> 1 be constants, and let <i class="emphasis">f</i> (<i class="emphasis">n</i>) be a nonnegative function defined on exact powers of <i class="emphasis">b</i>. Define <i class="emphasis">T</i> (<i class="emphasis">n</i>) on exact powers of <i class="emphasis">b</i> by the recurrence</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig99_03.jpg" height="37" width="230" alt="" border="0"></span>
</div>
<p class="para">where <i class="emphasis">i</i> is a positive integer. Then</p>
<p class="para">
<div class="equation">
<a name="258"></a><a name="ch04eq06"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(4.6)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig99_04.jpg" height="45" width="235" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> We use the recursion tree in <a class="internaljump" href="#ch04fig03">Figure 4.3</a>. The root of the tree has cost <i class="emphasis">f</i> (<i class="emphasis">n</i>), and it has <i class="emphasis">a</i> children, each with cost <i class="emphasis">f</i> (<i class="emphasis">n</i>/<i class="emphasis">b</i>). (It is convenient to think of <i class="emphasis">a</i> as being an integer, especially when visualizing the recursion tree, but the mathematics does not require it.) Each of these children has <i class="emphasis">a</i> children with cost <i class="emphasis">f</i> (<i class="emphasis">n</i>/<i class="emphasis">b</i><sup>2</sup>), and thus there are <i class="emphasis">a</i><sup>2</sup> nodes that are distance 2 from the root. In general, there are <i class="emphasis">a<sup>j</sup></i> nodes <a name="259"></a><a name="IDX-78"></a>that are distance <i class="emphasis">j</i> from the root, and each has cost <i class="emphasis">f</i> (<i class="emphasis">n</i>/<i class="emphasis">b<sup>j</sup></i>). The cost of each leaf is <i class="emphasis">T</i> (1) = <span class="unicode">&Theta;</span>(1), and each leaf is at depth log<i class="emphasis"><sub>b</sub> n</i>, since <span class="inlinemediaobject"><img src="images/fig100_01.jpg" height="14" width="59" alt="" border="0"></span>. There are <span class="inlinemediaobject"><img src="images/fig100_02.jpg" height="11" width="66" alt="" border="0"></span> leaves in the tree.</p>
<p class="para">
<div class="figure">
<a name="260"></a><a name="ch04fig03"></a><span class="figuremediaobject"><a href="images/fig99%5F02%5F0%2Ejpg" NAME="IMG_139" target="_parent"><img src="images/fig99_02.jpg" height="214" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 4.3: </span>The recursion tree generated by <i class="emphasis">T</i> (<i class="emphasis">n</i>) = <i class="emphasis">aT</i> (<i class="emphasis">n/b</i>) + <i class="emphasis">f</i> (<i class="emphasis">n</i>). The tree is a complete <i class="emphasis">a</i>-ary tree with <span class="inlinemediaobject"><img src="images/fig99_01.jpg" height="11" width="25" alt="" border="0"></span> leaves and height log<i class="emphasis"><sub>b</sub> n</i>. The cost of each level is shown at the right, and their sum is given in equation (4.6).</span>
</div>
</p>
<p class="para">We can obtain <a class="internaljump" href="#ch04eq06">equation (4.6)</a> by summing the costs of each level of the tree, as shown in the figure. The cost for a level <i class="emphasis">j</i> of internal nodes is <i class="emphasis">a<sup>j</sup> f</i>(<i class="emphasis">n</i>/<i class="emphasis">b<sup>j</sup></i>), and so the total of all internal node levels is</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig100_03.jpg" height="46" width="113" alt="" border="0"></span>
</div>
<p class="last-para">In the underlying divide-and-conquer algorithm, this sum represents the costs of dividing problems into subproblems and then recombining the subproblems. The cost of all the leaves, which is the cost of doing all <span class="inlinemediaobject"><img src="images/fig100_04.jpg" height="11" width="26" alt="" border="0"></span> subproblems of size 1, is <span class="inlinemediaobject"><img src="images/fig100_05.jpg" height="13" width="41" alt="" border="0"></span>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">In terms of the recursion tree, the three cases of the master theorem correspond to cases in which the total cost of the tree is (1) dominated by the costs in the leaves, (2) evenly distributed across the levels of the tree, or (3) dominated by the cost of the root.</p>
<p class="para">The summation in <a class="internaljump" href="#ch04eq06">equation (4.6)</a> describes the cost of the dividing and combining steps in the underlying divide-and-conquer algorithm. The next lemma provides asymptotic bounds on the summation's growth.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 4.3</span></span><a name="261"></a><a name="ch04ex19"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">a</i> <span class="unicode">&ge;</span> 1 and <i class="emphasis">b</i> <span class="unicode">&gt;</span> 1 be constants, and let <i class="emphasis">f</i>(<i class="emphasis">n</i>) be a nonnegative function defined on exact powers of <i class="emphasis">b</i>. A function <i class="emphasis">g</i>(<i class="emphasis">n</i>) defined over exact powers of <i class="emphasis">b</i> by</p>
<p class="para">
<div class="equation">
<a name="262"></a><a name="ch04eq07"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(4.7)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig100_06.jpg" height="46" width="151" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="para">can then be bounded asymptotically for exact powers of <i class="emphasis">b</i> as follows.</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">If <span class="inlinemediaobject"><img src="images/fig100_07.jpg" height="13" width="89" alt="" border="0"></span> for some constant <i class="emphasis"><span class="unicode">&isin;</span></i> <span class="unicode">&gt;</span> 0, then <span class="inlinemediaobject"><img src="images/fig100_08.jpg" height="14" width="78" alt="" border="0"></span>.</p>
</li>
<li class="listitem">
<p class="first-para">If <span class="inlinemediaobject"><img src="images/fig100_09.jpg" height="13" width="79" alt="" border="0"></span>, then <span class="inlinemediaobject"><img src="images/fig100_10.jpg" height="14" width="96" alt="" border="0"></span>.</p>
</li>
<li class="listitem">
<p class="first-para">If <i class="emphasis">af</i> (<i class="emphasis">n</i>/<i class="emphasis">b</i>) <span class="unicode">&le;</span> <i class="emphasis">cf</i>(<i class="emphasis">n</i>) for some constant <i class="emphasis">c</i> <span class="unicode">&lt;</span> 1 and for all <i class="emphasis">n</i> <span class="unicode">&ge;</span> <i class="emphasis">b</i>, then <i class="emphasis">g</i>(<i class="emphasis">n</i>) = <span class="unicode">&Theta;</span>(<i class="emphasis">f</i>(<i class="emphasis">n</i>)).</p>
</li>
</ol>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> For case 1, we have <span class="inlinemediaobject"><img src="images/fig100_11.jpg" height="14" width="92" alt="" border="0"></span>, which implies that <span class="inlinemediaobject"><img src="images/fig100_12.jpg" height="14" width="51" alt="" border="0"></span> <span class="inlinemediaobject"><img src="images/fig100_13.jpg" height="14" width="76" alt="" border="0"></span>. Substituting into <a class="internaljump" href="#ch04eq07">equation (4.7)</a> yields</p>
<p class="para">
<div class="equation">
<a name="263"></a><a name="ch04eq08"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(4.8)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig100_14.jpg" height="47" width="221" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<a name="264"></a><a name="IDX-79"></a>
<p class="para">We bound the summation within the <i class="emphasis">O</i>-notation by factoring out terms and simplifying, which leaves an increasing geometric series:</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig101_01.jpg" height="182" width="315" alt="" border="0"></span>
</div>
<p class="para">Since <i class="emphasis">b</i> and <i class="emphasis"><span class="unicode">&isin;</span></i> are constants, we can rewrite the last expression as <span class="inlinemediaobject"><img src="images/fig101_02.jpg" height="14" width="76" alt="" border="0"></span> <span class="inlinemediaobject"><img src="images/fig101_03.jpg" height="13" width="43" alt="" border="0"></span>. Substituting this expression for the summation in <a class="internaljump" href="#ch04eq08">equation (4.8)</a> yields</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig101_04.jpg" height="19" width="112" alt="" border="0"></span>
</div>
<p class="para">and case 1 is proved.</p>
<p class="para">Under the assumption that <span class="inlinemediaobject"><img src="images/fig101_05.jpg" height="13" width="79" alt="" border="0"></span> for case 2, we have that <span class="inlinemediaobject"><img src="images/fig101_06.jpg" height="14" width="50" alt="" border="0"></span> <span class="inlinemediaobject"><img src="images/fig101_07.jpg" height="14" width="67" alt="" border="0"></span>. Substituting into <a class="internaljump" href="#ch04eq07">equation (4.7)</a> yields</p>
<p class="para">
<div class="equation">
<a name="265"></a><a name="ch04eq09"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(4.9)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig101_08.jpg" height="46" width="207" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="para">We bound the summation within the <span class="unicode">&Theta;</span> as in case 1, but this time we do not obtain a geometric series. Instead, we discover that every term of the summation is the same:</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig101_09.jpg" height="121" width="290" alt="" border="0"></span>
</div>
<p class="para">Substituting this expression for the summation in <a class="internaljump" href="#ch04eq09">equation (4.9)</a> yields</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">g</i>(<i class="emphasis">n</i>)</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">(<span class="inlinemediaobject"><img src="images/fig101_10.jpg" height="14" width="71" alt="" border="0"></span>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">(<span class="inlinemediaobject"><img src="images/fig101_11.jpg" height="14" width="61" alt="" border="0"></span>,</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">and case 2 is proved.<a name="266"></a><a name="IDX-80"></a>
</p>
<p class="para">Case 3 is proved similarly. Since <i class="emphasis">f</i>(<i class="emphasis">n</i>) appears in the definition (<a class="internaljump" href="#ch04eq07">4.7</a>) of <i class="emphasis">g</i>(<i class="emphasis">n</i>) and all terms of <i class="emphasis">g</i>(<i class="emphasis">n</i>) are nonnegative, we can conclude that <i class="emphasis">g</i>(<i class="emphasis">n</i>) = <span class="unicode">&#8486;</span>(<i class="emphasis">f</i>(<i class="emphasis">n</i>)) for exact powers of <i class="emphasis">b</i>. Under our assumption that <i class="emphasis">af</i>(<i class="emphasis">n</i>/<i class="emphasis">b</i>) <span class="unicode">&le;</span> <i class="emphasis">cf</i>(<i class="emphasis">n</i>) for some constant <i class="emphasis">c</i> <span class="unicode">&lt;</span> 1 and all <i class="emphasis">n</i> <span class="unicode">&ge;</span> <i class="emphasis">b</i>, we have <i class="emphasis">f</i>(<i class="emphasis">n</i>/<i class="emphasis">b</i>) <span class="unicode">&le;</span> (<i class="emphasis">c</i>/<i class="emphasis">a</i>)<i class="emphasis">f</i>(<i class="emphasis">n</i>). Iterating <i class="emphasis">j</i> times, we have <i class="emphasis">f</i>(<i class="emphasis">n</i>/<i class="emphasis">b<sup>j</sup></i>) <span class="unicode">&le;</span> (<i class="emphasis">c</i>/<i class="emphasis">a</i>)<sup><i class="emphasis">j</i></sup> <i class="emphasis">f</i>(<i class="emphasis">n</i>) or, equivalently, <i class="emphasis">a<sup>j</sup> f</i>(<i class="emphasis">n</i>/<i class="emphasis">b<sup>j</sup></i>) <span class="unicode">&le;</span> <i class="emphasis">c<sup>j</sup> f</i>(<i class="emphasis">n</i>). Substituting into <a class="internaljump" href="#ch04eq07">equation (4.7)</a> and simplifying yields a geometric series, but unlike the series in case 1, this one has decreasing terms:</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig102_01.jpg" height="207" width="171" alt="" border="0"></span>
</div>
<p class="last-para">since <i class="emphasis">c</i> is constant. Thus, we can conclude that <i class="emphasis">g</i>(<i class="emphasis">n</i>) = <span class="unicode">&Theta;</span>(<i class="emphasis">f</i>(<i class="emphasis">n</i>)) for exact powers of <i class="emphasis">b</i>. Case 3 is proved, which completes the proof of the lemma.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">We can now prove a version of the master theorem for the case in which <i class="emphasis">n</i> is an exact power of <i class="emphasis">b</i>.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 4.4</span></span>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">a</i> <span class="unicode">&ge;</span> 1 and <i class="emphasis">b</i> <span class="unicode">&gt;</span> 1 be constants, and let <i class="emphasis">f</i>(<i class="emphasis">n</i>) be a nonnegative function defined on exact powers of <i class="emphasis">b</i>. Define <i class="emphasis">T</i>(<i class="emphasis">n</i>) on exact powers of <i class="emphasis">b</i> by the recurrence</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig102_02.jpg" height="38" width="231" alt="" border="0"></span>
</div>
<p class="para">where <i class="emphasis">i</i> is a positive integer. Then <i class="emphasis">T</i>(<i class="emphasis">n</i>) can be bounded asymptotically for exact powers of <i class="emphasis">b</i> as follows.</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">If <span class="inlinemediaobject"><img src="images/fig102_03.jpg" height="14" width="89" alt="" border="0"></span> for some constant <i class="emphasis"><span class="unicode">&isin;</span></i> <span class="unicode">&gt;</span> 0, then <span class="inlinemediaobject"><img src="images/fig102_04.jpg" height="14" width="80" alt="" border="0"></span>.</p>
</li>
<li class="listitem">
<p class="first-para">If <span class="inlinemediaobject"><img src="images/fig102_05.jpg" height="14" width="79" alt="" border="0"></span>, then <span class="inlinemediaobject"><img src="images/fig102_06.jpg" height="14" width="98" alt="" border="0"></span>.</p>
</li>
<li class="listitem">
<p class="first-para">If <span class="inlinemediaobject"><img src="images/fig102_07.jpg" height="14" width="91" alt="" border="0"></span> for some constant <i class="emphasis"><span class="unicode">&isin;</span></i> <span class="unicode">&gt;</span> 0, and if <i class="emphasis">af</i> (<i class="emphasis">n</i>/<i class="emphasis">b</i>) <span class="unicode">&le;</span> <i class="emphasis">cf</i>(<i class="emphasis">n</i>) for some constant <i class="emphasis">c</i> <span class="unicode">&lt;</span> 1 and all sufficiently large <i class="emphasis">n</i>, then <i class="emphasis">T</i>(<i class="emphasis">n</i>) = <span class="unicode">&Theta;</span>(<i class="emphasis">f</i>(<i class="emphasis">n</i>)).</p>
</li>
</ol>
<a name="267"></a><a name="IDX-81"></a>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> We use the bounds in <a class="internaljump" href="#ch04ex19">Lemma 4.3</a> to evaluate the summation (<a class="internaljump" href="#ch04eq06">4.6</a>) from <a class="internaljump" href="#ch04ex18">Lemma 4.2</a>. For case 1, we have</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>)</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig103_01.jpg" height="14" width="98" alt="" border="0"></span>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig103_02.jpg" height="14" width="43" alt="" border="0"></span>,</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">and for case 2,</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>)</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig103_03.jpg" height="15" width="117" alt="" border="0"></span>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig103_04.jpg" height="14" width="61" alt="" border="0"></span>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">For case 3,</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>)</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig103_05.jpg" height="14" width="95" alt="" border="0"></span>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="unicode">&Theta;</span>(<i class="emphasis">f</i>(<i class="emphasis">n</i>)),</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="last-para">because <span class="inlinemediaobject"><img src="images/fig103_06.jpg" height="14" width="89" alt="" border="0"></span>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>
<div class="section">
<h3 class="sect3-title">
<a name="268"></a><a name="ch04lev2sec2"></a><span class="section-titlelabel">4.4.2 </span>Floors and ceilings</h3>
<p class="first-para">To complete the proof of the master theorem, we must now extend our analysis to the situation in which floors and ceilings are used in the master recurrence, so that the recurrence is defined for all integers, not just exact powers of <i class="emphasis">b</i>. Obtaining a lower bound on</p>
<div class="equation">
<a name="269"></a><a name="ch04eq10"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(4.10)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig103_07.jpg" height="17" width="162" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">and an upper bound on</p>
<div class="equation">
<a name="270"></a><a name="ch04eq11"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(4.11)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig103_08.jpg" height="16" width="161" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">is routine, since the bound <span class="unicode">&lceil;</span><i class="emphasis">n</i>/<i class="emphasis">b</i><span class="unicode">&rceil;</span> <span class="unicode">&ge;</span> <i class="emphasis">n</i>/<i class="emphasis">b</i> can be pushed through in the first case to yield the desired result, and the bound <span class="unicode">&lfloor;</span><i class="emphasis">n</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span> <span class="unicode">&le;</span> <i class="emphasis">n</i>/<i class="emphasis">b</i> can be pushed through in the second case. Lower bounding the recurrence (<a class="internaljump" href="#ch04eq11">4.11</a>) requires much the same technique as upper bounding the recurrence (<a class="internaljump" href="#ch04eq10">4.10</a>), so we shall present only this latter bound.</p>
<p class="para">We modify the recursion tree of <a class="internaljump" href="#ch04fig03">Figure 4.3</a> to produce the recursion tree in <a class="internaljump" href="#ch04fig04">Figure 4.4</a>. As we go down in the recursion tree, we obtain a sequence of recursive invocations on the arguments</p>
<div class="figure">
<a name="271"></a><a name="ch04fig04"></a><span class="figuremediaobject"><a href="images/fig104%5F01%5F0%2Ejpg" NAME="IMG_178" target="_parent"><img src="images/fig104_01.jpg" height="211" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 4.4: </span>The recursion tree generated by <i class="emphasis">T</i>(<i class="emphasis">n</i>) = <i class="emphasis">aT</i>(<span class="unicode">&lceil;</span><i class="emphasis">n/b</i><span class="unicode">&rceil;</span>) + <i class="emphasis">f</i>(<i class="emphasis">n</i>). The recursive argument <i class="emphasis">n<sub>j</sub></i> is given by equation (4.12).</span>
</div>
<div class="informalexample">
<pre class="literallayout-normal">
<i class="emphasis">n</i> ,
<span class="unicode">&lceil;</span><i class="emphasis">n</i>/<i class="emphasis">b</i><span class="unicode">&rceil;</span> ,
<span class="unicode">&lceil;</span><span class="unicode">&lceil;</span><i class="emphasis">n</i>/<i class="emphasis">b</i><span class="unicode">&rceil;</span>/<i class="emphasis">b</i><span class="unicode">&rceil;</span> ,
<span class="unicode">&lceil;</span><span class="unicode">&lceil;</span><span class="unicode">&lceil;</span><i class="emphasis">n</i>/<i class="emphasis">b</i><span class="unicode">&rceil;</span>/<i class="emphasis">b</i><span class="unicode">&rceil;</span>/<i class="emphasis">b</i><span class="unicode">&rceil;</span> ,
          <span class="unicode">&#8942;</span>
</pre>
</div>
<a name="272"></a><a name="IDX-82"></a>
<p class="para">Let us denote the <i class="emphasis">j</i>th element in the sequence by <i class="emphasis">n<sub>j</sub></i>, where</p>
<div class="equation">
<a name="273"></a><a name="ch04eq12"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(4.12)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig104_02.jpg" height="38" width="167" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">Our first goal is to determine the depth <i class="emphasis">k</i> such that <i class="emphasis">n<sub>k</sub></i> is a constant. Using the inequality <span class="unicode">&lceil;</span><i class="emphasis">x</i><span class="unicode">&rceil;</span> <span class="unicode">&le;</span> <i class="emphasis">x</i> + 1, we obtain</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig104_03.jpg" height="145" width="167" alt="" border="0"></span>
</div>
<a name="274"></a><a name="IDX-83"></a>
<p class="para">In general,</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig105_01.jpg" height="127" width="132" alt="" border="0"></span>
</div>
<p class="para">Letting <i class="emphasis">j</i> = <span class="unicode">&lfloor;</span>log<sub><i class="emphasis">b</i></sub> <i class="emphasis">n</i><span class="unicode">&rfloor;</span>, we obtain</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig105_02.jpg" height="166" width="185" alt="" border="0"></span>
</div>
<p class="para">and thus we see that at depth <span class="unicode">&lfloor;</span>log<i class="emphasis"><sub>b</sub> n</i><span class="unicode">&rfloor;</span>, the problem size is at most a constant.</p>
<p class="para">From <a class="internaljump" href="#ch04fig04">Figure 4.4</a>, we see that</p>
<div class="equation">
<a name="275"></a><a name="ch04eq13"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(4.13)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig105_03.jpg" height="46" width="231" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">which is much the same as <a class="internaljump" href="#ch04eq06">equation (4.6)</a>, except that <i class="emphasis">n</i> is an arbitrary integer and not restricted to be an exact power of <i class="emphasis">b</i>.</p>
<p class="para">We can now evaluate the summation</p>
<div class="equation">
<a name="276"></a><a name="ch04eq14"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(4.14)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig105_04.jpg" height="47" width="147" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">from (<a class="internaljump" href="#ch04eq13">4.13</a>) in a manner analogous to the proof of <a class="internaljump" href="#ch04ex19">Lemma 4.3</a>. Beginning with case 3, if <i class="emphasis">af</i>(<span class="unicode">&lceil;</span><i class="emphasis">n</i>/<i class="emphasis">b</i><span class="unicode">&rceil;</span>) <span class="unicode">&le;</span> <i class="emphasis">cf</i>(<i class="emphasis">n</i>) for <i class="emphasis">n</i> <span class="unicode">&gt;</span> <i class="emphasis">b</i> + <i class="emphasis">b</i>/(<i class="emphasis">b</i> - 1), where <i class="emphasis">c</i> <span class="unicode">&lt;</span> 1 is a constant, then it follows that <i class="emphasis">a<sup>j</sup>f</i>(<i class="emphasis">n<sub>j</sub></i>) <span class="unicode">&le;</span> <i class="emphasis">c<sup>j</sup>f</i>(<i class="emphasis">n</i>). Therefore, the sum in <a class="internaljump" href="#ch04eq14">equation (4.14)</a> can be evaluated just as in <a class="internaljump" href="#ch04ex19">Lemma 4.3</a>. For case 2, we have <span class="inlinemediaobject"><img src="images/fig105_05.jpg" height="14" width="81" alt="" border="0"></span>. If we can show that <span class="inlinemediaobject"><img src="images/fig105_06.jpg" height="14" width="183" alt="" border="0"></span>, then the proof for case 2 of <a class="internaljump" href="#ch04ex19">Lemma 4.3</a> will go through. Observe that <i class="emphasis">j</i> = <span class="unicode">&le;</span> <span class="unicode">&lfloor;</span>log<i class="emphasis"><sub>b</sub> n</i><span class="unicode">&rfloor;</span> implies <i class="emphasis">b<sup>j</sup></i>/<i class="emphasis">n</i> <span class="unicode">&le;</span> 1. The bound <span class="inlinemediaobject"><img src="images/fig105_07.jpg" height="14" width="79" alt="" border="0"></span> implies that there exists a constant <i class="emphasis">c</i> <span class="unicode">&gt;</span> 0 such that for all <a name="277"></a><a name="IDX-84"></a>sufficiently large <i class="emphasis">n<sub>j</sub></i>,</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig106_01.jpg" height="210" width="296" alt="" border="0"></span>
</div>
<p class="para">since <span class="inlinemediaobject"><img src="images/fig106_02.jpg" height="14" width="98" alt="" border="0"></span> is a constant. Thus, case 2 is proved. The proof of case 1 is almost identical. The key is to prove the bound <span class="inlinemediaobject"><img src="images/fig106_03.jpg" height="14" width="96" alt="" border="0"></span>, which is similar to the corresponding proof of case 2, though the algebra is more intricate.</p>
<p class="para">We have now proved the upper bounds in the master theorem for all integers <i class="emphasis">n</i>. The proof of the lower bounds is similar.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 4.4-1: </span><span class="unicode">&#9733;</span></span><a name="278"></a><a name="ch04ex21"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Give a simple and exact expression for <i class="emphasis">n<sub>j</sub></i> in <a class="internaljump" href="#ch04eq12">equation (4.12)</a> for the case in which <i class="emphasis">b</i> is a positive integer instead of an arbitrary real number.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 4.4-2: </span><span class="unicode">&#9733;</span></span><a name="279"></a><a name="ch04ex22"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that if <span class="inlinemediaobject"><img src="images/fig106_04.jpg" height="14" width="103" alt="" border="0"></span>, where <i class="emphasis">k</i> <span class="unicode">&ge;</span> 0, then the master recurrence has solution <span class="inlinemediaobject"><img src="images/fig106_05.jpg" height="14" width="113" alt="" border="0"></span>. For simplicity, confine your analysis to exact powers of <i class="emphasis">b</i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 4.4-3: </span><span class="unicode">&#9733;</span></span><a name="280"></a><a name="ch04ex23"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that case 3 of the master theorem is overstated, in the sense that the regularity condition <i class="emphasis">af</i>(<i class="emphasis">n</i>/<i class="emphasis">b</i>) <span class="unicode">&le;</span> <i class="emphasis">cf</i>(<i class="emphasis">n</i>) for some constant <i class="emphasis">c</i> <span class="unicode">&lt;</span> 1 implies that there exists a constant <i class="emphasis"><span class="unicode">&isin;</span></i> <span class="unicode">&gt;</span> 0 such that <span class="inlinemediaobject"><img src="images/fig106_06.jpg" height="14" width="89" alt="" border="0"></span>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="281"></a><a name="IDX-85"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 4-1: </span>Recurrence examples</span><a name="282"></a><a name="ch04ex24"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Give asymptotic upper and lower bounds for <i class="emphasis">T</i>(<i class="emphasis">n</i>) in each of the following recurrences. Assume that <i class="emphasis">T</i>(<i class="emphasis">n</i>) is constant for <i class="emphasis">n</i> <span class="unicode">&le;</span> 2. Make your bounds as tight as possible, and justify your answers.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = 2<i class="emphasis">T</i>(<i class="emphasis">n</i>/2) + <i class="emphasis">n</i><sup>3</sup>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = <i class="emphasis">T</i>(9<i class="emphasis">n</i>/10) + <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = 16<i class="emphasis">T</i>(<i class="emphasis">n</i>/4) + <i class="emphasis">n</i><sup>2</sup>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i> (<i class="emphasis">n</i>) = 7<i class="emphasis">T</i>(<i class="emphasis">n</i>/3) + <i class="emphasis">n</i><sup>2</sup>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = 7<i class="emphasis">T</i>(<i class="emphasis">n</i>/2) + <i class="emphasis">n</i><sup>2</sup>.</p>
</li>
<li class="listitem">
<p class="first-para">
<span class="inlinemediaobject"><img src="images/fig107_01.jpg" height="13" width="104" alt="" border="0"></span>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = <i class="emphasis">T</i>(<i class="emphasis">n</i> - 1) + <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">
<span class="inlinemediaobject"><img src="images/fig107_02.jpg" height="14" width="87" alt="" border="0"></span>.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 4-2: </span>Finding the missing integer</span><a name="283"></a><a name="ch04ex25"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">An array <i class="emphasis">A</i>[1 <span class="unicode">&#8229;</span> <i class="emphasis">n</i>] contains all the integers from 0 to <i class="emphasis">n</i> except one. It would be easy to determine the missing integer in <i class="emphasis">O</i>(<i class="emphasis">n</i>) time by using an auxiliary array <i class="emphasis">B</i>[0 <span class="unicode">&#8229;</span> <i class="emphasis">n</i>] to record which numbers appear in <i class="emphasis">A</i>. In this problem, however, we cannot access an entire integer in <i class="emphasis">A</i> with a single operation. The elements of <i class="emphasis">A</i> are represented in binary, and the only operation we can use to access them is "fetch the <i class="emphasis">j</i>th bit of <i class="emphasis">A</i>[<i class="emphasis">i</i>]," which takes constant time.</p>
<p class="last-para">Show that if we use only this operation, we can still determine the missing integer in <i class="emphasis">O</i>(<i class="emphasis">n</i>) time.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 4-3: </span>Parameter-passing costs</span><a name="284"></a><a name="ch04ex26"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Throughout this book, we assume that parameter passing during procedure calls takes constant time, even if an <i class="emphasis">N</i>-element array is being passed. This assumption is valid in most systems because a pointer to the array is passed, not the array itself. This problem examines the implications of three parameter-passing strategies:<a name="285"></a><a name="IDX-86"></a>
</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">An array is passed by pointer. Time = <span class="unicode">&Theta;</span>(1).</p>
</li>
<li class="listitem">
<p class="first-para">An array is passed by copying. Time = <span class="unicode">&Theta;</span>(<i class="emphasis">N</i>), where <i class="emphasis">N</i> is the size of the array.</p>
</li>
<li class="listitem">
<p class="first-para">An array is passed by copying only the subrange that might be accessed by the called procedure. Time = <span class="unicode">&Theta;</span>(<i class="emphasis">q</i> - <i class="emphasis">p</i> + 1) if the subarray <i class="emphasis">A</i>[<i class="emphasis">p</i> <span class="unicode">&#8229;</span> <i class="emphasis">q</i>] is passed.</p>
</li>
</ol>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Consider the recursive binary search algorithm for finding a number in a sorted array (see <a href="DDU0016.html#109" target="_parent" class="chapterjump">Exercise 2.3-5</a>). Give recurrences for the worst-case running times of binary search when arrays are passed using each of the three methods above, and give good upper bounds on the solutions of the recurrences. Let <i class="emphasis">N</i> be the size of the original problem and <i class="emphasis">n</i> be the size of a subproblem.</p>
</li>
<li class="listitem">
<p class="first-para">Redo part (a) for the MERGE-SORT algorithm from <a href="DDU0016.html#90" target="_parent" class="chapterjump">Section 2.3.1</a>.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 4-4: </span>More recurrence examples</span><a name="286"></a><a name="ch04ex27"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Give asymptotic upper and lower bounds for <i class="emphasis">T</i>(<i class="emphasis">n</i>) in each of the following recurrences. Assume that <i class="emphasis">T</i>(<i class="emphasis">n</i>) is constant for sufficiently small <i class="emphasis">n</i>. Make your bounds as tight as possible, and justify your answers.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = 3<i class="emphasis">T</i>(<i class="emphasis">n</i>/2) + <i class="emphasis">n</i> lg <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = 5<i class="emphasis">T</i>(<i class="emphasis">n</i>/5) + <i class="emphasis">n</i>/ lg <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">
<span class="inlinemediaobject"><img src="images/fig108_01.jpg" height="14" width="115" alt="" border="0"></span>
</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = 3<i class="emphasis">T</i>(<i class="emphasis">n</i>/3 + 5) + <i class="emphasis">n</i>/2.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = 2<i class="emphasis">T</i>(<i class="emphasis">n</i>/2) + <i class="emphasis">n</i>/ lg <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = <i class="emphasis">T</i>(<i class="emphasis">n</i>/2) + <i class="emphasis">T</i>(<i class="emphasis">n</i>/4) + <i class="emphasis">T</i>(<i class="emphasis">n</i>/8) + <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = <i class="emphasis">T</i>(<i class="emphasis">n</i> - 1) + 1/<i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = <i class="emphasis">T</i>(<i class="emphasis">n</i> - 1) + lg <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">T</i>(<i class="emphasis">n</i>) = <i class="emphasis">T</i>(<i class="emphasis">n</i> - 2) + 2 lg <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">
<span class="inlinemediaobject"><img src="images/fig108_02.jpg" height="13" width="104" alt="" border="0"></span>.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 4-5: </span>Fibonacci numbers</span><a name="287"></a><a name="ch04ex28"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">This problem develops properties of the Fibonacci numbers, which are defined by recurrence (<a href="DDU0020.html#182" target="_parent" class="chapterjump">3.21</a>). We shall use the technique of generating functions to solve <a name="288"></a><a name="IDX-87"></a>the Fibonacci recurrence. Define the <b class="bold"><i class="emphasis">generating function</i></b> (or <b class="bold"><i class="emphasis">formal power series</i></b>) <span class="unicode">F</span> as</p>
<p class="para">
<div class="informalequation">
<span class="equation-image"><a href="images/fig109%5F01%2Ejpg" NAME="IMG_198" target="_parent"><img src="images/fig109_01.jpg" height="60" width="400" alt="Click To expand" border="0"></a></span>
</div>
</p>
<p class="para">where <i class="emphasis">F<sub>i</sub></i> is the <i class="emphasis">i</i>th Fibonacci number.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Show that <span class="unicode">F</span> (<i class="emphasis">z</i>) = <i class="emphasis">z</i> + <i class="emphasis">z</i> <span class="unicode">F</span> (<i class="emphasis">z</i>) + <i class="emphasis">z</i><sup>2</sup><span class="unicode">F</span>(<i class="emphasis">z</i>).</p>
</li>
<li class="listitem">
<p class="first-para">Show that</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig109_02.jpg" height="109" width="232" alt="" border="0"></span>
</div>
<p class="para">where</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig109_03.jpg" height="37" width="165" alt="" border="0"></span>
</div>
<p class="para">and</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig109_04.jpg" height="37" width="186" alt="" border="0"></span>
</div>
</li>
<li class="listitem">
<p class="first-para">Show that</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig109_05.jpg" height="41" width="172" alt="" border="0"></span>
</div>
</li>
<li class="listitem">
<p class="first-para">Prove that <span class="inlinemediaobject"><img src="images/fig109_06.jpg" height="15" width="57" alt="" border="0"></span> for <i class="emphasis">i</i> <span class="unicode">&gt;</span> 0, rounded to the nearest integer. (<i class="emphasis">Hint:</i> Observe <span class="inlinemediaobject"><img src="images/fig109_07.jpg" height="15" width="32" alt="" border="0"></span>.)</p>
</li>
<li class="listitem">
<p class="first-para">Prove that <i class="emphasis">F</i><sub><i class="emphasis">i</i>+2</sub> <span class="unicode">&ge;</span> <span class="unicode">&phi;</span><sup><i class="emphasis">i</i></sup> for <i class="emphasis">i</i> <span class="unicode">&ge;</span> 0.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 4-6: </span>VLSI chip testing</span><a name="289"></a><a name="ch04ex29"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Professor Diogenes has <i class="emphasis">n</i> supposedly identical VLSI<sup>[<a name="N3141" href="#ftn.N3141">1</a>]</sup> chips that in principle are capable of testing each other. The professor's test jig accommodates two chips at <a name="290"></a><a name="IDX-88"></a>a time. When the jig is loaded, each chip tests the other and reports whether it is good or bad. A good chip always reports accurately whether the other chip is good or bad, but the answer of a bad chip cannot be trusted. Thus, the four possible outcomes of a test are as follows:</p>
<div class="informaltable">
<table border="0">
<thead>
<tr valign="top">
<th class="th" scope="col" align="left">
<p class="table-para">Chip <i class="emphasis">A</i> says</p>
</th><th class="th" scope="col" align="left">
<p class="table-para">Chip <i class="emphasis">B</i> says</p>
</th><th class="th" scope="col" align="left">
<p class="table-para">Conclusion</p>
</th>
</tr>
<tr>
<td colspan="3">
<hr>
</td>
</tr>
</thead>
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">B</i> is good</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">A</i> is good</p>
</td><td class="td" align="left">
<p class="table-para">both are good, or both are bad</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">B</i> is good</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">A</i> is bad</p>
</td><td class="td" align="left">
<p class="table-para">at least one is bad</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">B</i> is bad</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">A</i> is good</p>
</td><td class="td" align="left">
<p class="table-para">at least one is bad</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">B</i> is bad</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">A</i> is bad</p>
</td><td class="td" align="left">
<p class="table-para">at least one is bad</p>
</td>
</tr>
</tbody>
</table>
</div>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Show that if more than <i class="emphasis">n</i>/2 chips are bad, the professor cannot necessarily determine which chips are good using any strategy based on this kind of pairwise test. Assume that the bad chips can conspire to fool the professor.</p>
</li>
<li class="listitem">
<p class="first-para">Consider the problem of finding a single good chip from among <i class="emphasis">n</i> chips, assuming that more than <i class="emphasis">n</i>/2 of the chips are good. Show that <span class="unicode">&lfloor;</span><i class="emphasis">n</i>/2<span class="unicode">&rfloor;</span> pairwise tests are sufficient to reduce the problem to one of nearly half the size.</p>
</li>
<li class="listitem">
<p class="first-para">Show that the good chips can be identified with <span class="unicode">&Theta;</span>(<i class="emphasis">n</i>) pairwise tests, assuming that more than <i class="emphasis">n</i>/2 of the chips are good. Give and solve the recurrence that describes the number of tests.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 4-7: </span>Monge arrays</span><a name="291"></a><a name="ch04ex30"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">An <i class="emphasis">m</i> &times; <i class="emphasis">n</i> array <i class="emphasis">A</i> of real numbers is a <b class="bold"><i class="emphasis">Monge array</i></b> if for all <i class="emphasis">i</i>, <i class="emphasis">j</i>, <i class="emphasis">k</i>, and <i class="emphasis">l</i> such that 1 <span class="unicode">&le;</span> <i class="emphasis">i</i> <span class="unicode">&lt;</span> <i class="emphasis">k</i> <span class="unicode">&le;</span> <i class="emphasis">m</i> and 1 <span class="unicode">&le;</span> <i class="emphasis">j</i> <span class="unicode">&lt;</span> <i class="emphasis">l</i> <span class="unicode">&le;</span> <i class="emphasis">n</i>, we have</p>
<p class="para">
<i class="emphasis">A</i>[<i class="emphasis">i</i>, <i class="emphasis">j</i>] + <i class="emphasis">A</i>[<i class="emphasis">k</i>, <i class="emphasis">l</i>] <span class="unicode">&le;</span> <i class="emphasis">A</i>[<i class="emphasis">i</i>, <i class="emphasis">l</i>] + <i class="emphasis">A</i>[<i class="emphasis">k</i>, <i class="emphasis">j</i>].</p>
<p class="para">In other words, whenever we pick two rows and two columns of a Monge array and consider the four elements at the intersections of the rows and the columns, the sum of the upper-left and lower-right elements is less or equal to the sum of the lower-left and upper-right elements. For example, the following array is Monge:</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">10</p>
</td><td class="td" align="center">
<p class="table-para">17</p>
</td><td class="td" align="center">
<p class="table-para">13</p>
</td><td class="td" align="center">
<p class="table-para">28</p>
</td><td class="td" align="center">
<p class="table-para">23</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">17</p>
</td><td class="td" align="center">
<p class="table-para">22</p>
</td><td class="td" align="center">
<p class="table-para">16</p>
</td><td class="td" align="center">
<p class="table-para">29</p>
</td><td class="td" align="center">
<p class="table-para">23</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">24</p>
</td><td class="td" align="center">
<p class="table-para">28</p>
</td><td class="td" align="center">
<p class="table-para">22</p>
</td><td class="td" align="center">
<p class="table-para">34</p>
</td><td class="td" align="center">
<p class="table-para">24</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">11</p>
</td><td class="td" align="center">
<p class="table-para">13</p>
</td><td class="td" align="center">
<p class="table-para">6</p>
</td><td class="td" align="center">
<p class="table-para">17</p>
</td><td class="td" align="center">
<p class="table-para">7</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">45</p>
</td><td class="td" align="center">
<p class="table-para">44</p>
</td><td class="td" align="center">
<p class="table-para">32</p>
</td><td class="td" align="center">
<p class="table-para">37</p>
</td><td class="td" align="center">
<p class="table-para">23</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">36</p>
</td><td class="td" align="center">
<p class="table-para">33</p>
</td><td class="td" align="center">
<p class="table-para">19</p>
</td><td class="td" align="center">
<p class="table-para">21</p>
</td><td class="td" align="center">
<p class="table-para">6</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">75</p>
</td><td class="td" align="center">
<p class="table-para">66</p>
</td><td class="td" align="center">
<p class="table-para">51</p>
</td><td class="td" align="center">
<p class="table-para">53</p>
</td><td class="td" align="center">
<p class="table-para">34</p>
</td>
</tr>
</tbody>
</table>
</div>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Prove that an array is Monge if and only if for all <i class="emphasis">i</i> = 1, 2, <span class="unicode">&hellip;</span>, <i class="emphasis">m</i> - 1 and <i class="emphasis">j</i> = 1, 2,<span class="unicode">&hellip;</span>, <i class="emphasis">n</i> - 1, we have<a name="292"></a><a name="IDX-89"></a>
</p>
<p class="para">
<i class="emphasis">A</i>[<i class="emphasis">i</i>, <i class="emphasis">j</i>] + <i class="emphasis">A</i>[<i class="emphasis">i</i> + 1, <i class="emphasis">j</i> + 1] <span class="unicode">&le;</span> <i class="emphasis">A</i>[<i class="emphasis">i</i>, <i class="emphasis">j</i> + 1] + <i class="emphasis">A</i>[<i class="emphasis">i</i> + 1, <i class="emphasis">j</i>].</p>
<table border="0" cellspacing="0" cellpadding="0" class="note">
<tr>
<td valign="top" class="admon-check"></td><td valign="top" class="admon-title">Note&nbsp;</td><td valign="top" class="admon-body">
<p class="first-para">(For the "only if" part, use induction separately on rows and columns.)</p>
</td>
</tr>
</table>
</li>
<li class="listitem">
<p class="first-para">The following array is not Monge. Change one element in order to make it Monge. (<i class="emphasis">Hint:</i> Use part (a).)</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">37</p>
</td><td class="td" align="center">
<p class="table-para">23</p>
</td><td class="td" align="center">
<p class="table-para">22</p>
</td><td class="td" align="center">
<p class="table-para">32</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">21</p>
</td><td class="td" align="center">
<p class="table-para">6</p>
</td><td class="td" align="center">
<p class="table-para">7</p>
</td><td class="td" align="center">
<p class="table-para">10</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">53</p>
</td><td class="td" align="center">
<p class="table-para">34</p>
</td><td class="td" align="center">
<p class="table-para">30</p>
</td><td class="td" align="center">
<p class="table-para">31</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">32</p>
</td><td class="td" align="center">
<p class="table-para">13</p>
</td><td class="td" align="center">
<p class="table-para">9</p>
</td><td class="td" align="center">
<p class="table-para">6</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">43</p>
</td><td class="td" align="center">
<p class="table-para">21</p>
</td><td class="td" align="center">
<p class="table-para">15</p>
</td><td class="td" align="center">
<p class="table-para">8</p>
</td>
</tr>
</tbody>
</table>
</div>
</li>
<li class="listitem">
<p class="first-para">Let <i class="emphasis">f</i>(<i class="emphasis">i</i>) be the index of the column containing the leftmost minimum element of row <i class="emphasis">i</i>. Prove that <i class="emphasis">f</i>(1) <span class="unicode">&le;</span> <i class="emphasis">f</i>(2) <span class="unicode">&le;</span> <span class="unicode">&middot;</span><span class="unicode">&middot;</span><span class="unicode">&middot;</span> <span class="unicode">&le;</span> <i class="emphasis">f</i>(<i class="emphasis">m</i>) for any <i class="emphasis">m</i> &times; <i class="emphasis">n</i> Monge array.</p>
</li>
<li class="listitem">
<p class="first-para">Here is a description of a divide-and-conquer algorithm that computes the left-most minimum element in each row of an <i class="emphasis">m</i> &times; <i class="emphasis">n</i> Monge array <i class="emphasis">A</i>:</p>
<ul class="simple-list">
<li class="first-listitem">
<p class="first-para">Construct a submatrix <i class="emphasis">A</i><span class="unicode">&prime;</span> of <i class="emphasis">A</i> consisting of the even-numbered rows of <i class="emphasis">A</i>. Recursively determine the leftmost minimum for each row of <i class="emphasis">A</i><span class="unicode">&prime;</span>. Then compute the leftmost minimum in the odd-numbered rows of <i class="emphasis">A</i>.</p>
</li>
</ul>
<p class="last-para">Explain how to compute the leftmost minimum in the odd-numbered rows of <i class="emphasis">A</i> (given that the leftmost minimum of the even-numbered rows is known) in <i class="emphasis">O</i>(<i class="emphasis">m</i> + <i class="emphasis">n</i>) time.</p>
</li>
<li class="listitem">
<p class="first-para">Write the recurrence describing the running time of the algorithm described in part (d). Show that its solution is <i class="emphasis">O</i>(<i class="emphasis">m</i> + <i class="emphasis">n</i> log <i class="emphasis">m</i>).</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
<div class="footnotes">
<div class="footnote">
<p>
<sup>[<a name="ftn.N3141" href="#N3141">1</a>]</sup>VLSI stands for "very large scale integration," which is the integrated-circuit chip technology used to fabricate most microprocessors today.</p>
</div>
</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0026.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0028.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
