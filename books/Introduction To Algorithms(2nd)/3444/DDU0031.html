<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>5.3 Randomized algorithms</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0030.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0032.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch05"></a>
<div class="section">
<h2 class="first-section-title">
<a name="324"></a><a name="ch05lev1sec3"></a><span class="section-titlelabel">5.3 </span>Randomized algorithms</h2>
<p class="first-para">In the <a href="DDU0030.html#314" target="_parent" class="chapterjump">previous section</a>, we showed how knowing a distribution on the inputs can help us to analyze the average-case behavior of an algorithm. Many times, we do not have such knowledge and no average-case analysis is possible. As mentioned in <a href="DDU0029.html#298" target="_parent" class="chapterjump">Section 5.1</a>, we may be able to use a randomized algorithm.</p>
<p class="para">For a problem such as the hiring problem, in which it is helpful to assume that all permutations of the input are equally likely, a probabilistic analysis will guide the development of a randomized algorithm. Instead of assuming a distribution of inputs, we impose a distribution. In particular, before running the algorithm, we randomly permute the candidates in order to enforce the property that every permutation is equally likely. This modification does not change our expectation of hiring a new office assistant roughly ln <i class="emphasis">n</i> times. It means, however, that for <i class="emphasis">any</i> input we expect this to be the case, rather than for inputs drawn from a particular distribution.</p>
<p class="para">We now explore the distinction between probabilistic analysis and randomized algorithms further. In <a href="DDU0030.html#308" target="_parent" class="chapterjump">Section 5.2</a>, we claimed that, assuming that the candidates are presented in a random order, the expected number of times we hire a new office assistant is about ln <i class="emphasis">n</i>. Note that the algorithm here is deterministic; for any particular input, the number of times a new office assistant is hired will always be the same. Furthermore, the number of times we hire a new office assistant differs for different inputs, and it depends on the ranks of the various candidates. Since this number depends only on the ranks of the candidates, we can represent a particular input by listing, in order, the ranks of the candidates, i.e., <span class="unicode">&lt;</span><i class="emphasis">rank</i>(1), <i class="emphasis">rank</i>(2), ..., <i class="emphasis">rank</i>(<i class="emphasis">n</i>)<span class="unicode">&gt;</span>. Given the rank list <i class="emphasis">A</i><sub>1</sub> = <span class="unicode">&lt;</span>1, 2, 3, 4, 5, 6, 7, 8, 9, 10<span class="unicode">&gt;</span>, a new office assistant will always be hired 10 times, since each successive candidate is better than the previous one, and lines 5<span class="unicode">-</span>6 will be executed in each iteration of the algorithm. Given the list of ranks <i class="emphasis">A</i><sub>2</sub> = <span class="unicode">&lt;</span>10, 9, 8, 7, 6, 5, 4, 3, 2, 1<span class="unicode">&gt;</span>, a new office assistant will be hired only once, in the first iteration. Given a list of ranks <i class="emphasis">A</i><sub>3</sub>= <span class="unicode">&lt;</span>5, 2, 1, 8, 4, 7, 10, 9, 3, 6<span class="unicode">&gt;</span>, a new office assistant will be hired three times, upon interviewing the candidates with ranks 5, 8, and 10. Recalling that the cost of our algorithm is dependent on how many times we hire a new office assistant, we <a name="325"></a><a name="IDX-100"></a>see that there are expensive inputs, such as <i class="emphasis">A</i><sub>1</sub>, inexpensive inputs, such as <i class="emphasis">A</i><sub>2</sub>, and moderately expensive inputs, such as <i class="emphasis">A</i><sub>3</sub>.</p>
<p class="para">Consider, on the other hand, the randomized algorithm that first permutes the candidates and then determines the best candidate. In this case, the randomization is in the algorithm, not in the input distribution. Given a particular input, say <i class="emphasis">A</i><sub>3</sub> above, we cannot say how many times the maximum will be updated, because this quantity differs with each run of the algorithm. The first time we run the algorithm on <i class="emphasis">A</i><sub>3</sub>, it may produce the permutation <i class="emphasis">A</i><sub>1</sub> and perform 10 updates, while the second time we run the algorithm, we may produce the permutation <i class="emphasis">A</i><sub>2</sub> and perform only one update. The third time we run it, we may perform some other number of updates. Each time we run the algorithm, the execution depends on the random choices made and is likely to differ from the previous execution of the algorithm. For this algorithm and many other randomized algorithms, <i class="emphasis">no particular input elicits its worst-case behavior</i>. Even your worst enemy cannot produce a bad input array, since the random permutation makes the input order irrelevant. The randomized algorithm performs badly only if the random-number generator produces an "unlucky" permutation.</p>
<p class="para">For the hiring problem, the only change needed in the code is to randomly permute the array.</p>
<div class="informalexample">
<pre class="literallayout-normal">
RANDOMIZED-HIRE-ASSISTANT(<i class="emphasis">n</i>)
1 randomly permute the list of candidates
2 <i class="emphasis">best</i> <span class="unicode"><span class="unicode">&larr;</span></span> 0      <span class="unicode"><font face="symbol">&reg;</font></span> candidate 0 is a least-qualified dummy candidate
3 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&larr;</span></span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
4       <b class="bold">do</b> interview candidate <i class="emphasis">i</i>
5          <b class="bold">if</b> candidate <i class="emphasis">i</i> is better than candidate <i class="emphasis">best</i>
6             <b class="bold">then</b> <i class="emphasis">best</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">i</i>
7                  hire candidate <i class="emphasis">i</i>
</pre>
</div>
<p class="para">With this simple change, we have created a randomized algorithm whose performance matches that obtained by assuming that the candidates were presented in a random order.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 5.3</span></span><a name="326"></a><a name="ch05ex11"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">The expected hiring cost of the procedure RANDOMIZED-HIRE-ASSISTANT is <i class="emphasis">O</i>(<i class="emphasis">c<sub>h</sub></i> ln <i class="emphasis">n</i>).</p>
<p class="last-para">
<b class="bold"><i class="emphasis">Proof</i></b> After permuting the input array, we have achieved a situation identical to that of the probabilistic analysis of HIRE-ASSISTANT.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">The comparison between <a href="DDU0030.html#317" target="_parent" class="chapterjump">Lemmas 5.2</a> and <a class="internaljump" href="#ch05ex11">5.3</a> captures the difference between probabilistic analysis and randomized algorithms. In <a href="DDU0030.html#317" target="_parent" class="chapterjump">Lemma 5.2</a>, we make an <a name="327"></a><a name="IDX-101"></a>assumption about the input. In <a class="internaljump" href="#ch05ex11">Lemma 5.3</a>, we make no such assumption, although randomizing the input takes some additional time. In the remainder of this section, we discuss some issues involved in randomly permuting inputs.</p>
<div class="section">
<h4 class="sect4-title">
<a name="328"></a><a name="ch05lev3sec5"></a>Randomly permuting arrays</h4>
<p class="first-para">Many randomized algorithms randomize the input by permuting the given input array. (There are other ways to use randomization.) Here, we shall discuss two methods for doing so. We assume that we are given an array <i class="emphasis">A</i> which, without loss of generality, contains the elements 1 through <i class="emphasis">n</i>. Our goal is to produce a random permutation of the array.</p>
<p class="para">One common method is to assign each element <i class="emphasis">A</i>[<i class="emphasis">i</i>] of the array a random priority <i class="emphasis">P</i>[<i class="emphasis">i</i>], and then sort the elements of <i class="emphasis">A</i> according to these priorities. For example if our initial array is <i class="emphasis">A</i> = <span class="unicode">&lt;</span>1, 2, 3, 4<span class="unicode">&gt;</span> and we choose random priorities <i class="emphasis">P</i> = <span class="unicode">&lt;</span>36, 3, 97, 19<span class="unicode">&gt;</span>, we would produce an array <i class="emphasis">B</i> = <span class="unicode">&lt;</span>2, 4, 1, 3<span class="unicode">&gt;</span>, since the second priority is the smallest, followed by the fourth, then the first, and finally the third. We call this procedure PERMUTE-BY-SORTING:</p>
<div class="informalexample">
<pre class="literallayout-normal">
PERMUTE-BY-SORTING(<i class="emphasis">A</i>)
1 <i class="emphasis">n</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">length</i>[<i class="emphasis">A</i>]
2 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&larr;</span></span> 1 <i class="emphasis">to</i> <i class="emphasis">n</i>
3      <b class="bold">do</b> <i class="emphasis">P</i>[<i class="emphasis">i</i>] = RANDOM(1, <i class="emphasis">n</i><sup>3</sup>)
4 sort <i class="emphasis">A</i>, using <i class="emphasis">P</i> as sort keys
5 <b class="bold">return</b> <i class="emphasis">A</i>
</pre>
</div>
<p class="para">Line 3 chooses a random number between 1 and <i class="emphasis">n</i><sup>3</sup>. We use a range of 1 to <i class="emphasis">n</i><sup>3</sup> to make it likely that all the priorities in <i class="emphasis">P</i> are unique. (<a class="internaljump" href="#ch05ex18">Exercise 5.3-5</a> asks you to prove that the probability that all entries are unique is at least 1 - 1/<i class="emphasis">n</i>, and <a class="internaljump" href="#ch05ex19">Exercise 5.3-6</a> asks how to implement the algorithm even if two or more priorities are identical.) Let us assume that all the priorities are unique.</p>
<p class="para">The time-consuming step in this procedure is the sorting in line 4. As we shall see in <a href="DDU0047.html#514" target="_parent" class="chapterjump">Chapter 8</a>, if we use a comparison sort, sorting takes <span class="unicode"><span class="unicode">&#8486;</span></span>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>) time. We can achieve this lower bound, since we have seen that merge sort takes <span class="unicode"><span class="unicode">&Theta;</span></span>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>) time. (We shall see other comparison sorts that take <span class="unicode"><span class="unicode">&Theta;</span></span>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>) time in <a href="DDU0034.html#376" target="_parent" class="chapterjump">Part II</a>.) After sorting, if <i class="emphasis">P</i>[<i class="emphasis">i</i>] is the <i class="emphasis">j</i>th smallest priority, then <i class="emphasis">A</i>[<i class="emphasis">i</i>] will be in position <i class="emphasis">j</i> of the output. In this manner we obtain a permutation. It remains to prove that the procedure produces a <b class="bold"><i class="emphasis">uniform random permutation</i></b>, that is, that every permutation of the numbers 1 through <i class="emphasis">n</i> is equally likely to be produced.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 5.4</span></span>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Procedure PERMUTE-BY-SORTING produces a uniform random permutation of the input, assuming that all priorities are distinct.<a name="329"></a><a name="IDX-102"></a>
</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> We start by considering the particular permutation in which each element <i class="emphasis">A</i>[<i class="emphasis">i</i>] receives the <i class="emphasis">i</i>th smallest priority. We shall show that this permutation occurs with probability exactly 1/<i class="emphasis">n</i>!. For <i class="emphasis">i</i> = 1, 2, ..., <i class="emphasis">n</i>, let <i class="emphasis">X<sub>i</sub></i> be the event that element <i class="emphasis">A</i>[<i class="emphasis">i</i>] receives the <i class="emphasis">i</i>th smallest priority. Then we wish to compute the probability that for all <i class="emphasis">i</i>, event <i class="emphasis">X<sub>i</sub></i> occurs, which is</p>
<p class="para">Pr {<i class="emphasis">X</i><sub>1</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub>2</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub>3</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <span class="unicode">&middot;</span><span class="unicode">&middot;</span><span class="unicode">&middot;</span> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub><i class="emphasis">n</i>-1</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X<sub>n</sub></i>}.</p>
<p class="para">Using <a href="DDU0254.html#3466" target="_parent" class="chapterjump">Exercise C.2-6</a>, this probability is equal to</p>
<p class="para">Pr {<i class="emphasis">X</i><sub>1</sub>} <span class="unicode">&middot;</span> Pr{<i class="emphasis">X</i><sub>2</sub> | <i class="emphasis">X</i><sub>1</sub>} <span class="unicode">&middot;</span> Pr{<i class="emphasis">X</i><sub>3</sub> | <i class="emphasis">X</i><sub>2</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub>1</sub>} <span class="unicode">&middot;</span> Pr{<i class="emphasis">X</i><sub>4</sub> | <i class="emphasis">X</i><sub>3</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub>2</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub>1</sub>}</p>
<p class="para">Pr{<i class="emphasis">X<sub>i</sub></i> | <i class="emphasis">X</i><sub><i class="emphasis">i</i>-1</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub><i class="emphasis">i</i>-2</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <span class="unicode">&middot;</span><span class="unicode">&middot;</span><span class="unicode">&middot;</span> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub>1</sub>} Pr{<i class="emphasis">X<sub>n</sub></i> | <i class="emphasis">X</i><sub><i class="emphasis">n</i>-1</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <span class="unicode">&middot;</span><span class="unicode">&middot;</span><span class="unicode">&middot;</span> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub>1</sub>}.</p>
<p class="para">We have that Pr {<i class="emphasis">X</i><sub>1</sub>} = 1/<i class="emphasis">n</i> because it is the probability that one priority chosen randomly out of a set of <i class="emphasis">n</i> is the smallest. Next, we observe that Pr {<i class="emphasis">X</i><sub>2</sub> | <i class="emphasis">X</i><sub>1</sub>} = 1/(<i class="emphasis">n</i> - 1) because given that element <i class="emphasis">A</i>[1] has the smallest priority, each of the remaining <i class="emphasis">n</i> - 1 elements has an equal chance of having the second smallest priority. In general, for <i class="emphasis">i</i> = 2, 3, ..., <i class="emphasis">n</i>, we have that Pr {<i class="emphasis">X<sub>i</sub></i> | <i class="emphasis">X</i><sub><i class="emphasis">i</i>-1</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub><i class="emphasis">i</i>-2</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <span class="unicode">&middot;</span><span class="unicode">&middot;</span><span class="unicode">&middot;</span> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">X</i><sub>1</sub>} = 1/(<i class="emphasis">n</i> - <i class="emphasis">i</i> + 1), since, given that elements <i class="emphasis">A</i>[1] through <i class="emphasis">A</i>[<i class="emphasis">i</i> - 1] have the <i class="emphasis">i</i> - 1 smallest priorities (in order), each of the remaining <i class="emphasis">n</i> - (<i class="emphasis">i</i> - 1) elements has an equal chance of having the <i class="emphasis">i</i>th smallest priority. Thus, we have</p>
<div class="informalequation">
<span class="equation-image"><a href="images/fig124%5F01%2Ejpg" NAME="IMG_219" target="_parent"><img src="images/fig124_01.jpg" height="71" width="400" alt="Click To expand" border="0"></a></span>
</div>
<p class="para">and we have shown that the probability of obtaining the identity permutation is 1/<i class="emphasis">n</i>!.</p>
<p class="last-para">We can extend this proof to work for any permutation of priorities. Consider any fixed permutation <i class="emphasis"><span class="unicode"><span class="unicode">&sigma;</span></span></i> = <span class="unicode">&lt;</span><i class="emphasis"><span class="unicode"><span class="unicode">&sigma;</span></span></i>(1), <i class="emphasis"><span class="unicode"><span class="unicode">&sigma;</span></span></i>(2), ..., <i class="emphasis"><span class="unicode"><span class="unicode">&sigma;</span></span></i>(<i class="emphasis">n</i>)<span class="unicode">&gt;</span> of the set {1, 2, ..., <i class="emphasis">n</i>}. Let us denote by <i class="emphasis">r<sub>i</sub></i> the rank of the priority assigned to element <i class="emphasis">A</i>[<i class="emphasis">i</i>], where the element with the <i class="emphasis">j</i>th smallest priority has rank <i class="emphasis">j</i>. If we define <i class="emphasis">X<sub>i</sub></i> as the event in which element <i class="emphasis">A</i>[<i class="emphasis">i</i>] receives the <i class="emphasis"><span class="unicode"><span class="unicode">&sigma;</span></span></i>(<i class="emphasis">i</i>)th smallest priority, or <i class="emphasis">r<sub>i</sub></i> = <i class="emphasis"><span class="unicode"><span class="unicode">&sigma;</span></span></i>(<i class="emphasis">i</i>), the same proof still applies. Therefore, if we calculate the probability of obtaining any particular permutation, the calculation is identical to the one above, so that the probability of obtaining this permutation is also 1/<i class="emphasis">n</i>!.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">One might think that to prove that a permutation is a uniform random permutation it suffices to show that, for each element <i class="emphasis">A</i>[<i class="emphasis">i</i>], the probability that it winds up in position <i class="emphasis">j</i> is 1/<i class="emphasis">n</i>. <a class="internaljump" href="#ch05ex17">Exercise 5.3-4</a> shows that this weaker condition is, in fact, insufficient.</p>
<p class="para">A better method for generating a random permutation is to permute the given array in place. The procedure RANDOMIZE-IN-PLACE does so in <i class="emphasis">O</i>(<i class="emphasis">n</i>) time. <a name="330"></a><a name="IDX-103"></a>In iteration <i class="emphasis">i</i>, the element <i class="emphasis">A</i>[<i class="emphasis">i</i>] is chosen randomly from among elements <i class="emphasis">A</i>[<i class="emphasis">i</i>] through <i class="emphasis">A</i>[<i class="emphasis">n</i>]. Subsequent to iteration <i class="emphasis">i</i>, <i class="emphasis">A</i>[<i class="emphasis">i</i>] is never altered.</p>
<div class="informalexample">
<pre class="literallayout-normal">
RANDOMIZE-IN-PLACE(<i class="emphasis">A</i>)
1 <i class="emphasis">n</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">length</i>[<i class="emphasis">A</i>]
2 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&larr;</span></span> <b class="bold">to</b> <i class="emphasis">n</i>
3      <b class="bold">do</b> swap <i class="emphasis">A</i>[<i class="emphasis">i</i>] <span class="unicode"><span class="unicode">&harr;</span></span> <i class="emphasis">A</i>[RANDOM(<i class="emphasis">i</i>, <i class="emphasis">n</i>)]
</pre>
</div>
<p class="para">We will use a loop invariant to show that procedure RANDOMIZE-IN-PLACE produces a uniform random permutation. Given a set of <i class="emphasis">n</i> elements, a <i class="emphasis">k</i>-permutation is a sequence containing <i class="emphasis">k</i> of the <i class="emphasis">n</i> elements. (See <a href="DDU0247.html#3329" target="_parent" class="chapterjump">Appendix B</a>.) There are <i class="emphasis">n</i>!/(<i class="emphasis">n</i> - <i class="emphasis">k</i>)! such possible <i class="emphasis">k</i>-permutations.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 5.5</span></span><a name="331"></a><a name="ch05ex13"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Procedure RANDOMIZE-IN-PLACE computes a uniform random permutation.</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> We use the following loop invariant:</p>
<ul class="simple-list">
<li class="first-listitem">
<p class="first-para">Just prior to the <i class="emphasis">i</i>th iteration of the <b class="bold">for</b> loop of lines 2<span class="unicode">-</span>3, for each possible (<i class="emphasis">i</i> - 1)-permutation, the subarray <i class="emphasis">A</i>[1 <span class="unicode">..</span> <i class="emphasis">i</i> - 1] contains this (<i class="emphasis">i</i> - 1)-permutation with probability (<i class="emphasis">n</i> - <i class="emphasis">i</i> + 1)!/<i class="emphasis">n</i>!.</p>
</li>
</ul>
<p class="para">We need to show that this invariant is true prior to the first loop iteration, that each iteration of the loop maintains the invariant, and that the invariant provides a useful property to show correctness when the loop terminates.</p>
<ul class="simple-list">
<li class="first-listitem">
<p class="first-para">
<b class="bold">Initialization:</b> Consider the situation just before the first loop iteration, so that <i class="emphasis">i</i> = 1. The loop invariant says that for each possible 0-permutation, the sub-array <i class="emphasis">A</i>[1 <span class="unicode">..</span> 0] contains this 0-permutation with probability (<i class="emphasis">n</i> - <i class="emphasis">i</i> + 1)!/<i class="emphasis">n</i>! = <i class="emphasis">n</i>!/<i class="emphasis">n</i>! = 1. The subarray <i class="emphasis">A</i>[1 <span class="unicode">..</span> 0] is an empty subarray, and a 0-permutation has no elements. Thus, <i class="emphasis">A</i>[1 <span class="unicode">..</span> 0] contains any 0-permutation with probability 1, and the loop invariant holds prior to the first iteration.</p>
</li>
<li class="listitem">
<p class="first-para">
<b class="bold">Maintenance:</b> We assume that just before the (<i class="emphasis">i</i> - 1)st iteration, each possible (<i class="emphasis">i</i> - 1)-permutation appears in the subarray <i class="emphasis">A</i>[1 <span class="unicode">..</span> <i class="emphasis">i</i> - 1] with probability (<i class="emphasis">n</i> - <i class="emphasis">i</i> + 1)!/<i class="emphasis">n</i>!, and we will show that after the <i class="emphasis">i</i>th iteration, each possible <i class="emphasis">i</i>-permutation appears in the subarray <i class="emphasis">A</i>[1 <span class="unicode">..</span> <i class="emphasis">i</i>] with probability (<i class="emphasis">n</i> - <i class="emphasis">i</i>)!/<i class="emphasis">n</i>!. Incrementing <i class="emphasis">i</i> for the next iteration will then maintain the loop invariant.</p>
<p class="para">Let us examine the <i class="emphasis">i</i>th iteration. Consider a particular <i class="emphasis">i</i>-permutation, and denote the elements in it by <span class="unicode">&lt;</span><i class="emphasis">x</i><sub>1</sub>, <i class="emphasis">x</i><sub>2</sub>, ..., <i class="emphasis">x<sub>i</sub></i><span class="unicode">&gt;</span>. This permutation consists of an (<i class="emphasis">i</i> - 1)-permutation <span class="unicode">&lt;</span><i class="emphasis">x</i><sub>1</sub>, ..., <i class="emphasis">x</i><sub><i class="emphasis">i</i>-1</sub><span class="unicode">&gt;</span> followed by the value <i class="emphasis">x<sub>i</sub></i> that the algorithm places in <i class="emphasis">A</i>[<i class="emphasis">i</i>]. Let <i class="emphasis">E</i><sub>1</sub> denote the event in which the first <i class="emphasis">i</i> - 1 iterations have created the particular (<i class="emphasis">i</i> - 1)-permutation <span class="unicode">&lt;</span><i class="emphasis">x</i><sub>1</sub>,..., <i class="emphasis">x</i><sub><i class="emphasis">i</i>-1</sub><span class="unicode">&gt;</span> in <i class="emphasis">A</i>[1 <span class="unicode">..</span> <i class="emphasis">i</i> - 1]. By the <a name="332"></a><a name="IDX-104"></a>loop invariant, Pr {<i class="emphasis">E</i><sub>1</sub>} = (<i class="emphasis">n</i> - <i class="emphasis">i</i> + 1)!/<i class="emphasis">n</i>!. Let <i class="emphasis">E</i><sub>2</sub> be the event that <i class="emphasis">i</i>th iteration puts <i class="emphasis">x<sub>i</sub></i> in position <i class="emphasis">A</i>[<i class="emphasis">i</i>]. The <i class="emphasis">i</i>-permutation <span class="unicode">&lt;</span><i class="emphasis">x</i><sub>1</sub>, ..., <i class="emphasis">x<sub>i</sub></i><span class="unicode">&gt;</span> is formed in <i class="emphasis">A</i>[1 <span class="unicode">..</span> <i class="emphasis">i</i>] precisely when both <i class="emphasis">E</i><sub>1</sub> and <i class="emphasis">E</i><sub>2</sub> occur, and so we wish to compute Pr {<i class="emphasis">E</i><sub>2</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">E</i><sub>1</sub>}. Using <a href="DDU0254.html#3452" target="_parent" class="chapterjump">equation (C.14)</a>, we have</p>
<p class="para">Pr {<i class="emphasis">E</i><sub>2</sub> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">E</i><sub>1</sub>} = Pr{<i class="emphasis">E</i><sub>2</sub> | <i class="emphasis">E</i><sub>1</sub>}Pr{<i class="emphasis">E</i><sub>1</sub>}.</p>
<p class="para">The probability Pr {<i class="emphasis">E</i><sub>2</sub> | <i class="emphasis">E</i><sub>1</sub>} equals 1/(<i class="emphasis">n</i>-<i class="emphasis">i</i> + 1) because in line 3 the algorithm chooses <i class="emphasis">x<sub>i</sub></i> randomly from the <i class="emphasis">n</i> - <i class="emphasis">i</i> + 1 values in positions <i class="emphasis">A</i>[<i class="emphasis">i</i> <span class="unicode">..</span> <i class="emphasis">n</i>]. Thus, we have</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig126_01.jpg" height="90" width="259" alt="" border="0"></span>
</div>
</li>
<li class="listitem">
<p class="first-para">
<b class="bold">Termination:</b> At termination, <i class="emphasis">i</i> = <i class="emphasis">n</i> + 1, and we have that the subarray <i class="emphasis">A</i>[1 <span class="unicode">..</span> <i class="emphasis">n</i>] is a given <i class="emphasis">n</i>-permutation with probability (<i class="emphasis">n</i> - <i class="emphasis">n</i>)!/<i class="emphasis">n</i>! = 1/<i class="emphasis">n</i>!.</p>
<p class="last-para">Thus, RANDOMIZE-IN-PLACE produces a uniform random permutation.</p>
</li>
</ul>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">A randomized algorithm is often the simplest and most efficient way to solve a problem. We shall use randomized algorithms occasionally throughout this book.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.3-1</span></span><a name="333"></a><a name="ch05ex14"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Professor Marceau objects to the loop invariant used in the proof of <a class="internaljump" href="#ch05ex13">Lemma 5.5</a>. He questions whether it is true prior to the first iteration. His reasoning is that one could just as easily declare that an empty subarray contains no 0-permutations. Therefore, the probability that an empty subarray contains a 0-permutation should be 0, thus invalidating the loop invariant prior to the first iteration. Rewrite the procedure RANDOMIZE-IN-PLACE so that its associated loop invariant applies to a nonempty subarray prior to the first iteration, and modify the proof of <a class="internaljump" href="#ch05ex13">Lemma 5.5</a> for your procedure.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.3-2</span></span><a name="334"></a><a name="ch05ex15"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Professor Kelp decides to write a procedure that will produce at random any permutation besides the identity permutation. He proposes the following procedure:</p>
<pre class="literallayout-normal">
PERMUTE-WITHOUT-IDENTITY(<i class="emphasis">A</i>)
1 <i class="emphasis">n</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">length</i>[<i class="emphasis">A</i>]
2 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&larr;</span></span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
3      <b class="bold">do</b> swap <i class="emphasis">A</i>[<i class="emphasis">i</i>] <span class="unicode"><span class="unicode">&harr;</span></span> <i class="emphasis">A</i>[RANDOM(<i class="emphasis">i</i> + 1, <i class="emphasis">n</i>)]
</pre>
<a name="335"></a><a name="IDX-105"></a>
<p class="last-para">Does this code do what Professor Kelp intends?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.3-3</span></span><a name="336"></a><a name="ch05ex16"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Suppose that instead of swapping element <i class="emphasis">A</i>[<i class="emphasis">i</i>] with a random element from the subarray <i class="emphasis">A</i>[<i class="emphasis">i</i> <span class="unicode">..</span> <i class="emphasis">n</i>], we swapped it with a random element from anywhere in the array:</p>
<pre class="literallayout-normal">
PERMUTE-WITH-ALL(<i class="emphasis">A</i>)
1 <i class="emphasis">n</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">length</i>[<i class="emphasis">A</i>]
2 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&larr;</span></span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
3      <b class="bold">do</b> swap <i class="emphasis">A</i>[<i class="emphasis">i</i>] <span class="unicode"><span class="unicode">&harr;</span></span> <i class="emphasis">A</i>[RANDOM(1, <i class="emphasis">n</i>)]
</pre>
<p class="last-para">Does this code produce a uniform random permutation? Why or why not?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.3-4</span></span><a name="337"></a><a name="ch05ex17"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Professor Armstrong suggests the following procedure for generating a uniform random permutation:</p>
<pre class="literallayout-normal">
PERMUTE-BY-CYCLIC(<i class="emphasis">A</i>)
1  <i class="emphasis">n</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">length</i>[<i class="emphasis">A</i>]
2  <i class="emphasis">offset</i> <span class="unicode"><span class="unicode">&larr;</span></span> RANDOM(1, <i class="emphasis">n</i>)
3  <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&larr;</span></span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
4       <b class="bold">do</b> <i class="emphasis">dest</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">i</i> + <i class="emphasis">offset</i>
5          <b class="bold">if</b> <i class="emphasis">dest</i> <span class="unicode">&gt;</span> <i class="emphasis">n</i>
6             <b class="bold">then</b> <i class="emphasis">dest</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">dest</i> -<i class="emphasis">n</i>
7          <i class="emphasis">B</i>[<i class="emphasis">dest</i>] <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">A</i>[<i class="emphasis">i</i>]
8  <b class="bold">return</b> <i class="emphasis">B</i>
</pre>
<p class="last-para">Show that each element <i class="emphasis">A</i>[<i class="emphasis">i</i>] has a 1/<i class="emphasis">n</i> probability of winding up in any particular position in <i class="emphasis">B</i>. Then show that Professor Armstrong is mistaken by showing that the resulting permutation is not uniformly random.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.3-5: </span><span class="unicode"><span class="extended-unicode">&#9733;</span></span></span><a name="338"></a><a name="ch05ex18"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Prove that in the array <i class="emphasis">P</i> in procedure PERMUTE-BY-SORTING, the probability that all elements are unique is at least 1 - 1/<i class="emphasis">n</i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.3-6</span></span><a name="339"></a><a name="ch05ex19"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Explain how to implement the algorithm PERMUTE-BY-SORTING to handle the case in which two or more priorities are identical. That is, your algorithm should produce a uniform random permutation, even if two or more priorities are identical.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0030.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0032.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
