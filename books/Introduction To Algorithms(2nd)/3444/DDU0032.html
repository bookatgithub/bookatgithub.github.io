<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>5.4 &#9733; Probabilistic analysis and further uses of indicator random variables</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0031.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0033.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch05"></a>
<div class="section">
<h2 class="first-section-title">
<a name="340"></a><a name="ch05lev1sec4"></a><span class="section-titlelabel">5.4 </span><span class="unicode"><span class="extended-unicode">&#9733;</span></span> Probabilistic analysis and further uses of indicator random variables</h2>
<a name="341"></a><a name="IDX-106"></a>
<p class="para">This advanced section further illustrates probabilistic analysis by way of four examples. The first determines the probability that in a room of <i class="emphasis">k</i> people, some pair shares the same birthday. The second example examines the random tossing of balls into bins. The third investigates "streaks" of consecutive heads in coin flipping. The final example analyzes a variant of the hiring problem in which you have to make decisions without actually interviewing all the candidates.</p>
<div class="section">
<h3 class="sect3-title">
<a name="342"></a><a name="ch05lev2sec1"></a><span class="section-titlelabel">5.4.1 </span>The birthday paradox</h3>
<p class="first-para">Our first example is the <b class="bold"><i class="emphasis">birthday paradox</i></b>. How many people must there be in a room before there is a 50% chance that two of them were born on the same day of the year? The answer is surprisingly few. The paradox is that it is in fact far fewer than the number of days in a year, or even half the number of days in a year, as we shall see.</p>
<p class="para">To answer this question, we index the people in the room with the integers 1, 2, ..., <i class="emphasis">k</i>, where <i class="emphasis">k</i> is the number of people in the room. We ignore the issue of leap years and assume that all years have <i class="emphasis">n</i> = 365 days. For <i class="emphasis">i</i> = 1, 2, ..., <i class="emphasis">k</i>, let <i class="emphasis">b<sub>i</sub></i> be the day of the year on which person <i class="emphasis">i</i>'s birthday falls, where 1 <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">b<sub>i</sub></i> <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">n</i>. We also assume that birthdays are uniformly distributed across the <i class="emphasis">n</i> days of the year, so that Pr {<i class="emphasis">b<sub>i</sub></i> = <i class="emphasis">r</i>} = 1/<i class="emphasis">n</i> for <i class="emphasis">i</i> = 1, 2, ..., <i class="emphasis">k</i> and <i class="emphasis">r</i> = 1, 2, ..., <i class="emphasis">n</i>.</p>
<p class="para">The probability that two given people, say <i class="emphasis">i</i> and <i class="emphasis">j</i>, have matching birthdays depends on whether the random selection of birthdays is independent. We assume from now on that birthdays are independent, so that the probability that <i class="emphasis">i</i>'s birthday and <i class="emphasis">j</i>'s birthday both fall on day <i class="emphasis">r</i> is</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">Pr {<i class="emphasis">b<sub>i</sub></i> = <i class="emphasis">r</i> and <i class="emphasis">b<sub>j</sub></i> = <i class="emphasis">r</i>}</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">Pr{<i class="emphasis">b<sub>i</sub></i> = <i class="emphasis">r</i>}Pr{<i class="emphasis">b<sub>j</sub></i> = <i class="emphasis">r</i>}</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">1/<i class="emphasis">n</i><sup>2</sup>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">Thus, the probability that they both fall on the same day is</p>
<div class="equation">
<a name="343"></a><a name="ch05eq07"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(5.7)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig128_01.jpg" height="106" width="263" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">More intuitively, once <i class="emphasis">b<sub>i</sub></i> is chosen, the probability that <i class="emphasis">b<sub>j</sub></i> is chosen to be the same day is 1/<i class="emphasis">n</i>. Thus, the probability that <i class="emphasis">i</i> and <i class="emphasis">j</i> have the same birthday is the same as the probability that the birthday of one of them falls on a given day. Notice, <a name="344"></a><a name="IDX-107"></a>however, that this coincidence depends on the assumption that the birthdays are independent.</p>
<p class="para">We can analyze the probability of at least 2 out of <i class="emphasis">k</i> people having matching birthdays by looking at the complementary event. The probability that at least two of the birthdays match is 1 minus the probability that all the birthdays are different. The event that <i class="emphasis">k</i> people have distinct birthdays is</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig129_01.jpg" height="43" width="80" alt="" border="0"></span>
</div>
<p class="para">where <i class="emphasis">A<sub>i</sub></i> is the event that person <i class="emphasis">i</i>'s birthday is different from person <i class="emphasis">j</i>'s for all <i class="emphasis">j</i> <span class="unicode">&lt;</span> <i class="emphasis">i</i>. Since we can write <i class="emphasis">B<sub>k</sub></i> = <i class="emphasis">A<sub>k</sub></i> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">B</i><sub><i class="emphasis">k</i>-1</sub>, we obtain from <a href="DDU0254.html#3456" target="_parent" class="chapterjump">equation (C.16)</a> the recurrence</p>
<div class="equation">
<a name="345"></a><a name="ch05eq08"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(5.8)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig129_02.jpg" height="16" width="214" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">where we take Pr{<i class="emphasis">B</i><sub>1</sub>} = Pr{<i class="emphasis">A</i><sub>1</sub>} = 1 as an initial condition. In other words, the probability that <i class="emphasis">b</i><sub>1</sub>, <i class="emphasis">b</i><sub>2</sub>, ..., <i class="emphasis">b<sub>k</sub></i> are distinct birthdays is the probability that <i class="emphasis">b</i><sub>1</sub>, <i class="emphasis">b</i><sub>2</sub>, ..., <i class="emphasis">b</i><sub><i class="emphasis">k</i>-1</sub> are distinct birthdays times the probability that <i class="emphasis">b<sub>k</sub></i> <span class="unicode"><span class="unicode">&ne;</span></span> <i class="emphasis">b<sub>i</sub></i> for <i class="emphasis">i</i> = 1, 2, ..., <i class="emphasis">k</i> - 1, given that <i class="emphasis">b</i><sub>1</sub>, <i class="emphasis">b</i><sub>2</sub>, ..., <i class="emphasis">b</i><sub><i class="emphasis">k</i>-1</sub> are distinct.</p>
<p class="para">If <i class="emphasis">b</i><sub>1</sub>, <i class="emphasis">b</i><sub>2</sub>, ..., <i class="emphasis">b</i><sub><i class="emphasis">k</i>-1</sub> are distinct, the conditional probability that <i class="emphasis">b<sub>k</sub></i> <span class="unicode"><span class="unicode">&ne;</span></span> <i class="emphasis">b<sub>i</sub></i> for <i class="emphasis">i</i> = 1, 2, ..., <i class="emphasis">k</i> - 1 is Pr {<i class="emphasis">A<sub>k</sub></i> | <i class="emphasis">B</i><sub><i class="emphasis">k</i>-1</sub>} = (<i class="emphasis">n</i> - <i class="emphasis">k</i> + 1)/<i class="emphasis">n</i>, since out of the <i class="emphasis">n</i> days, there are <i class="emphasis">n</i> - (<i class="emphasis">k</i> - 1) that are not taken. We iteratively apply the recurrence (<a class="internaljump" href="#ch05eq08">5.8</a>) to obtain</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig129_03.jpg" height="170" width="373" alt="" border="0"></span>
</div>
<p class="para">Inequality (3.11), 1 + <i class="emphasis">x</i> <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">e<sub>x</sub></i>, gives us</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig129_04.jpg" height="85" width="217" alt="" border="0"></span>
</div>
<p class="para">when -<i class="emphasis">k</i>(<i class="emphasis">k</i> - 1)/2<i class="emphasis">n</i> <span class="unicode"><span class="unicode">&le;</span></span> ln(1/2). The probability that all <i class="emphasis">k</i> birthdays are distinct is at most 1/2 when <i class="emphasis">k</i>(<i class="emphasis">k</i> - 1) = 2<i class="emphasis">n</i> ln 2 or, solving the quadratic equation, when <a name="346"></a><a name="IDX-108"></a><span class="inlinemediaobject"><img src="images/fig130_01.jpg" height="13" width="130" alt="" border="0"></span>. For <i class="emphasis">n</i> = 365, we must have <i class="emphasis">k</i> <span class="unicode"><span class="unicode">&ge;</span></span> 23. Thus, if at least 23 people are in a room, the probability is at least 1/2 that at least two people have the same birthday. On Mars, a year is 669 Martian days long; it therefore takes 31 Martians to get the same effect.</p>
<div class="section">
<h4 class="sect4-title">An analysis using indicator random variables</h4>
<p class="first-para">We can use indicator random variables to provide a simpler but approximate analysis of the birthday paradox. For each pair (<i class="emphasis">i</i>, <i class="emphasis">j</i>) of the <i class="emphasis">k</i> people in the room, we define the indicator random variable <i class="emphasis">X<sub>ij</sub></i>, for 1 <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">i</i> <span class="unicode">&lt;</span> <i class="emphasis">j</i> <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">k</i>, by</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig130_02.jpg" height="57" width="373" alt="" border="0"></span>
</div>
<p class="para">By <a class="internaljump" href="#ch05eq07">equation (5.7)</a>, the probability that two people have matching birthdays is 1/<i class="emphasis">n</i>, and thus by <a href="DDU0030.html#311" target="_parent" class="chapterjump">Lemma 5.1</a>, we have</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">E [<i class="emphasis">X<sub>ij</sub></i>]</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">Pr{person <i class="emphasis">i</i> and person <i class="emphasis">j</i> have the same birthday}</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">1/<i class="emphasis">n</i>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">Letting <i class="emphasis">X</i> be the random variable that counts the number of pairs of individuals having the same birthday, we have</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig130_03.jpg" height="45" width="114" alt="" border="0"></span>
</div>
<p class="para">Taking expectations of both sides and applying linearity of expectation, we obtain</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig130_04.jpg" height="175" width="175" alt="" border="0"></span>
</div>
<p class="para">When <i class="emphasis">k</i>(<i class="emphasis">k</i> - 1) <span class="unicode"><span class="unicode">&ge;</span></span> 2<i class="emphasis">n</i>, therefore, the expected number of pairs of people with the same birthday is at least 1. Thus, if we have at least <span class="inlinemediaobject"><img src="images/fig130_05.jpg" height="14" width="38" alt="" border="0"></span> individuals in a room, we can expect at least two to have the same birthday. For <i class="emphasis">n</i> = 365, if <i class="emphasis">k</i> = 28, the expected number of pairs with the same birthday is (28 <span class="unicode">&middot;</span> 27)/(2 <span class="unicode">&middot;</span> 365) <span class="unicode"><span class="unicode">&asymp;</span></span> 1.0356.<a name="347"></a><a name="IDX-109"></a>
</p>
<p class="para">Thus, with at least 28 people, we expect to find at least one matching pair of birth-days. On Mars, where a year is 669 Martian days long, we need at least 38 Martians.</p>
<p class="last-para">The first analysis, which used only probabilities, determined the number of people required for the probability to exceed 1/2 that a matching pair of birthdays exists, and the second analysis, which used indicator random variables, determined the number such that the expected number of matching birthdays is 1. Although the exact numbers of people differ for the two situations, they are the same asymptotically: <span class="inlinemediaobject"><img src="images/fig131_01.jpg" height="14" width="33" alt="" border="0"></span>.</p>

</div>

</div>
<div class="section">
<h3 class="sect3-title">
<a name="348"></a><a name="ch05lev2sec2"></a><span class="section-titlelabel">5.4.2 </span>Balls and bins</h3>
<p class="first-para">Consider the process of randomly tossing identical balls into <i class="emphasis">b</i> bins, numbered 1, 2,..., <i class="emphasis">b</i>. The tosses are independent, and on each toss the ball is equally likely to end up in any bin. The probability that a tossed ball lands in any given bin is 1/<i class="emphasis">b</i>. Thus, the ball-tossing process is a sequence of Bernoulli trials (see <a href="DDU0256.html#3498" target="_parent" class="chapterjump">Appendix C.4</a>) with a probability 1/<i class="emphasis">b</i> of success, where success means that the ball falls in the given bin. This model is particularly useful for analyzing hashing (see <a href="DDU0063.html#698" target="_parent" class="chapterjump">Chapter 11</a>), and we can answer a variety of interesting questions about the ball-tossing process. (<a href="DDU0253.html#3426" target="_parent" class="chapterjump">Problem C-1</a> asks additional questions about balls and bins.)</p>
<p class="para">
<i class="emphasis">How many balls fall in a given bin?</i> The number of balls that fall in a given bin follows the binomial distribution <i class="emphasis">b</i>(<i class="emphasis">k</i>; <i class="emphasis">n</i>, 1/<i class="emphasis">b</i>). If <i class="emphasis">n</i> balls are tossed, <a href="DDU0256.html#3511" target="_parent" class="chapterjump">equation (C.36)</a> tells us that the expected number of balls that fall in the given bin is <i class="emphasis">n</i>/<i class="emphasis">b</i>.</p>
<p class="para">
<i class="emphasis">How many balls must one toss, on the average, until a given bin contains a ball?</i> The number of tosses until the given bin receives a ball follows the geometric distribution with probability 1/<i class="emphasis">b</i> and, by <a href="DDU0256.html#3503" target="_parent" class="chapterjump">equation (C.31)</a>, the expected number of tosses until success is 1/(1/<i class="emphasis">b</i>) = <i class="emphasis">b</i>.</p>
<p class="para">
<i class="emphasis">How many balls must one toss until every bin contains at least one ball?</i> Let us call a toss in which a ball falls into an empty bin a "hit." We want to know the expected number <i class="emphasis">n</i> of tosses required to get <i class="emphasis">b</i> hits.</p>
<p class="para">The hits can be used to partition the <i class="emphasis">n</i> tosses into stages. The <i class="emphasis">i</i>th stage consists of the tosses after the (<i class="emphasis">i</i> - 1)st hit until the <i class="emphasis">i</i>th hit. The first stage consists of the first toss, since we are guaranteed to have a hit when all bins are empty. For each toss during the <i class="emphasis">i</i>th stage, there are <i class="emphasis">i</i> - 1 bins that contain balls and <i class="emphasis">b</i> - <i class="emphasis">i</i> + 1 empty bins. Thus, for each toss in the <i class="emphasis">i</i>th stage, the probability of obtaining a hit is (<i class="emphasis">b</i>-<i class="emphasis">i</i> +1)/<i class="emphasis">b</i>.</p>
<p class="para">Let <i class="emphasis">n<sub>i</sub></i> denote the number of tosses in the <i class="emphasis">i</i>th stage. Thus, the number of tosses required to get <i class="emphasis">b</i> hits is <span class="inlinemediaobject"><img src="images/fig131_02.jpg" height="21" width="80" alt="" border="0"></span>. Each random variable <i class="emphasis">n<sub>i</sub></i> has a geometric distribution with probability of success (<i class="emphasis">b</i> - <i class="emphasis">i</i> + 1)/<i class="emphasis">b</i> and, by <a href="DDU0256.html#3503" target="_parent" class="chapterjump">equation (C.31)</a>,</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig131_03.jpg" height="34" width="122" alt="" border="0"></span>
</div>
<a name="349"></a><a name="IDX-110"></a>
<p class="para">By linearity of expectation,</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig132_01.jpg" height="210" width="165" alt="" border="0"></span>
</div>
<p class="last-para">The last line follows from the bound (A.7) on the harmonic series. It therefore takes approximately <i class="emphasis">b</i> ln <i class="emphasis">b</i> tosses before we can expect that every bin has a ball. This problem is also known as the <b class="bold"><i class="emphasis">coupon collector's problem</i></b>, and says that a person trying to collect each of <i class="emphasis">b</i> different coupons must acquire approximately <i class="emphasis">b</i> ln <i class="emphasis">b</i> randomly obtained coupons in order to succeed.</p>

</div>
<div class="section">
<h3 class="sect3-title">
<a name="350"></a><a name="ch05lev2sec3"></a><span class="section-titlelabel">5.4.3 </span>Streaks</h3>
<p class="first-para">Suppose you flip a fair coin <i class="emphasis">n</i> times. What is the longest streak of consecutive heads that you expect to see? The answer is <span class="unicode"><span class="unicode">&Theta;</span></span>(lg <i class="emphasis">n</i>), as the following analysis shows.</p>
<p class="para">We first prove that the expected length of the longest streak of heads is <i class="emphasis">O</i>(lg <i class="emphasis">n</i>). The probability that each coin flip is a head is 1/2. Let <i class="emphasis">A<sub>ik</sub></i> be the event that a streak of heads of length at least <i class="emphasis">k</i> begins with the <i class="emphasis">i</i>th coin flip or, more precisely, the event that the <i class="emphasis">k</i> consecutive coin flips <i class="emphasis">i</i>, <i class="emphasis">i</i> + 1, ..., <i class="emphasis">i</i> + <i class="emphasis">k</i> - 1 yield only heads, where 1 <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">k</i> <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">n</i> and 1 <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">n</i> -<i class="emphasis">k</i> +1. Since coin flips are mutually independent, for any given event <i class="emphasis">A<sub>ik</sub></i>, the probability that all <i class="emphasis">k</i> flips are heads is</p>
<div class="equation">
<a name="351"></a><a name="ch05eq09"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(5.9)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig132_02.jpg" height="117" width="163" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">and thus the probability that a streak of heads of length at least 2 <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span> begins in position <i class="emphasis">i</i> is quite small. There are at most <i class="emphasis">n</i> - 2 <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span> + 1 positions where such <a name="352"></a><a name="IDX-111"></a>a streak can begin. The probability that a streak of heads of length at least 2 <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span> begins anywhere is therefore</p>
<div class="equation">
<a name="353"></a><a name="ch05eq10"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(5.10)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig133_01.jpg" height="111" width="265" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">since by Boole's inequality (C.18), the probability of a union of events is at most the sum of the probabilities of the individual events. (Note that Boole's inequality holds even for events such as these that are not independent.)</p>
<p class="para">We now use inequality (<a class="internaljump" href="#ch05eq10">5.10</a>) to bound the length of the longest streak. For <i class="emphasis">j</i> = 0, 1, 2,..., <i class="emphasis">n</i>, let <i class="emphasis">L<sub>j</sub></i> be the event that the longest streak of heads has length exactly <i class="emphasis">j</i>, and let <i class="emphasis">L</i> be the length of the longest streak. By the definition of expected value,</p>
<div class="equation">
<a name="354"></a><a name="ch05eq11"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(5.11)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig133_02.jpg" height="42" width="137" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">We could try to evaluate this sum using upper bounds on each Pr {<i class="emphasis">L<sub>j</sub></i>} similar to those computed in inequality (<a class="internaljump" href="#ch05eq10">5.10</a>). Unfortunately, this method would yield weak bounds. We can use some intuition gained by the above analysis to obtain a good bound, however. Informally, we observe that for no individual term in the summation in <a class="internaljump" href="#ch05eq11">equation (5.11)</a> are both the factors <i class="emphasis">j</i> and Pr {<i class="emphasis">L<sub>j</sub></i>} large. Why? When <i class="emphasis">j</i> <span class="unicode"><span class="unicode">&ge;</span></span> 2 <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span>, then Pr {<i class="emphasis">L<sub>j</sub></i>} is very small, and when <i class="emphasis">j</i> <span class="unicode">&lt;</span> 2 <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg<i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span>, then <i class="emphasis">j</i> is fairly small. More formally, we note that the events <i class="emphasis">L<sub>j</sub></i> for <i class="emphasis">j</i> = 0, 1,..., <i class="emphasis">n</i> are disjoint, and so the probability that a streak of heads of length at least 2 <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span> begins anywhere is <span class="inlinemediaobject"><img src="images/fig133_03.jpg" height="15" width="77" alt="" border="0"></span>. By inequality (<a class="internaljump" href="#ch05eq10">5.10</a>), we have <span class="inlinemediaobject"><img src="images/fig133_04.jpg" height="15" width="109" alt="" border="0"></span>. Also, noting that <span class="inlinemediaobject"><img src="images/fig133_05.jpg" height="15" width="80" alt="" border="0"></span>, we have that <span class="inlinemediaobject"><img src="images/fig133_06.jpg" height="17" width="96" alt="" border="0"></span>. Thus, we obtain</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig133_07.jpg" height="145" width="327" alt="" border="0"></span>
</div>
<a name="355"></a><a name="IDX-112"></a>
<div class="informalequation">
<span class="equation-image"><img src="images/fig134_01.jpg" height="87" width="274" alt="" border="0"></span>
</div>
<p class="para">The chances that a streak of heads exceeds <i class="emphasis">r</i> <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span> flips diminish quickly with <i class="emphasis">r</i>. For <i class="emphasis">r</i> <span class="unicode"><span class="unicode">&ge;</span></span> 1, the probability that a streak of <i class="emphasis">r</i> <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span> heads starts in position <i class="emphasis">i</i> is</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">Pr {<i class="emphasis">A</i><sub><i class="emphasis">i,r</i><span class="extended-unicode"><span class="extended-unicode">&lceil;</span> lg <i class="emphasis">n</i><span class="extended-unicode"><span class="extended-unicode">&rceil;</span></span></span></sub>}</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">1/2<sup><i class="emphasis">r</i><span class="extended-unicode"><span class="extended-unicode">&lceil;</span> lg <i class="emphasis">n</i><span class="extended-unicode"><span class="extended-unicode">&rceil;</span></span></span></sup>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode"><span class="unicode">&le;</span></span>
</p>
</td><td class="td" align="left">
<p class="table-para">1/<i class="emphasis">n<sup>r</sup></i>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">Thus, the probability is at most <i class="emphasis">n</i>/<i class="emphasis">n<sup>r</sup></i> = 1/<i class="emphasis">n</i><sup><i class="emphasis">r</i>-1</sup> that the longest streak is at least <i class="emphasis">r</i> <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span>, or equivalently, the probability is at least 1 - 1/<i class="emphasis">n</i><sup><i class="emphasis">r</i>-1</sup> that the longest streak has length less than <i class="emphasis">r</i> <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span>.</p>
<p class="para">As an example, for <i class="emphasis">n</i> = 1000 coin flips, the probability of having a streak of at least 2 <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span> = 20 heads is at most 1/<i class="emphasis">n</i> = 1/1000. The chances of having a streak longer than 3 <span class="unicode"><span class="extended-unicode">&lceil;</span></span>lg <i class="emphasis">n</i><span class="unicode"><span class="extended-unicode">&rceil;</span></span> = 30 heads is at most 1/<i class="emphasis">n</i><sup>2</sup> = 1/1,000,000.</p>
<p class="para">We now prove a complementary lower bound: the expected length of the longest streak of heads in <i class="emphasis">n</i> coin flips is <span class="unicode"><span class="unicode">&#8486;</span></span>(lg <i class="emphasis">n</i>). To prove this bound, we look for streaks of length <i class="emphasis">s</i> by partitioning the <i class="emphasis">n</i> flips into approximately <i class="emphasis">n</i>/<i class="emphasis">s</i> groups of <i class="emphasis">s</i> flips each. If we choose <i class="emphasis">s</i> = <span class="unicode"><span class="extended-unicode">&lfloor;</span></span>(lg <i class="emphasis">n</i>)/2<span class="unicode"><span class="extended-unicode">&rfloor;</span></span>, we can show that it is likely that at least one of these groups comes up all heads, and hence it is likely that the longest streak has length at least <i class="emphasis">s</i> = <span class="unicode"><span class="unicode">&#8486;</span></span>(lg <i class="emphasis">n</i>). We will then show that the longest streak has expected length <span class="unicode"><span class="unicode">&#8486;</span></span>(lg <i class="emphasis">n</i>).</p>
<p class="para">We partition the <i class="emphasis">n</i> coin flips into at least <span class="unicode"><span class="extended-unicode">&lfloor;</span></span><i class="emphasis">n</i>/ <span class="unicode"><span class="extended-unicode">&lfloor;</span></span>(lg <i class="emphasis">n</i>)/2<span class="unicode"><span class="extended-unicode">&rfloor;</span></span><span class="unicode"><span class="extended-unicode">&rfloor;</span></span> groups of <span class="unicode"><span class="extended-unicode">&lfloor;</span></span>(lg <i class="emphasis">n</i>)/2<span class="unicode"><span class="extended-unicode">&rfloor;</span></span> consecutive flips, and we bound the probability that no group comes up all heads. By <a class="internaljump" href="#ch05eq09">equation (5.9)</a>, the probability that the group starting in position <i class="emphasis">i</i> comes up all heads is</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">Pr {<i class="emphasis">A</i><sub><i class="emphasis">i,</i><span class="extended-unicode"><span class="extended-unicode">&lfloor;</span> (lg <i class="emphasis">n</i>)/<span class="extended-unicode"><span class="extended-unicode">&rfloor;</span></span></span></sub>}</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">1/2<sup><span class="extended-unicode"><span class="extended-unicode">&lfloor;</span>(lg<i class="emphasis">n</i>)/<span class="extended-unicode"><span class="extended-unicode">&rfloor;</span></span></span></sup>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode"><span class="unicode">&ge;</span></span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig134_02.jpg" height="20" width="42" alt="" border="0"></span>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">The probability that a streak of heads of length at least <span class="unicode"><span class="extended-unicode">&lfloor;</span></span>(lg <i class="emphasis">n</i>)/2<span class="unicode"><span class="extended-unicode">&rfloor;</span></span> does not begin in position <i class="emphasis">i</i> is therefore at most <span class="inlinemediaobject"><img src="images/fig134_03.jpg" height="13" width="46" alt="" border="0"></span>. Since the <span class="unicode"><span class="extended-unicode">&lfloor;</span></span><i class="emphasis">n</i>/ <span class="unicode"><span class="extended-unicode">&lfloor;</span></span>(lg <i class="emphasis">n</i>)/2<span class="unicode"><span class="extended-unicode">&rfloor;</span></span><span class="unicode"><span class="extended-unicode">&rfloor;</span></span> groups are formed from mutually exclusive, independent coin flips, the probability that every one of these groups <i class="emphasis">fails</i> to be a streak of length <span class="unicode"><span class="extended-unicode">&lfloor;</span></span>(lg <i class="emphasis">n</i>)/2<span class="unicode"><span class="extended-unicode">&rfloor;</span></span> is at most</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig134_04.jpg" height="109" width="305" alt="" border="0"></span>
</div>
<a name="356"></a><a name="IDX-113"></a>
<p class="para">For this argument, we used inequality (3.11), 1 + <i class="emphasis">x</i> <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">e<sup>x</sup></i> , and the fact, which you might want to verify, that <span class="inlinemediaobject"><img src="images/fig135_01.jpg" height="13" width="113" alt="" border="0"></span> for sufficiently large <i class="emphasis">n</i>.</p>
<p class="para">Thus, the probability that the longest streak exceeds <span class="unicode"><span class="extended-unicode">&lfloor;</span></span>(lg <i class="emphasis">n</i>)/2<span class="unicode"><span class="extended-unicode">&rfloor;</span></span> is</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(5.12)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig135_02.jpg" height="43" width="211" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">We can now calculate a lower bound on the expected length of the longest streak, beginning with <a class="internaljump" href="#ch05eq11">equation (5.11)</a> and proceeding in a manner similar to our analysis of the upper bound:</p>
<div class="informalequation">
<span class="equation-image"><a href="images/fig135%5F03%2Ejpg" NAME="IMG_249" target="_parent"><img src="images/fig135_03.jpg" height="233" width="400" alt="Click To expand" border="0"></a></span>
</div>
<p class="para">As with the birthday paradox, we can obtain a simpler but approximate analysis using indicator random variables. We let <i class="emphasis">X<sub>ik</sub></i> = I{<i class="emphasis">A<sub>ik</sub></i>} be the indicator random variable associated with a streak of heads of length at least <i class="emphasis">k</i> beginning with the <i class="emphasis">i</i>th coin flip. To count the total number of such streaks, we define</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig135_04.jpg" height="43" width="93" alt="" border="0"></span>
</div>
<p class="para">Taking expectations and using linearity of expectation, we have</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig135_05.jpg" height="141" width="153" alt="" border="0"></span>
</div>
<a name="357"></a><a name="IDX-114"></a>
<div class="informalequation">
<span class="equation-image"><img src="images/fig136_01.jpg" height="81" width="94" alt="" border="0"></span>
</div>
<p class="para">By plugging in various values for <i class="emphasis">k</i>, we can calculate the expected number of streaks of length <i class="emphasis">k</i>. If this number is large (much greater than 1), then many streaks of length <i class="emphasis">k</i> are expected to occur and the probability that one occurs is high. If this number is small (much less than 1), then very few streaks of length <i class="emphasis">k</i> are expected to occur and the probability that one occurs is low. If <i class="emphasis">k</i> = <i class="emphasis">c</i> lg <i class="emphasis">n</i>, for some positive constant <i class="emphasis">c</i>, we obtain</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig136_02.jpg" height="126" width="204" alt="" border="0"></span>
</div>
<p class="last-para">If <i class="emphasis">c</i> is large, the expected number of streaks of length <i class="emphasis">c</i> lg <i class="emphasis">n</i> is very small, and we conclude that they are unlikely to occur. On the other hand, if <i class="emphasis">c</i> <span class="unicode">&lt;</span> 1/2, then we obtain E [<i class="emphasis">X</i>] = <span class="unicode"><span class="unicode">&Theta;</span></span>(1/<i class="emphasis">n</i><sup>1/2-1</sup>) = <span class="unicode"><span class="unicode">&Theta;</span></span>(<i class="emphasis">n</i><sup>1/2</sup>), and we expect that there will be a large number of streaks of length (1/2) lg <i class="emphasis">n</i>. Therefore, one streak of such a length is very likely to occur. From these rough estimates alone, we can conclude that the length of the longest streak is <span class="unicode"><span class="unicode">&Theta;</span></span>(lg <i class="emphasis">n</i>).</p>

</div>
<div class="section">
<h3 class="sect3-title">
<a name="358"></a><a name="ch05lev2sec4"></a><span class="section-titlelabel">5.4.4 </span>The on-line hiring problem</h3>
<p class="first-para">As a final example, we consider a variant of the hiring problem. Suppose now that we do not wish to interview all the candidates in order to find the best one. We also do not wish to hire and fire as we find better and better applicants. Instead, we are willing to settle for a candidate who is close to the best, in exchange for hiring exactly once. We must obey one company requirement: after each interview we must either immediately offer the position to the applicant or must tell them that they will not receive the job. What is the trade-off between minimizing the amount of interviewing and maximizing the quality of the candidate hired?</p>
<p class="para">We can model this problem in the following way. After meeting an applicant, we are able to give each one a score; let <i class="emphasis">score</i>(<i class="emphasis">i</i>) denote the score given to the <i class="emphasis">i</i>th applicant, and assume that no two applicants receive the same score. After we have seen <i class="emphasis">j</i> applicants, we know which of the <i class="emphasis">j</i> has the highest score, but we do not know if any of the remaining <i class="emphasis">n</i> - <i class="emphasis">j</i> applicants will have a higher score. We decide to adopt the strategy of selecting a positive integer <i class="emphasis">k</i> <span class="unicode">&lt;</span> <i class="emphasis">n</i>, interviewing and <a name="359"></a><a name="IDX-115"></a>then rejecting the first <i class="emphasis">k</i> applicants, and hiring the first applicant thereafter who has a higher score than all preceding applicants. If it turns out that the best-qualified applicant was among the first <i class="emphasis">k</i> interviewed, then we will hire the <i class="emphasis">n</i>th applicant. This strategy is formalized in the procedure ON-LINE-MAXIMUM(<i class="emphasis">k</i>, <i class="emphasis">n</i>), which appears below. Procedure ON-LINE-MAXIMUM returns the index of the candidate we wish to hire.</p>
<div class="informalexample">
<pre class="literallayout-normal">
ON-LINE-MAXIMUM(<i class="emphasis">k</i>, <i class="emphasis">n</i>)
1 bestscore <span class="unicode"><span class="unicode">&larr;</span></span> -<span class="unicode"><span class="unicode">&infin;</span></span>
2 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&larr;</span></span> <b class="bold">to</b> <i class="emphasis">k</i>
3      <b class="bold">do if</b> <i class="emphasis">score</i>(<i class="emphasis">i</i>) <span class="unicode">&gt;</span> <i class="emphasis">bestscore</i>
4            <b class="bold">then</b> <i class="emphasis">bestscore</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">score</i>(<i class="emphasis">i</i>)
5 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&larr;</span></span> <i class="emphasis">k</i> + 1 <b class="bold">to</b> <i class="emphasis">n</i>
6      <b class="bold">do if</b> <i class="emphasis">score</i>(<i class="emphasis">i</i>) <span class="unicode">&gt;</span> <i class="emphasis">bestscore</i>
7            <b class="bold">then return</b> <i class="emphasis">i</i>
8 <b class="bold">return</b> <i class="emphasis">n</i>
</pre>
</div>
<p class="para">We wish to determine, for each possible value of <i class="emphasis">k</i>, the probability that we hire the most qualified applicant. We will then choose the best possible <i class="emphasis">k</i>, and implement the strategy with that value. For the moment, assume that <i class="emphasis">k</i> is fixed. Let <i class="emphasis">M</i>(<i class="emphasis">j</i>) = max<sub><span class="unicode"><span class="unicode">&le;</span><i class="emphasis">i</i><span class="unicode"><span class="unicode">&le;</span><i class="emphasis">j</i></span></span></sub> {<i class="emphasis">score</i>(<i class="emphasis">i</i>)} denote the maximum score among applicants 1 through <i class="emphasis">j</i>. Let <i class="emphasis">S</i> be the event that we succeed in choosing the best-qualified applicant, and let <i class="emphasis">S<sub>i</sub></i> be the event that we succeed when the best-qualified applicant is the <i class="emphasis">i</i>th one interviewed. Since the various <i class="emphasis">S<sub>i</sub></i> are disjoint, we have that <span class="inlinemediaobject"><img src="images/fig137_01.jpg" height="14" width="98" alt="" border="0"></span>. Noting that we never succeed when the best-qualified applicant is one of the first <i class="emphasis">k</i>, we have that Pr {<i class="emphasis">S<sub>i</sub></i>} = 0 for <i class="emphasis">i</i> = 1, 2,..., <i class="emphasis">k</i>. Thus, we obtain</p>
<div class="equation">
<a name="360"></a><a name="ch05eq13"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(5.13)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig137_02.jpg" height="41" width="135" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">We now compute Pr {<i class="emphasis">S<sub>i</sub></i>}. In order to succeed when the best-qualified applicant is the <i class="emphasis">i</i>th one, two things must happen. First, the best-qualified applicant must be in position <i class="emphasis">i</i>, an event which we denote by <i class="emphasis">B<sub>i</sub></i>. Second, the algorithm must not select any of the applicants in positions <i class="emphasis">k</i> + 1 through <i class="emphasis">i</i> - 1, which happens only if, for each <i class="emphasis">j</i> such that <i class="emphasis">k</i> + 1 <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">j</i> <span class="unicode"><span class="unicode">&le;</span></span> <i class="emphasis">i</i> - 1, we find that <i class="emphasis">score</i>(<i class="emphasis">j</i>) <span class="unicode">&lt;</span> <i class="emphasis">bestscore</i> in line 6. (Because scores are unique, we can ignore the possibility of <i class="emphasis">score</i>(<i class="emphasis">j</i>) = <i class="emphasis">bestscore</i>.) In other words, it must be the case that all of the values <i class="emphasis">score</i>(<i class="emphasis">k</i> + 1) through <i class="emphasis">score</i>(<i class="emphasis">i</i> - 1) are less than <i class="emphasis">M</i>(<i class="emphasis">k</i>); if any are greater than <i class="emphasis">M</i>(<i class="emphasis">k</i>) we will instead return the index of the first one that is greater. We use <i class="emphasis">O<sub>i</sub></i> to denote the event that none of the applicants in position <i class="emphasis">k</i> + 1 through <i class="emphasis">i</i> - 1 are chosen. Fortunately, the two events <i class="emphasis">B<sub>i</sub></i> and <i class="emphasis">O<sub>i</sub></i> are independent. The event <i class="emphasis">O<sub>i</sub></i> depends only on the relative <a name="361"></a><a name="IDX-116"></a>ordering of the values in positions 1 through <i class="emphasis">i</i> - 1, whereas <i class="emphasis">B<sub>i</sub></i> depends only on whether the value in position <i class="emphasis">i</i> is greater than all the values 1 through <i class="emphasis">i</i> - 1. The ordering of positions 1 through <i class="emphasis">i</i> - 1 does not affect whether <i class="emphasis">i</i> is greater than all of them, and the value of <i class="emphasis">i</i> does not affect the ordering of positions 1 through <i class="emphasis">i</i> - 1. Thus we can apply <a href="DDU0254.html#3453" target="_parent" class="chapterjump">equation (C.15)</a> to obtain</p>
<p class="para">Pr {<i class="emphasis">S<sub>i</sub></i>} = Pr {<i class="emphasis">B<sub>i</sub></i> <span class="unicode"><span class="unicode">&cap;</span></span> <i class="emphasis">O<sub>i</sub></i>} = Pr {<i class="emphasis">B<sub>i</sub></i>} Pr {<i class="emphasis">O<sub>i</sub></i>}.</p>
<p class="para">The probability Pr {<i class="emphasis">B<sub>i</sub></i>} is clearly 1/<i class="emphasis">n</i>, since the maximum is equally likely to be in any one of the <i class="emphasis">n</i> positions. For event <i class="emphasis">O<sub>i</sub></i> to occur, the maximum value in positions 1 through <i class="emphasis">i</i> - 1 must be in one of the first <i class="emphasis">k</i> positions, and it is equally likely to be in any of these <i class="emphasis">i</i> - 1 positions. Consequently, Pr {<i class="emphasis">O<sub>i</sub></i>} = <i class="emphasis">k</i>/(<i class="emphasis">i</i> - 1) and Pr {<i class="emphasis">S<sub>i</sub></i>} = <i class="emphasis">k</i>/(<i class="emphasis">n</i>(<i class="emphasis">i</i> - 1)). Using <a class="internaljump" href="#ch05eq13">equation (5.13)</a>, we have</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig138_01.jpg" height="183" width="157" alt="" border="0"></span>
</div>
<p class="para">We approximate by integrals to bound this summation from above and below. By the inequalities (A.12), we have</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig138_02.jpg" height="43" width="199" alt="" border="0"></span>
</div>
<p class="para">Evaluating these definite integrals gives us the bounds</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig138_03.jpg" height="33" width="313" alt="" border="0"></span>
</div>
<p class="para">which provide a rather tight bound for Pr {<i class="emphasis">S</i>}. Because we wish to maximize our probability of success, let us focus on choosing the value of <i class="emphasis">k</i> that maximizes the lower bound on Pr {<i class="emphasis">S</i>}. (Besides, the lower-bound expression is easier to maximize than the upper-bound expression.) Differentiating the expression (<i class="emphasis">k</i>/<i class="emphasis">n</i>)(ln <i class="emphasis">n</i> - ln <i class="emphasis">k</i>) with respect to <i class="emphasis">k</i>, we obtain</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig138_04.jpg" height="33" width="115" alt="" border="0"></span>
</div>
<a name="362"></a><a name="IDX-117"></a>
<p class="para">Setting this derivative equal to 0, we see that the lower bound on the probability is maximized when ln <i class="emphasis">k</i> = ln <i class="emphasis">n</i> - 1 = ln(<i class="emphasis">n</i>/<i class="emphasis">e</i>) or, equivalently, when <i class="emphasis">k</i> = <i class="emphasis">n</i>/<i class="emphasis">e</i>. Thus, if we implement our strategy with <i class="emphasis">k</i> = <i class="emphasis">n</i>/<i class="emphasis">e</i>, we will succeed in hiring our best-qualified applicant with probability at least 1/<i class="emphasis">e</i>.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.4-1</span></span><a name="363"></a><a name="ch05ex20"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">How many people must there be in a room before the probability that someone has the same birthday as you do is at least 1/2? How many people must there be before the probability that at least two people have a birthday on July 4 is greater than 1/2?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.4-2</span></span><a name="364"></a><a name="ch05ex21"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Suppose that balls are tossed into <i class="emphasis">b</i> bins. Each toss is independent, and each ball is equally likely to end up in any bin. What is the expected number of ball tosses before at least one of the bins contains two balls?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.4-3: </span><span class="unicode"><span class="extended-unicode">&#9733;</span></span></span><a name="365"></a><a name="ch05ex22"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">For the analysis of the birthday paradox, is it important that the birthdays be mutually independent, or is pairwise independence sufficient? Justify your answer.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.4-4: </span><span class="unicode"><span class="extended-unicode">&#9733;</span></span></span><a name="366"></a><a name="ch05ex23"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">How many people should be invited to a party in order to make it likely that there are <i class="emphasis">three</i> people with the same birthday?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.4-5: </span><span class="unicode"><span class="extended-unicode">&#9733;</span></span></span><a name="367"></a><a name="ch05ex24"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">What is the probability that a <i class="emphasis">k</i>-string over a set of size <i class="emphasis">n</i> is actually a <i class="emphasis">k</i>-permutation? How does this question relate to the birthday paradox?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.4-6: </span><span class="unicode"><span class="extended-unicode">&#9733;</span></span></span><a name="368"></a><a name="ch05ex25"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Suppose that <i class="emphasis">n</i> balls are tossed into <i class="emphasis">n</i> bins, where each toss is independent and the ball is equally likely to end up in any bin. What is the expected number of empty bins? What is the expected number of bins with exactly one ball?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 5.4-7: </span><span class="unicode"><span class="extended-unicode">&#9733;</span></span></span><a name="369"></a><a name="ch05ex26"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Sharpen the lower bound on streak length by showing that in <i class="emphasis">n</i> flips of a fair coin, the probability is less than 1/<i class="emphasis">n</i> that no streak longer than lg <i class="emphasis">n</i>-2 lg lg <i class="emphasis">n</i> consecutive heads occurs.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="370"></a><a name="IDX-118"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 5-1: </span>Probabilistic counting</span><a name="371"></a><a name="ch05ex27"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">With a <i class="emphasis">b</i>-bit counter, we can ordinarily only count up to 2<sup><i class="emphasis">b</i></sup> - 1. With R. Morris's <b class="bold"><i class="emphasis">probabilistic counting</i></b>, we can count up to a much larger value at the expense of some loss of precision.</p>
<p class="para">We let a counter value of <i class="emphasis">i</i> represent a count of <i class="emphasis">n<sub>i</sub></i> for <i class="emphasis">i</i> = 0, 1,..., 2<sup><i class="emphasis">b</i></sup> -1, where the <i class="emphasis">n<sub>i</sub></i> form an increasing sequence of nonnegative values. We assume that the initial value of the counter is 0, representing a count of <i class="emphasis">n</i><sub>0</sub> = 0. The INCREMENT operation works on a counter containing the value <i class="emphasis">i</i> in a probabilistic manner. If <i class="emphasis">i</i> = 2<sup><i class="emphasis">b</i></sup> - 1, then an overflow error is reported. Otherwise, the counter is increased by 1 with probability 1/(<i class="emphasis">n</i><sub><i class="emphasis">i</i>+1</sub> - <i class="emphasis">n<sub>i</sub></i>), and it remains unchanged with probability 1 - 1/(<i class="emphasis">n</i><sub><i class="emphasis">i</i>+1</sub> - <i class="emphasis">n<sub>i</sub></i>).</p>
<p class="para">If we select <i class="emphasis">n<sub>i</sub></i> = <i class="emphasis">i</i> for all <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&ge;</span></span> 0, then the counter is an ordinary one. More interesting situations arise if we select, say, <i class="emphasis">n<sub>i</sub></i> = 2<sup><i class="emphasis">i</i>-1</sup> for <i class="emphasis">i</i> <span class="unicode">&gt;</span> 0 or <i class="emphasis">n<sub>i</sub></i> = <i class="emphasis">F<sub>i</sub></i> (the <i class="emphasis">i</i>th Fibonacci number<span class="unicode">-</span>see <a href="DDU0020.html#156" target="_parent" class="chapterjump">Section 3.2</a>).</p>
<p class="para">For this problem, assume that <span class="inlinemediaobject"><img src="images/fig140_01.jpg" height="12" width="34" alt="" border="0"></span> is large enough that the probability of an overflow error is negligible.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Show that the expected value represented by the counter after <i class="emphasis">n</i> INCREMENT operations have been performed is exactly <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="first-para">The analysis of the variance of the count represented by the counter depends on the sequence of the <i class="emphasis">n<sub>i</sub></i>. Let us consider a simple case: <i class="emphasis">n<sub>i</sub></i> = 100<i class="emphasis">i</i> for all <i class="emphasis">i</i> <span class="unicode"><span class="unicode">&ge;</span></span> 0. Estimate the variance in the value represented by the register after <i class="emphasis">n</i> INCREMENT operations have been performed.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 5-2: </span>Searching an unsorted array</span><a name="372"></a><a name="ch05ex28"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Thus problem examines three algorithms for searching for a value <i class="emphasis">x</i> in an unsorted array <i class="emphasis">A</i> consisting of <i class="emphasis">n</i> elements.</p>
<p class="para">Consider the following randomized strategy: pick a random index <i class="emphasis">i</i> into <i class="emphasis">A</i>. If <i class="emphasis">A</i>[<i class="emphasis">i</i>] = <i class="emphasis">x</i>, then we terminate; otherwise, we continue the search by picking a new random index into <i class="emphasis">A</i>. We continue picking random indices into <i class="emphasis">A</i> until we find an index <i class="emphasis">j</i> such that <i class="emphasis">A</i>[<i class="emphasis">j</i>] = <i class="emphasis">x</i> or until we have checked every element of <i class="emphasis">A</i>. Note that we pick from the whole set of indices each time, so that we may examine a given element more than once.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Write pseudocode for a procedure RANDOM-SEARCH to implement the strategy above. Be sure that your algorithm terminates when all indices into <i class="emphasis">A</i> have been picked.</p>
<a name="373"></a><a name="IDX-119"></a>
</li>
<li class="listitem">
<p class="first-para">Suppose that there is exactly one index <i class="emphasis">i</i> such that <i class="emphasis">A</i>[<i class="emphasis">i</i>] = <i class="emphasis">x</i>. What is the expected number of indices into <i class="emphasis">A</i> that must be picked before <i class="emphasis">x</i> is found and RANDOM-SEARCH terminates?</p>
</li>
<li class="listitem">
<p class="first-para">Generalizing your solution to part (b), suppose that there are <i class="emphasis">k</i> <span class="unicode"><span class="unicode">&ge;</span></span> 1 indices <i class="emphasis">i</i> such that <i class="emphasis">A</i>[<i class="emphasis">i</i>] = <i class="emphasis">x</i>. What is the expected number of indices into <i class="emphasis">A</i> that must be picked before <i class="emphasis">x</i> is found and RANDOM-SEARCH terminates? Your answer should be a function of <i class="emphasis">n</i> and <i class="emphasis">k</i>.</p>
</li>
<li class="listitem">
<p class="first-para">Suppose that there are no indices <i class="emphasis">i</i> such that <i class="emphasis">A</i>[<i class="emphasis">i</i>] = <i class="emphasis">x</i>. What is the expected number of indices into <i class="emphasis">A</i> that must be picked before all elements of <i class="emphasis">A</i> have been checked and RANDOM-SEARCH terminates?</p>
</li>
</ol>
<p class="para">Now consider a deterministic linear search algorithm, which we refer to as DETERMINISTIC-SEARCH. Specifically, the algorithm searches <i class="emphasis">A</i> for <i class="emphasis">x</i> in order, considering <i class="emphasis">A</i>[1], <i class="emphasis">A</i>[2], <i class="emphasis">A</i>[3],..., <i class="emphasis">A</i>[<i class="emphasis">n</i>] until either <i class="emphasis">A</i>[<i class="emphasis">i</i>] = <i class="emphasis">x</i> is found or the end of the array is reached. Assume that all possible permutations of the input array are equally likely.</p>
<ol class="orderedlist" start="5" type="a">
<li class="first-listitem">
<p class="first-para">Suppose that there is exactly one index <i class="emphasis">i</i> such that <i class="emphasis">A</i>[<i class="emphasis">i</i>] = <i class="emphasis">x</i>. What is the expected running time of DETERMINISTIC-SEARCH? What is the worst-case running time of DETERMINISTIC-SEARCH?</p>
</li>
<li class="listitem">
<p class="first-para">Generalizing your solution to part (e), suppose that there are <i class="emphasis">k</i> <span class="unicode"><span class="unicode">&ge;</span></span> 1 indices <i class="emphasis">i</i> such that <i class="emphasis">A</i>[<i class="emphasis">i</i>] = <i class="emphasis">x</i>. What is the expected running time of DETERMINISTIC-SEARCH? What is the worst-case running time of DETERMINISTIC-SEARCH? Your answer should be a function of <i class="emphasis">n</i> and <i class="emphasis">k</i>.</p>
</li>
<li class="listitem">
<p class="first-para">Suppose that there are no indices <i class="emphasis">i</i> such that <i class="emphasis">A</i>[<i class="emphasis">i</i>] = <i class="emphasis">x</i>. What is the expected running time of DETERMINISTIC-SEARCH? What is the worst-case running time of DETERMINISTIC-SEARCH?</p>
</li>
</ol>
<p class="para">Finally, consider a randomized algorithm SCRAMBLE-SEARCH that works by first randomly permuting the input array and then running the deterministic linear search given above on the resulting permuted array.</p>
<ol class="orderedlist" start="8" type="a">
<li class="first-listitem">
<p class="first-para">Letting <i class="emphasis">k</i> be the number of indices <i class="emphasis">i</i> such that <i class="emphasis">A</i>[<i class="emphasis">i</i>] = <i class="emphasis">x</i>, give the worst-case and expected running times of SCRAMBLE-SEARCH for the cases in which <i class="emphasis">k</i> = 0 and <i class="emphasis">k</i> = 1. Generalize your solution to handle the case in which <i class="emphasis">k</i> <span class="unicode"><span class="unicode">&ge;</span></span> 1.</p>
</li>
<li class="listitem">
<p class="first-para">Which of the three searching algorithms would you use? Explain your answer.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0031.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0033.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
