<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>6.4 The heapsort algorithm</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0038.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0040.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch06"></a>
<div class="section">
<h2 class="first-section-title">
<a name="415"></a><a name="ch06lev1sec4"></a><span class="section-titlelabel">6.4 </span>The heapsort algorithm</h2>
<p class="first-para">The heapsort algorithm starts by using BUILD-MAX-HEAP to build a max-heap on the input array <i class="emphasis">A</i>[1 <span class="unicode">&#8229;</span> <i class="emphasis">n</i>], where <i class="emphasis">n</i> = <i class="emphasis">length</i>[<i class="emphasis">A</i>]. Since the maximum element of the array is stored at the root <i class="emphasis">A</i>[1], it can be put into its correct final position <a name="416"></a><a name="IDX-136"></a>by exchanging it with <i class="emphasis">A</i>[<i class="emphasis">n</i>]. If we now "discard" node <i class="emphasis">n</i> from the heap (by decrementing <i class="emphasis">heap-size</i>[<i class="emphasis">A</i>]), we observe that <i class="emphasis">A</i>[1 <span class="unicode">&#8229;</span> (<i class="emphasis">n</i> - 1)] can easily be made into a max-heap. The children of the root remain max-heaps, but the new root element may violate the max-heap property. All that is needed to restore the max-heap property, however, is one call to MAX-HEAPIFY(<i class="emphasis">A</i>, 1), which leaves a max-heap in <i class="emphasis">A</i>[1 <span class="unicode">&#8229;</span> (<i class="emphasis">n</i> - 1)]. The heapsort algorithm then repeats this process for the max-heap of size <i class="emphasis">n</i> - 1 down to a heap of size 2. (See <a class="internaljump" href="#ch06ex18">Exercise 6.4-2</a> for a precise loop invariant.)</p>
<div class="informalexample">
<pre class="literallayout-normal">
HEAPSORT(<i class="emphasis">A</i>)
1 BUILD-MAX-HEAP(<i class="emphasis">A</i>)
2 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> <i class="emphasis">length</i>[<i class="emphasis">A</i>] <b class="bold">downto</b> 2
3    <b class="bold">do</b> exchange <i class="emphasis">A</i>[1] <span class="unicode">&harr;</span> <i class="emphasis">A</i>[<i class="emphasis">i</i>]
4       <i class="emphasis">heap-size</i>[<i class="emphasis">A</i>] <span class="unicode">&larr;</span> <i class="emphasis">heap-size</i>[<i class="emphasis">A</i>] - 1
5       MAX-HEAPIFY(<i class="emphasis">A</i>, 1)
</pre>
</div>
<p class="para">
<a class="internaljump" href="#ch06fig04">Figure 6.4</a> shows an example of the operation of heapsort after the max-heap is initially built. Each max-heap is shown at the beginning of an iteration of the <b class="bold">for</b> loop of lines 2<span class="unicode">-</span>5.</p>
<div class="figure">
<a name="417"></a><a name="ch06fig04"></a><span class="figuremediaobject"><a href="images/fig159%5F01%5F0%2Ejpg" NAME="IMG_269" target="_parent"><img src="images/fig159_01.jpg" height="322" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 6.4: </span>The operation of HEAPSORT. <i class="emphasis">(a)</i> The max-heap data structure just after it has been built by BUILD-MAX-HEAP. <i class="emphasis">(b)<span class="unicode">-</span>(j)</i> The max-heap just after each call of MAX-HEAPIFY in line 5. The value of <i class="emphasis">i</i> at that time is shown. Only lightly shaded nodes remain in the heap. <i class="emphasis">(k)</i> The resulting sorted array <i class="emphasis">A</i>.</span>
</div>
<p class="para">The HEAPSORT procedure takes time <i class="emphasis">O</i>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>), since the call to BUILD-MAX-HEAP takes time <i class="emphasis">O</i>(<i class="emphasis">n</i>) and each of the <i class="emphasis">n</i> - 1 calls to MAX-HEAPIFY takes time <i class="emphasis">O</i>(lg <i class="emphasis">n</i>).</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 6.4-1</span></span><a name="418"></a><a name="ch06ex17"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Using <a class="internaljump" href="#ch06fig04">Figure 6.4</a> as a model, illustrate the operation of HEAPSORT on the array <i class="emphasis">A</i> = <span class="unicode">&#12296;</span>5, 13, 2, 25, 7, 17, 20, 8, 4<span class="unicode">&#12297;</span>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 6.4-2</span></span><a name="419"></a><a name="ch06ex18"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Argue the correctness of HEAPSORT using the following loop invariant:</p>
<ul class="simple-list">
<li class="first-listitem">
<p class="first-para">At the start of each iteration of the <b class="bold">for</b> loop of lines 2<span class="unicode">-</span>5, the subarray <i class="emphasis">A</i>[1 <span class="unicode">&#8229;</span> <i class="emphasis">i</i>] is a max-heap containing the <i class="emphasis">i</i> smallest elements of <i class="emphasis">A</i>[1 <span class="unicode">&#8229;</span> <i class="emphasis">n</i>], and the subarray <i class="emphasis">A</i>[<i class="emphasis">i</i> + 1 <span class="unicode">&#8229;</span> <i class="emphasis">n</i>] contains the <i class="emphasis">n</i> - <i class="emphasis">i</i> largest elements of <i class="emphasis">A</i>[1 <span class="unicode">&#8229;</span> <i class="emphasis">n</i>], sorted.</p>
</li>
</ul>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 6.4-3</span></span><a name="420"></a><a name="ch06ex19"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">What is the running time of heapsort on an array <i class="emphasis">A</i> of length <i class="emphasis">n</i> that is already sorted in increasing order? What about decreasing order?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 6.4-4</span></span><a name="421"></a><a name="ch06ex20"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that the worst-case running time of heapsort is <span class="unicode">&#8486;</span>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="422"></a><a name="IDX-137"></a><a name="423"></a><a name="IDX-138"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 6.4-5: </span><span class="unicode">&#9733;</span></span><a name="424"></a><a name="ch06ex21"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that when all elements are distinct, the best-case running time of heapsort is <span class="unicode">&#8486;</span>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>). </p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0038.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0040.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
