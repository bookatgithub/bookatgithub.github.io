<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>8.1 Lower bounds for sorting</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0047.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0049.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch08"></a>
<div class="section">
<h2 class="first-section-title">
<a name="517"></a><a name="ch08lev1sec1"></a><span class="section-titlelabel">8.1 </span>Lower bounds for sorting</h2>
<p class="first-para">In a comparison sort, we use only comparisons between elements to gain order information about an input sequence <span class="unicode">&#12296;</span><i class="emphasis">a</i><sub>1</sub>, <i class="emphasis">a</i><sub>2</sub>, . . ., <i class="emphasis">a<sub>n</sub></i><span class="unicode">&#12297;</span>. That is, given two elements <i class="emphasis">a<sub>i</sub></i> and <i class="emphasis">a<sub>j</sub></i>, we perform one of the tests <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&lt;</span> <i class="emphasis">a<sub>j</sub></i>, <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&le;</span> <i class="emphasis">a<sub>j</sub></i>, <i class="emphasis">a<sub>i</sub></i> = <i class="emphasis">a<sub>j</sub></i>, <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&ge;</span> <i class="emphasis">a<sub>j</sub></i>, or <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&gt;</span> <i class="emphasis">a<sub>j</sub></i> to determine their relative order. We may not inspect the values of the elements or gain order information about them in any other way.</p>
<p class="para">In this section, we assume without loss of generality that all of the input elements are distinct. Given this assumption, comparisons of the form <i class="emphasis">a<sub>i</sub></i> = <i class="emphasis">a<sub>j</sub></i> are useless, so we can assume that no comparisons of this form are made. We also note that the comparisons <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&le;</span> <i class="emphasis">a<sub>j</sub></i>, <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&ge;</span> <i class="emphasis">a<sub>j</sub></i>, <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&gt;</span> <i class="emphasis">a<sub>j</sub></i>, and <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&lt;</span> <i class="emphasis">a<sub>j</sub></i> are all equivalent in that <a name="518"></a><a name="IDX-166"></a>they yield identical information about the relative order of <i class="emphasis">a<sub>i</sub></i> and <i class="emphasis">a<sub>j</sub></i>. We therefore assume that all comparisons have the form <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&le;</span> <i class="emphasis">a<sub>j</sub></i>.</p>
<div class="section">
<h4 class="sect4-title">
<a name="519"></a><a name="ch08lev3sec1"></a>The decision-tree model</h4>
<p class="first-para">Comparison sorts can be viewed abstractly in terms of <b class="bold"><i class="emphasis">decision trees</i></b>. A decision tree is a full binary tree that represents the comparisons between elements that are performed by a particular sorting algorithm operating on an input of a given size. Control, data movement, and all other aspects of the algorithm are ignored. <a class="internaljump" href="#ch08fig01">Figure 8.1</a> shows the decision tree corresponding to the insertion sort algorithm from <a href="DDU0014.html#59" target="_parent" class="chapterjump">Section 2.1</a> operating on an input sequence of three elements.</p>
<div class="figure">
<a name="520"></a><a name="ch08fig01"></a><span class="figuremediaobject"><a href="images/fig188%5F01%5F0%2Ejpg" NAME="IMG_291" target="_parent"><img src="images/fig188_01.jpg" height="116" width="263" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 8.1: </span>The decision tree for insertion sort operating on three elements. An internal node annotated by <i class="emphasis">i: j</i> indicates a comparison between <i class="emphasis">a<sub>i</sub></i> and <i class="emphasis">a<sub>j</sub></i>. A leaf annotated by the permutation <span class="unicode">&#12296;</span><span class="unicode">&pi;</span>(1), <span class="unicode">&pi;</span>(2), . . ., <span class="unicode">&pi;</span>(<i class="emphasis">n</i>)<span class="unicode">&#12297;</span> indicates the ordering <i class="emphasis">a</i><sub><span class="unicode">&pi;</span>(1)</sub> <span class="unicode">&le;</span> <i class="emphasis">a</i><sub><span class="unicode">&pi;</span>(2)</sub> <span class="unicode">&le;</span> <span class="unicode">&middot;</span><span class="unicode">&middot;</span><span class="unicode">&middot;</span> <i class="emphasis">a</i><sub><span class="unicode">&pi;</span>(<i class="emphasis">n</i>)</sub>. The shaded path indicates the decisions made when sorting the input sequence <span class="unicode">&#12296;</span><i class="emphasis">a</i><sub>1</sub> = 6, <i class="emphasis">a</i><sub>2</sub> = 8, <i class="emphasis">a</i><sub>3</sub> = 5<span class="unicode">&#12297;</span> the permutation <span class="unicode">&#12296;</span>3, 1, 2<span class="unicode">&#12297;</span> at the leaf indicates that the sorted ordering is <i class="emphasis">a</i><sub>3</sub> = 5 <i class="emphasis">a</i><sub>1</sub> = 6 <i class="emphasis">a</i><sub>2</sub> = 8. There are 3! = 6 possible permutations of the input elements, so the decision tree must have at least 6 leaves.</span>
</div>
<p class="para">In a decision tree, each internal node is annotated by <i class="emphasis">i</i>: <i class="emphasis">j</i> for some <i class="emphasis">i</i> and <i class="emphasis">j</i> in the range 1 <span class="unicode">&le;</span> <i class="emphasis">i</i>, <i class="emphasis">j</i> <i class="emphasis">n</i>, where <i class="emphasis">n</i> is the number of elements in the input sequence. Each leaf is annotated by a permutation <span class="unicode">&#12296;</span><span class="unicode">&pi;</span>(1), <span class="unicode">&pi;</span>(2), . . ., <span class="unicode">&pi;</span>(<i class="emphasis">n</i>)<span class="unicode">&#12297;</span>. (See <a href="DDU0253.html#3409" target="_parent" class="chapterjump">Section C.1</a> for background on permutations.) The execution of the sorting algorithm corresponds to tracing a path from the root of the decision tree to a leaf. At each internal node, a comparison <i class="emphasis">a<sub>i</sub></i> <i class="emphasis">a<sub>j</sub></i> is made. The left subtree then dictates subsequent comparisons for <i class="emphasis">a<sub>i</sub></i> <i class="emphasis">a<sub>j</sub></i>, and the right subtree dictates subsequent comparisons for <i class="emphasis">a<sub>i</sub></i> <span class="unicode">&gt;</span> <i class="emphasis">a<sub>j</sub></i>. When we come to a leaf, the sorting algorithm has established the ordering <i class="emphasis">a</i><sub><span class="unicode">&pi;</span>(1)</sub> <i class="emphasis">a</i><sub><span class="unicode">&pi;</span>(2)</sub> <span class="unicode">&middot;</span><span class="unicode">&middot;</span><span class="unicode">&middot;</span> <i class="emphasis">a</i><sub><span class="unicode">&pi;</span>(<i class="emphasis">n</i>)</sub>. Because any correct sorting algorithm must be able to produce each permutation of its input, a necessary condition for a comparison sort to be correct is that each of the <i class="emphasis">n</i>! permutations on <i class="emphasis">n</i> elements must appear as one of the leaves of the decision tree, and that each of these leaves must be reachable from the root by a path corresponding to an actual execution of the comparison sort. (We shall refer to such leaves as "reachable.") Thus, we shall consider only decision trees in which each permutation appears as a reachable leaf.</p>
<a name="521"></a><a name="IDX-167"></a>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="522"></a><a name="ch08lev3sec2"></a>A lower bound for the worst case</h4>
<p class="first-para">The length of the longest path from the root of a decision tree to any of its reachable leaves represents the worst-case number of comparisons that the corresponding sorting algorithm performs. Consequently, the worst-case number of comparisons for a given comparison sort algorithm equals the height of its decision tree. A lower bound on the heights of all decision trees in which each permutation appears as a reachable leaf is therefore a lower bound on the running time of any comparison sort algorithm. The following theorem establishes such a lower bound.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 8.1</span></span><a name="523"></a><a name="ch08ex01"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Any comparison sort algorithm requires <span class="unicode">&#8486;</span>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>) comparisons in the worst case.</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> From the preceding discussion, it suffices to determine the height of a decision tree in which each permutation appears as a reachable leaf. Consider a decision tree of height <i class="emphasis">h</i> with <i class="emphasis">l</i> reachable leaves corresponding to a comparison sort on <i class="emphasis">n</i> elements. Because each of the <i class="emphasis">n</i>! permutations of the input appears as some leaf, we have <i class="emphasis">n</i>! <span class="unicode">&le;</span> <i class="emphasis">l</i>. Since a binary tree of height <i class="emphasis">h</i> has no more than 2<sup><i class="emphasis">h</i></sup> leaves, we have</p>
<p class="para">
<i class="emphasis">n</i>! <span class="unicode">&le;</span> <i class="emphasis">l</i> 2<sup><i class="emphasis">h</i></sup>,</p>
<p class="para">which, by taking logarithms, implies</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">h</i>
</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&le;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">lg(<i class="emphasis">n</i>!)</p>
</td><td class="td" align="left">
<p class="table-para">(since the lg function is monotonically increasing)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="unicode">&#8486;</span>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(by <a href="DDU0020.html#176" target="_parent" class="chapterjump">equation (3.18)</a>).</p>
</td>
</tr>
</tbody>
</table>
</div>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Corollary 8.2</span></span><a name="524"></a><a name="ch08ex02"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Heapsort and merge sort are asymptotically optimal comparison sorts.</p>
<p class="last-para">
<b class="bold"><i class="emphasis">Proof</i></b> The <i class="emphasis">O</i>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>) upper bounds on the running times for heapsort and merge sort match the <span class="unicode">&#8486;</span>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>) worst-case lower bound from <a class="internaljump" href="#ch08ex01">Theorem 8.1</a>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 8.1-1</span></span><a name="525"></a><a name="ch08ex03"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">What is the smallest possible depth of a leaf in a decision tree for a comparison sort?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 8.1-2</span></span><a name="526"></a><a name="ch08ex04"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Obtain asymptotically tight bounds on lg(<i class="emphasis">n</i>!) without using Stirling's approximation. Instead, evaluate the summation <span class="inlinemediaobject"><img src="images/fig189_01.jpg" height="16" width="45" alt="" border="0"></span> using techniques from <a href="DDU0245.html#3307" target="_parent" class="chapterjump">Section A.2</a>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="527"></a><a name="IDX-168"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 8.1-3</span></span><a name="528"></a><a name="ch08ex05"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that there is no comparison sort whose running time is linear for at least half of the <i class="emphasis">n</i>! inputs of length <i class="emphasis">n</i>. What about a fraction of 1/<i class="emphasis">n</i> of the inputs of length <i class="emphasis">n</i>? What about a fraction 1/2<sup><i class="emphasis">n</i></sup>?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 8.1-4</span></span><a name="529"></a><a name="ch08ex06"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">You are given a sequence of <i class="emphasis">n</i> elements to sort. The input sequence consists of <i class="emphasis">n/k</i> subsequences, each containing <i class="emphasis">k</i> elements. The elements in a given subsequence are all smaller than the elements in the succeeding subsequence and larger than the elements in the preceding subsequence. Thus, all that is needed to sort the whole sequence of length <i class="emphasis">n</i> is to sort the <i class="emphasis">k</i> elements in each of the <i class="emphasis">n/k</i> subsequences. Show an <span class="unicode">&#8486;</span>(<i class="emphasis">n</i> lg <i class="emphasis">k</i>) lower bound on the number of comparisons needed to solve this variant of the sorting problem. (<i class="emphasis">Hint:</i> It is not rigorous to simply combine the lower bounds for the individual subsequences.)</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0047.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0049.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
