<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>12.4 &#9733; Randomly built binary search trees</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0073.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0075.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch12"></a>
<div class="section">
<h2 class="first-section-title">
<a name="839"></a><a name="ch12lev1sec4"></a><span class="section-titlelabel">12.4 </span><span class="unicode">&#9733;</span> Randomly built binary search trees</h2>
<a name="840"></a><a name="IDX-265"></a>
<p class="para">We have shown that all the basic operations on a binary search tree run in <i class="emphasis">O</i>(<i class="emphasis">h</i>) time, where <i class="emphasis">h</i> is the height of the tree. The height of a binary search tree varies, however, as items are inserted and deleted. If, for example, the items are inserted in strictly increasing order, the tree will be a chain with height <i class="emphasis">n</i> - 1. On the other hand, <a href="DDU0247.html#3345" target="_parent" class="chapterjump">Exercise B.5-4</a> shows that <i class="emphasis">h</i><span class="unicode">&ge;</span> <span class="unicode">&lfloor;</span>lg <i class="emphasis">n</i><span class="unicode">&rfloor;</span>. As with quicksort, we can show that the behavior of the average case is much closer to the best case than the worst case.</p>
<p class="para">Unfortunately, little is known about the average height of a binary search tree when both insertion and deletion are used to create it. When the tree is created by insertion alone, the analysis becomes more tractable. Let us therefore define a <b class="bold"><i class="emphasis">randomly built binary search tree</i></b> on <i class="emphasis">n</i> keys as one that arises from inserting the keys in random order into an initially empty tree, where each of the <i class="emphasis">n</i>! permutations of the input keys is equally likely. (<a class="internaljump" href="#ch12ex27">Exercise 12.4-3</a> asks you to show that this notion is different from assuming that every binary search tree on <i class="emphasis">n</i> keys is equally likely.) In this section, we shall show that the expected height of a randomly built binary search tree on <i class="emphasis">n</i> keys is <i class="emphasis">O</i>(lg <i class="emphasis">n</i>). We assume that all keys are distinct.</p>
<p class="para">We start by defining three random variables that help measure the height of a randomly built binary search tree. We denote the height of a randomly built binary search on <i class="emphasis">n</i> keys by <i class="emphasis">X</i><sub><i class="emphasis">n</i></sub>, and we define the <b class="bold"><i class="emphasis">exponential height</i></b> <span class="inlinemediaobject"><img src="images/fig287_01.jpg" height="14" width="44" alt="" border="0"></span>. When we build a binary search tree on <i class="emphasis">n</i> keys, we choose one key as that of the root, and we let <i class="emphasis">R<sub>n</sub></i> denote the random variable that holds this key's rank within the set of <i class="emphasis">n</i> keys. The value of <i class="emphasis">R<sub>n</sub></i> is equally likely to be any element of the set {1, 2, ..., <i class="emphasis">n</i>}. If <i class="emphasis">R<sub>n</sub></i> = <i class="emphasis">i</i>, then the left subtree of the root is a randomly built binary search tree on <i class="emphasis">i</i> - 1 keys, and the right subtree is a randomly built binary search tree on <i class="emphasis">n</i> - <i class="emphasis">i</i> keys. Because the height of a binary tree is one more than the larger of the heights of the two subtrees of the root, the exponential height of a binary tree is twice the larger of the exponential heights of the two subtrees of the root. If we know that <i class="emphasis">R<sub>n</sub></i> = <i class="emphasis">i</i>, we therefore have that</p>
<p class="para">
<i class="emphasis">Y<sub>n</sub></i> = 2 <span class="unicode">&middot;</span> max(<i class="emphasis">Y</i><sub><i class="emphasis">i</i>-1</sub>, <i class="emphasis">Y<sub>n-i</sub></i>).</p>
<p class="para">As base cases, we have <i class="emphasis">Y</i><sub>1</sub> = 1, because the exponential height of a tree with 1 node is 2<sup>0</sup> = 1 and, for convenience, we define <i class="emphasis">Y</i><sub>0</sub> = 0.</p>
<p class="para">Next we define indicator random variables <i class="emphasis">Z</i><sub><i class="emphasis">n</i>,1</sub>, <i class="emphasis">Z</i><sub><i class="emphasis">n</i>,2</sub>, ..., <i class="emphasis">Z<sub>n,n</sub></i>, where</p>
<p class="para">
<i class="emphasis">Z<sub>n,i</sub></i> = I{<i class="emphasis">R<sub>n</sub></i> = <i class="emphasis">i</i>}.</p>
<p class="para">Because <i class="emphasis">R<sub>n</sub></i> is equally likely to be any element of {1, 2, ..., <i class="emphasis">n</i>}, we have that Pr{<i class="emphasis">R<sub>n</sub></i> = <i class="emphasis">i</i>} = 1/<i class="emphasis">n</i> for <i class="emphasis">i</i> = 1,2, ..., <i class="emphasis">n</i>, and hence, by <a href="DDU0030.html#311" target="_parent" class="chapterjump">Lemma 5.1</a>,</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(12.1)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig287_02.jpg" height="16" width="96" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">for <i class="emphasis">i</i> = 1, 2, ..., <i class="emphasis">n</i>. Because exactly one value of <i class="emphasis">Z<sub>n,i</sub></i> is 1 and all others are 0, we also have<a name="841"></a><a name="IDX-266"></a>
</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig288_01.jpg" height="40" width="217" alt="" border="0"></span>
</div>
<p class="para">We will show that E[<i class="emphasis">Y<sub>n</sub></i>] is polynomial in <i class="emphasis">n</i>, which will ultimately imply that E[<i class="emphasis">X<sub>n</sub></i>] = <i class="emphasis">O</i>(lg <i class="emphasis">n</i>).</p>
<p class="para">The indicator random variable <i class="emphasis">Z<sub>n,i</sub></i> = I{<i class="emphasis">R<sub>n</sub></i> = <i class="emphasis">i</i>} is independent of the values of <i class="emphasis">Y</i><sub><i class="emphasis">i</i>-1</sub> and <i class="emphasis">Y<sub>n-i</sub></i>. Having chosen <i class="emphasis">R<sub>n</sub></i> = <i class="emphasis">i</i>, the left subtree, whose exponential height is <i class="emphasis">Y</i><sub><i class="emphasis">i</i>-1</sub>, is randomly built on the <i class="emphasis">i</i> - 1 keys whose ranks are less than <i class="emphasis">i</i>. This subtree is just like any other randomly built binary search tree on <i class="emphasis">i</i> - 1 keys. Other than the number of keys it contains, this subtree's structure is not affected at all by the choice of <i class="emphasis">R<sub>n</sub></i> = <i class="emphasis">i</i>; hence the random variables <i class="emphasis">Y</i><sub><i class="emphasis">i</i>-1</sub> and <i class="emphasis">Z<sub>n,i</sub></i> are independent. Likewise, the right subtree, whose exponential height is <i class="emphasis">Y<sub>n-i</sub></i>, is randomly built on the <i class="emphasis">n</i> - <i class="emphasis">i</i> keys whose ranks are greater than <i class="emphasis">i</i>. Its structure is independent of the value of <i class="emphasis">R<sub>n</sub></i>, and so the random variables <i class="emphasis">Y<sub>n-i</sub></i> and <i class="emphasis">Z<sub>n,i</sub></i> are independent. Hence,</p>
<div class="informalequation">
<span class="equation-image"><a href="images/fig288%5F02%2Ejpg" NAME="IMG_398" target="_parent"><img src="images/fig288_02.jpg" height="242" width="400" alt="Click To expand" border="0"></a></span>
</div>
<p class="para">Each term E[<i class="emphasis">Y</i><sub>0</sub>], E[<i class="emphasis">Y</i><sub>1</sub>], ..., E[<i class="emphasis">Y</i><sub><i class="emphasis">n</i>-1</sub>] appears twice in the last summation, once as E[<i class="emphasis">Y</i><sub><i class="emphasis">i</i>-1</sub>] and once as E[<i class="emphasis">Y<sub>n-i</sub></i>], and so we have the recurrence</p>
<div class="equation">
<a name="842"></a><a name="ch12eq02"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(12.2)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig288_03.jpg" height="43" width="137" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">Using the substitution method, we will show that for all positive integers <i class="emphasis">n</i>, the recurrence (<a class="internaljump" href="#ch12eq02">12.2</a>) has the solution</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig288_04.jpg" height="38" width="128" alt="" border="0"></span>
</div>
<p class="para">In doing so, we will use the identity<a name="843"></a><a name="IDX-267"></a>
</p>
<div class="equation">
<a name="844"></a><a name="ch12eq03"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(12.3)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig289_01.jpg" height="43" width="155" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">(<a class="internaljump" href="#ch12ex25">Exercise 12.4-1</a> asks you to prove this identity.)</p>
<p class="para">For the base case, we verify that the bound</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig289_02.jpg" height="38" width="200" alt="" border="0"></span>
</div>
<p class="para">holds. For the substitution, we have that</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig289_03.jpg" height="294" width="353" alt="" border="0"></span>
</div>
<p class="para">We have bounded E[<i class="emphasis">Y<sub>n</sub></i>], but our ultimate goal is to bound E[<i class="emphasis">X<sub>n</sub></i>]. As <a class="internaljump" href="#ch12ex28">Exercise 12.4-4</a> asks you to show, the function <i class="emphasis">f</i>(<i class="emphasis">x</i>) = 2<sup><i class="emphasis">x</i></sup> is convex (see page 1109). Therefore, we can apply Jensen's inequality (<a href="DDU0255.html#3481" target="_parent" class="chapterjump">C.25</a>), which says that</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig289_04.jpg" height="19" width="161" alt="" border="0"></span>
</div>
<p class="para">to derive that</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig289_05.jpg" height="113" width="228" alt="" border="0"></span>
</div>
<p class="para">Taking logarithms of both sides gives E[<i class="emphasis">X<sub>n</sub></i>] = <i class="emphasis">O</i>(lg <i class="emphasis">n</i>). Thus, we have proven the following:<a name="845"></a><a name="IDX-268"></a>
</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 12.4</span></span>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">The expected height of a randomly built binary search tree on <i class="emphasis">n</i> keys is <i class="emphasis">O</i>(lg <i class="emphasis">n</i>).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 12.4-1</span></span><a name="846"></a><a name="ch12ex25"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Prove <a class="internaljump" href="#ch12eq03">equation (12.3)</a>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 12.4-2</span></span><a name="847"></a><a name="ch12ex26"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Describe a binary search tree on <i class="emphasis">n</i> nodes such that the average depth of a node in the tree is <span class="unicode">&Theta;</span>(lg <i class="emphasis">n</i>) but the height of the tree is <i class="emphasis">w</i>(lg <i class="emphasis">n</i>). Give an asymptotic upper bound on the height of an <i class="emphasis">n</i>-node binary search tree in which the average depth of a node is <span class="unicode">&Theta;</span>(lg <i class="emphasis">n</i>).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 12.4-3</span></span><a name="848"></a><a name="ch12ex27"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that the notion of a randomly chosen binary search tree on <i class="emphasis">n</i> keys, where each binary search tree of <i class="emphasis">n</i> keys is equally likely to be chosen, is different from the notion of a randomly built binary search tree given in this section. (<i class="emphasis">Hint:</i> List the possibilities when <i class="emphasis">n</i> = 3.)</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 12.4-4</span></span><a name="849"></a><a name="ch12ex28"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that the function <i class="emphasis">f</i>(<i class="emphasis">x</i>) = 2<sup><i class="emphasis">x</i></sup> is convex.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 12.4-5: </span><span class="unicode">&#9733;</span></span><a name="850"></a><a name="ch12ex29"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Consider RANDOMIZED-QUICKSORT operating on a sequence of <i class="emphasis">n</i> input numbers. Prove that for any constant <i class="emphasis">k</i> <span class="unicode">&gt;</span> 0, all but <i class="emphasis">O</i>(1/<i class="emphasis">n<sup>k</sup></i>) of the <i class="emphasis">n</i>! input permutations yield an <i class="emphasis">O</i>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>) running time.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 12-1: </span>Binary search trees with equal keys</span><a name="851"></a><a name="ch12ex30"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Equal keys pose a problem for the implementation of binary search trees.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">What is the asymptotic performance of TREE-INSERT when used to insert <i class="emphasis">n</i> items with identical keys into an initially empty binary search tree?</p>
</li>
</ol>
<p class="para">We propose to improve TREE-INSERT by testing before line 5 whether or not <i class="emphasis">key</i>[<i class="emphasis">z</i>] = <i class="emphasis">key</i>[<i class="emphasis">x</i>] and by testing before line 11 whether or not <i class="emphasis">key</i>[<i class="emphasis">z</i>] = <i class="emphasis">key</i>[<i class="emphasis">y</i>].If equality holds, we implement one of the following strategies. For each strategy, find the asymptotic performance of inserting <i class="emphasis">n</i> items with identical keys into an initially empty binary search tree. (The strategies are described for line 5, in which <a name="852"></a><a name="IDX-269"></a>we compare the keys of <i class="emphasis">z</i> and <i class="emphasis">x</i>. Substitute <i class="emphasis">y</i> for <i class="emphasis">x</i> to arrive at the strategies for line 11.)</p>
<ol class="orderedlist" start="2" type="a">
<li class="first-listitem">
<p class="first-para">Keep a boolean flag <i class="emphasis">b</i>[<i class="emphasis">x</i>] at node <i class="emphasis">x</i>, and set <i class="emphasis">x</i> to either <i class="emphasis">left</i>[<i class="emphasis">x</i>] or <i class="emphasis">right</i>[<i class="emphasis">x</i>] based on the value of <i class="emphasis">b</i>[<i class="emphasis">x</i>], which alternates between FALSE and TRUE each time <i class="emphasis">x</i> is visited during insertion of a node with the same key as <i class="emphasis">x</i>.</p>
</li>
<li class="listitem">
<p class="first-para">Keep a list of nodes with equal keys at <i class="emphasis">x</i>, and insert <i class="emphasis">z</i> into the list.</p>
</li>
<li class="listitem">
<p class="first-para">Randomly set <i class="emphasis">x</i> to either <i class="emphasis">left</i>[<i class="emphasis">x</i>] or <i class="emphasis">right</i>[<i class="emphasis">x</i>]. (Give the worst-case performance</p>
<p class="last-para">and informally derive the average-case performance.)</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 12-2: </span>Radix trees</span><a name="853"></a><a name="ch12ex31"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Given two strings <i class="emphasis">a</i> = <i class="emphasis">a</i><sub>0</sub><i class="emphasis">a</i><sub>1</sub>...<i class="emphasis">a<sub>p</sub></i> and <i class="emphasis">b</i> = <i class="emphasis">b</i><sub>0</sub><i class="emphasis">b</i><sub>1</sub>...<i class="emphasis">b<sub>q</sub></i>, where each <i class="emphasis">a<sub>i</sub></i> and each <i class="emphasis">b<sub>j</sub></i> is in some ordered set of characters, we say that string <i class="emphasis">a</i> is <b class="bold"><i class="emphasis">lexicographically less than</i></b> string <i class="emphasis">b</i> if either</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">there exists an integer <i class="emphasis">j</i>, where 0 <span class="unicode">&le;</span> <i class="emphasis">j</i> <span class="unicode">&le;</span> min(<i class="emphasis">p</i>, <i class="emphasis">q</i>), such that <i class="emphasis">a<sub>i</sub></i> = <i class="emphasis">b<sub>i</sub></i> for all <i class="emphasis">i</i> = 0, 1, ..., <i class="emphasis">j</i> - 1 and <i class="emphasis">a<sub>j</sub></i> <span class="unicode">&lt;</span> <i class="emphasis">b<sub>j</sub></i>, or</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">p</i> <span class="unicode">&lt;</span> <i class="emphasis">q</i> and <i class="emphasis">a<sub>i</sub></i> = <i class="emphasis">b<sub>i</sub></i> for all <i class="emphasis">i</i> = 0, 1, ..., <i class="emphasis">p</i>.</p>
</li>
</ol>
<p class="para">For example, if <i class="emphasis">a</i> and <i class="emphasis">b</i> are bit strings, then 10100 <span class="unicode">&lt;</span> 10110 by rule 1 (letting <i class="emphasis">j</i> = 3) and 10100 <span class="unicode">&lt;</span> 101000 by rule 2. This is similar to the ordering used in English-language dictionaries.</p>
<p class="para">The <b class="bold"><i class="emphasis">radix tree</i></b> data structure shown in <a class="internaljump" href="#ch12fig05">Figure 12.5</a> stores the bit strings 1011, 10, 011, 100, and 0. When searching for a key <i class="emphasis">a</i> = <i class="emphasis">a</i><sub>0</sub><i class="emphasis">a</i><sub>1</sub>...<i class="emphasis">a<sub>p</sub></i>, we go left at a node <a name="854"></a><a name="IDX-270"></a>of depth <i class="emphasis">i</i> if <i class="emphasis">a<sub>i</sub></i> = 0 and right if <i class="emphasis">a<sub>i</sub></i> = 1. Let <i class="emphasis">S</i> be a set of distinct binary strings whose lengths sum to <i class="emphasis">n</i>. Show how to use a radix tree to sort <i class="emphasis">S</i> lexicographically in <span class="unicode">&Theta;</span>(<i class="emphasis">n</i>) time. For the example in <a class="internaljump" href="#ch12fig05">Figure 12.5</a>, the output of the sort should be the sequence 0, 011, 10, 100, 1011.</p>
<p class="last-para">
<div class="figure">
<a name="855"></a><a name="ch12fig05"></a><span class="figuremediaobject"><a href="images/fig291%5F01%5F0%2Ejpg" NAME="IMG_406" target="_parent"><img src="images/fig291_01.jpg" height="151" width="229" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 12.5: </span>A radix tree storing the bit strings 1011, 10, 011, 100, and 0. Each node's key can be determined by traversing the path from the root to that node. There is no need, therefore, to store the keys in the nodes; the keys are shown here for illustrative purposes only. Nodes are heavily shaded if the keys corresponding to them are not in the tree; such nodes are present only to establish a path to other nodes.</span>
</div>
</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 12-3: </span>Average node depth in a randomly built binary search tree</span><a name="856"></a><a name="ch12ex32"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">In this problem, we prove that the average depth of a node in a randomly built binary search tree with <i class="emphasis">n</i> nodes is <i class="emphasis">O</i>(lg <i class="emphasis">n</i>). Although this result is weaker than that of <a class="internaljump" href="#ch12ex25">Theorem 12.4</a>, the technique we shall use reveals a surprising similarity between the building of a binary search tree and the running of RANDOMIZED-QUICKSORT from <a href="DDU0044.html#477" target="_parent" class="chapterjump">Section 7.3</a>.</p>
<p class="para">We define the <b class="bold"><i class="emphasis">total path length</i></b> <i class="emphasis">P</i>(<i class="emphasis">T</i>) of a binary tree <i class="emphasis">T</i> as the sum, over all nodes <i class="emphasis">x</i> in <i class="emphasis">T</i> , of the depth of node <i class="emphasis">x</i>, which we denote by <i class="emphasis">d</i>(<i class="emphasis">x</i>, <i class="emphasis">T</i>).</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Argue that the average depth of a node in <i class="emphasis">T</i> is</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig292_01.jpg" height="39" width="154" alt="" border="0"></span>
</div>
</li>
</ol>
<p class="para">Thus, we wish to show that the expected value of <i class="emphasis">P</i>(<i class="emphasis">T</i>) is <i class="emphasis">O</i>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>).</p>
<ol class="orderedlist" start="2" type="a">
<li class="first-listitem">
<p class="first-para">Let <i class="emphasis">T<sub>L</sub></i> and <i class="emphasis">T<sub>R</sub></i> denote the left and right subtrees of tree <i class="emphasis">T</i>, respectively. Argue that if <i class="emphasis">T</i> has <i class="emphasis">n</i> nodes, then</p>
<p class="last-para">
<i class="emphasis">P</i>(<i class="emphasis">T</i>) = <i class="emphasis">P</i>(<i class="emphasis">T<sub>L</sub></i>) + <i class="emphasis">P</i>(<i class="emphasis">T<sub>R</sub></i>) + <i class="emphasis">n</i> - 1.</p>
</li>
<li class="listitem">
<p class="first-para">Let <i class="emphasis">P</i>(<i class="emphasis">n</i>) denote the average total path length of a randomly built binary search tree with <i class="emphasis">n</i> nodes. Show that</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig292_02.jpg" height="42" width="277" alt="" border="0"></span>
</div>
</li>
<li class="listitem">
<p class="first-para">Show that <i class="emphasis">P</i>(<i class="emphasis">n</i>) can be rewritten as</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig292_03.jpg" height="43" width="173" alt="" border="0"></span>
</div>
</li>
<li class="listitem">
<p class="first-para">Recalling the alternative analysis of the randomized version of quicksort given in <a href="DDU0045.html#501" target="_parent" class="chapterjump">Problem 7-2</a>, conclude that <i class="emphasis">P</i>(<i class="emphasis">n</i>) = <i class="emphasis">O</i>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>).</p>
</li>
</ol>
<p class="para">At each recursive invocation of quicksort, we choose a random pivot element to partition the set of elements being sorted. Each node of a binary search tree partitions the set of elements that fall into the subtree rooted at that node.<a name="857"></a><a name="IDX-271"></a>
</p>
<ol class="orderedlist" start="6" type="a">
<li class="first-listitem">
<p class="first-para">Describe an implementation of quicksort in which the comparisons to sort a set of elements are exactly the same as the comparisons to insert the elements into a binary search tree. (The order in which comparisons are made may differ, but the same comparisons must be made.)</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 12-4: </span>Number of different binary trees</span><a name="858"></a><a name="ch12ex33"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">b<sub>n</sub></i> denote the number of different binary trees with <i class="emphasis">n</i> nodes. In this problem, you will find a formula for <i class="emphasis">b<sub>n</sub></i>, as well as an asymptotic estimate.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Show that <i class="emphasis">b</i><sub>0</sub> = 1 and that, for <i class="emphasis">n</i> <span class="unicode">&ge;</span> 1,</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig293_01.jpg" height="43" width="117" alt="" border="0"></span>
</div>
</li>
<li class="listitem">
<p class="first-para">Referring to <a href="DDU0027.html#287" target="_parent" class="chapterjump">Problem 4-5</a> for the definition of a generating function, let <i class="emphasis">B</i>(<i class="emphasis">x</i>) be the generating function</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig293_02.jpg" height="40" width="108" alt="" border="0"></span>
</div>
<p class="para">Show that <i class="emphasis">B</i>(<i class="emphasis">x</i>) = <i class="emphasis">xB</i>(<i class="emphasis">x</i>)<sup>2</sup> + 1, and hence one way to express <i class="emphasis">B</i>(<i class="emphasis">x</i>) in closed form is</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig293_03.jpg" height="33" width="171" alt="" border="0"></span>
</div>
</li>
</ol>
<p class="para">The <b class="bold"><i class="emphasis">Taylor expansion</i></b> of <i class="emphasis">f</i>(<i class="emphasis">x</i>) around the point <i class="emphasis">x</i> = <i class="emphasis">a</i> is given by</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig293_04.jpg" height="41" width="177" alt="" border="0"></span>
</div>
<p class="para">where <i class="emphasis">f</i><sup>(<i class="emphasis">k</i>)</sup>(<i class="emphasis">x</i>) is the <i class="emphasis">k</i>th derivative of <i class="emphasis">f</i> evaluated at <i class="emphasis">x</i>.</p>
<ol class="orderedlist" start="3" type="a">
<li class="first-listitem">
<p class="first-para">Show that</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig293_05.jpg" height="38" width="105" alt="" border="0"></span>
</div>
<p class="para">(the <i class="emphasis">n</i>th <b class="bold"><i class="emphasis">Catalan number</i></b>) by using the Taylor expansion of <span class="inlinemediaobject"><img src="images/fig293_06.jpg" height="14" width="41" alt="" border="0"></span> around <i class="emphasis">x</i> = 0. (If you wish, instead of using the Taylor expansion, you may use the generalization of the binomial expansion (<a href="DDU0253.html#3421" target="_parent" class="chapterjump">C.4</a>) to nonintegral exponents <i class="emphasis">n</i>, where for any real number <i class="emphasis">n</i> and for any integer <i class="emphasis">k</i>, we interpret <span class="inlinemediaobject"><img src="images/fig293_07.jpg" height="15" width="13" alt="" border="0"></span> to be <i class="emphasis">n</i>(<i class="emphasis">n</i> - 1) (<i class="emphasis">n</i> - <i class="emphasis">k</i> + 1)/<i class="emphasis">k</i>! if <i class="emphasis">k</i> <span class="unicode">&ge;</span> 0, and 0 otherwise.)</p>
<a name="859"></a><a name="IDX-272"></a>
</li>
<li class="listitem">
<p class="first-para">Show that</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig294_01.jpg" height="37" width="178" alt="" border="0"></span>
</div>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0073.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0075.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
