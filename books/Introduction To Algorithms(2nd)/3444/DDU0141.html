<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Optimal substructure of a shortest path</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0140.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0142.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch24"></a>
<div class="section">
<h4 class="sect4-title">
<a name="1753"></a><a name="ch24lev3sec2"></a>Optimal substructure of a shortest path</h4>
<p class="first-para">Shortest-paths algorithms typically rely on the property that a shortest path between two vertices contains other shortest paths within it. (The Edmonds-Karp maximum-flow algorithm in <a href="DDU0160.html#1960" target="_parent" class="chapterjump">Chapter 26</a> also relies on this property.) This optimal-substructure property is a hallmark of the applicability of both dynamic programming (<a href="DDU0086.html#1007" target="_parent" class="chapterjump">Chapter 15</a>) and the greedy method (<a href="DDU0093.html#1143" target="_parent" class="chapterjump">Chapter 16</a>). Dijkstra's algorithm, which we shall see in <a href="DDU0150.html#1788" target="_parent" class="chapterjump">Section 24.3</a>, is a greedy algorithm, and the Floyd-Warshall algorithm, which finds shortest paths between all pairs of vertices (see <a href="DDU0154.html#1876" target="_parent" class="chapterjump">Chapter 25</a>), is a dynamic-programming algorithm. The following lemma states the optimal-substructure property of shortest paths more precisely.<a name="1754"></a><a name="IDX-582"></a>
</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 24.1: </span>(Subpaths of shortest paths are shortest paths)</span><a name="1755"></a><a name="ch24ex01"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Given a weighted, directed graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) with weight function <i class="emphasis">w</i> : <i class="emphasis">E</i> <span class="unicode">&rarr;</span> <b class="bold">R</b>, let <i class="emphasis">p</i> = <span class="unicode">&#12296;</span><i class="emphasis">v</i><sub>1</sub>, <i class="emphasis">v</i><sub>2</sub>,..., <i class="emphasis">v<sub>k</sub></i><span class="unicode">&#12297;</span> be a shortest path from vertex <i class="emphasis">v</i><sub>1</sub> to vertex <i class="emphasis">v<sub>k</sub></i> and, for any <i class="emphasis">i</i> and <i class="emphasis">j</i> such that 1 <span class="unicode">&le;</span> <i class="emphasis">i</i> <span class="unicode">&le;</span> <i class="emphasis">j</i> <span class="unicode">&le;</span> <i class="emphasis">k</i>, let <i class="emphasis">p<sub>ij</sub></i> = <span class="unicode">&#12296;</span><i class="emphasis">v<sub>i</sub></i>, <i class="emphasis">v</i><sub><i class="emphasis">i</i>+1</sub>,..., <i class="emphasis">v<sub>j</sub></i><span class="unicode">&#12297;</span> be the subpath of <i class="emphasis">p</i> from vertex <i class="emphasis">v<sub>i</sub></i> to vertex <i class="emphasis">v<sub>j</sub></i> . Then, <i class="emphasis">p<sub>ij</sub></i> is a shortest path from <i class="emphasis">v<sub>i</sub></i> to <i class="emphasis">v<sub>j</sub></i>.</p>
<p class="last-para">
<b class="bold"><i class="emphasis">Proof</i></b> If we decompose path <i class="emphasis">p</i> into <span class="inlinemediaobject"><img src="images/fig604_01.jpg" height="16" width="103" alt="" border="0"></span>, then we have that <i class="emphasis">w</i>(<i class="emphasis">p</i>) = <i class="emphasis">w</i>(<i class="emphasis">p</i><sub>1<i class="emphasis">i</i></sub>) + <i class="emphasis">w</i>(<i class="emphasis">p<sub>ij</sub></i>) + <i class="emphasis">w</i>(<i class="emphasis">p<sub>jk</sub></i>). Now, assume that there is a path <span class="inlinemediaobject"><img src="images/fig604_02.jpg" height="14" width="13" alt="" border="0"></span> from <i class="emphasis">v<sub>i</sub></i> to <i class="emphasis">v<sub>j</sub></i> with weight <span class="inlinemediaobject"><img src="images/fig604_03.jpg" height="14" width="76" alt="" border="0"></span>. Then, <span class="inlinemediaobject"><img src="images/fig604_04.jpg" height="19" width="94" alt="" border="0"></span> is a path from <i class="emphasis">v</i><sub>1</sub> to <i class="emphasis">v<sub>k</sub></i> whose weight <span class="inlinemediaobject"><img src="images/fig604_05.jpg" height="14" width="114" alt="" border="0"></span> is less than <i class="emphasis">w</i>(<i class="emphasis">p</i>), which contradicts the assumption that <i class="emphasis">p</i> is a shortest path from <i class="emphasis">v</i><sub>1</sub> to <i class="emphasis">v<sub>k</sub></i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0140.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0142.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
