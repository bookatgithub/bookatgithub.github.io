<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Negative-weight edges</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0141.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0143.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch24"></a>
<div class="section">
<h4 class="sect4-title">
<a name="1756"></a><a name="ch24lev3sec3"></a>Negative-weight edges</h4>
<p class="first-para">In some instances of the single-source shortest-paths problem, there may be edges whose weights are negative. If the graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) contains no negative-weight cycles reachable from the source <i class="emphasis">s</i>, then for all <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i> , the shortest-path weight <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">v</i>) remains well defined, even if it has a negative value. If there is a negative-weight cycle reachable from <i class="emphasis">s</i>, however, shortest-path weights are not well defined. No path from <i class="emphasis">s</i> to a vertex on the cycle can be a shortest path<span class="unicode">-</span>a lesser-weight path can always be found that follows the proposed "shortest" path and then traverses the negative-weight cycle. If there is a negative-weight cycle on some path from <i class="emphasis">s</i> to <i class="emphasis">v</i>, we define <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">v</i>) = -<span class="unicode">&infin;</span>.</p>
<p class="para">
<a class="internaljump" href="#ch24fig01">Figure 24.1</a> illustrates the effect of negative weights and negative-weight cycles on shortest-path weights. Because there is only one path from <i class="emphasis">s</i> to <i class="emphasis">a</i> (the path <span class="unicode">&#12296;</span><i class="emphasis">s</i>, <i class="emphasis">a</i><span class="unicode">&#12297;</span>), <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">a</i>) = <i class="emphasis">w</i>(<i class="emphasis">s</i>, <i class="emphasis">a</i>) = 3. Similarly, there is only one path from <i class="emphasis">s</i> to <i class="emphasis">b</i>, and so <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">b</i>) = <i class="emphasis">w</i>(<i class="emphasis">s</i>, <i class="emphasis">a</i>) + <i class="emphasis">w</i>(<i class="emphasis">a</i>, <i class="emphasis">b</i>) = 3 + (-4) = -1. There are infinitely many paths from <i class="emphasis">s</i> to <i class="emphasis">c</i>: <span class="unicode">&#12296;</span><i class="emphasis">s</i>, <i class="emphasis">c</i><span class="unicode">&#12297;</span>, <span class="unicode">&#12296;</span><i class="emphasis">s</i>, <i class="emphasis">c</i>, <i class="emphasis">d</i>, <i class="emphasis">c</i><span class="unicode">&#12297;</span>, <span class="unicode">&#12296;</span><i class="emphasis">s</i>, <i class="emphasis">c</i>, <i class="emphasis">d</i>, <i class="emphasis">c</i>, <i class="emphasis">d</i>, <i class="emphasis">c</i><span class="unicode">&#12297;</span>, and so on. Because the cycle <span class="unicode">&#12296;</span><i class="emphasis">c</i>, <i class="emphasis">d</i>, <i class="emphasis">c</i><span class="unicode">&#12297;</span> has weight 6 + (-3) = 3 <span class="unicode">&gt;</span> 0, the shortest path from <i class="emphasis">s</i> to <i class="emphasis">c</i> is <span class="unicode">&#12296;</span><i class="emphasis">s</i>, <i class="emphasis">c</i><span class="unicode">&#12297;</span>, with weight <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">c</i>) = 5. Similarly, the shortest path from <i class="emphasis">s</i> to <i class="emphasis">d</i> is <span class="unicode">&#12296;</span><i class="emphasis">s</i>, <i class="emphasis">c</i>, <i class="emphasis">d</i><span class="unicode">&#12297;</span>, with weight <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">d</i>) = <i class="emphasis">w</i>(<i class="emphasis">s</i>, <i class="emphasis">c</i>) + <i class="emphasis">w</i>(<i class="emphasis">c</i>, <i class="emphasis">d</i>) = 11. Analogously, there are infinitely many paths from <i class="emphasis">s</i> to <i class="emphasis">e</i>: <span class="unicode">&#12296;</span><i class="emphasis">s</i>, <i class="emphasis">e</i><span class="unicode">&#12297;</span>, <span class="unicode">&#12296;</span><i class="emphasis">s</i>, <i class="emphasis">e</i>, <i class="emphasis">f</i>, <i class="emphasis">e</i><span class="unicode">&#12297;</span>, <span class="unicode">&#12296;</span><i class="emphasis">s</i>, <i class="emphasis">e</i>, <i class="emphasis">f</i>, <i class="emphasis">e</i>, <i class="emphasis">f</i>, <i class="emphasis">e</i><span class="unicode">&#12297;</span>, and so on. Since the cycle <span class="unicode">&#12296;</span><i class="emphasis">e</i>, <i class="emphasis">f</i>, <i class="emphasis">e</i><span class="unicode">&#12297;</span> has weight 3 + (-6) = -3 <span class="unicode">&lt;</span> 0, however, there is no shortest path from <i class="emphasis">s</i> to <i class="emphasis">e</i>. By traversing the negative-weight cycle <span class="unicode">&#12296;</span><i class="emphasis">e</i>, <i class="emphasis">f</i>, <i class="emphasis">e</i><span class="unicode">&#12297;</span> arbitrarily many times, we can find paths from <i class="emphasis">s</i> to <i class="emphasis">e</i> with arbitrarily large negative weights, and so <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">e</i>) = -<span class="unicode">&infin;</span>. Similarly, <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">f</i>) = -<span class="unicode">&infin;</span>. Because <i class="emphasis">g</i> is reachable from <i class="emphasis">f</i> , we can also find paths with arbitrarily large negative weights from <i class="emphasis">s</i> to <i class="emphasis">g</i>, and <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">g</i>) = -<span class="unicode">&infin;</span>. Vertices <i class="emphasis">h</i>, <i class="emphasis">i</i>, and <i class="emphasis">j</i> also form a negative-weight cycle. They are not reachable from <i class="emphasis">s</i>, however, and so <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">h</i>) = <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">i</i>) = <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">j</i>) = <span class="unicode">&infin;</span>.</p>
<div class="figure">
<a name="1757"></a><a name="ch24fig01"></a><span class="figuremediaobject"><a href="images/fig605%5F01%5F0%2Ejpg" NAME="IMG_701" target="_parent"><img src="images/fig605_01.jpg" height="139" width="343" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 24.1: </span>Negative edge weights in a directed graph. Shown within each vertex is its shortest-path weight from source <i class="emphasis">s</i>. Because vertices <i class="emphasis">e</i> and <i class="emphasis">f</i> form a negative-weight cycle reachable from <i class="emphasis">s</i>, they have shortest-path weights of -<span class="unicode">&infin;</span>. Because vertex <i class="emphasis">g</i> is reachable from a vertex whose shortest-path weight is -<span class="unicode">&infin;</span>, it, too, has a shortest-path weight of -<span class="unicode">&infin;</span>. Vertices such as <i class="emphasis">h, i</i>, and <i class="emphasis">j</i> are not reachable from <i class="emphasis">s</i>, and so their shortest-path weights are <span class="unicode">&infin;</span>, even though they lie on a negative-weight cycle.</span>
</div>
<p class="last-para">Some shortest-paths algorithms, such as Dijkstra's algorithm, assume that all edge weights in the input graph are nonnegative, as in the road-map example. Oth<a name="1758"></a><a name="IDX-583"></a>ers, such as the Bellman-Ford algorithm, allow negative-weight edges in the input graph and produce a correct answer as long as no negative-weight cycles are reachable from the source. Typically, if there is such a negative-weight cycle, the algorithm can detect and report its existence.</p>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0141.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0143.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
