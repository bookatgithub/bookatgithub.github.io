<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>25.1 Shortest paths and matrix multiplication</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0155.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0157.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch25"></a>
<div class="section">
<h2 class="first-section-title">
<a name="1883"></a><a name="ch25lev1sec1"></a><span class="section-titlelabel">25.1 </span>Shortest paths and matrix multiplication</h2>
<p class="first-para">This section presents a dynamic-programming algorithm for the all-pairs shortestpaths problem on a directed graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>). Each major loop of the dynamic program will invoke an operation that is very similar to matrix multiplication, so that the algorithm will look like repeated matrix multiplication. We shall start by developing a <span class="unicode">&Theta;</span>(<i class="emphasis">V</i><sup>4</sup>)-time algorithm for the all-pairs shortest-paths problem and then improve its running time to <span class="unicode">&Theta;</span>(<i class="emphasis">V</i><sup>3</sup> lg <i class="emphasis">V</i>).</p>
<p class="para">Before proceeding, let us briefly recap the steps given in <a href="DDU0086.html#1007" target="_parent" class="chapterjump">Chapter 15</a> for developing a dynamic-programming algorithm.</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">Characterize the structure of an optimal solution.</p>
</li>
<li class="listitem">
<p class="first-para">Recursively define the value of an optimal solution.</p>
</li>
<li class="listitem">
<p class="first-para">Compute the value of an optimal solution in a bottom-up fashion.</p>
</li>
</ol>
<p class="para">(The fourth step, constructing an optimal solution from computed information, is dealt with in the exercises.)<a name="1884"></a><a name="IDX-623"></a>
</p>
<div class="section">
<h4 class="sect4-title">
<a name="1885"></a><a name="ch25lev3sec2"></a>The structure of a shortest path</h4>
<p class="first-para">We start by characterizing the structure of an optimal solution. For the all-pairs shortest-paths problem on a graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>), we have proven (<a href="DDU0141.html#1755" target="_parent" class="chapterjump">Lemma 24.1</a>) that all subpaths of a shortest path are shortest paths. Suppose that the graph is represented by an adjacency matrix <i class="emphasis">W</i> = (<i class="emphasis">w<sub>ij</sub></i>). Consider a shortest path <i class="emphasis">p</i> from vertex <i class="emphasis">i</i> to vertex <i class="emphasis">j</i>, and suppose that <i class="emphasis">p</i> contains at most <i class="emphasis">m</i> edges. Assuming that there are no negative-weight cycles, <i class="emphasis">m</i> is finite. If <i class="emphasis">i</i> = <i class="emphasis">j</i>, then <i class="emphasis">p</i> has weight 0 and no edges. If vertices <i class="emphasis">i</i> and <i class="emphasis">j</i> are distinct, then we decompose path <i class="emphasis">p</i> into <span class="inlinemediaobject"><img src="images/fig645_01.jpg" height="17" width="52" alt="" border="0"></span>, where path <i class="emphasis">p</i><span class="unicode">&prime;</span> now contains at most <i class="emphasis">m</i> - 1 edges. By <a href="DDU0141.html#1755" target="_parent" class="chapterjump">Lemma 24.1</a>, <i class="emphasis">p</i><span class="unicode">&prime;</span> is a shortest path from <i class="emphasis">i</i> to <i class="emphasis">k</i>, and so <span class="unicode">&delta;</span>(<i class="emphasis">i</i>, <i class="emphasis">j</i>) = <span class="unicode">&delta;</span>(<i class="emphasis">i</i>, <i class="emphasis">k</i>) + <i class="emphasis">w<sub>kj</sub></i>.</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="1886"></a><a name="ch25lev3sec3"></a>A recursive solution to the all-pairs shortest-paths problem</h4>
<p class="first-para">Now, let <span class="inlinemediaobject"><img src="images/fig645_02.jpg" height="17" width="16" alt="" border="0"></span> be the minimum weight of any path from vertex <i class="emphasis">i</i> to vertex <i class="emphasis">j</i> that contains at most <i class="emphasis">m</i> edges. When <i class="emphasis">m</i> = 0, there is a shortest path from <i class="emphasis">i</i> to <i class="emphasis">j</i> with no edges if and only if <i class="emphasis">i</i> = <i class="emphasis">j</i>. Thus,</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig645_03.jpg" height="37" width="130" alt="" border="0"></span>
</div>
<p class="para">For <i class="emphasis">m</i> <span class="unicode">&ge;</span> 1, we compute <span class="inlinemediaobject"><img src="images/fig645_04.jpg" height="16" width="16" alt="" border="0"></span> as the minimum of <span class="inlinemediaobject"><img src="images/fig645_05.jpg" height="17" width="26" alt="" border="0"></span> (the weight of the shortest path from <i class="emphasis">i</i> to <i class="emphasis">j</i> consisting of at most <i class="emphasis">m</i> - 1 edges) and the minimum weight of any path from <i class="emphasis">i</i> to <i class="emphasis">j</i> consisting of at most <i class="emphasis">m</i> edges, obtained by looking at all possible predecessors <i class="emphasis">k</i> of <i class="emphasis">j</i>. Thus, we recursively define</p>
<div class="equation">
<a name="1887"></a><a name="ch25eq02"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(25.2)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig645_06.jpg" height="62" width="261" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">The latter equality follows since <i class="emphasis">w<sub>jj</sub></i> = 0 for all <i class="emphasis">j</i>.</p>
<p class="para">What are the actual shortest-path weights <span class="unicode">&delta;</span>(<i class="emphasis">i</i>, <i class="emphasis">j</i>)? If the graph contains no negative-weight cycles, then for every pair of vertices <i class="emphasis">i</i> and <i class="emphasis">j</i> for which <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">i</i>, <i class="emphasis">j</i>) <span class="unicode">&lt;</span> <span class="unicode">&infin;</span>, there is a shortest path from <i class="emphasis">i</i> to <i class="emphasis">j</i> that is simple and thus contains at most <i class="emphasis">n</i> - 1 edges. A path from vertex <i class="emphasis">i</i> to vertex <i class="emphasis">j</i> with more than <i class="emphasis">n</i> - 1 edges cannot have lower weight than a shortest path from <i class="emphasis">i</i> to <i class="emphasis">j</i>. The actual shortest-path weights are therefore given by</p>
<div class="equation">
<a name="1888"></a><a name="ch25eq03"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(25.3)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig645_07.jpg" height="23" width="224" alt="" border="0"></span></td>
</tr>
</table>
</div>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="1889"></a><a name="ch25lev3sec4"></a>Computing the shortest-path weights bottom up</h4>
<p class="first-para">Taking as our input the matrix <i class="emphasis">W</i> = (<i class="emphasis">w<sub>ij</sub></i>), we now compute a series of matrices <i class="emphasis">L</i><sup>(1)</sup>, <i class="emphasis">L</i><sup>(2)</sup>,..., <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup>, where for <i class="emphasis">m</i> = 1, 2,..., <i class="emphasis">n</i> - 1, we have <span class="inlinemediaobject"><img src="images/fig645_08.jpg" height="17" width="64" alt="" border="0"></span>. <a name="1890"></a><a name="IDX-624"></a>The final matrix <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup> contains the actual shortest-path weights. Observe that <span class="inlinemediaobject"><img src="images/fig646_01.jpg" height="17" width="43" alt="" border="0"></span> for all vertices <i class="emphasis">i</i>, <i class="emphasis">j</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i> , and so <i class="emphasis">L</i><sup>(1)</sup> = <i class="emphasis">W</i>.</p>
<p class="para">The heart of the algorithm is the following procedure, which, given matrices <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>-1)</sup> and <i class="emphasis">W</i>, returns the matrix <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup>. That is, it extends the shortest paths computed so far by one more edge.</p>
<div class="informalexample">
<pre class="literallayout-normal">
EXTEND-SHORTEST-PATHS(<i class="emphasis">L</i>, <i class="emphasis">W</i>)
1  <i class="emphasis">n</i> <span class="unicode">&larr;</span> <i class="emphasis">rows</i>[<i class="emphasis">L</i>]
2  let <span class="inlinemediaobject"><img src="images/fig646_02.jpg" height="14" width="42" alt="" border="0"></span> be an <i class="emphasis">n</i> <span class="unicode">&times;</span> <i class="emphasis">n</i> matrix
3  <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
4      <b class="bold">do for</b> <i class="emphasis">j</i> <span class="unicode">&larr;</span> <b class="bold">to</b> <i class="emphasis">n</i>
5            <b class="bold">do</b> <span class="inlinemediaobject"><img src="images/fig646_03.jpg" height="15" width="40" alt="" border="0"></span>
6              <b class="bold">for</b> <i class="emphasis">k</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
7                  <b class="bold">do</b> <span class="inlinemediaobject"><img src="images/fig646_04.jpg" height="19" width="144" alt="" border="0"></span>
8  <b class="bold">return</b> <i class="emphasis">L</i><span class="unicode">&prime;</span>
</pre>
</div>
<p class="para">The procedure computes a matrix <span class="inlinemediaobject"><img src="images/fig646_05.jpg" height="14" width="43" alt="" border="0"></span>, which it returns at the end. It does so by computing equation (<a class="internaljump" href="#ch25eq02">25.2</a>) for all <i class="emphasis">i</i> and <i class="emphasis">j</i>, using <i class="emphasis">L</i> for <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>-1)</sup> and <i class="emphasis">L</i><span class="unicode">&prime;</span> for <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup>. (It is written without the superscripts to make its input and output matrices independent of <i class="emphasis">m</i>.) Its running time is <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>3</sup>) due to the three nested <b class="bold">for</b> loops.</p>
<p class="para">Now we can see the relation to matrix multiplication. Suppose we wish to compute the matrix product <i class="emphasis">C</i> = <i class="emphasis">A</i> <span class="unicode">&middot;</span> <i class="emphasis">B</i> of two <i class="emphasis">n</i> <span class="unicode">&times;</span> <i class="emphasis">n</i> matrices <i class="emphasis">A</i> and <i class="emphasis">B</i>. Then, for <i class="emphasis">i</i>, <i class="emphasis">j</i> = 1, 2,..., <i class="emphasis">n</i>, we compute</p>
<div class="equation">
<a name="1891"></a><a name="ch25eq04"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(25.4)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig646_06.jpg" height="40" width="111" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">Observe that if we make the substitutions</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">l</i><sup>(<i class="emphasis">m</i>-1)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&rarr;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">a</i>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">w</i>
</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&rarr;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">l</i><sup>(<i class="emphasis">m</i>)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&rarr;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">c</i>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">min</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&rarr;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">+,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">+</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&rarr;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="unicode">&middot;</span>
</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">in equation (<a class="internaljump" href="#ch25eq02">25.2</a>), we obtain equation (<a class="internaljump" href="#ch25eq04">25.4</a>). Thus, if we make these changes to EXTEND-SHORTEST-PATHS and also replace <span class="unicode">&infin;</span> (the identity for min) by 0 (the identity for +), we obtain the straightforward <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>3</sup>)-time procedure for matrix multiplication: <a name="1892"></a><a name="IDX-625"></a>
</p>
<div class="informalexample">
<pre class="literallayout-normal">
MATRIX-MULTIPLY(<i class="emphasis">A</i>, <i class="emphasis">B</i>)
1  <i class="emphasis">n</i> <span class="unicode">&larr;</span> <i class="emphasis">rows</i>[<i class="emphasis">A</i>]
2  let <i class="emphasis">C</i> be an <i class="emphasis">n</i> <span class="unicode">&times;</span> <i class="emphasis">n</i> matrix
3  <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
4      <b class="bold">do for</b> <i class="emphasis">j</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
5           <b class="bold">do</b> <i class="emphasis">c<sub>ij</sub></i> <span class="unicode">&larr;</span> 0
6              <b class="bold">for</b> <i class="emphasis">k</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
7                <b class="bold">do</b> <i class="emphasis">c<sub>ij</sub></i> <span class="unicode">&larr;</span> <i class="emphasis">c<sub>ij</sub></i> + <i class="emphasis">a<sub>ik</sub></i> <span class="unicode">&middot;</span> <i class="emphasis">b<sub>kj</sub></i>
8  <b class="bold">return</b> <i class="emphasis">C</i>
</pre>
</div>
<p class="para">Returning to the all-pairs shortest-paths problem, we compute the shortest-path weights by extending shortest paths edge by edge. Letting <i class="emphasis">A</i> <span class="unicode">&middot;</span> <i class="emphasis">B</i> denote the matrix "product" returned by EXTEND-SHORTEST-PATHS(<i class="emphasis">A</i>, <i class="emphasis">B</i>), we compute the sequence of <i class="emphasis">n</i> - 1 matrices</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">L</i><sup>(1)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="center">
<p class="table-para">
<i class="emphasis">L</i><sup>(0)</sup> <span class="unicode">&middot;</span> <i class="emphasis">W</i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">W</i>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">L</i><sup>(2)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="center">
<p class="table-para">
<i class="emphasis">L</i><sup>(1)</sup> <span class="unicode">&middot;</span> <i class="emphasis">W</i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">W</i><sup>2</sup>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">L</i><sup>(3)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="center">
<p class="table-para">
<i class="emphasis">L</i><sup>(2)</sup> <span class="unicode">&middot;</span> <i class="emphasis">W</i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">W</i><sup>3</sup>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">&nbsp;</td><td class="td" align="center">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&#8942;</span>
</p>
</td><td class="td" align="center">&nbsp;</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="center">
<p class="table-para">
<i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-2)</sup> <span class="unicode">&middot;</span> <i class="emphasis">W</i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">W</i><sup><i class="emphasis">n</i>-1</sup>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">As we argued above, the matrix <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup> = <i class="emphasis">W</i><sup><i class="emphasis">n</i>-1</sup> contains the shortest-path weights. The following procedure computes this sequence in <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>4</sup>) time.</p>
<div class="informalexample">
<pre class="literallayout-normal">
SLOW-ALL-PAIRS-SHORTEST-PATHS(<i class="emphasis">W</i>)
1  <i class="emphasis">n</i> <span class="unicode">&larr;</span> <i class="emphasis">rows</i>[<i class="emphasis">W</i>]
2  <i class="emphasis">L</i><sup>(1)</sup> <i class="emphasis">W</i>
3  <b class="bold">for</b> <i class="emphasis">m</i> <span class="unicode">&larr;</span> 2 <b class="bold">to</b> <i class="emphasis">n</i> - 1
4      <b class="bold">do</b> <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup> <span class="unicode">&larr;</span> EXTEND-SHORTEST-PATHS(<i class="emphasis">L</i><sup>(<i class="emphasis">m</i>-1)</sup>, <i class="emphasis">W</i>)
5  <b class="bold">return</b> <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup>
</pre>
</div>
<p class="para">
<a class="internaljump" href="#ch25fig01">Figure 25.1</a> shows a graph and the matrices <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup> computed by the procedure SLOW-ALL-PAIRS-SHORTEST-PATHS.</p>
<div class="figure">
<a name="1893"></a><a name="ch25fig01"></a><span class="figuremediaobject"><a href="images/fig648%5F01%5F0%2Ejpg" NAME="IMG_779" target="_parent"><img src="images/fig648_01.jpg" height="302" width="343" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 25.1: </span> A directed graph and the sequence of matrices <i class="emphasis">L<sup>(m)</sup></i> computed by SLOW-ALL-PAIRS-SHORTEST-PATHS. The reader may verify that <i class="emphasis">L</i><sup>(5)</sup> = <i class="emphasis">L</i><sup>(4)</sup> <span class="unicode">&middot;</span> <i class="emphasis">W</i> is equal to <i class="emphasis">L</i><sup>(4)</sup>, and thus <i class="emphasis">L</i><sup>(m)</sup> = <i class="emphasis">L</i><sup>(4)</sup> for all <i class="emphasis">m</i> <span class="unicode">&ge;</span> 4.</span>
</div>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="1894"></a><a name="ch25lev3sec5"></a>Improving the running time</h4>
<p class="first-para">Our goal, however, is not to compute <i class="emphasis">all</i> the <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup> matrices: we are interested only in matrix <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup>. Recall that in the absence of negative-weight cycles, equation (<a class="internaljump" href="#ch25eq03">25.3</a>) implies <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup> = <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup> for all integers <i class="emphasis">m</i> <span class="unicode">&ge;</span> <i class="emphasis">n</i> - 1. Just as traditional matrix multiplication is associative, so is matrix multiplication defined by the EXTEND-SHORTEST-PATHS procedure (see <a class="internaljump" href="#ch25ex04">Exercise 25.1-4</a>). Therefore, we can compute <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup> with only <span class="unicode">&lceil;</span>lg(<i class="emphasis">n</i> - 1)<span class="unicode">&rceil;</span> matrix products by computing the sequence <a name="1895"></a><a name="IDX-626"></a>
</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">L</i><sup>(1)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="center">
<p class="table-para">
<i class="emphasis">W</i>,</p>
</td><td class="td" align="center">&nbsp;</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">L</i><sup>(2)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="center">
<p class="table-para">
<i class="emphasis">W</i><sup>2</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">W</i> <span class="unicode">&middot;</span> <i class="emphasis">W</i>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">L</i><sup>(4)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="center">
<p class="table-para">
<i class="emphasis">W</i><sup>4</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">W</i><sup>2</sup> <span class="unicode">&middot;</span> <i class="emphasis">W</i><sup>2</sup>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">L</i><sup>(8)</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="center">
<p class="table-para">
<i class="emphasis">W</i><sup>8</sup>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">W</i><sup>4</sup> <span class="unicode">&middot;</span> <i class="emphasis">W</i><sup>4</sup>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">&nbsp;</td><td class="td" align="center">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&#8942;</span>
</p>
</td><td class="td" align="center">&nbsp;</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig648_02.jpg" height="14" width="43" alt="" border="0"></span>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig648_03.jpg" height="20" width="58" alt="" border="0"></span>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig648_04.jpg" height="23" width="143" alt="" border="0"></span>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">Since 2<sup><i class="emphasis"><span class="unicode">&lceil;</span></i>lg(<i class="emphasis">n</i>-1)<i class="emphasis"><span class="unicode">&rceil;</span></i></sup> <span class="unicode">&ge;</span> <i class="emphasis">n</i> - 1, the final product <span class="inlinemediaobject"><img src="images/fig648_05.jpg" height="14" width="43" alt="" border="0"></span> is equal to <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup>.</p>
<p class="para">The following procedure computes the above sequence of matrices by using this technique of <b class="bold"><i class="emphasis">repeated squaring</i></b>.<a name="1896"></a><a name="IDX-627"></a>
</p>
<div class="informalexample">
<pre class="literallayout-normal">
FASTER-ALL-PAIRS-SHORTEST-PATHS(<i class="emphasis">W</i>)
1  <i class="emphasis">n</i> <span class="unicode">&larr;</span> <i class="emphasis">rows</i>[<i class="emphasis">W</i>]
2  <i class="emphasis">L</i><sup>(1)</sup> <span class="unicode">&larr;</span> <i class="emphasis">W</i>
3  <i class="emphasis">m</i> <span class="unicode">&larr;</span> 1
4  <b class="bold">while</b> <i class="emphasis">m</i> <span class="unicode">&lt;</span> <i class="emphasis">n</i> - 1
5      <b class="bold">do</b> <i class="emphasis">L</i><sup>(2<i class="emphasis">m</i>)</sup> <span class="unicode">&larr;</span> EXTEND-SHORTEST-PATHS(<i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup>, <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup>)
6         <i class="emphasis">m</i> <span class="unicode">&larr;</span> 2<i class="emphasis">m</i>
7  <b class="bold">return</b> <i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup>
</pre>
</div>
<p class="para">In each iteration of the <b class="bold">while</b> loop of lines 4<span class="unicode">-</span>6, we compute <i class="emphasis">L</i><sup>(2<i class="emphasis">m</i>)</sup> = (<i class="emphasis">L</i><sup>(<i class="emphasis">m</i>)</sup>)<sup>2</sup>, starting with <i class="emphasis">m</i> = 1. At the end of each iteration, we double the value of <i class="emphasis">m</i>. The final iteration computes <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup> by actually computing <i class="emphasis">L</i><sup>(2<i class="emphasis">m</i>)</sup> for some <i class="emphasis">n</i> - 1 <span class="unicode">&le;</span> 2<i class="emphasis">m</i> <span class="unicode">&lt;</span> 2<i class="emphasis">n</i> - 2. By equation (<a class="internaljump" href="#ch25eq03">25.3</a>), <i class="emphasis">L</i><sup>(2<i class="emphasis">m</i>)</sup> = <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup>. The next time the test in line 4 is performed, <i class="emphasis">m</i> has been doubled, so now <i class="emphasis">m</i> <span class="unicode">&ge;</span> <i class="emphasis">n</i> - 1, the test fails, and the procedure returns the last matrix it computed.</p>
<p class="para">The running time of FASTER-ALL-PAIRS-SHORTEST-PATHS is <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>3</sup> lg <i class="emphasis">n</i>) since each of the <span class="unicode">&lceil;</span>lg(<i class="emphasis">n</i> - 1)<span class="unicode">&rceil;</span> matrix products takes <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>3</sup>) time. Observe that the code is tight, containing no elaborate data structures, and the constant hidden in the <span class="unicode">&Theta;</span>-notation is therefore small.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-1</span></span><a name="1897"></a><a name="ch25ex01"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Run SLOW-ALL-PAIRS-SHORTEST-PATHS on the weighted, directed graph of <a class="internaljump" href="#ch25fig02">Figure 25.2</a>, showing the matrices that result for each iteration of the loop. Then do the same for FASTER-ALL-PAIRS-SHORTEST-PATHS.</p>
<p class="last-para">
<div class="figure">
<a name="1898"></a><a name="ch25fig02"></a><span class="figuremediaobject"><img src="images/fig649_01.jpg" height="146" width="280" alt="" border="0"></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 25.2: </span>A weighted, directed graph for use in Exercises 25.1-1, 25.2-1, and 25.3-1.</span>
</div>
</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-2</span></span><a name="1899"></a><a name="ch25ex02"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Why do we require that <i class="emphasis">w<sub>ii</sub></i> = 0 for all 1 <span class="unicode">&le;</span> <i class="emphasis">i</i> <span class="unicode">&le;</span> <i class="emphasis">n</i>?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-3</span></span><a name="1900"></a><a name="ch25ex03"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">What does the matrix</p>
<a name="1901"></a><a name="IDX-628"></a>
<p class="para">
<div class="informalequation">
<span class="equation-image"><img src="images/fig650_01.jpg" height="148" width="305" alt="" border="0"></span>
</div>
</p>
<p class="last-para">used in the shortest-paths algorithms correspond to in regular matrix multiplication?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-4</span></span><a name="1902"></a><a name="ch25ex04"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that matrix multiplication defined by EXTEND-SHORTEST-PATHS is associative.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-5</span></span><a name="1903"></a><a name="ch25ex05"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show how to express the single-source shortest-paths problem as a product of matrices and a vector. Describe how evaluating this product corresponds to a Bellman-Ford-like algorithm (see <a href="DDU0148.html#1770" target="_parent" class="chapterjump">Section 24.1</a>).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-6</span></span><a name="1904"></a><a name="ch25ex06"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Suppose we also wish to compute the vertices on shortest paths in the algorithms of this section. Show how to compute the predecessor matrix <span class="unicode">&Pi;</span> from the completed matrix <i class="emphasis">L</i> of shortest-path weights in <i class="emphasis">O</i>(<i class="emphasis">n</i><sup>3</sup>) time.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-7</span></span><a name="1905"></a><a name="ch25ex07"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">The vertices on shortest paths can also be computed at the same time as the shortest-path weights. Let us define <span class="inlinemediaobject"><img src="images/fig650_02.jpg" height="17" width="21" alt="" border="0"></span> to be the predecessor of vertex <i class="emphasis">j</i> on any minimum-weight path from <i class="emphasis">i</i> to <i class="emphasis">j</i> that contains at most <i class="emphasis">m</i> edges. Modify EXTEND-SHORTEST-PATHS and SLOW-ALL-PAIRS-SHORTEST-PATHS to compute the matrices <span class="unicode">&Pi;</span><sup>(1)</sup>, <span class="unicode">&Pi;</span><sup>(2)</sup>,..., <span class="unicode">&Pi;</span><sup>(<i class="emphasis">n</i>-1)</sup> as the matrices <i class="emphasis">L</i><sup>(1)</sup>, <i class="emphasis">L</i><sup>(2)</sup>,..., <i class="emphasis">L</i><sup>(<i class="emphasis">n</i>-1)</sup> are computed.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-8</span></span><a name="1906"></a><a name="ch25ex08"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">The FASTER-ALL-PAIRS-SHORTEST-PATHS procedure, as written, requires us to store <span class="unicode">&lceil;</span>lg(<i class="emphasis">n</i> - 1)<span class="unicode">&rceil;</span> matrices, each with <i class="emphasis">n</i><sup>2</sup> elements, for a total space requirement of <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>2</sup> lg <i class="emphasis">n</i>). Modify the procedure to require only <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>2</sup>) space by using only two <i class="emphasis">n</i> <span class="unicode">&times;</span> <i class="emphasis">n</i> matrices.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-9</span></span><a name="1907"></a><a name="ch25ex09"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Modify FASTER-ALL-PAIRS-SHORTEST-PATHS so that it can detect the presence of a negative-weight cycle.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.1-10</span></span><a name="1908"></a><a name="ch25ex10"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Give an efficient algorithm to find the length (number of edges) of a minimum-length negative-weight cycle in a graph.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0155.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0157.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
