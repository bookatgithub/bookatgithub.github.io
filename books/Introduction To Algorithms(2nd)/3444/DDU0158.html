<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>25.3 Johnson's algorithm for sparse graphs</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0157.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0159.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch25"></a>
<div class="section">
<h2 class="first-section-title">
<a name="1937"></a><a name="ch25lev1sec3"></a><span class="section-titlelabel">25.3 </span>Johnson's algorithm for sparse graphs</h2>
<a name="1938"></a><a name="IDX-636"></a>
<p class="para">Johnson's algorithm finds shortest paths between all pairs in <i class="emphasis">O</i>(<i class="emphasis">V</i><sup>2</sup> lg <i class="emphasis">V</i> + <i class="emphasis">V</i> <i class="emphasis">E</i>) time. For sparse graphs, it is asymptotically better than either repeated squaring of matrices or the Floyd-Warshall algorithm. The algorithm either returns a matrix of shortest-path weights for all pairs of vertices or reports that the input graph contains a negative-weight cycle. Johnson's algorithm uses as subroutines both Dijkstra's algorithm and the Bellman-Ford algorithm, which are described in <a href="DDU0139.html#1748" target="_parent" class="chapterjump">Chapter 24</a>.</p>
<p class="para">Johnson's algorithm uses the technique of <b class="bold"><i class="emphasis">reweighting</i></b>, which works as follows. If all edge weights <i class="emphasis">w</i> in a graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) are nonnegative, we can find shortest paths between all pairs of vertices by running Dijkstra's algorithm once from each vertex; with the Fibonacci-heap min-priority queue, the running time of this all-pairs algorithm is <i class="emphasis">O</i>(<i class="emphasis">V</i><sup>2</sup> lg <i class="emphasis">V</i> + <i class="emphasis">V E</i>). If <i class="emphasis">G</i> has negative-weight edges but no negative-weight cycles, we simply compute a new set of nonnegative edge weights that allows us to use the same method. The new set of edge weights <span class="inlinemediaobject"><img src="images/fig658_01.jpg" height="10" width="10" alt="" border="0"></span> must satisfy two important properties.</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">For all pairs of vertices <i class="emphasis">u</i>, <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>, a path <i class="emphasis">p</i> is a shortest path from <i class="emphasis">u</i> to <i class="emphasis">v</i> using weight function <i class="emphasis">w</i> if and only if <i class="emphasis">p</i> is also a shortest path from <i class="emphasis">u</i> to <i class="emphasis">v</i> using weight function <span class="inlinemediaobject"><img src="images/fig658_02.jpg" height="10" width="10" alt="" border="0"></span>.</p>
</li>
<li class="listitem">
<p class="first-para">For all edges (<i class="emphasis">u</i>, <i class="emphasis">v</i>), the new weight <span class="inlinemediaobject"><img src="images/fig658_03.jpg" height="14" width="34" alt="" border="0"></span> is nonnegative.</p>
</li>
</ol>
<p class="para">As we shall see in a moment, the preprocessing of <i class="emphasis">G</i> to determine the new weight function <span class="inlinemediaobject"><img src="images/fig658_04.jpg" height="10" width="10" alt="" border="0"></span> can be performed in <i class="emphasis">O</i>(<i class="emphasis">V E</i>) time.</p>
<div class="section">
<h4 class="sect4-title">
<a name="1939"></a><a name="ch25lev3sec11"></a>Preserving shortest paths by reweighting</h4>
<p class="first-para">As the following lemma shows, it is easy to come up with a reweighting of the edges that satisfies the first property above. We use <i class="emphasis"><span class="unicode">&delta;</span></i> to denote shortest-path weights derived from weight function <i class="emphasis">w</i> and <span class="inlinemediaobject"><img src="images/fig658_05.jpg" height="14" width="10" alt="" border="0"></span> to denote shortest-path weights derived from weight function <span class="inlinemediaobject"><img src="images/fig658_06.jpg" height="11" width="10" alt="" border="0"></span>.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 25.1: </span>(Reweighting does not change shortest paths)</span>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Given a weighted, directed graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) with weight function <i class="emphasis">w</i> : <i class="emphasis">E</i> <span class="unicode">&rarr;</span> <b class="bold">R</b>, let <i class="emphasis">h</i> : <i class="emphasis">V</i> <span class="unicode">&rarr;</span> <b class="bold">R</b> be any function mapping vertices to real numbers. For each edge (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&isin;</span> <i class="emphasis">E</i>, define</p>
<p class="para">
<div class="equation">
<a name="1940"></a><a name="ch25eq09"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(25.9)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig658_07.jpg" height="17" width="208" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="para">Let <i class="emphasis">p</i> = <span class="unicode">&#12296;</span><i class="emphasis">v</i><sub>0</sub>, <i class="emphasis">v</i><sub>1</sub>,..., <i class="emphasis">v<sub>k</sub></i><span class="unicode">&#12296;</span> be any path from vertex <i class="emphasis">v</i><sub>0</sub> to vertex <i class="emphasis">v<sub>k</sub></i>. Then <i class="emphasis">p</i> is a shortest path from <i class="emphasis">v</i><sub>0</sub> to <i class="emphasis">v<sub>k</sub></i> with weight function <i class="emphasis">w</i> if and only if it is a shortest path with weight function <span class="inlinemediaobject"><img src="images/fig658_08.jpg" height="11" width="9" alt="" border="0"></span>. That is, <i class="emphasis">w</i>(<i class="emphasis">p</i>) = <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">v</i><sub>0</sub>, <i class="emphasis">v<sub>k</sub></i>) if and only if <span class="inlinemediaobject"><img src="images/fig658_09.jpg" height="14" width="76" alt="" border="0"></span>. <a name="1941"></a><a name="IDX-637"></a>Also, <i class="emphasis">G</i> has a negative-weight cycle using weight function <i class="emphasis">w</i> if and only if <i class="emphasis">G</i> has a negative-weight cycle using weight function <span class="inlinemediaobject"><img src="images/fig659_01.jpg" height="10" width="10" alt="" border="0"></span>.</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> We start by showing that</p>
<p class="para">
<div class="equation">
<a name="1942"></a><a name="ch25eq10"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(25.10)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig659_02.jpg" height="17" width="190" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="para">We have</p>
<div class="informalequation">
<span class="equation-image"><a href="images/fig659%5F03%2Ejpg" NAME="IMG_833" target="_parent"><img src="images/fig659_03.jpg" height="140" width="400" alt="Click To expand" border="0"></a></span>
</div>
<p class="para">Therefore, any path <i class="emphasis">p</i> from <i class="emphasis">v</i><sub>0</sub> to <i class="emphasis">v<sub>k</sub></i> has <span class="inlinemediaobject"><img src="images/fig659_04.jpg" height="14" width="135" alt="" border="0"></span>. If one path from <i class="emphasis">v</i><sub>0</sub> to <i class="emphasis">v<sub>k</sub></i> is shorter than another using weight function <i class="emphasis">w</i>, then it is also shorter using <span class="inlinemediaobject"><img src="images/fig659_05.jpg" height="11" width="10" alt="" border="0"></span>. Thus, <i class="emphasis">w</i>(<i class="emphasis">p</i>) = <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">v</i><sub>0</sub>, <i class="emphasis">v<sub>k</sub></i>) if and only if <span class="inlinemediaobject"><img src="images/fig659_06.jpg" height="14" width="77" alt="" border="0"></span>.</p>
<p class="para">Finally, we show that <i class="emphasis">G</i> has a negative-weight cycle using weight function <i class="emphasis">w</i> if and only if <i class="emphasis">G</i> has a negative-weight cycle using weight function <span class="inlinemediaobject"><img src="images/fig659_07.jpg" height="11" width="10" alt="" border="0"></span>. Consider any cycle <i class="emphasis">c</i> = <span class="unicode">&#12296;</span><i class="emphasis">v</i><sub>0</sub>, <i class="emphasis">v</i><sub>1</sub>,..., <i class="emphasis">v<sub>k</sub></i><span class="unicode">&#12297;</span>, where <i class="emphasis">v</i><sub>0</sub> = <i class="emphasis">v<sub>k</sub></i>. By equation (<a class="internaljump" href="#ch25eq10">25.10</a>),</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<span class="inlinemediaobject"><img src="images/fig659_08.jpg" height="18" width="31" alt="" border="0"></span>
</p>
</td><td class="td" align="left">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">w</i>(<i class="emphasis">c</i>) + <i class="emphasis">h</i>(<i class="emphasis">v</i><sub>0</sub>) - <i class="emphasis">h</i>(<i class="emphasis">v<sub>k</sub></i>)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="left">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">w</i>(<i class="emphasis">c</i>),</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="last-para">and thus <i class="emphasis">c</i> has negative weight using <i class="emphasis">w</i> if and only if it has negative weight using <span class="inlinemediaobject"><img src="images/fig659_09.jpg" height="11" width="10" alt="" border="0"></span>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="1943"></a><a name="ch25lev3sec12"></a>Producing nonnegative weights by reweighting</h4>
<p class="first-para">Our next goal is to ensure that the second property holds: we want <span class="inlinemediaobject"><img src="images/fig659_10.jpg" height="14" width="34" alt="" border="0"></span> to be nonnegative for all edges (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&isin;</span> <i class="emphasis">E</i>. Given a weighted, directed graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) with weight function <i class="emphasis">w</i> : <i class="emphasis">E</i> <span class="unicode">&rarr;</span> <b class="bold">R</b>, we make a new graph <i class="emphasis">G</i><span class="unicode">&prime;</span> = (<i class="emphasis">V</i><span class="unicode">&prime;</span>, <i class="emphasis">E</i><span class="unicode">&prime;</span>), where <i class="emphasis">V</i><span class="unicode">&prime;</span> = <i class="emphasis">V</i> <span class="unicode">&cup;</span> {<i class="emphasis">s</i>} for some new vertex <i class="emphasis">s</i> <span class="unicode">&notin;</span> <i class="emphasis">V</i> and <i class="emphasis">E</i><span class="unicode">&prime;</span> = <i class="emphasis">E</i> <span class="unicode">&cup;</span> {(<i class="emphasis">s</i>, <i class="emphasis">v</i>) : <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>}. We extend the weight function <i class="emphasis">w</i> so that <i class="emphasis">w</i>(<i class="emphasis">s</i>, <i class="emphasis">v</i>) = 0 for all <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i> . Note that because <i class="emphasis">s</i> has no edges that enter it, no shortest paths in <i class="emphasis">G</i><span class="unicode">&prime;</span>, other than those with source <i class="emphasis">s</i>, contain <i class="emphasis">s</i>. Moreover, <i class="emphasis">G</i><span class="unicode">&prime;</span> has no negative-weight cycles if and only if <i class="emphasis">G</i> has no negative-weight cycles. <a class="internaljump" href="#ch25fig06">Figure 25.6(a)</a> shows the graph <i class="emphasis">G</i><span class="unicode">&prime;</span> corresponding to the graph <i class="emphasis">G</i> of <a href="DDU0156.html#1893" target="_parent" class="chapterjump">Figure 25.1</a>.</p>
<div class="figure">
<a name="1944"></a><a name="ch25fig06"></a><span class="figuremediaobject"><a href="images/fig660%5F05%5F0%2Ejpg" NAME="IMG_845" target="_parent"><img src="images/fig660_05.jpg" height="354" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 25.6: </span>Johnson's all-pairs shortest-paths algorithm run of the graph of Figure 25.1. <i class="emphasis">(a)</i> The graph <i class="emphasis">G</i><span class="unicode">&prime;</span> with the original weight function <i class="emphasis">w</i>. The new vertex <i class="emphasis">s</i> is black. Within each vertex <i class="emphasis">v</i> is <i class="emphasis">h</i>(<i class="emphasis">v</i>) = <span class="unicode">&delta;</span>(<i class="emphasis">s</i>, <i class="emphasis">v</i>). <i class="emphasis">(b)</i> Each edge (<i class="emphasis">u</i>, <i class="emphasis">v</i>) is reweighted with weight function <span class="inlinemediaobject"><img src="images/fig660_01.jpg" height="13" width="165" alt="" border="0"></span>. <i class="emphasis">(c)</i><span class="unicode">-</span><i class="emphasis">(g)</i> The result of running Dijkstra's algorithm on each vertex of <i class="emphasis">G</i> using weight function <span class="inlinemediaobject"><img src="images/fig660_02.jpg" height="8" width="8" alt="" border="0"></span>. In each part, the source vertex <i class="emphasis">u</i> is black, and shaded edges are in the shortest-paths tree computed by the algorithm. Within each vertex <i class="emphasis">v</i> are the values <span class="inlinemediaobject"><img src="images/fig660_03.jpg" height="12" width="26" alt="" border="0"></span> and <span class="unicode">&delta;</span>(<i class="emphasis">u</i>, <i class="emphasis">v</i>), separated by a slash. The value <i class="emphasis">d<sub>uv</sub></i> = <span class="unicode">&delta;</span>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) is equal to <span class="inlinemediaobject"><a href="images/fig660%5F04%5F0%2Ejpg" NAME="IMG_844" target="_parent"><img src="images/fig660_04.jpg" height="12" width="82" alt="Click To expand" border="0"></a></span>.</span>
</div>
<p class="last-para">Now suppose that <i class="emphasis">G</i> and <i class="emphasis">G</i><span class="unicode">&prime;</span> have no negative-weight cycles. Let us define <i class="emphasis">h</i>(<i class="emphasis">v</i>) = <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">v</i>) for all <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i><span class="unicode">&prime;</span>. By the triangle inequality (<a href="DDU0152.html#1838" target="_parent" class="chapterjump">Lemma 24.10</a>), <a name="1945"></a><a name="IDX-638"></a><a name="1946"></a><a name="IDX-639"></a>we have <i class="emphasis">h</i>(<i class="emphasis">v</i>) <span class="unicode">&le;</span> <i class="emphasis">h</i>(<i class="emphasis">u</i>) + <i class="emphasis">w</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) for all edges (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&isin;</span> <i class="emphasis">E</i><span class="unicode">&prime;</span>. Thus, if we define the new weights <span class="inlinemediaobject"><img src="images/fig661_01.jpg" height="11" width="10" alt="" border="0"></span> according to equation (<a class="internaljump" href="#ch25eq09">25.9</a>), we have <span class="inlinemediaobject"><img src="images/fig661_02.jpg" height="12" width="50" alt="" border="0"></span><span class="inlinemediaobject"><img src="images/fig661_03.jpg" height="12" width="124" alt="" border="0"></span>, and the second property is satisfied. <a class="internaljump" href="#ch25fig06">Figure 25.6(b)</a> shows the graph <i class="emphasis">G</i><span class="unicode">&prime;</span> from <a class="internaljump" href="#ch25fig06">Figure 25.6(a)</a> with reweighted edges.</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="1947"></a><a name="ch25lev3sec13"></a>Computing all-pairs shortest paths</h4>
<p class="first-para">Johnson's algorithm to compute all-pairs shortest paths uses the Bellman-Ford algorithm (<a href="DDU0148.html#1770" target="_parent" class="chapterjump">Section 24.1</a>) and Dijkstra's algorithm (<a href="DDU0150.html#1788" target="_parent" class="chapterjump">Section 24.3</a>) as subroutines. It assumes that the edges are stored in adjacency lists. The algorithm returns the usual |<i class="emphasis">V</i>| <span class="unicode">&times;</span> |<i class="emphasis">V</i>| matrix <i class="emphasis">D</i> = <i class="emphasis">d<sub>ij</sub></i>, where <i class="emphasis">d<sub>ij</sub></i> = <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">i</i>, <i class="emphasis">j</i>), or it reports that the input graph contains a negative-weight cycle. As is typical for an all-pairs shortest-paths algorithm, we assume that the vertices are numbered from 1 to |<i class="emphasis">V</i>|.</p>
<div class="informalexample">
<pre class="literallayout-normal">
JOHNSON(<i class="emphasis">G</i>)
 1  compute <i class="emphasis">G</i><span class="unicode">&prime;</span>, where <i class="emphasis">V</i>[<i class="emphasis">G</i><span class="unicode">&prime;</span>] = <i class="emphasis">V</i>[<i class="emphasis">G</i>] <span class="unicode">&cup;</span> {<i class="emphasis">s</i>},
           <i class="emphasis">E</i>[<i class="emphasis">G</i><span class="unicode">&prime;</span>] = <i class="emphasis">E</i>[<i class="emphasis">G</i>] <span class="unicode">&cup;</span> {(<i class="emphasis">s</i>, <i class="emphasis">v</i>) : <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>[<i class="emphasis">G</i>]}, and
           <i class="emphasis">w</i>(<i class="emphasis">s</i>, <i class="emphasis">v</i>) = 0 for all <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>[<i class="emphasis">G</i>]
 2  <b class="bold">if</b> BELLMAN-FORD(<i class="emphasis">G</i><span class="unicode">&prime;</span>, <i class="emphasis">w</i>, <i class="emphasis">s</i>) = FALSE
 3     <b class="bold">then</b> print "the input graph contains a negative-weight cycle"
 4     <b class="bold">else for</b> each vertex <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>[<i class="emphasis">G</i><span class="unicode">&prime;</span>]
 5              <b class="bold">do</b> set <i class="emphasis">h</i>(<i class="emphasis">v</i>) to the value of <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">v</i>)
                           computed by the Bellman-Ford algorithm
 6          <b class="bold">for</b> each edge (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&isin;</span> <i class="emphasis">E</i>[<i class="emphasis">G</i><span class="unicode">&prime;</span>]
 7              <b class="bold">do</b> <span class="inlinemediaobject"><img src="images/fig661_04.jpg" height="13" width="153" alt="" border="0"></span>
 8          <b class="bold">for</b> each vertex <i class="emphasis">u</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>[<i class="emphasis">G</i>]
 9              <b class="bold">do</b> run DIJKSTRA(<i class="emphasis">G</i>, <span class="inlinemediaobject"><img src="images/fig661_05.jpg" height="11" width="10" alt="" border="0"></span>, <i class="emphasis">u</i>) to compute <span class="inlinemediaobject"><img src="images/fig661_06.jpg" height="15" width="32" alt="" border="0"></span> for all <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>[<i class="emphasis">G</i>]
10                 <b class="bold">for</b> each vertex <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>[<i class="emphasis">G</i>]
11                     <b class="bold">do</b> <span class="inlinemediaobject"><img src="images/fig661_07.jpg" height="16" width="131" alt="" border="0"></span>
12          <b class="bold">return</b> <i class="emphasis">D</i>
</pre>
</div>
<p class="para">This code simply performs the actions we specified earlier. Line 1 produces <i class="emphasis">G</i><span class="unicode">&prime;</span>. Line 2 runs the Bellman-Ford algorithm on <i class="emphasis">G</i><span class="unicode">&prime;</span> with weight function <i class="emphasis">w</i> and source vertex <i class="emphasis">s</i>. If <i class="emphasis">G</i><span class="unicode">&prime;</span>, and hence <i class="emphasis">G</i>, contains a negative-weight cycle, line 3 reports the problem. Lines 4<span class="unicode">-</span>11 assume that <i class="emphasis">G</i><span class="unicode">&prime;</span> contains no negative-weight cycles. Lines 4<span class="unicode">-</span>5 set <i class="emphasis">h</i>(<i class="emphasis">v</i>) to the shortest-path weight <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">s</i>, <i class="emphasis">v</i>) computed by the Bellman-Ford algorithm for all <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i><span class="unicode">&prime;</span>. Lines 6<span class="unicode">-</span>7 compute the new weights <span class="inlinemediaobject"><img src="images/fig661_08.jpg" height="10" width="10" alt="" border="0"></span>. For each pair of vertices <i class="emphasis">u</i>, <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i> , the <b class="bold">for</b> loop of lines 8<span class="unicode">-</span>11 computes the shortest-path weight <span class="inlinemediaobject"><img src="images/fig661_09.jpg" height="15" width="33" alt="" border="0"></span> by calling Dijkstra's algorithm once from each vertex in <i class="emphasis">V</i>. Line 11 stores in matrix entry <i class="emphasis">d<sub>uv</sub></i> the correct shortest-path weight <i class="emphasis"><span class="unicode">&delta;</span></i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>), calculated using equation (<a class="internaljump" href="#ch25eq10">25.10</a>). Finally, line 12 returns the completed <i class="emphasis">D</i> matrix. <a class="internaljump" href="#ch25fig06">Figure 25.6</a> shows the execution of Johnson's algorithm.<a name="1948"></a><a name="IDX-640"></a>
</p>
<p class="para">If the min-priority queue in Dijkstra's algorithm is implemented by a Fibonacci heap, the running time of Johnson's algorithm is <i class="emphasis">O</i>(<i class="emphasis">V</i><sup>2</sup> lg <i class="emphasis">V</i> + <i class="emphasis">V E</i>). The simpler binary min-heap implementation yields a running time of <i class="emphasis">O</i>(<i class="emphasis">V E</i> lg <i class="emphasis">V</i>), which is still asymptotically faster than the Floyd-Warshall algorithm if the graph is sparse.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.3-1</span></span><a name="1949"></a><a name="ch25ex21"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Use Johnson's algorithm to find the shortest paths between all pairs of vertices in the graph of <a href="DDU0156.html#1898" target="_parent" class="chapterjump">Figure 25.2</a>. Show the values of <i class="emphasis">h</i> and <span class="inlinemediaobject"><img src="images/fig662_01.jpg" height="10" width="9" alt="" border="0"></span> computed by the algorithm.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.3-2</span></span><a name="1950"></a><a name="ch25ex22"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">What is the purpose of adding the new vertex <i class="emphasis">s</i> to <i class="emphasis">V</i> , yielding <i class="emphasis">V</i><span class="unicode">&prime;</span>?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.3-3</span></span><a name="1951"></a><a name="ch25ex23"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Suppose that <i class="emphasis">w</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&ge;</span> 0 for all edges (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&isin;</span> <i class="emphasis">E</i>. What is the relationship between the weight functions <i class="emphasis">w</i> and <span class="inlinemediaobject"><img src="images/fig662_02.jpg" height="10" width="9" alt="" border="0"></span>?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.3-4</span></span><a name="1952"></a><a name="ch25ex24"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Professor Greenstreet claims that there is a simpler way to reweight edges than the method used in Johnson's algorithm. Letting <i class="emphasis">w</i>* = min<sub>(<i class="emphasis">u</i>, <i class="emphasis">v</i>)<i class="emphasis"><span class="unicode">&isin;</span>E</i></sub> {<i class="emphasis">w</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>)}, just define <span class="inlinemediaobject"><img src="images/fig662_03.jpg" height="13" width="111" alt="" border="0"></span> for all edges (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&isin;</span> <i class="emphasis">E</i>. What is wrong with the professor's method of reweighting?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.3-5</span></span><a name="1953"></a><a name="ch25ex25"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Suppose that we run Johnson's algorithm on a directed graph <i class="emphasis">G</i> with weight function <i class="emphasis">w</i>. Show that if <i class="emphasis">G</i> contains a 0-weight cycle <i class="emphasis">c</i>, then <span class="inlinemediaobject"><img src="images/fig662_04.jpg" height="13" width="57" alt="" border="0"></span> for every edge (<i class="emphasis">u</i>, <i class="emphasis">v</i>) in <i class="emphasis">c</i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 25.3-6</span></span><a name="1954"></a><a name="ch25ex26"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Professor Michener claims that there is no need to create a new source vertex in line 1 of JOHNSON. He claims that instead we can just use <i class="emphasis">G</i><span class="unicode">&prime;</span> = <i class="emphasis">G</i> and let <i class="emphasis">s</i> be any vertex in <i class="emphasis">V</i>[<i class="emphasis">G</i>]. Give an example of a weighted, directed graph <i class="emphasis">G</i> for which incorporating the professor's idea into JOHNSON causes incorrect answers. Then show that if <i class="emphasis">G</i> is strongly connected (every vertex is reachable from every other vertex), the results returned by JOHNSON with the professor's modification are correct.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="1955"></a><a name="IDX-641"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 25-1: </span>Transitive closure of a dynamic graph</span><a name="1956"></a><a name="ch25ex27"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Suppose that we wish to maintain the transitive closure of a directed graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) as we insert edges into <i class="emphasis">E</i>. That is, after each edge has been inserted, we want to update the transitive closure of the edges inserted so far. Assume that the graph <i class="emphasis">G</i> has no edges initially and that the transitive closure is to be represented as a boolean matrix.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Show how the transitive closure <i class="emphasis">G</i>* = (<i class="emphasis">V</i>, <i class="emphasis">E</i>*) of a graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) can be updated in <i class="emphasis">O</i>(<i class="emphasis">V</i><sup>2</sup>) time when a new edge is added to <i class="emphasis">G</i>.</p>
</li>
<li class="listitem">
<p class="first-para">Give an example of a graph <i class="emphasis">G</i> and an edge <i class="emphasis">e</i> such that <span class="unicode">&#8486;</span>(<i class="emphasis">V</i><sup>2</sup>) time is required to update the transitive closure after the insertion of <i class="emphasis">e</i> into <i class="emphasis">G</i>.</p>
</li>
<li class="listitem">
<p class="first-para">Describe an efficient algorithm for updating the transitive closure as edges are inserted into the graph. For any sequence of <i class="emphasis">n</i> insertions, your algorithm should run in total time <span class="inlinemediaobject"><img src="images/fig663_01.jpg" height="15" width="78" alt="" border="0"></span>, where <i class="emphasis">t<sub>i</sub></i> is the time to update the transitive closure when the <i class="emphasis">i</i>th edge is inserted. Prove that your algorithm attains this time bound.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems 25-2: </span>Shortest paths in <span class="unicode">&isin;</span>-dense graphs</span><a name="1957"></a><a name="ch25ex28"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">A graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) is <b class="bold"><i class="emphasis"><span class="unicode">&isin;</span>-dense</i></b> if |<i class="emphasis">E</i>| = <span class="unicode">&Theta;</span>(<i class="emphasis">V</i><sup>1+<i class="emphasis"><span class="unicode">&isin;</span></i></sup>) for some constant <i class="emphasis"><span class="unicode">&isin;</span></i> in the range 0 <span class="unicode">&lt;</span> <i class="emphasis"><span class="unicode">&isin;</span></i> <span class="unicode">&le;</span> 1. By using <i class="emphasis">d</i>-ary min-heaps (see <a href="DDU0040.html#441" target="_parent" class="chapterjump">Problem 6-2</a>) in shortest-paths algorithms on <i class="emphasis"><span class="unicode">&isin;</span></i>-dense graphs, we can match the running times of Fibonacci-heap-based algorithms without using as complicated a data structure.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">What are the asymptotic running times for INSERT, EXTRACT-MIN, and DECREASE-KEY, as a function of <i class="emphasis">d</i> and the number <i class="emphasis">n</i> of elements in a <i class="emphasis">d</i>-ary min-heap? What are these running times if we choose <i class="emphasis">d</i> = <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup><i class="emphasis"><span class="unicode">&alpha;</span></i></sup>) for some constant 0 <span class="unicode">&lt;</span> <span class="unicode">&alpha;</span> <span class="unicode">&le;</span> 1? Compare these running times to the amortized costs of these operations for a Fibonacci heap.</p>
</li>
<li class="listitem">
<p class="first-para">Show how to compute shortest paths from a single source on an <i class="emphasis"><span class="unicode">&isin;</span></i>-dense directed graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) with no negative-weight edges in <i class="emphasis">O</i>(<i class="emphasis">E</i>) time. (<i class="emphasis">Hint:</i> Pick <i class="emphasis">d</i> as a function of <i class="emphasis"><span class="unicode">&isin;</span></i>.)</p>
</li>
<li class="listitem">
<p class="first-para">Show how to solve the all-pairs shortest-paths problem on an <i class="emphasis"><span class="unicode">&isin;</span></i>-dense directed graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) with no negative-weight edges in <i class="emphasis">O</i>(<i class="emphasis">V E</i>) time.</p>
<a name="1958"></a><a name="IDX-642"></a>
</li>
<li class="listitem">
<p class="first-para">Show how to solve the all-pairs shortest-paths problem in <i class="emphasis">O</i>(<i class="emphasis">V E</i>) time on an <i class="emphasis"><span class="unicode">&isin;</span></i>-dense directed graph <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) that may have negative-weight edges but has no negative-weight cycles.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0157.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0159.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
