<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>26.1 Flow networks</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0160.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0162.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch26"></a>
<div class="section">
<h2 class="first-section-title">
<a name="1964"></a><a name="ch26lev1sec1"></a><span class="section-titlelabel">26.1 </span>Flow networks</h2>
<p class="first-para">In this section, we give a graph-theoretic definition of flow networks, discuss their properties, and define the maximum-flow problem precisely. We also introduce some helpful notation.</p>
<div class="section">
<h4 class="sect4-title">
<a name="1965"></a><a name="ch26lev3sec1"></a>Flow networks and flows</h4>
<p class="first-para">A <b class="bold"><i class="emphasis">flow network</i></b> <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) is a directed graph in which each edge (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&isin;</span><i class="emphasis">E</i> has a nonnegative <b class="bold"><i class="emphasis">capacity</i></b> <i class="emphasis">c</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&ge;</span> 0. If (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&notin;</span> <i class="emphasis">E</i>, we assume that <i class="emphasis">c</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) = 0. We distinguish two vertices in a flow network: a <b class="bold"><i class="emphasis">source</i></b> <i class="emphasis">s</i> and a <b class="bold"><i class="emphasis">sink</i></b> <i class="emphasis">t</i>. For convenience, we assume that every vertex lies on some path from the source to the sink. That is, for every vertex <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>, there is a path <span class="inlinemediaobject"><img src="images/fig666_01.jpg" height="11" width="76" alt="" border="0"></span> The graph is therefore connected, and |<i class="emphasis">E</i>| <span class="unicode">&ge;</span> |<i class="emphasis">V</i> | - 1. <a class="internaljump" href="#ch26fig01">Figure 26.1</a> shows an example of a flow network.</p>
<p class="para">We are now ready to define flows more formally. Let <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) be a flow network with a capacity function <i class="emphasis">c</i>. Let <i class="emphasis">s</i> be the source of the network, and let <i class="emphasis">t</i> be the sink. A <b class="bold"><i class="emphasis">flow</i></b> in <i class="emphasis">G</i> is a real-valued function <i class="emphasis">f</i> : <i class="emphasis">V</i> <span class="unicode">&times;</span> <i class="emphasis">V</i> <span class="unicode">&rarr;</span> <b class="bold">R</b> that satisfies the following three properties:</p>
<div class="figure">
<a name="1966"></a><a name="ch26fig01"></a><span class="figuremediaobject"><a href="images/fig667%5F01%5F0%2Ejpg" NAME="IMG_861" target="_parent"><img src="images/fig667_01.jpg" height="93" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 26.1: </span><i class="emphasis">(a)</i> A flow network <i class="emphasis">G</i> = (<i class="emphasis">V, E</i>) for the Lucky Puck Company's trucking problem. The Vancouver factory is the source <i class="emphasis">s</i>, and the Winnipeg warehouse is the sink <i class="emphasis">t</i>. Pucks are shipped through intermediate cities, but only <i class="emphasis">c</i>(<i class="emphasis">u, v</i>) crates per day can go from city <i class="emphasis">u</i> to city <i class="emphasis">v</i>. Each edge is labeled with its capacity. <i class="emphasis">(b)</i> A flow <i class="emphasis">f</i> in <i class="emphasis">G</i> with value |<i class="emphasis">f</i>| = 19. Only positive flows are shown. If <i class="emphasis">f</i> (<i class="emphasis">u, v</i>) <span class="unicode">&gt;</span> 0, edge (<i class="emphasis">u, v</i>) is labeled by <i class="emphasis">f</i>(<i class="emphasis">u, v</i>)/<i class="emphasis">c</i>(<i class="emphasis">u, v</i>). (The slash notation is used merely to separate the flow and capacity; it does not indicate division.) If <i class="emphasis">f</i>(<i class="emphasis">u, v</i>) <span class="unicode">&le;</span> 0, edge (<i class="emphasis">u, v</i>) is labeled only by its capacity.</span>
</div>
<p class="para">
<b class="bold">Capacity constraint:</b> For all <i class="emphasis">u</i>, <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>, we require <i class="emphasis">f</i> (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&le;</span> <i class="emphasis">c</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>).</p>
<p class="para">
<b class="bold">Skew symmetry:</b> For all <i class="emphasis">u</i>, <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>, we require <i class="emphasis">f</i> (<i class="emphasis">u</i>, <i class="emphasis">v</i>) = - <i class="emphasis">f</i> (<i class="emphasis">v</i>, <i class="emphasis">u</i>).</p>
<p class="para">
<b class="bold">Flow conservation:</b> For all <i class="emphasis">u</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i> - {<i class="emphasis">s</i>, <i class="emphasis">t</i>}, we require</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig666_02.jpg" height="33" width="103" alt="" border="0"></span>
</div>
<p class="para">The quantity <i class="emphasis">f</i> (<i class="emphasis">u</i>, <i class="emphasis">v</i>), which can be positive, zero, or negative, is called the <b class="bold"><i class="emphasis">flow</i></b> from vertex <i class="emphasis">u</i> to vertex <i class="emphasis">v</i>. The <b class="bold"><i class="emphasis">value</i></b> of a flow <i class="emphasis">f</i> is defined as</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(26.1)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig666_03.jpg" height="33" width="111" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">that is, the total flow out of the source. (Here, the |<span class="unicode">&middot;</span>| notation denotes flow value, not absolute value or cardinality.) In the <b class="bold"><i class="emphasis">maximum-flow problem</i></b>, we are given a <a name="1967"></a><a name="IDX-645"></a>flow network <i class="emphasis">G</i> with source <i class="emphasis">s</i> and sink <i class="emphasis">t</i>, and we wish to find a flow of maximum value.</p>
<p class="para">Before seeing an example of a network-flow problem, let us briefly explore the three flow properties. The capacity constraint simply says that the flow from one vertex to another must not exceed the given capacity. Skew symmetry is a notational convenience that says that the flow from a vertex <i class="emphasis">u</i> to a vertex <i class="emphasis">v</i> is the negative of the flow in the reverse direction. The flow-conservation property says that the total flow out of a vertex other than the source or sink is 0. By skew symmetry, we can rewrite the flow-conservation property as</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig667_02.jpg" height="33" width="96" alt="" border="0"></span>
</div>
<p class="para">for all <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i> - {<i class="emphasis">s</i>, <i class="emphasis">t</i>}. That is, the total flow into a vertex is 0.</p>
<p class="para">When neither (<i class="emphasis">u</i>, <i class="emphasis">v</i>) nor (<i class="emphasis">v</i>, <i class="emphasis">u</i>) is in <i class="emphasis">E</i>, there can be no flow between <i class="emphasis">u</i> and <i class="emphasis">v</i>, and <i class="emphasis">f</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) = <i class="emphasis">f</i>(<i class="emphasis">v</i>, <i class="emphasis">u</i>) = 0. (<a class="internaljump" href="#ch26ex02">Exercise 26.1-1</a> asks you to prove this property formally.)</p>
<p class="para">Our last observation concerning the flow properties deals with flows that are positive. The <b class="bold"><i class="emphasis">total positive flow</i></b> entering a vertex <i class="emphasis">v</i> is defined by</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(26.2)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig667_03.jpg" height="43" width="99" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="last-para">The total positive flow leaving a vertex is defined symmetrically. We define the <b class="bold"><i class="emphasis">total net flow</i></b> at a vertex to be the total positive flow leaving a vertex minus the total positive flow entering a vertex. One interpretation of the flow-conservation property is that the total positive flow entering a vertex other than the source or <a name="1968"></a><a name="IDX-646"></a>sink must equal the total positive flow leaving that vertex. This property, that the total net flow at a vertex must equal 0, is often informally referred to as "flow in equals flow out."</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="1969"></a><a name="ch26lev3sec2"></a>An example of flow</h4>
<p class="first-para">A flow network can model the trucking problem shown in <a class="internaljump" href="#ch26fig01">Figure 26.1(a)</a>. The Lucky Puck Company has a factory (source <i class="emphasis">s</i>) in Vancouver that manufactures hockey pucks, and it has a warehouse (sink <i class="emphasis">t</i>) in Winnipeg that stocks them. Lucky Puck leases space on trucks from another firm to ship the pucks from the factory to the warehouse. Because the trucks travel over specified routes (edges) between cities (vertices) and have a limited capacity, Lucky Puck can ship at most <i class="emphasis">c</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) crates per day between each pair of cities <i class="emphasis">u</i> and <i class="emphasis">v</i> in <a class="internaljump" href="#ch26fig01">Figure 26.1(a)</a>. Lucky Puck has no control over these routes and capacities and so cannot alter the flow network shown in <a class="internaljump" href="#ch26fig01">Figure 26.1(a)</a>. Their goal is to determine the largest number <i class="emphasis">p</i> of crates per day that can be shipped and then to produce this amount, since there is no point in producing more pucks than they can ship to their warehouse. Lucky Puck is not concerned with how long it takes for a given puck to get from the factory to the warehouse; they care only that <i class="emphasis">p</i> crates per day leave the factory and <i class="emphasis">p</i> crates per day arrive at the warehouse.</p>
<p class="para">On the surface, it seems appropriate to model the "flow" of shipments with a flow in this network because the number of crates shipped per day from one city to another is subject to a capacity constraint. Additionally, flow conservation must be obeyed, for in a steady state, the rate at which pucks enter an intermediate city must equal the rate at which they leave. Otherwise, crates would accumulate at intermediate cities.</p>
<p class="para">There is one subtle difference between shipments and flows, however. Lucky Puck may ship pucks from Edmonton to Calgary, and they may also ship pucks from Calgary to Edmonton. Suppose that they ship 8 crates per day from Edmonton (<i class="emphasis">v</i><sub>1</sub> in <a class="internaljump" href="#ch26fig01">Figure 26.1</a>) to Calgary (<i class="emphasis">v</i><sub>2</sub>) and 3 crates per day from Calgary to Edmonton. It may seem natural to represent these shipments directly by flows, but we cannot. The skew-symmetry constraint requires that <i class="emphasis">f</i> (<i class="emphasis">v</i><sub>1</sub>, <i class="emphasis">v</i><sub>2</sub>) = - <i class="emphasis">f</i> (<i class="emphasis">v</i><sub>2</sub>, <i class="emphasis">v</i><sub>1</sub>), but this is clearly not the case if we consider <i class="emphasis">f</i>(<i class="emphasis">v</i><sub>1</sub>, <i class="emphasis">v</i><sub>2</sub>) = 8 and <i class="emphasis">f</i>(<i class="emphasis">v</i><sub>2</sub>, <i class="emphasis">v</i><sub>1</sub>) = 3.</p>
<p class="para">Lucky Puck may realize that it is pointless to ship 8 crates per day from Edmonton to Calgary and 3 crates from Calgary to Edmonton, when they could achieve the same net effect by shipping 5 crates from Edmonton to Calgary and 0 crates from Calgary to Edmonton (and presumably use fewer resources in the process). We represent this latter scenario with a flow: we have <i class="emphasis">f</i> (<i class="emphasis">v</i><sub>1</sub>, <i class="emphasis">v</i><sub>2</sub>) = 5 and <i class="emphasis">f</i>(<i class="emphasis">v</i><sub>2</sub>, <i class="emphasis">v</i><sub>1</sub>) = -5. In effect, 3 of the 8 crates per day from <i class="emphasis">v</i><sub>1</sub> to <i class="emphasis">v</i><sub>2</sub> are <b class="bold"><i class="emphasis">canceled</i></b> by 3 crates per day from <i class="emphasis">v</i><sub>2</sub> to <i class="emphasis">v</i><sub>1</sub>.<a name="1970"></a><a name="IDX-647"></a>
</p>
<p class="para">In general, cancellation allows us to represent the shipments between two cities by a flow that is positive along at most one of the two edges between the corresponding vertices. That is, any situation in which pucks are shipped in both directions between two cities can be transformed using cancellation into an equivalent situation in which pucks are shipped in one direction only: the direction of positive flow.</p>
<p class="para">Given a flow <i class="emphasis">f</i> that arose from, say, physical shipments, we cannot reconstruct the exact shipments. If we know that <i class="emphasis">f</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) = 5, this flow may be because 5 units were shipped from <i class="emphasis">u</i> to <i class="emphasis">v</i>, or it may be because 8 units were shipped from <i class="emphasis">u</i> to <i class="emphasis">v</i> and 3 units were shipped from <i class="emphasis">v</i> to <i class="emphasis">u</i>. Typically, we shall not care how the actual physical shipments are set up; for any pair of vertices, we care only about the net amount that travels between them. If we do care about the underlying shipments, then we should be using a different model, one that retains information about shipments in both directions.</p>
<p class="last-para">Cancellation will arise implicitly in the algorithms in this chapter. Suppose that edge (<i class="emphasis">u</i>, <i class="emphasis">v</i>) has a flow value of <i class="emphasis">f</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>). In the course of an algorithm, we may increase the flow on edge (<i class="emphasis">v</i>, <i class="emphasis">u</i>) by some amount <i class="emphasis">d</i>. Mathematically, this operation must decrease <i class="emphasis">f</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) by <i class="emphasis">d</i> and, conceptually, we can think of these <i class="emphasis">d</i> units as canceling <i class="emphasis">d</i> units of flow that are already on edge (<i class="emphasis">u</i>, <i class="emphasis">v</i>).</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="1971"></a><a name="ch26lev3sec3"></a>Networks with multiple sources and sinks</h4>
<p class="first-para">A maximum-flow problem may have several sources and sinks, rather than just one of each. The Lucky Puck Company, for example, might actually have a set of <i class="emphasis">m</i> factories {<i class="emphasis">s</i><sub>1</sub>, <i class="emphasis">s</i><sub>2</sub>, . . . , <i class="emphasis">s<sub>m</sub></i>} and a set of <i class="emphasis">n</i> warehouses {<i class="emphasis">t</i><sub>1</sub>, <i class="emphasis">t</i><sub>2</sub>, . . . , <i class="emphasis">t<sub>n</sub></i>}, as shown in <a class="internaljump" href="#ch26fig02">Figure 26.2(a)</a>. Fortunately, this problem is no harder than ordinary maximum flow.</p>
<div class="figure">
<a name="1972"></a><a name="ch26fig02"></a><span class="figuremediaobject"><a href="images/fig670%5F01%5F0%2Ejpg" NAME="IMG_866" target="_parent"><img src="images/fig670_01.jpg" height="217" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 26.2: </span>Converting a multiple-source, multiple-sink maximum-flow problem into a problem with a single source and a single sink. <i class="emphasis">(a)</i> A flow network with five sources <i class="emphasis">S</i> = {<i class="emphasis">s</i><sub>1</sub>, <i class="emphasis">s</i><sub>2</sub>, <i class="emphasis">s</i><sub>3</sub>, <i class="emphasis">s</i><sub>4</sub>, <i class="emphasis">s</i><sub>5</sub>} and three sinks <i class="emphasis">T</i> = {<i class="emphasis">t</i><sub>1</sub>, <i class="emphasis">t</i><sub>2</sub>, <i class="emphasis">t</i><sub>3</sub>}. <i class="emphasis">(b)</i> An equivalent single-source, single-sink flow network. We add a supersource <i class="emphasis">s</i> and an edge with infinite capacity from <i class="emphasis">s</i> to each of the multiple sources. We also add a supersink <i class="emphasis">t</i> and an edge with infinite capacity from each of the multiple sinks to <i class="emphasis">t</i>.</span>
</div>
<p class="last-para">We can reduce the problem of determining a maximum flow in a network with multiple sources and multiple sinks to an ordinary maximum-flow problem. <a class="internaljump" href="#ch26fig02">Figure 26.2(b)</a> shows how the network from (a) can be converted to an ordinary flow network with only a single source and a single sink. We add a <b class="bold"><i class="emphasis">supersource</i></b> <i class="emphasis">s</i> and add a directed edge (<i class="emphasis">s</i>, <i class="emphasis">s<sub>i</sub></i>) with capacity <i class="emphasis">c</i>(<i class="emphasis">s</i>, <i class="emphasis">s<sub>i</sub></i>) = <span class="unicode">&infin;</span> for each <i class="emphasis">i</i> = 1, 2, . . . , <i class="emphasis">m</i>. We also create a new <b class="bold"><i class="emphasis">supersink</i></b> <i class="emphasis">t</i> and add a directed edge (<i class="emphasis">t<sub>i</sub></i>, <i class="emphasis">t</i>) with capacity <i class="emphasis">c</i>(<i class="emphasis">t<sub>i</sub></i>, <i class="emphasis">t</i>) = <span class="unicode">&infin;</span> for each <i class="emphasis">i</i> = 1, 2, . . . , <i class="emphasis">n</i>. Intuitively, any flow in the network in (a) corresponds to a flow in the network in (b), and vice versa. The single source <i class="emphasis">s</i> simply provides as much flow as desired for the multiple sources <i class="emphasis">s<sub>i</sub></i>, and the single sink <i class="emphasis">t</i> likewise consumes as much flow as desired for the multiple sinks <i class="emphasis">t<sub>i</sub></i>. <a class="internaljump" href="#ch26ex04">Exercise 26.1-3</a> asks you to prove formally that the two problems are equivalent.<a name="1973"></a><a name="IDX-648"></a>
</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="1974"></a><a name="ch26lev3sec4"></a>Working with flows</h4>
<p class="first-para">We shall be dealing with several functions (like <i class="emphasis">f</i>) that take as arguments two vertices in a flow network. In this chapter, we shall use an <b class="bold"><i class="emphasis">implicit summation notation</i></b> in which either argument, or both, may be a <i class="emphasis">set</i> of vertices, with the interpretation that the value denoted is the sum of all possible ways of replacing the arguments with their members. For example, if <i class="emphasis">X</i> and <i class="emphasis">Y</i> are sets of vertices, then</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig670_02.jpg" height="35" width="167" alt="" border="0"></span>
</div>
<p class="para">Thus, the flow-conservation constraint can be expressed as the condition that <i class="emphasis">f</i>(<i class="emphasis">u</i>, <i class="emphasis">V</i>) = 0 for all <i class="emphasis">u</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i> - {<i class="emphasis">s</i>, <i class="emphasis">t</i>}. Also, for convenience, we shall typically omit set braces when they would otherwise be used in the implicit summation notation. For example, in the equation <i class="emphasis">f</i> (<i class="emphasis">s</i>, <i class="emphasis">V</i> - <i class="emphasis">s</i>) = <i class="emphasis">f</i>(<i class="emphasis">s</i>, <i class="emphasis">V</i>), the term <i class="emphasis">V</i> - <i class="emphasis">s</i> means the set <i class="emphasis">V</i> - {<i class="emphasis">s</i>}.<a name="1975"></a><a name="IDX-649"></a>
</p>
<p class="para">The implicit set notation often simplifies equations involving flows. The following lemma, whose proof is left as <a class="internaljump" href="#ch26ex05">Exercise 26.1-4</a>, captures several of the most commonly occurring identities that involve flows and the implicit set notation.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 26.1</span></span><a name="1976"></a><a name="ch26ex01"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) be a flow network, and let <i class="emphasis">f</i> be a flow in <i class="emphasis">G</i>. Then the following equalities hold:</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">For all <i class="emphasis">X</i> <span class="unicode">&sube;</span> <i class="emphasis">V</i>, we have <i class="emphasis">f</i>(<i class="emphasis">X</i>, <i class="emphasis">X</i>) = 0.</p>
</li>
<li class="listitem">
<p class="first-para">For all <i class="emphasis">X</i>, <i class="emphasis">Y</i> <span class="unicode">&sube;</span> <i class="emphasis">V</i>, we have <i class="emphasis">f</i>(<i class="emphasis">X</i>, <i class="emphasis">Y</i>) = - <i class="emphasis">f</i> (<i class="emphasis">Y</i>, <i class="emphasis">X</i>).</p>
</li>
<li class="listitem">
<p class="first-para">For all <i class="emphasis">X</i>, <i class="emphasis">Y</i>, <i class="emphasis">Z</i> <span class="unicode">&sube;</span> <i class="emphasis">V</i> with <i class="emphasis">X</i> <span class="unicode">&cap;</span> <i class="emphasis">Y</i> = <span class="unicode">&Oslash;</span>, we have the sums <i class="emphasis">f</i>(<i class="emphasis">X</i> <span class="unicode">&cup;</span> <i class="emphasis">Y</i>, <i class="emphasis">Z</i>) =</p>
<p class="last-para">
<i class="emphasis">f</i>(<i class="emphasis">X</i>, <i class="emphasis">Z</i>) + <i class="emphasis">f</i>(<i class="emphasis">Y</i>, <i class="emphasis">Z</i>) and <i class="emphasis">f</i>(<i class="emphasis">Z</i>, <i class="emphasis">X</i> <span class="unicode">&cup;</span> <i class="emphasis">Y</i>) = <i class="emphasis">f</i> (<i class="emphasis">Z</i>, <i class="emphasis">X</i>) + <i class="emphasis">f</i>(<i class="emphasis">Z</i>, <i class="emphasis">Y</i>).</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">As an example of working with the implicit summation notation, we can prove that the value of a flow is the total flow into the sink; that is,</p>
<div class="equation">
<a name="1977"></a><a name="ch26eq03"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(26.3)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig671_01.jpg" height="16" width="91" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">Intuitively, we expect this property to hold. By flow conservation, all vertices other than the source and sink have equal amounts of total positive flow entering and leaving. The source has, by definition, a total net flow that is greater than 0; that is, more positive flow leaves the source than enters it. Symmetrically, the sink is the only vertex that can have a total net flow that is less than 0; that is, more positive flow enters the sink than leaves it. Our formal proof goes as follows:</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">|<i class="emphasis">f</i>|</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">f</i>(<i class="emphasis">s</i>, <i class="emphasis">V</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(by definition)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">f</i>(<i class="emphasis">V</i>, <i class="emphasis">V</i>) - <i class="emphasis">f</i> (<i class="emphasis">V</i> - <i class="emphasis">s</i>, <i class="emphasis">V</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(by <a class="internaljump" href="#ch26ex01">Lemma 26.1</a>, part (3))</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">- <i class="emphasis">f</i>(<i class="emphasis">V</i> - <i class="emphasis">s</i>, <i class="emphasis">V</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(by <a class="internaljump" href="#ch26ex01">Lemma 26.1</a>, part (1))</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">f</i>(<i class="emphasis">V</i>, <i class="emphasis">V</i> - <i class="emphasis">s</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(by <a class="internaljump" href="#ch26ex01">Lemma 26.1</a>, part (2))</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">f</i>(<i class="emphasis">V</i>, <i class="emphasis">t</i>) + <i class="emphasis">f</i>(<i class="emphasis">V</i>, <i class="emphasis">V</i> - <i class="emphasis">s</i> - <i class="emphasis">t</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(by <a class="internaljump" href="#ch26ex01">Lemma 26.1</a>, part (3))</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">f</i>(<i class="emphasis">V</i>, <i class="emphasis">t</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(by flow conservation).</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">Later in this chapter, we shall generalize this result (<a href="DDU0162.html#2006" target="_parent" class="chapterjump">Lemma 26.5</a>).</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 26.1-1</span></span><a name="1978"></a><a name="ch26ex02"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Using the definition of a flow, prove that if (<i class="emphasis">u</i>, <i class="emphasis">v</i>) <span class="unicode">&notin;</span> <i class="emphasis">E</i> and (<i class="emphasis">v</i>, <i class="emphasis">u</i>) <span class="unicode">&notin;</span> <i class="emphasis">E</i> then <i class="emphasis">f</i>(<i class="emphasis">u</i>, <i class="emphasis">v</i>) = <i class="emphasis">f</i>(<i class="emphasis">v</i>, <i class="emphasis">u</i>) = 0.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 26.1-2</span></span><a name="1979"></a><a name="ch26ex03"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Prove that for any vertex <i class="emphasis">v</i> other than the source or sink, the total positive flow entering <i class="emphasis">v</i> must equal the total positive flow leaving <i class="emphasis">v</i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="1980"></a><a name="IDX-650"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 26.1-3</span></span><a name="1981"></a><a name="ch26ex04"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Extend the flow properties and definitions to the multiple-source, multiple-sink problem. Show that any flow in a multiple-source, multiple-sink flow network corresponds to a flow of identical value in the single-source, single-sink network obtained by adding a supersource and a supersink, and vice versa.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 26.1-4</span></span><a name="1982"></a><a name="ch26ex05"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Prove <a class="internaljump" href="#ch26ex01">Lemma 26.1</a>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 26.1-5</span></span><a name="1983"></a><a name="ch26ex06"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">For the flow network <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>) and flow <i class="emphasis">f</i> shown in <a class="internaljump" href="#ch26fig01">Figure 26.1(b)</a>, find a pair of subsets <i class="emphasis">X</i>, <i class="emphasis">Y</i> <span class="unicode">&sube;</span> <i class="emphasis">V</i> for which <i class="emphasis">f</i>(<i class="emphasis">X</i>, <i class="emphasis">Y</i>) = - <i class="emphasis">f</i>(<i class="emphasis">V</i> - <i class="emphasis">X</i>, <i class="emphasis">Y</i>). Then, find a pair of subsets <i class="emphasis">X</i>, <i class="emphasis">Y</i> <span class="unicode">&sube;</span> <i class="emphasis">V</i> for which <i class="emphasis">f</i> (<i class="emphasis">X</i>, <i class="emphasis">Y</i>) <span class="unicode">&ne;</span> - <i class="emphasis">f</i>(<i class="emphasis">V</i> - <i class="emphasis">X</i>, <i class="emphasis">Y</i>).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 26.1-6</span></span><a name="1984"></a><a name="ch26ex07"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Given a flow network <i class="emphasis">G</i> = (<i class="emphasis">V</i>, <i class="emphasis">E</i>), let <i class="emphasis">f</i><sub>1</sub> and <i class="emphasis">f</i><sub>2</sub> be functions from <i class="emphasis">V</i> <span class="unicode">&times;</span> <i class="emphasis">V</i> to <b class="bold">R</b>. The <b class="bold"><i class="emphasis">flow sum</i></b> <i class="emphasis">f</i><sub>1</sub> + <i class="emphasis">f</i><sub>2</sub> is the function from <i class="emphasis">V</i> <span class="unicode">&times;</span> <i class="emphasis">V</i> to <b class="bold">R</b> defined by</p>
<p class="para">
<div class="equation">
<a name="1985"></a><a name="ch26eq04"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(26.4)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig672_01.jpg" height="17" width="221" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="last-para">for all <i class="emphasis">u</i>, <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>. If <i class="emphasis">f</i><sub>1</sub> and <i class="emphasis">f</i><sub>2</sub> are flows in <i class="emphasis">G</i>, which of the three flow properties must the flow sum <i class="emphasis">f</i><sub>1</sub> + <i class="emphasis">f</i><sub>2</sub> satisfy, and which might it violate?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 26.1-7</span></span><a name="1986"></a><a name="ch26ex08"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">f</i> be a flow in a network, and let <span class="unicode">&alpha;</span> be a real number. The <b class="bold"><i class="emphasis">scalar flow product</i></b>, denoted <span class="unicode">&alpha;</span> <i class="emphasis">f</i>, is a function from <i class="emphasis">V</i> <span class="unicode">&times;</span> <i class="emphasis">V</i> to <b class="bold">R</b> defined by</p>
<p class="para">(<span class="unicode">&alpha;</span><i class="emphasis">f</i>)(<i class="emphasis">u</i>, <i class="emphasis">v</i>) = <span class="unicode">&alpha;</span> <span class="unicode">&middot;</span> <i class="emphasis">f</i> (<i class="emphasis">u</i>, <i class="emphasis">v</i>).</p>
<p class="last-para">Prove that the flows in a network form a <b class="bold"><i class="emphasis">convex set</i></b>. That is, show that if <i class="emphasis">f</i><sub>1</sub> and <i class="emphasis">f</i><sub>2</sub> are flows, then so is <span class="unicode">&alpha;</span><i class="emphasis">f</i><sub>1</sub> + (1 - <span class="unicode">&alpha;</span>) <i class="emphasis">f</i><sub>2</sub> for all <span class="unicode">&alpha;</span> in the range 0 <span class="unicode">&le;</span> <span class="unicode">&alpha;</span> <span class="unicode">&le;</span> 1.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 26.1-8</span></span><a name="1987"></a><a name="ch26ex09"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">State the maximum-flow problem as a linear-programming problem.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 26.1-9</span></span><a name="1988"></a><a name="ch26ex10"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Professor Adam has two children who, unfortunately, dislike each other. The problem is so severe that not only do they refuse to walk to school together, but in fact each one refuses to walk on any block that the other child has stepped on that day. The children have no problem with their paths crossing at a corner. Fortunately both the professor's house and the school are on corners, but beyond that he is not sure if it is going to be possible to send both of his children to the same school. The professor has a map of his town. Show how to formulate the problem of determining if both his children can go to the same school as a maximum-flow problem.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0160.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0162.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
