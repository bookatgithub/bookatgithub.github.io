<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>28.3 Solving systems of linear equations</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0177.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0179.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch28"></a>
<div class="section">
<h2 class="first-section-title">
<a name="2274"></a><a name="ch28lev1sec3"></a><span class="section-titlelabel">28.3 </span>Solving systems of linear equations</h2>
<a name="2275"></a><a name="IDX-742"></a>
<p class="para">Solving a set of simultaneous linear equations is a fundamental problem that occurs in diverse applications. A linear system can be expressed as a matrix equation in which each matrix or vector element belongs to a field, typically the real numbers <b class="bold">R</b>. This section discusses how to solve a system of linear equations using a method called LUP decomposition.</p>
<p class="para">We start with a set of linear equations in <i class="emphasis">n</i> unknowns <i class="emphasis">x</i><sub>1</sub>, <i class="emphasis">x</i><sub>2</sub>, . . . , <i class="emphasis">x<sub>n</sub></i>:</p>
<div class="equation">
<a name="2276"></a><a name="ch28eq16"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(28.16)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig764_01.jpg" height="91" width="247" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">A set of values for <i class="emphasis">x</i><sub>1</sub>, <i class="emphasis">x</i><sub>2</sub>, . . . , <i class="emphasis">x<sub>n</sub></i> that satisfy all of the <a class="internaljump" href="#ch28eq16">equations (28.16)</a> simultaneously is said to be a <b class="bold"><i class="emphasis">solution</i></b> to these equations. In this section, we treat only the case in which there are exactly <i class="emphasis">n</i> equations in <i class="emphasis">n</i> unknowns.</p>
<p class="para">We can conveniently rewrite <a class="internaljump" href="#ch28eq16">equations (28.16)</a> as the matrix-vector equation</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig764_02.jpg" height="81" width="250" alt="" border="0"></span>
</div>
<p class="para">or, equivalently, letting <i class="emphasis">A</i> = (<i class="emphasis">a<sub>ij</sub></i>), <i class="emphasis">x</i> = (<i class="emphasis">x<sub>i</sub></i>), and <i class="emphasis">b</i> = (<i class="emphasis">b<sub>i</sub></i>), as</p>
<div class="equation">
<a name="2277"></a><a name="ch28eq17"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(28.17)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig764_03.jpg" height="12" width="53" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">If <i class="emphasis">A</i> is nonsingular, it possesses an inverse <i class="emphasis">A</i><sup>-1</sup>, and</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(28.18)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig764_04.jpg" height="16" width="62" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">is the solution vector. We can prove that <i class="emphasis">x</i> is the unique solution to <a class="internaljump" href="#ch28eq17">equation (28.17)</a> as follows. If there are two solutions, <i class="emphasis">x</i> and <i class="emphasis">x</i><span class="unicode">&prime;</span>, then <i class="emphasis">Ax</i> = <i class="emphasis">Ax</i><span class="unicode">&prime;</span> = <i class="emphasis">b</i> and</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">x</i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">(<i class="emphasis">A</i><sup>-1</sup><i class="emphasis">A</i>)<i class="emphasis">x</i>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">A</i><sup>-1</sup>(<i class="emphasis">Ax</i>)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">A</i><sup>-1</sup>(<i class="emphasis">Ax</i><span class="unicode">&prime;</span>)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">(<i class="emphasis">A</i><sup>-1</sup><i class="emphasis">A</i>)<i class="emphasis">x</i><span class="unicode">&prime;</span>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">x</i><span class="unicode">&prime;</span>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">In this section, we shall be concerned predominantly with the case in which <i class="emphasis">A</i> is nonsingular or, equivalently (by <a href="DDU0176.html#2232" target="_parent" class="chapterjump">Theorem 28.1</a>), the rank of <i class="emphasis">A</i> is equal to the <a name="2278"></a><a name="IDX-743"></a>number <i class="emphasis">n</i> of unknowns. There are other possibilities, however, which merit a brief discussion. If the number of equations is less than the number <i class="emphasis">n</i> of unknowns<span class="unicode">-</span>or, more generally, if the rank of <i class="emphasis">A</i> is less than <i class="emphasis">n</i><span class="unicode">-</span>then the system is <b class="bold"><i class="emphasis">underdetermined</i></b>. An underdetermined system typically has infinitely many solutions, although it may have no solutions at all if the equations are inconsistent. If the number of equations exceeds the number <i class="emphasis">n</i> of unknowns, the system is <b class="bold"><i class="emphasis">overdetermined</i></b>, and there may not exist any solutions. Finding good approximate solutions to overdetermined systems of linear equations is an important problem that is addressed in <a href="DDU0180.html#2325" target="_parent" class="chapterjump">Section 28.5</a>.</p>
<p class="para">Let us return to our problem of solving the system <i class="emphasis">Ax</i> = <i class="emphasis">b</i> of <i class="emphasis">n</i> equations in <i class="emphasis">n</i> unknowns. One approach is to compute <i class="emphasis">A</i><sup>-1</sup> and then multiply both sides by <i class="emphasis">A</i><sup>-1</sup>, yielding <i class="emphasis">A</i><sup>-1</sup> <i class="emphasis">Ax</i> = <i class="emphasis">A</i><sup>-1</sup><i class="emphasis">b</i>, or <i class="emphasis">x</i> = <i class="emphasis">A</i><sup>-1</sup><i class="emphasis">b</i>. This approach suffers in practice from numerical instability. There is, fortunately, another approach<span class="unicode">-</span>LUP decomposition<span class="unicode">-</span>that is numerically stable and has the further advantage of being faster in practice.</p>
<div class="section">
<h4 class="sect4-title">
<a name="2279"></a><a name="ch28lev3sec8"></a>Overview of LUP decomposition</h4>
<p class="first-para">The idea behind LUP decomposition is to find three <i class="emphasis">n</i> <span class="unicode">&times;</span> <i class="emphasis">n</i> matrices <i class="emphasis">L</i>, <i class="emphasis">U</i>, and <i class="emphasis">P</i> such that</p>
<div class="equation">
<a name="2280"></a><a name="ch28eq19"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(28.19)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig765_01.jpg" height="14" width="71" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">where</p>
<ul class="itemizedlist">
<li class="first-listitem">
<p class="first-para">
<i class="emphasis">L</i> is a unit lower-triangular matrix,</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">U</i> is an upper-triangular matrix, and</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">P</i> is a permutation matrix.</p>
</li>
</ul>
<p class="para">We call matrices <i class="emphasis">L, U</i> , and <i class="emphasis">P</i> satisfying <a class="internaljump" href="#ch28eq19">equation (28.19)</a> an <b class="bold"><i class="emphasis">LUP decomposition</i></b> of the matrix <i class="emphasis">A</i>. We shall show that every nonsingular matrix <i class="emphasis">A</i> possesses such a decomposition.</p>
<p class="para">The advantage of computing an LUP decomposition for the matrix <i class="emphasis">A</i> is that linear systems can be solved more readily when they are triangular, as is the case for both matrices <i class="emphasis">L</i> and <i class="emphasis">U</i> . Having found an LUP decomposition for <i class="emphasis">A</i>, we can solve the <a class="internaljump" href="#ch28eq17">equation (28.17)</a> <i class="emphasis">Ax</i> = <i class="emphasis">b</i> by solving only triangular linear systems, as follows. Multiplying both sides of <i class="emphasis">Ax</i> = <i class="emphasis">b</i> by <i class="emphasis">P</i> yields the equivalent equation <i class="emphasis">P Ax</i> = <i class="emphasis">Pb</i>, which by <a href="DDU0176.html#2244" target="_parent" class="chapterjump">Exercise 28.1-5</a> amounts to permuting the <a class="internaljump" href="#ch28eq16">equations (28.16)</a>.Using our decomposition (<a class="internaljump" href="#ch28eq19">28.19</a>), we obtain</p>
<p class="para">
<i class="emphasis">LU x</i> = <i class="emphasis">Pb</i>.</p>
<p class="para">We can now solve this equation by solving two triangular linear systems. Let us define <i class="emphasis">y</i> = <i class="emphasis">U x</i>, where <i class="emphasis">x</i> is the desired solution vector. First, we solve the lower-triangular system<a name="2281"></a><a name="IDX-744"></a>
</p>
<div class="equation">
<a name="2282"></a><a name="ch28eq20"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(28.20)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig766_01.jpg" height="15" width="57" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">for the unknown vector <i class="emphasis">y</i> by a method called "forward substitution." Having solved for <i class="emphasis">y</i>, we then solve the upper-triangular system</p>
<div class="equation">
<a name="2283"></a><a name="ch28eq21"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(28.21)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig766_02.jpg" height="15" width="47" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">for the unknown <i class="emphasis">x</i> by a method called "back substitution." The vector <i class="emphasis">x</i> is our solution to <i class="emphasis">Ax</i> = <i class="emphasis">b</i>, since the permutation matrix <i class="emphasis">P</i> is invertible (<a href="DDU0176.html#2244" target="_parent" class="chapterjump">Exercise 28.1-5</a>):</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">Ax</i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">P</i><sup>-1</sup><i class="emphasis">LU x</i>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">P</i><sup>-1</sup><i class="emphasis">Ly</i>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">P</i><sup>-1</sup><i class="emphasis">Pb</i>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="last-para">Our next step is to show how forward and back substitution work and then attack the problem of computing the LUP decomposition itself.</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="2284"></a><a name="ch28lev3sec9"></a>Forward and back substitution</h4>
<p class="first-para">
<b class="bold"><i class="emphasis">Forward substitution</i></b> can solve the lower-triangular system (<a class="internaljump" href="#ch28eq20">28.20</a>) in <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>2</sup>) time, given <i class="emphasis">L</i>, <i class="emphasis">P</i>, and <i class="emphasis">b</i>. For convenience, we represent the permutation <i class="emphasis">P</i> compactly by an array <i class="emphasis"><span class="unicode">&pi;</span></i>[1 <span class="unicode">&#8229;</span> <i class="emphasis">n</i>]. For <i class="emphasis">i</i> = 1, 2, . . . , <i class="emphasis">n</i>, the entry <i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">i</i>] indicates that <i class="emphasis">P</i><sub><i class="emphasis">i</i>, <i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">i</i>]</sub> = 1 and <i class="emphasis">P<sub>ij</sub></i> = 0 for <i class="emphasis">j</i> <span class="unicode">&ne;</span> <i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">i</i>]. Thus, <i class="emphasis">P A</i> has <i class="emphasis">a</i><sub><i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">i</i>], <i class="emphasis">j</i></sub> in row <i class="emphasis">i</i> and column <i class="emphasis">j</i>, and <i class="emphasis">Pb</i> has <i class="emphasis">b</i><sub><i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">i</i>]</sub> as its <i class="emphasis">i</i>th element. Since <i class="emphasis">L</i> is unit lower-triangular, <a class="internaljump" href="#ch28eq20">equation (28.20)</a> can be rewritten as</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">y</i><sub>1</sub>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i><sub><i class="emphasis"><span class="unicode">&pi;</span></i>[1],</sub>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">l</i><sub>21</sub><i class="emphasis">y</i><sub>1</sub> + <i class="emphasis">y</i><sub>2</sub>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i><sub><i class="emphasis"><span class="unicode">&pi;</span></i>[2],</sub>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">l</i><sub>31</sub><i class="emphasis">y</i><sub>1</sub> + <i class="emphasis">l</i><sub>32</sub><i class="emphasis">y</i><sub>2</sub> + <i class="emphasis">y</i><sub>3</sub>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i><sub><i class="emphasis"><span class="unicode">&pi;</span></i>[3],</sub>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&#8942;</span>
</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">l</i><sub><i class="emphasis">n</i>1</sub><i class="emphasis">y</i><sub>1</sub> + <i class="emphasis">l</i><sub><i class="emphasis">n</i>2</sub><i class="emphasis">y</i><sub>2</sub> + <i class="emphasis">l</i><sub><i class="emphasis">n</i>3</sub><i class="emphasis">y</i><sub>3</sub> + <span class="unicode">&middot;</span> <span class="unicode">&middot;</span> <span class="unicode">&middot;</span> + <i class="emphasis">y<sub>n</sub></i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i><sub><i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">n</i>]</sub>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">We can solve for <i class="emphasis">y</i><sub>1</sub> directly, since the first equation tells us that <i class="emphasis">y</i><sub>1</sub> = <i class="emphasis">b</i><sub><i class="emphasis"><span class="unicode">&pi;</span></i>[1]</sub>. Having solved for <i class="emphasis">y</i><sub>1</sub>, we can substitute it into the second equation, yielding</p>
<p class="para">
<i class="emphasis">y</i><sub>2</sub> = <i class="emphasis">b</i><sub><i class="emphasis"><span class="unicode">&pi;</span></i>[2]</sub> - <i class="emphasis">l</i><sub>21</sub><i class="emphasis">y</i><sub>1</sub>.</p>
<p class="para">Now, we can substitute both <i class="emphasis">y</i><sub>1</sub> and <i class="emphasis">y</i><sub>2</sub> into the third equation, obtaining</p>
<p class="para">
<i class="emphasis">y</i><sub>3</sub> = <i class="emphasis">b</i><sub><i class="emphasis"><span class="unicode">&pi;</span></i>[3]</sub> - (<i class="emphasis">l</i><sub>31</sub><i class="emphasis">y</i><sub>1</sub> + <i class="emphasis">l</i><sub>32</sub><i class="emphasis">y</i><sub>2</sub>).</p>
<p class="para">In general, we substitute <i class="emphasis">y</i><sub>1</sub>, <i class="emphasis">y</i><sub>2</sub>, . . . , <i class="emphasis">y</i><sub><i class="emphasis">i</i>-1</sub> "forward" into the <i class="emphasis">i</i>th equation to solve for <i class="emphasis">y<sub>i</sub></i>:<a name="2285"></a><a name="IDX-745"></a>
</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig767_01.jpg" height="44" width="132" alt="" border="0"></span>
</div>
<p class="para">
<b class="bold"><i class="emphasis">Back substitution</i></b> is similar to forward substitution. Given <i class="emphasis">U</i> and <i class="emphasis">y</i>, we solve the <i class="emphasis">n</i>th equation first and work backward to the first equation. Like forward substitution, this process runs in <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>2</sup>) time. Since <i class="emphasis">U</i> is upper-triangular, we can rewrite the system (<a class="internaljump" href="#ch28eq21">28.21</a>) as</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">u</i><sub>11</sub><i class="emphasis">x</i><sub>1</sub> + <i class="emphasis">u</i><sub>12</sub><i class="emphasis">x</i><sub>2</sub> + <span class="unicode">&middot;</span> <span class="unicode">&middot;</span> <span class="unicode">&middot;</span> + <i class="emphasis">u</i><sub>1, <i class="emphasis">n</i>-2</sub><i class="emphasis">x</i><sub><i class="emphasis">n</i>-2</sub> + <i class="emphasis">u</i><sub>1, <i class="emphasis">n</i>-1</sub><i class="emphasis">x</i><sub><i class="emphasis">n</i>-1</sub> + <i class="emphasis">u</i><sub>1<i class="emphasis">n</i></sub><i class="emphasis">x</i><sub><i class="emphasis">n</i></sub>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">y</i><sub>1</sub>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">u</i><sub>22</sub><i class="emphasis">x</i><sub>2</sub> + <span class="unicode">&middot;</span> <span class="unicode">&middot;</span> <span class="unicode">&middot;</span> + <i class="emphasis">u</i><sub>2, <i class="emphasis">n</i>-2</sub><i class="emphasis">x</i><sub><i class="emphasis">n</i>-2</sub> + <i class="emphasis">u</i><sub>2, <i class="emphasis">n</i>-1</sub><i class="emphasis">x</i><sub><i class="emphasis">n</i>-1</sub> + <i class="emphasis">u</i><sub>2<i class="emphasis">n</i></sub><i class="emphasis">x</i><sub><i class="emphasis">n</i></sub>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">y</i><sub>2</sub>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&#8942;</span>
</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">u</i><sub><i class="emphasis">n</i>-2, <i class="emphasis">n</i>-2</sub><i class="emphasis">x</i><sub><i class="emphasis">n</i>-2</sub> + <i class="emphasis">u</i><sub><i class="emphasis">n</i>-2, <i class="emphasis">n</i>-1</sub><i class="emphasis">x</i><sub><i class="emphasis">n</i>-1</sub> + <i class="emphasis">u</i><sub><i class="emphasis">n</i>-2, <i class="emphasis">n</i></sub><i class="emphasis">x</i><sub><i class="emphasis">n</i></sub>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">y</i><sub><i class="emphasis">n</i>-2</sub>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">u</i><sub><i class="emphasis">n</i>-1,<i class="emphasis">n</i>-1</sub><i class="emphasis">x</i><sub><i class="emphasis">n</i>-1</sub> + <i class="emphasis">u</i><sub><i class="emphasis">n</i>-1, <i class="emphasis">n</i></sub><i class="emphasis">x<sub>n</sub></i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">y</i><sub><i class="emphasis">n</i>-1</sub>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">u<sub>n,n</sub></i><i class="emphasis">x<sub>n</sub></i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">y<sub>n</sub></i>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">Thus, we can solve for <i class="emphasis">x<sub>n</sub></i>, <i class="emphasis">x</i><sub><i class="emphasis">n</i>-1</sub>, . . . , <i class="emphasis">x</i><sub>1</sub> successively as follows:</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">x<sub>n</sub></i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">y<sub>n</sub></i>/<i class="emphasis">u<sub>n,n</sub></i>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">x</i><sub><i class="emphasis">n</i>-1</sub>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">(<i class="emphasis">y</i><sub><i class="emphasis">n</i>-1</sub> - <i class="emphasis">u</i><sub><i class="emphasis">n</i>-1,<i class="emphasis">n</i></sub><i class="emphasis">x<sub>n</sub></i>)/<i class="emphasis">u</i><sub><i class="emphasis">n</i>-1,<i class="emphasis">n</i>-1</sub>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">
<p class="table-para">
<i class="emphasis">x</i><sub><i class="emphasis">n</i>-2</sub>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">(<i class="emphasis">y</i><sub><i class="emphasis">n</i>-2</sub> - (<i class="emphasis">u</i><sub><i class="emphasis">n</i>-2,<i class="emphasis">n</i>-1</sub><i class="emphasis">x</i><sub><i class="emphasis">n</i>-1</sub> + <i class="emphasis">u</i><sub><i class="emphasis">n</i>-2,<i class="emphasis">n</i></sub><i class="emphasis">x<sub>n</sub></i>))/<i class="emphasis">u</i><sub><i class="emphasis">n</i>-2,<i class="emphasis">n</i>-2</sub>,</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="right">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&#8942;</span>
</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<p class="para">or, in general,</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig767_02.jpg" height="46" width="177" alt="" border="0"></span>
</div>
<p class="para">Given <i class="emphasis">P</i>, <i class="emphasis">L</i>, <i class="emphasis">U</i> , and <i class="emphasis">b</i>, the procedure LUP-SOLVE solves for <i class="emphasis">x</i> by combining forward and back substitution. The pseudocode assumes that the dimension <i class="emphasis">n</i> appears in the attribute <i class="emphasis">rows</i>[<i class="emphasis">L</i>] and that the permutation matrix <i class="emphasis">P</i> is represented by the array <i class="emphasis"><span class="unicode">&pi;</span></i>.</p>
<div class="informalexample">
<pre class="literallayout-normal">
LUP-SOLVE(<i class="emphasis">L</i>, <i class="emphasis">U</i>, <i class="emphasis"><span class="unicode">&pi;</span></i>, <i class="emphasis">b</i>)
1 <i class="emphasis">n</i> <span class="unicode">&larr;</span> <i class="emphasis">rows</i>[<i class="emphasis">L</i>]
2 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
3      <b class="bold">do</b> <span class="inlinemediaobject"><img src="images/fig767_03.jpg" height="16" width="107" alt="" border="0"></span>
4 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> <i class="emphasis">n</i> <b class="bold">downto</b> 1
5      <b class="bold">do</b> <span class="inlinemediaobject"><img src="images/fig767_04.jpg" height="15" width="136" alt="" border="0"></span>
6 <b class="bold">return</b> <i class="emphasis">x</i>
</pre>
</div>
<a name="2286"></a><a name="IDX-746"></a>
<p class="para">Procedure LUP-SOLVE solves for <i class="emphasis">y</i> using forward substitution in lines 2<span class="unicode">-</span>3, and then it solves for <i class="emphasis">x</i> using backward substitution in lines 4<span class="unicode">-</span>5. Since there is an implicit loop in the summations within each of the <b class="bold">for</b> loops, the running time is <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>2</sup>).</p>
<p class="para">As an example of these methods, consider the system of linear equations defined by</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig768_01.jpg" height="55" width="155" alt="" border="0"></span>
</div>
<p class="para">where</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig768_02.jpg" height="112" width="139" alt="" border="0"></span>
</div>
<p class="para">and we wish to solve for the unknown <i class="emphasis">x</i>. The LUP decomposition is</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig768_03.jpg" height="169" width="173" alt="" border="0"></span>
</div>
<p class="para">(The reader can verify that <i class="emphasis">P A</i> = <i class="emphasis">LU</i>.) Using forward substitution, we solve <i class="emphasis">Ly</i> = <i class="emphasis">Pb</i> for <i class="emphasis">y</i>:</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig768_04.jpg" height="55" width="214" alt="" border="0"></span>
</div>
<p class="para">obtaining</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig768_05.jpg" height="54" width="75" alt="" border="0"></span>
</div>
<a name="2287"></a><a name="IDX-747"></a>
<p class="para">by computing first <i class="emphasis">y</i><sub>1</sub>, then <i class="emphasis">y</i><sub>2</sub>, and finally <i class="emphasis">y</i><sub>3</sub>. Using back substitution, we solve <i class="emphasis">U x</i> = <i class="emphasis">y</i> for <i class="emphasis">x</i>:</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig769_01.jpg" height="54" width="237" alt="" border="0"></span>
</div>
<p class="para">thereby obtaining the desired answer</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig769_02.jpg" height="55" width="87" alt="" border="0"></span>
</div>
<p class="last-para">by computing first <i class="emphasis">x</i><sub>3</sub>, then <i class="emphasis">x</i><sub>2</sub>, and finally <i class="emphasis">x</i><sub>1</sub>.</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="2288"></a><a name="ch28lev3sec10"></a>Computing an LU decomposition</h4>
<p class="first-para">We have now shown that if an LUP decomposition can be computed for a nonsingular matrix <i class="emphasis">A</i>, forward and back substitution can be used to solve the system <i class="emphasis">Ax</i> = <i class="emphasis">b</i> of linear equations. It remains to show how an LUP decomposition for <i class="emphasis">A</i> can be found efficiently. We start with the case in which <i class="emphasis">A</i> is an <i class="emphasis">n</i> <span class="unicode">&times;</span> <i class="emphasis">n</i> nonsingular matrix and <i class="emphasis">P</i> is absent (or, equivalently, <i class="emphasis">P</i> = <i class="emphasis">I<sub>n</sub></i>). In this case, we must find a factorization <i class="emphasis">A</i> = <i class="emphasis">LU</i> . We call the two matrices <i class="emphasis">L</i> and <i class="emphasis">U</i> an <b class="bold"><i class="emphasis">LU decomposition</i></b> of <i class="emphasis">A</i>.</p>
<p class="para">The process by which we perform LU decomposition is called <b class="bold"><i class="emphasis">Gaussian elimination</i></b>. We start by subtracting multiples of the first equation from the other equations so that the first variable is removed from those equations. Then, we subtract multiples of the second equation from the third and subsequent equations so that now the first and second variables are removed from them. We continue this process until the system that is left has an upper-triangular form<span class="unicode">-</span>in fact, it is the matrix <i class="emphasis">U</i>. The matrix <i class="emphasis">L</i> is made up of the row multipliers that cause variables to be eliminated.</p>
<p class="para">Our algorithm to implement this strategy is recursive. We wish to construct an LU decomposition for an <i class="emphasis">n</i> <span class="unicode">&times;</span> <i class="emphasis">n</i> nonsingular matrix <i class="emphasis">A</i>. If <i class="emphasis">n</i> = 1, then we're done, since we can choose <i class="emphasis">L</i> = <i class="emphasis">I</i><sub>1</sub> and <i class="emphasis">U</i> = <i class="emphasis">A</i>. For <i class="emphasis">n</i> <span class="unicode">&gt;</span> 1, we break <i class="emphasis">A</i> into four parts:</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig769_03.jpg" height="121" width="190" alt="" border="0"></span>
</div>
<p class="para">where <i class="emphasis">v</i> is a size-(<i class="emphasis">n</i> - 1) column vector, <i class="emphasis">w</i><sup>T</sup> is a size-(<i class="emphasis">n</i> - 1) row vector, and <i class="emphasis">A</i><span class="unicode">&prime;</span> is an (<i class="emphasis">n</i> - 1) <span class="unicode">&times;</span> (<i class="emphasis">n</i> - 1) matrix. Then, using matrix algebra (verify the equations by <a name="2289"></a><a name="IDX-748"></a>simply multiplying through), we can factor <i class="emphasis">A</i> as</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(28.22)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig770_01.jpg" height="77" width="301" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">The 0's in the first and second matrices of the factorization are row and column vectors, respectively, of size <i class="emphasis">n</i> - 1. The term <i class="emphasis">vw</i><sup>T</sup>/<i class="emphasis">a</i><sub>11</sub>, formed by taking the outer product of <i class="emphasis">v</i> and <i class="emphasis">w</i> and dividing each element of the result by <i class="emphasis">a</i><sub>11</sub>, is an (<i class="emphasis">n</i> - 1) <span class="unicode">&times;</span> (<i class="emphasis">n</i> - 1) matrix, which conforms in size to the matrix <i class="emphasis">A</i><span class="unicode">&prime;</span> from which it is subtracted. The resulting (<i class="emphasis">n</i> - 1) <span class="unicode">&times;</span> (<i class="emphasis">n</i> - 1) matrix</p>
<div class="equation">
<a name="2290"></a><a name="ch28eq23"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(28.23)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig770_02.jpg" height="18" width="82" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">is called the <b class="bold"><i class="emphasis">Schur complement</i></b> of <i class="emphasis">A</i> with respect to <i class="emphasis">a</i><sub>11</sub>.</p>
<p class="para">We claim that if <i class="emphasis">A</i> is nonsingular, then the Schur complement is nonsingular, too. Why? Suppose that the Schur complement, which is (<i class="emphasis">n</i> - 1) <span class="unicode">&times;</span> (<i class="emphasis">n</i> - 1), is singular. Then by <a href="DDU0176.html#2232" target="_parent" class="chapterjump">Theorem 28.1</a>, it has row rank strictly less than <i class="emphasis">n</i> - 1. Because the bottom <i class="emphasis">n</i> - 1 entries in the first column of the matrix</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig770_03.jpg" height="37" width="138" alt="" border="0"></span>
</div>
<p class="para">are all 0, the bottom <i class="emphasis">n</i> - 1 rows of this matrix must have row rank strictly less than <i class="emphasis">n</i> - 1. The row rank of the entire matrix, therefore, is strictly less than <i class="emphasis">n</i>. Applying <a href="DDU0176.html#2250" target="_parent" class="chapterjump">Exercise 28.1-10</a> to <a href="DDU0177.html#2272" target="_parent" class="chapterjump">equation (28.22)</a>, <i class="emphasis">A</i> has rank strictly less than <i class="emphasis">n</i>, and from <a href="DDU0176.html#2232" target="_parent" class="chapterjump">Theorem 28.1</a> we derive the contradiction that <i class="emphasis">A</i> is singular.</p>
<p class="para">Because the Schur complement is nonsingular, we can now recursively find an LU decomposition of it. Let us say that</p>
<p class="para">
<i class="emphasis">A</i><span class="unicode">&prime;</span> - <i class="emphasis">vw</i><sup>T</sup>/<i class="emphasis">a</i><sub>11</sub> = <i class="emphasis">L</i><span class="unicode">&prime;</span><i class="emphasis">U</i><span class="unicode">&prime;</span>,</p>
<p class="para">where <i class="emphasis">L</i><span class="unicode">&prime;</span> is unit lower-triangular and <i class="emphasis">U</i><span class="unicode">&prime;</span> is upper-triangular. Then, using matrix algebra, we have</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig770_04.jpg" height="135" width="289" alt="" border="0"></span>
</div>
<p class="para">thereby providing our LU decomposition. (Note that because <i class="emphasis">L</i><span class="unicode">&prime;</span> is unit lower-triangular, so is <i class="emphasis">L</i>, and because <i class="emphasis">U</i><span class="unicode">&prime;</span> is upper-triangular, so is <i class="emphasis">U</i>.)<a name="2291"></a><a name="IDX-749"></a>
</p>
<p class="para">Of course, if <i class="emphasis">a</i><sub>11</sub> = 0, this method doesn't work, because it divides by 0. It also doesn't work if the upper leftmost entry of the Schur complement <i class="emphasis">A</i><span class="unicode">&prime;</span> - <i class="emphasis">vw</i><sup>T</sup>/<i class="emphasis">a</i><sub>11</sub> is 0, since we divide by it in the next step of the recursion. The elements by which we divide during LU decomposition are called <b class="bold"><i class="emphasis">pivots</i></b>, and they occupy the diagonal elements of the matrix <i class="emphasis">U</i>. The reason we include a permutation matrix <i class="emphasis">P</i> during LUP decomposition is that it allows us to avoid dividing by zero elements. Using permutations to avoid division by 0 (or by small numbers) is called <b class="bold"><i class="emphasis">pivoting</i></b>.</p>
<p class="para">An important class of matrices for which LU decomposition always works correctly is the class of symmetric positive-definite matrices. Such matrices require no pivoting, and thus the recursive strategy outlined above can be employed without fear of dividing by 0. We shall prove this result, as well as several others, in <a href="DDU0180.html#2325" target="_parent" class="chapterjump">Section 28.5.</a>
</p>
<p class="para">Our code for LU decomposition of a matrix <i class="emphasis">A</i> follows the recursive strategy, except that an iteration loop replaces the recursion. (This transformation is a standard optimization for a "tail-recursive" procedure<span class="unicode">-</span>one whose last operation is a recursive call to itself.) It assumes that the dimension of <i class="emphasis">A</i> is kept in the attribute <i class="emphasis">rows</i>[<i class="emphasis">A</i>]. Since we know that the output matrix <i class="emphasis">U</i> has 0's below the diagonal, and since LUP-SOLVE does not look at these entries, the code does not bother to fill them in. Likewise, because the output matrix <i class="emphasis">L</i> has 1's on its diagonal and 0's above the diagonal, these entries are not filled in either. Thus, the code computes only the "significant" entries of <i class="emphasis">L</i> and <i class="emphasis">U</i>.</p>
<div class="informalexample">
<pre class="literallayout-normal">
LU-DECOMPOSITION(<i class="emphasis">A</i>)
 1 <i class="emphasis">n</i> <span class="unicode">&larr;</span> <i class="emphasis">rows</i>[<i class="emphasis">A</i>]
 2 <b class="bold">for</b> <i class="emphasis">k</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
 3      <b class="bold">do</b> <i class="emphasis">u<sub>kk</sub></i> <span class="unicode">&larr;</span> <i class="emphasis">a<sub>kk</sub></i>
 4         <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> <i class="emphasis">k</i> + 1 <b class="bold">to</b> <i class="emphasis">n</i>
 5             <b class="bold">do</b> <i class="emphasis">l<sub>ik</sub></i> <span class="unicode">&larr;</span> <i class="emphasis">a<sub>ik</sub></i>/<i class="emphasis">u<sub>kk</sub></i>    <span class="unicode">&#9657;</span><i class="emphasis">l<sub>ik</sub></i> holds <i class="emphasis">v<sub>i</sub></i>
 6                <i class="emphasis">u<sub>ki</sub></i> <span class="unicode">&larr;</span> <i class="emphasis">a<sub>ki</sub></i>       <span class="unicode">&#9657;</span><i class="emphasis">u<sub>ki</sub></i> holds <span class="inlinemediaobject"><img src="images/fig771_01.jpg" height="14" width="14" alt="" border="0"></span>
 7         <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> <i class="emphasis">k</i> + 1 <b class="bold">to</b> <i class="emphasis">n</i>
 8             <b class="bold">do for</b> <i class="emphasis">j</i> <span class="unicode">&larr;</span> <i class="emphasis">k</i> + 1 <b class="bold">to</b> <i class="emphasis">n</i>
 9                    <b class="bold">do</b> <i class="emphasis">a<sub>ij</sub></i> <span class="unicode">&larr;</span> <i class="emphasis">a<sub>ij</sub></i> - <i class="emphasis">l<sub>ik</sub>u<sub>kj</sub></i>
10 <b class="bold">return</b> <i class="emphasis">L</i> and <i class="emphasis">U</i>
</pre>
</div>
<p class="para">The outer <b class="bold">for</b> loop beginning in line 2 iterates once for each recursive step. Within this loop, the pivot is determined to be <i class="emphasis">u<sub>kk</sub></i> = <i class="emphasis">a<sub>kk</sub></i> in line 3. Within the <b class="bold">for</b> loop in lines 4<span class="unicode">-</span>6 (which does not execute when <i class="emphasis">k</i> = <i class="emphasis">n</i>), the <i class="emphasis">v</i> and <i class="emphasis">w</i><sup>T</sup> vectors are used to update <i class="emphasis">L</i> and <i class="emphasis">U</i> . The elements of the <i class="emphasis">v</i> vector are determined in line 5, where <i class="emphasis">v<sub>i</sub></i> is stored in <i class="emphasis">l<sub>ik</sub></i>, and the elements of the <i class="emphasis">w</i><sup>T</sup> vector are determined in line 6, where <span class="inlinemediaobject"><img src="images/fig771_02.jpg" height="14" width="14" alt="" border="0"></span> is stored in <i class="emphasis">u<sub>ki</sub></i> . Finally, the elements of the Schur complement are computed in lines 7<span class="unicode">-</span>9 and stored back in the matrix <i class="emphasis">A</i>. (We don't need to divide by <i class="emphasis">a<sub>kk</sub></i> in line 9 <a name="2292"></a><a name="IDX-750"></a>because we already did so when we computed <i class="emphasis">l<sub>ik</sub></i> in line 5.) Because line 9 is triply nested, LU-DECOMPOSITION runs in time <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>3</sup>).</p>
<p class="para">
<a class="internaljump" href="#ch28fig01">Figure 28.1</a> illustrates the operation of LU-DECOMPOSITION. It shows a standard optimization of the procedure in which the significant elements of <i class="emphasis">L</i> and <i class="emphasis">U</i> are stored "in place" in the matrix <i class="emphasis">A</i>. That is, we can set up a correspondence between each element <i class="emphasis">a<sub>ij</sub></i> and either <i class="emphasis">l<sub>ij</sub></i> (if <i class="emphasis">i</i> <span class="unicode">&gt;</span> <i class="emphasis">j</i>) or <i class="emphasis">u<sub>ij</sub></i> (if <i class="emphasis">i</i> <span class="unicode">&le;</span> <i class="emphasis">j</i>) and update the matrix <i class="emphasis">A</i> so that it holds both <i class="emphasis">L</i> and <i class="emphasis">U</i> when the procedure terminates. The pseudocode for this optimization is obtained from the above pseudocode merely by replacing each reference to <i class="emphasis">l</i> or <i class="emphasis">u</i> by <i class="emphasis">a</i>; it is not difficult to verify that this transformation preserves correctness.</p>
<div class="figure">
<a name="2293"></a><a name="ch28fig01"></a><span class="figuremediaobject"><a href="images/fig772%5F01%5F0%2Ejpg" NAME="IMG_993" target="_parent"><img src="images/fig772_01.jpg" height="183" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 28.1: </span>The operation of LU-DECOMPOSITION. <i class="emphasis">(a)</i> The matrix <i class="emphasis">A</i>. <i class="emphasis">(b)</i> The element <i class="emphasis">a</i><sub>11</sub> = 2 in the black circle is the pivot, the shaded column is <i class="emphasis">v</i>/<i class="emphasis">a</i><sub>11</sub>, and the shaded row is <i class="emphasis">w</i><sup>T</sup>. The elements of <i class="emphasis">U</i> computed thus far are above the horizontal line, and the elements of <i class="emphasis">L</i> are to the left of the vertical line. The Schur complement matrix <i class="emphasis">A</i><span class="unicode">&prime;</span> - <i class="emphasis">vw</i><sup>T</sup>/<i class="emphasis">a</i><sub>11</sub> occupies the lower right. <i class="emphasis">(c)</i> We now operate on the Schur complement matrix produced from part (b). The element <i class="emphasis">a</i><sub>22</sub> = 4 in the black circle is the pivot, and the shaded column and row are <i class="emphasis">v</i>/<i class="emphasis">a</i><sub>22</sub> and <i class="emphasis">w</i><sup>T</sup> (in the partitioning of the Schur complement), respectively. Lines divide the matrix into the elements of <i class="emphasis">U</i> computed so far (above), the elements of <i class="emphasis">L</i> computed so far (left), and the new Schur complement (lower right). <i class="emphasis">(d)</i> The next step completes the factorization. (The element 3 in the new Schur complement becomes part of <i class="emphasis">U</i> when the recursion terminates.) <i class="emphasis">(e)</i> The factorization <i class="emphasis">A</i> = <i class="emphasis">LU</i>.</span>
</div>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="2294"></a><a name="ch28lev3sec11"></a>Computing an LUP decomposition</h4>
<p class="first-para">Generally, in solving a system of linear equations <i class="emphasis">Ax</i> = <i class="emphasis">b</i>, we must pivot on off-diagonal elements of <i class="emphasis">A</i> to avoid dividing by 0. Not only is division by 0 undesirable, so is division by any small value, even if <i class="emphasis">A</i> is nonsingular, because numerical instabilities can result in the computation. We therefore try to pivot on a large value.<a name="2295"></a><a name="IDX-751"></a>
</p>
<p class="para">The mathematics behind LUP decomposition is similar to that of LU decomposition. Recall that we are given an <i class="emphasis">n</i> <span class="unicode">&times;</span> <i class="emphasis">n</i> nonsingular matrix <i class="emphasis">A</i> and wish to find a permutation matrix <i class="emphasis">P</i>, a unit lower-triangular matrix <i class="emphasis">L</i>, and an upper-triangular matrix <i class="emphasis">U</i> such that <i class="emphasis">P A</i> = <i class="emphasis">LU</i> . Before we partition the matrix <i class="emphasis">A</i>, as we did for LU decomposition, we move a nonzero element, say <i class="emphasis">a</i><sub><i class="emphasis">k</i>1</sub>, from somewhere in the first column to the (1, 1) position of the matrix. (If the first column contains only 0's, then <i class="emphasis">A</i> is singular, because its determinant is 0, by <a href="DDU0179.html#2319" target="_parent" class="chapterjump">Theorems 28.4</a> and <a href="DDU0176.html#2236" target="_parent" class="chapterjump">28.5</a>.) In order to preserve the set of equations, we exchange row 1 with row <i class="emphasis">k</i>, which is equivalent to multiplying <i class="emphasis">A</i> by a permutation matrix <i class="emphasis">Q</i> on the left (<a href="DDU0176.html#2244" target="_parent" class="chapterjump">Exercise 28.1-5</a>). Thus, we can write <i class="emphasis">Q A</i> as</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig773_01.jpg" height="38" width="130" alt="" border="0"></span>
</div>
<p class="para">where <i class="emphasis">v</i> = (<i class="emphasis">a</i><sub>21</sub>, <i class="emphasis">a</i><sub>31</sub>, . . . , <i class="emphasis">a</i><sub><i class="emphasis">n</i>1</sub>)<sup>T</sup>, except that <i class="emphasis">a</i><sub>11</sub> replaces <i class="emphasis">a</i><sub><i class="emphasis">k</i>1</sub>; <i class="emphasis">w</i><sup>T</sup> = (<i class="emphasis">a</i><sub><i class="emphasis">k</i>2</sub>, <i class="emphasis">a</i><sub><i class="emphasis">k</i>3</sub>, . . . , <i class="emphasis">a<sub>kn</sub></i>); and <i class="emphasis">A</i><span class="unicode">&prime;</span> is an (<i class="emphasis">n</i> - 1) <span class="unicode">&times;</span> (<i class="emphasis">n</i> - 1) matrix. Since <i class="emphasis">a</i><sub><i class="emphasis">k</i>1</sub> <span class="unicode">&ne;</span> 0, we can now perform much the same linear algebra as for LU decomposition, but now guaranteeing that we do not divide by 0:</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig773_02.jpg" height="78" width="314" alt="" border="0"></span>
</div>
<p class="para">As we saw for LU decomposition, if <i class="emphasis">A</i> is nonsingular, then the Schur complement <i class="emphasis">A</i><span class="unicode">&prime;</span> - <i class="emphasis">vw</i><sup>T</sup>/<i class="emphasis">a</i><sub><i class="emphasis">k</i>1</sub> is nonsingular, too. Therefore, we can inductively find an LUP decomposition for it, with unit lower-triangular matrix <i class="emphasis">L</i><span class="unicode">&prime;</span>, upper-triangular matrix <i class="emphasis">U</i><span class="unicode">&prime;</span>, and permutation matrix <i class="emphasis">P</i><span class="unicode">&prime;</span>, such that</p>
<p class="para">
<i class="emphasis">P</i><span class="unicode">&prime;</span>(<i class="emphasis">A</i><span class="unicode">&prime;</span> - <i class="emphasis">vw</i><sup>T</sup>/<i class="emphasis">a</i><sub><i class="emphasis">k</i>1</sub>) = <i class="emphasis">L</i><span class="unicode">&prime;</span><i class="emphasis">U</i><span class="unicode">&prime;</span>.</p>
<p class="para">Define</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig773_03.jpg" height="39" width="116" alt="" border="0"></span>
</div>
<p class="para">which is a permutation matrix, since it is the product of two permutation matrices (<a href="DDU0176.html#2244" target="_parent" class="chapterjump">Exercise 28.1-5</a>). We now have</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig773_04.jpg" height="119" width="367" alt="" border="0"></span><span class="equation-image"><img src="images/fig774_01.jpg" height="136" width="309" alt="" border="0"></span>
</div>
<a name="2296"></a><a name="IDX-752"></a>
<p class="para">yielding the LUP decomposition. Because <i class="emphasis">L</i><span class="unicode">&prime;</span> is unit lower-triangular, so is <i class="emphasis">L</i>, and because <i class="emphasis">U</i><span class="unicode">&prime;</span> is upper-triangular, so is <i class="emphasis">U</i>.</p>
<p class="para">Notice that in this derivation, unlike the one for LU decomposition, both the column vector <i class="emphasis">v</i>/<i class="emphasis">a</i><sub><i class="emphasis">k</i>1</sub> and the Schur complement <i class="emphasis">A</i><span class="unicode">&prime;</span> - <i class="emphasis">vw</i><sup>T</sup>/<i class="emphasis">a</i><sub><i class="emphasis">k</i>1</sub> must be multiplied by the permutation matrix <i class="emphasis">P</i><span class="unicode">&prime;</span>.</p>
<p class="para">Like LU-DECOMPOSITION, our pseudocode for LUP decomposition replaces the recursion with an iteration loop. As an improvement over a direct implementation of the recursion, we dynamically maintain the permutation matrix <i class="emphasis">P</i> as an array <i class="emphasis"><span class="unicode">&pi;</span></i>, where <i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">i</i>] = <i class="emphasis">j</i> means that the <i class="emphasis">i</i>th row of <i class="emphasis">P</i> contains a 1 in column <i class="emphasis">j</i>. We also implement the code to compute <i class="emphasis">L</i> and <i class="emphasis">U</i> "in place" in the matrix <i class="emphasis">A</i>. Thus, when the procedure terminates,</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig774_02.jpg" height="39" width="130" alt="" border="0"></span>
</div>
<div class="informalexample">
<pre class="literallayout-normal">
LUP-DECOMPOSITION(<i class="emphasis">A</i>)
 1 <i class="emphasis">n</i> <span class="unicode">&larr;</span> <i class="emphasis">rows</i>[<i class="emphasis">A</i>]
 2 <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
 3      <b class="bold">do</b> <i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">i</i>] <span class="unicode">&larr;</span> <i class="emphasis">i</i>
 4 <b class="bold">for</b> <i class="emphasis">k</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
 5      <b class="bold">do</b> <i class="emphasis">p</i> <span class="unicode">&larr;</span> 0
 6         <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> <i class="emphasis">k</i> <b class="bold">to</b> <i class="emphasis">n</i>
 7             <b class="bold">do if</b> |<i class="emphasis">a<sub>ik</sub></i>| <span class="unicode">&gt;</span> <i class="emphasis">p</i>
 8                   <b class="bold">then</b> <i class="emphasis">p</i> <span class="unicode">&larr;</span> |<i class="emphasis">a<sub>ik</sub></i>|
 9                        <i class="emphasis">k</i>' <span class="unicode">&larr;</span> <i class="emphasis">i</i>
10         <b class="bold">if</b> <i class="emphasis">p</i> = 0
11            <b class="bold">then error</b> "singular matrix"
12         exchange <i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">k</i>] <span class="unicode">&harr;</span> <i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">k</i>']
13         <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> 1 <b class="bold">to</b> <i class="emphasis">n</i>
14              <b class="bold">do</b> exchange <i class="emphasis">a<sub>ki</sub></i> <span class="unicode">&harr;</span> <i class="emphasis">a<sub>k'i</sub></i>
15         <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> <i class="emphasis">k</i> + 1 <b class="bold">to</b> <i class="emphasis">n</i>
16              <b class="bold">do</b> <i class="emphasis">a<sub>ik</sub></i> <span class="unicode">&larr;</span> <i class="emphasis">a<sub>ik</sub></i>/<i class="emphasis">a<sub>kk</sub></i>
17                 <b class="bold">for</b> <i class="emphasis">j</i> <span class="unicode">&larr;</span> <i class="emphasis">k</i> + 1 <b class="bold">to</b> <i class="emphasis">n</i>
18                     <b class="bold">do</b> <i class="emphasis">a<sub>ij</sub></i> <span class="unicode">&larr;</span> <i class="emphasis">a<sub>ij</sub></i> - <i class="emphasis">a<sub>ik</sub></i><i class="emphasis">a<sub>kj</sub></i>
</pre>
</div>
<a name="2297"></a><a name="IDX-753"></a>
<p class="para">
<a class="internaljump" href="#ch28fig02">Figure 28.2</a> illustrates how LUP-DECOMPOSITION factors a matrix. The array <i class="emphasis"><span class="unicode">&pi;</span></i> is initialized by lines 2<span class="unicode">-</span>3 to represent the identity permutation. The outer <b class="bold">for</b> loop beginning in line 4 implements the recursion. Each time through the outer loop, lines 5<span class="unicode">-</span>9 determine the element <i class="emphasis">a<sub>k'k</sub></i> with largest absolute value of those in the current first column (column <i class="emphasis">k</i>) of the (<i class="emphasis">n</i> - <i class="emphasis">k</i> + 1) <span class="unicode">&times;</span> (<i class="emphasis">n</i> - <i class="emphasis">k</i> + 1) matrix whose LU decomposition must be found. If all elements in the current first column are <a name="2298"></a><a name="IDX-754"></a>zero, lines 10<span class="unicode">-</span>11 report that the matrix is singular. To pivot, we exchange <i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">k</i>'] with <i class="emphasis"><span class="unicode">&pi;</span></i>[<i class="emphasis">k</i>] in line 12 and exchange the <i class="emphasis">k</i>th and <i class="emphasis">k</i>'th rows of <i class="emphasis">A</i> in lines 13<span class="unicode">-</span>14, thereby making the pivot element <i class="emphasis">a<sub>kk</sub></i>. (The entire rows are swapped because in the derivation of the method above, not only is <i class="emphasis">A</i><span class="unicode">&prime;</span> - <i class="emphasis">vw</i><sup>T</sup>/<i class="emphasis">a</i><sub><i class="emphasis">k</i>1</sub> multiplied by <i class="emphasis">P</i><span class="unicode">&prime;</span>, but so is <i class="emphasis">v</i>/<i class="emphasis">a</i><sub><i class="emphasis">k</i>1</sub>.) Finally, the Schur complement is computed by lines 15<span class="unicode">-</span>18 in much the same way as it is computed by lines 4<span class="unicode">-</span>9 of LU-DECOMPOSITION, except that here the operation is written to work "in place."</p>
<div class="figure">
<a name="2299"></a><a name="ch28fig02"></a><span class="figuremediaobject"><a href="images/fig775%5F01%5F0%2Ejpg" NAME="IMG_1000" target="_parent"><img src="images/fig775_01.jpg" height="279" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 28.2: </span>The operation of LUP-DECOMPOSITION. <i class="emphasis">(a)</i> The input matrix <i class="emphasis">A</i> with the identity permutation of the rows on the left. The first step of the algorithm determines that the element 5 in the black circle in the third row is the pivot for the first column. <i class="emphasis">(b)</i> Rows 1 and 3 are swapped and the permutation is updated. The shaded column and row represent <i class="emphasis">v</i> and <i class="emphasis">w</i><sup>T</sup>. <i class="emphasis">(c)</i> The vector <i class="emphasis">v</i> is replaced by <i class="emphasis">v</i>/5, and the lower right of the matrix is updated with the Schur complement. Lines divide the matrix into three regions: elements of <i class="emphasis">U</i> (above), elements of <i class="emphasis">L</i> (left), and elements of the Schur complement (lower right). <i class="emphasis">(d)</i><span class="unicode">-</span><i class="emphasis">(f)</i> The second step. <i class="emphasis">(g)</i><span class="unicode">-</span><i class="emphasis">(i)</i> The third step. No further changes occur on the fourth, and final, step. <i class="emphasis">(j)</i> The LUP decomposition <i class="emphasis">PA</i> = <i class="emphasis">LU</i>.</span>
</div>
<p class="para">Because of its triply nested loop structure, LUP-DECOMPOSITION has a running time of <span class="unicode">&Theta;</span>(<i class="emphasis">n</i><sup>3</sup>), which is the same as that of LU-DECOMPOSITION. Thus, pivoting costs us at most a constant factor in time.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 28.3-1</span></span><a name="2300"></a><a name="ch28ex24"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Solve the equation</p>
<p class="para">
<div class="informalequation">
<span class="equation-image"><img src="images/fig776_01.jpg" height="55" width="203" alt="" border="0"></span>
</div>
</p>
<p class="last-para">by using forward substitution.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 28.3-2</span></span><a name="2301"></a><a name="ch28ex25"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Find an LU decomposition of the matrix</p>
<p class="last-para">
<div class="informalequation">
<span class="equation-image"><img src="images/fig776_02.jpg" height="56" width="115" alt="" border="0"></span>
</div>
</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 28.3-3</span></span><a name="2302"></a><a name="ch28ex26"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Solve the equation</p>
<p class="para">
<div class="informalequation">
<span class="equation-image"><img src="images/fig776_03.jpg" height="56" width="188" alt="" border="0"></span>
</div>
</p>
<p class="last-para">by using an LUP decomposition.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 28.3-4</span></span><a name="2303"></a><a name="ch28ex27"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Describe the LUP decomposition of a diagonal matrix.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 28.3-5</span></span><a name="2304"></a><a name="ch28ex28"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Describe the LUP decomposition of a permutation matrix <i class="emphasis">A</i>, and prove that it is unique.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="2305"></a><a name="IDX-755"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 28.3-6</span></span><a name="2306"></a><a name="ch28ex29"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that for all <i class="emphasis">n</i> <span class="unicode">&ge;</span> 1, there exists a singular <i class="emphasis">n</i> <span class="unicode">&times;</span> <i class="emphasis">n</i> matrix that has an LU decomposition.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 28.3-7</span></span><a name="2307"></a><a name="ch28ex30"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">In LU-DECOMPOSITION, is it necessary to perform the outermost <b class="bold">for</b> loop iteration when <i class="emphasis">k</i> = <i class="emphasis">n</i>? How about in LUP-DECOMPOSITION?</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0177.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0179.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
