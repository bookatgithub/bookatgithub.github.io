<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>31.2 Greatest common divisor</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0200.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0202.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch31"></a>
<div class="section">
<h2 class="first-section-title">
<a name="2665"></a><a name="ch31lev1sec2"></a><span class="section-titlelabel">31.2 </span>Greatest common divisor</h2>
<p class="first-para">In this section, we describe Euclid's algorithm for computing the greatest common divisor of two integers efficiently. The analysis of running time brings up a surprising connection with the Fibonacci numbers, which yield a worst-case input for Euclid's algorithm.</p>
<p class="para">We restrict ourselves in this section to nonnegative integers. This restriction is justified by <a href="DDU0200.html#2638" target="_parent" class="chapterjump">equation (31.8)</a>, which states that gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>) = gcd(|<i class="emphasis">a</i>|, |<i class="emphasis">b</i>|).</p>
<p class="para">In principle, we can compute gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>) for positive integers <i class="emphasis">a</i> and <i class="emphasis">b</i> from the prime factorizations of <i class="emphasis">a</i> and <i class="emphasis">b</i>. Indeed, if</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.11)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig878_01.jpg" height="18" width="135" alt="" border="0"></span></td>
</tr>
</table>
</div>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.12)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig878_02.jpg" height="21" width="137" alt="" border="0"></span></td>
</tr>
</table>
</div>
<a name="2666"></a><a name="IDX-857"></a>
<p class="para">with zero exponents being used to make the set of primes <i class="emphasis">p</i><sub>1</sub>, <i class="emphasis">p</i><sub>2</sub>, ..., <i class="emphasis">p<sub>r</sub></i> the same for both <i class="emphasis">a</i> and <i class="emphasis">b</i>, then, as <a class="internaljump" href="#ch31ex24">Exercise 31.2-1</a> asks you to show,</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.13)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig879_01.jpg" height="22" width="273" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">As we shall show in <a href="DDU0208.html#2799" target="_parent" class="chapterjump">Section 31.9</a>, however, the best algorithms to date for factoring do not run in polynomial time. Thus, this approach to computing greatest common divisors seems unlikely to yield an efficient algorithm.</p>
<p class="para">Euclid's algorithm for computing greatest common divisors is based on the following theorem.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.9: </span>(GCD recursion theorem)</span><a name="2667"></a><a name="ch31ex21"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">For any nonnegative integer <i class="emphasis">a</i> and any positive integer <i class="emphasis">b</i>,</p>
<p class="para">gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>) = gcd(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>).</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> We shall show that gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>) and gcd(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>) divide each other, so that by <a href="DDU0200.html#2637" target="_parent" class="chapterjump">equation (31.5)</a> they must be equal (since they are both nonnegative).</p>
<p class="para">We first show that gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>) | gcd(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>). If we let <i class="emphasis">d</i> = gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>), then <i class="emphasis">d</i> | <i class="emphasis">a</i> and <i class="emphasis">d</i> | <i class="emphasis">b</i>. By <a href="DDU0200.html#2638" target="_parent" class="chapterjump">equation (3.8)</a>, (<i class="emphasis">a</i> mod <i class="emphasis">b</i>) = <i class="emphasis">a</i> - <i class="emphasis">qb</i>, where <i class="emphasis">q</i> = <span class="unicode">&lfloor;</span><i class="emphasis">a</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span>. Since (<i class="emphasis">a</i> mod <i class="emphasis">b</i>) is thus a linear combination of <i class="emphasis">a</i> and <i class="emphasis">b</i>, <a href="DDU0200.html#2636" target="_parent" class="chapterjump">equation (31.4)</a> implies that <i class="emphasis">d</i> | (<i class="emphasis">a</i> mod <i class="emphasis">b</i>). Therefore, since <i class="emphasis">d</i> | <i class="emphasis">b</i> and <i class="emphasis">d</i> | (<i class="emphasis">a</i> mod <i class="emphasis">b</i>), <a href="DDU0200.html#2642" target="_parent" class="chapterjump">Corollary 31.3</a> implies that <i class="emphasis">d</i> | gcd(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>) or, equivalently, that</p>
<p class="para">
<div class="equation">
<a name="2668"></a><a name="ch31eq14"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.14)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig879_02.jpg" height="17" width="169" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="para">Showing that gcd(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>) | gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>) is almost the same. If we now let <i class="emphasis">d</i> = gcd(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>), then <i class="emphasis">d</i> | <i class="emphasis">b</i> and <i class="emphasis">d</i> | (<i class="emphasis">a</i> mod <i class="emphasis">b</i>). Since <i class="emphasis">a</i> = <i class="emphasis">qb</i> + (<i class="emphasis">a</i> mod <i class="emphasis">b</i>), where <i class="emphasis">q</i> = <span class="unicode">&lfloor;</span><i class="emphasis">a</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span>, we have that <i class="emphasis">a</i> is a linear combination of <i class="emphasis">b</i> and (<i class="emphasis">a</i> mod <i class="emphasis">b</i>). By <a href="DDU0200.html#2636" target="_parent" class="chapterjump">equation (31.4)</a>, we conclude that <i class="emphasis">d</i> | <i class="emphasis">a</i>. Since <i class="emphasis">d</i> | <i class="emphasis">b</i> and <i class="emphasis">d</i> | <i class="emphasis">a</i>, we have that <i class="emphasis">d</i> | gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>) by <a href="DDU0200.html#2642" target="_parent" class="chapterjump">Corollary 31.3</a> or, equivalently, that</p>
<p class="para">
<div class="equation">
<a name="2669"></a><a name="ch31eq15"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.15)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig879_03.jpg" height="17" width="169" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="last-para">Using <a href="DDU0200.html#2637" target="_parent" class="chapterjump">equation (31.5)</a> to combine <a class="internaljump" href="#ch31eq14">equations (31.14)</a> and <a class="internaljump" href="#ch31eq15">(31.15)</a> completes the proof.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="section">
<h4 class="sect4-title">
<a name="2670"></a><a name="ch31lev3sec8"></a>Euclid's algorithm</h4>
<p class="first-para">The <i class="emphasis">Elements</i> of Euclid (<i class="emphasis">circa</i> 300 B.C.) describes the following gcd algorithm, although it may be of even earlier origin. Euclid's algorithm is expressed as a recursive program based directly on <a class="internaljump" href="#ch31ex21">Theorem 31.9</a>. The inputs <i class="emphasis">a</i> and <i class="emphasis">b</i> are arbitrary nonnegative integers.<a name="2671"></a><a name="IDX-858"></a>
</p>
<div class="informalexample">
<pre class="literallayout-normal">
EUCLID(<i class="emphasis">a</i>, <i class="emphasis">b</i>)
1  <b class="bold">if</b> <i class="emphasis">b</i> = 0
2    <b class="bold">then return</b> <i class="emphasis">a</i>
3    <b class="bold">else return</b> EUCLID(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>)
</pre>
</div>
<p class="para">As an example of the running of EUCLID, consider the computation of gcd(30, 21):</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">EUCLID(30, 21)</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">EUCLID(21,9)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">EUCLID(9,3)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">EUCLID(3,0)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">3.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">In this computation, there are three recursive invocations of EUCLID.</p>
<p class="last-para">The correctness of EUCLID follows from <a class="internaljump" href="#ch31ex21">Theorem 31.9</a> and the fact that if the algorithm returns <i class="emphasis">a</i> in line 2, then <i class="emphasis">b</i> = 0, so <a href="DDU0200.html#2639" target="_parent" class="chapterjump">equation (31.9)</a> implies that gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>) = gcd(<i class="emphasis">a</i>, 0) = <i class="emphasis">a</i>. The algorithm cannot recurse indefinitely, since the second argument strictly decreases in each recursive call and is always nonnegative. Therefore, EUCLID always terminates with the correct answer.</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="2672"></a><a name="ch31lev3sec9"></a>The running time of Euclid's algorithm</h4>
<p class="first-para">We analyze the worst-case running time of EUCLID as a function of the size of <i class="emphasis">a</i> and <i class="emphasis">b</i>. We assume with no loss of generality that <i class="emphasis">a</i> <span class="unicode">&gt;</span> <i class="emphasis">b</i> <span class="unicode">&ge;</span> 0. This assumption can be justified by the observation that if <i class="emphasis">b</i> <span class="unicode">&gt;</span> <i class="emphasis">a</i> <span class="unicode">&ge;</span> 0, then EUCLID(<i class="emphasis">a</i>, <i class="emphasis">b</i>) immediately makes the recursive call EUCLID(<i class="emphasis">b</i>, <i class="emphasis">a</i>). That is, if the first argument is less than the second argument, EUCLID spends one recursive call swapping its arguments and then proceeds. Similarly, if <i class="emphasis">b</i> = <i class="emphasis">a</i> <span class="unicode">&gt;</span> 0, the procedure terminates after one recursive call, since <i class="emphasis">a</i> mod <i class="emphasis">b</i> = 0.</p>
<p class="para">The overall running time of EUCLID is proportional to the number of recursive calls it makes. Our analysis makes use of the Fibonacci numbers <i class="emphasis">F<sub>k</sub></i>, defined by the recurrence (<a href="DDU0020.html#198" target="_parent" class="chapterjump">3.21</a>).</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Lemma 31.10</span></span>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">If <i class="emphasis">a</i> <span class="unicode">&gt;</span> <i class="emphasis">b</i> <span class="unicode">&ge;</span> 1 and the invocation EUCLID(<i class="emphasis">a</i>, <i class="emphasis">b</i>) performs <i class="emphasis">k</i> <span class="unicode">&ge;</span> 1 recursive calls, then <i class="emphasis">a</i> <span class="unicode">&ge;</span> <i class="emphasis">F</i><sub><i class="emphasis">k</i>+2</sub> and <i class="emphasis">b</i> <span class="unicode">&ge;</span> <i class="emphasis">F</i><sub><i class="emphasis">k</i>+1</sub>.</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> The proof is by induction on <i class="emphasis">k</i>. For the basis of the induction, let <i class="emphasis">k</i> = 1. Then, <i class="emphasis">b</i> <span class="unicode">&ge;</span> 1 = <i class="emphasis">F</i><sub>2</sub>, and since <i class="emphasis">a</i> <span class="unicode">&gt;</span> <i class="emphasis">b</i>, we must have <i class="emphasis">a</i> <span class="unicode">&ge;</span> 2 = <i class="emphasis">F</i><sub>3</sub>. Since <i class="emphasis">b</i> <span class="unicode">&gt;</span> (<i class="emphasis">a</i> mod <i class="emphasis">b)</i>, in each recursive call the first argument is strictly larger than the second; the assumption that <i class="emphasis">a</i> <span class="unicode">&gt;</span> <i class="emphasis">b</i> therefore holds for each recursive call.</p>
<p class="para">Assume inductively that the lemma is true if <i class="emphasis">k</i> - 1 recursive calls are made; we shall then prove that it is true for <i class="emphasis">k</i> recursive calls. Since <i class="emphasis">k</i> <span class="unicode">&gt;</span> 0, we have <i class="emphasis">b</i> <span class="unicode">&gt;</span> 0, and <a name="2673"></a><a name="IDX-859"></a>EUCLID(<i class="emphasis">a</i>, <i class="emphasis">b</i>) calls EUCLID(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>) recursively, which in turn makes <i class="emphasis">k</i> - 1 recursive calls. The inductive hypothesis then implies that <i class="emphasis">b</i> <span class="unicode">&ge;</span> <i class="emphasis">F</i><sub><i class="emphasis">k</i>+1</sub> (thus proving part of the lemma), and (<i class="emphasis">a</i> mod <i class="emphasis">b</i>) <span class="unicode">&ge;</span> <i class="emphasis">F<sub>k</sub></i>. We have</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i> + (<i class="emphasis">a</i> mod <i class="emphasis">b</i>)</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i> + (<i class="emphasis">a</i> - <span class="unicode">&lfloor;</span><i class="emphasis">a</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span> <i class="emphasis">b</i>)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&le;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">a</i> ,</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">since <i class="emphasis">a</i> <span class="unicode">&gt;</span> <i class="emphasis">b</i> <span class="unicode">&gt;</span> 0 implies <span class="unicode">&lfloor;</span><i class="emphasis">a</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span> <span class="unicode">&ge;</span> 1. Thus,</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">a</i>
</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&ge;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i> + (<i class="emphasis">a</i> mod <i class="emphasis">b</i>)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&ge;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">F</i><sub><i class="emphasis">k</i>+1</sub> + <i class="emphasis">F<sub>k</sub></i>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">F</i><sub><i class="emphasis">k</i>+2</sub> .</p>
</td>
</tr>
</tbody>
</table>
</div>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">The following theorem is an immediate corollary of this lemma.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.11: </span>(Lam<span class="unicode">&eacute;</span>'s theorem)</span><a name="2674"></a><a name="ch31ex23"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">For any integer <i class="emphasis">k</i> <span class="unicode">&ge;</span> 1, if <i class="emphasis">a</i> <span class="unicode">&gt;</span> <i class="emphasis">b</i> <span class="unicode">&ge;</span> 1 and <i class="emphasis">b</i> <span class="unicode">&lt;</span> <i class="emphasis">F</i><sub><i class="emphasis">k</i>+1</sub>, then the call EUCLID(<i class="emphasis">a</i>, <i class="emphasis">b</i>) makes fewer than <i class="emphasis">k</i> recursive calls.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">We can show that the upper bound of <a class="internaljump" href="#ch31ex23">Theorem 31.11</a> is the best possible. Consecutive Fibonacci numbers are a worst-case input for EUCLID. Since EUCLID(<i class="emphasis">F</i><sub>3</sub>, <i class="emphasis">F</i><sub>2</sub>) makes exactly one recursive call, and since for <i class="emphasis">k</i> <span class="unicode">&gt;</span> 2 we have <i class="emphasis">F</i><sub><i class="emphasis">k</i>+1</sub> mod <i class="emphasis">F<sub>k</sub></i> = <i class="emphasis">F</i><sub><i class="emphasis">k</i>-1</sub>, we also have</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">gcd(<i class="emphasis">F</i><sub><i class="emphasis">k</i>+1</sub>, <i class="emphasis">F<sub>k</sub></i>)</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">gcd(<i class="emphasis">F<sub>k</sub></i>, (<i class="emphasis">F</i><sub><i class="emphasis">k</i>+1</sub> mod <i class="emphasis">F<sub>k</sub></i>))</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">gcd(<i class="emphasis">F<sub>k</sub></i>, <i class="emphasis">F</i><sub><i class="emphasis">k</i>-1</sub>).</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">Thus, EUCLID(<i class="emphasis">F</i><sub><i class="emphasis">k</i>+1</sub>, <i class="emphasis">F<sub>k</sub></i>) recurses <i class="emphasis">exactly k</i> - 1 times, meeting the upper bound of <a class="internaljump" href="#ch31ex23">Theorem 31.11</a>.</p>
<p class="last-para">Since <i class="emphasis">F<sub>k</sub></i> is approximately <span class="inlinemediaobject"><img src="images/fig881_01.jpg" height="14" width="33" alt="" border="0"></span>, where <i class="emphasis"><span class="unicode">&phi;</span></i> is the golden ratio <span class="inlinemediaobject"><img src="images/fig881_02.jpg" height="14" width="53" alt="" border="0"></span> defined by <a href="DDU0203.html#2719" target="_parent" class="chapterjump">equation (3.22)</a>, the number of recursive calls in EUCLID is <i class="emphasis">O</i>(lg <i class="emphasis">b</i>). (See <a class="internaljump" href="#ch31ex28">Exercise 31.2-5</a> for a tighter bound.) It follows that if EUCLID is applied to two <i class="emphasis"><span class="unicode">&beta;</span></i>-bit numbers, then it will perform <i class="emphasis">O</i>(<i class="emphasis"><span class="unicode">&beta;</span></i>) arithmetic operations and <i class="emphasis">O</i>(<i class="emphasis"><span class="unicode">&beta;</span></i><sup>3</sup>) bit operations (assuming that multiplication and division of <i class="emphasis"><span class="unicode">&beta;</span></i>-bit numbers take <i class="emphasis">O</i>(<i class="emphasis"><span class="unicode">&beta;</span></i><sup>2</sup>) bit operations). <a href="DDU0208.html#2814" target="_parent" class="chapterjump">Problem 31-2</a> asks you to show an <i class="emphasis">O</i>(<i class="emphasis"><span class="unicode">&beta;</span></i><sup>2</sup>) bound on the number of bit operations.</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="2675"></a><a name="ch31lev3sec10"></a>The extended form of Euclid's algorithm</h4>
<p class="first-para">We now rewrite Euclid's algorithm to compute additional useful information. Specifically, we extend the algorithm to compute the integer coefficients <i class="emphasis">x</i> and <i class="emphasis">y</i> such that<a name="2676"></a><a name="IDX-860"></a>
</p>
<div class="equation">
<a name="2677"></a><a name="ch31eq16"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.16)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig882_01.jpg" height="17" width="161" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">Note that <i class="emphasis">x</i> and <i class="emphasis">y</i> may be zero or negative. We shall find these coefficients useful later for the computation of modular multiplicative inverses. The procedure EXTENDED-EUCLID takes as input a pair of nonnegative integers and returns a triple of the form (<i class="emphasis">d</i>, <i class="emphasis">x</i>, <i class="emphasis">y</i>) that satisfies <a class="internaljump" href="#ch31eq16">equation (31.16)</a>.</p>
<div class="informalexample">
<pre class="literallayout-normal">
EXTENDED-EUCLID(<i class="emphasis">a</i>, <i class="emphasis">b</i>)
1  <b class="bold">if</b> <i class="emphasis">b</i> = 0
2     <b class="bold">then return</b> (<i class="emphasis">a</i>, 1, 0)
3  (<i class="emphasis">d</i><span class="unicode">&prime;</span>, <i class="emphasis">x</i><span class="unicode">&prime;</span>, <i class="emphasis">y</i><span class="unicode">&prime;</span>) <span class="unicode">&larr;</span> EXTENDED-EUCLID(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>)
4  (<i class="emphasis">d</i>, <i class="emphasis">x</i>, <i class="emphasis">y</i>) <span class="unicode">&larr;</span> (<i class="emphasis">d</i><span class="unicode">&prime;</span>, <i class="emphasis">y</i><span class="unicode">&prime;</span>, <i class="emphasis">x</i><span class="unicode">&prime;</span>- <span class="unicode">&lfloor;</span><i class="emphasis">a</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span> <i class="emphasis">y</i><span class="unicode">&prime;</span>)
5  <b class="bold">return</b> (<i class="emphasis">d</i>, <i class="emphasis">x</i>, <i class="emphasis">y</i>)
</pre>
</div>
<p class="para">
<a class="internaljump" href="#ch31fig01">Figure 31.1</a> illustrates the execution of EXTENDED-EUCLID with the computation of gcd(99, 78).</p>
<div class="miscfigure">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start Figure" border="0"></b></font></td>
</tr>
</table>
<a name="2678"></a><a name="ch31fig01"></a>
<div class="miscfigure-informaltable">
<table border="0">
<thead>
<tr valign="top">
<th class="th" scope="col" align="center">
<p class="table-para">
<i class="emphasis">a</i>
</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">
<i class="emphasis">b</i>
</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">
<span class="unicode">&lfloor;</span><i class="emphasis">a</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span>
</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">
<i class="emphasis">d</i>
</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">
<i class="emphasis">x</i>
</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">
<i class="emphasis">y</i>
</p>
</th>
</tr>
<tr>
<td colspan="6">
<hr>
</td>
</tr>
</thead>
<tbody>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">99</p>
</td><td class="td" align="center">
<p class="table-para">78</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">-11</p>
</td><td class="td" align="center">
<p class="table-para">14</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">78</p>
</td><td class="td" align="center">
<p class="table-para">21</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">-11</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">21</p>
</td><td class="td" align="center">
<p class="table-para">15</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">-2</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">15</p>
</td><td class="td" align="center">
<p class="table-para">6</p>
</td><td class="td" align="center">
<p class="table-para">2</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">-2</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">6</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">2</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">-</span>
</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td>
</tr>
</tbody>
</table>
</div>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End Figure" border="0"></b></font></td>
</tr>
</table>
<br style="line-height: 1">
<span class="miscfigure-title"><span class="figure-titlelabel">Figure 31.1: </span>An example of the operation of EXTENDED-EUCLID on the inputs 99 and 78. Each line shows one level of the recursion: the values of the inputs <i class="emphasis">a</i> and <i class="emphasis">b</i>, the computed value <span class="unicode">&lfloor;</span><i class="emphasis">a/b</i><span class="unicode">&rfloor;</span>, and the values <i class="emphasis">d, x</i>, and <i class="emphasis">y</i> returned. The triple (<i class="emphasis">d, x, y</i>) returned becomes the triple (<i class="emphasis">d<span class="unicode">&prime;</span>, x<span class="unicode">&prime;</span>, y<span class="unicode">&prime;</span></i>) used in the computation at the next higher level of recursion. The call EXTENDED-EUCLID(99, 78) returns (3, -11, 14), so gcd(99, 78) = 3 and gcd(99, 78) = 3 = 99 <span class="unicode">&middot;</span> (-11) + 78 <span class="unicode">&middot;</span> 14.</span>
</div>
<p class="para">The EXTENDED-EUCLID procedure is a variation of the EUCLID procedure. Line 1 is equivalent to the test "<i class="emphasis">b</i> = 0" in line 1 of EUCLID. If <i class="emphasis">b</i> = 0, then EXTENDED-EUCLID returns not only <i class="emphasis">d</i> = <i class="emphasis">a</i> in line 2, but also the coefficients <i class="emphasis">x</i> = 1 and <i class="emphasis">y</i> = 0, so that <i class="emphasis">a</i> = <i class="emphasis">ax</i> + <i class="emphasis">by</i>. If <i class="emphasis">b</i> <span class="unicode">&ne;</span> 0, EXTENDED-EUCLID first computes (<i class="emphasis">d</i><span class="unicode">&prime;</span>, <i class="emphasis">x</i><span class="unicode">&prime;</span>, <i class="emphasis">y</i><span class="unicode">&prime;</span>) such that <i class="emphasis">d</i><span class="unicode">&prime;</span>= gcd(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>) and</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.17)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig882_02.jpg" height="17" width="149" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">As for EUCLID, we have in this case <i class="emphasis">d</i> = gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>) = <i class="emphasis">d</i><span class="unicode">&prime;</span> = gcd(<i class="emphasis">b</i>, <i class="emphasis">a</i> mod <i class="emphasis">b</i>). To obtain <i class="emphasis">x</i> and <i class="emphasis">y</i> such that <i class="emphasis">d</i> = <i class="emphasis">ax</i> + <i class="emphasis">by</i>, we start by rewriting <a href="DDU0200.html#2661" target="_parent" class="chapterjump">equation (31.17)</a> using the equation <i class="emphasis">d</i> = <i class="emphasis">d</i><span class="unicode">&prime;</span> and <a href="DDU0200.html#2651" target="_parent" class="chapterjump">equation (3.8)</a>:</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">d</i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">bx</i><span class="unicode">&prime;</span> + (<i class="emphasis">a</i> - <span class="unicode">&lfloor;</span><i class="emphasis">a</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span> <i class="emphasis">b</i>)<i class="emphasis">y</i><span class="unicode">&prime;</span>
</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">ay</i><span class="unicode">&prime;</span> + <i class="emphasis">b</i>(<i class="emphasis">x</i><span class="unicode">&prime;</span> - <span class="unicode">&lfloor;</span><i class="emphasis">a</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span> <i class="emphasis">y</i><span class="unicode">&prime;</span>).</p>
</td>
</tr>
</tbody>
</table>
</div>
<a name="2679"></a><a name="IDX-861"></a>
<p class="para">Thus, choosing <i class="emphasis">x</i> = <i class="emphasis">y</i><span class="unicode">&prime;</span> and <i class="emphasis">y</i> = <i class="emphasis">x</i><span class="unicode">&prime;</span> - <span class="unicode">&lfloor;</span><i class="emphasis">a</i>/<i class="emphasis">b</i><span class="unicode">&rfloor;</span> <i class="emphasis">y</i><span class="unicode">&prime;</span> satisfies the equation <i class="emphasis">d</i> = <i class="emphasis">ax</i> + <i class="emphasis">by</i>, proving the correctness of EXTENDED-EUCLID.</p>
<p class="para">Since the number of recursive calls made in EUCLID is equal to the number of recursive calls made in EXTENDED-EUCLID, the running times of EUCLID and EXTENDED-EUCLID are the same, to within a constant factor. That is, for <i class="emphasis">a</i> <span class="unicode">&gt;</span> <i class="emphasis">b</i> <span class="unicode">&gt;</span> 0, the number of recursive calls is <i class="emphasis">O</i>(lg <i class="emphasis">b</i>).</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.2-1</span></span><a name="2680"></a><a name="ch31ex24"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Prove that <a href="DDU0200.html#2654" target="_parent" class="chapterjump">equations (31.11)</a> and <a href="DDU0200.html#2655" target="_parent" class="chapterjump">(31.12)</a> imply <a href="DDU0200.html#2656" target="_parent" class="chapterjump">equation (31.13)</a>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.2-2</span></span><a name="2681"></a><a name="ch31ex25"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Compute the values (<i class="emphasis">d</i>, <i class="emphasis">x</i>, <i class="emphasis">y</i>) that the call EXTENDED-EUCLID(899, 493) returns.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.2-3</span></span><a name="2682"></a><a name="ch31ex26"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Prove that for all integers <i class="emphasis">a</i>, <i class="emphasis">k</i>, and <i class="emphasis">n</i>,</p>
<p class="last-para">gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) = gcd(<i class="emphasis">a</i> + <i class="emphasis">kn</i>, <i class="emphasis">n</i>).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.2-4</span></span><a name="2683"></a><a name="ch31ex27"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Rewrite EUCLID in an iterative form that uses only a constant amount of memory (that is, stores only a constant number of integer values).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.2-5</span></span><a name="2684"></a><a name="ch31ex28"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">If <i class="emphasis">a</i> <span class="unicode">&gt;</span> <i class="emphasis">b</i> <span class="unicode">&ge;</span> 0, show that the invocation EUCLID(<i class="emphasis">a</i>, <i class="emphasis">b</i>) makes at most 1 + log<i class="emphasis"><sub><i class="emphasis"><span class="unicode">&phi;</span></i></sub></i> <i class="emphasis">b</i> recursive calls. Improve this bound to 1 + log<sub><i class="emphasis"><span class="unicode">&phi;</span></i></sub>(<i class="emphasis">b</i>/ gcd(<i class="emphasis">a</i>, <i class="emphasis">b</i>)).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.2-6</span></span><a name="2685"></a><a name="ch31ex29"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">What does EXTENDED-EUCLID(<i class="emphasis">F</i><sub><i class="emphasis">k</i>+1</sub>, <i class="emphasis">F<sub>k</sub></i>) return? Prove your answer correct.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.2-7</span></span><a name="2686"></a><a name="ch31ex30"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Define the gcd function for more than two arguments by the recursive equation gcd(<i class="emphasis">a</i><sub>0</sub>, <i class="emphasis">a</i><sub>1</sub>, ..., <i class="emphasis">a<sub>n</sub></i>) = gcd(<i class="emphasis">a</i><sub>0</sub>, gcd(<i class="emphasis">a</i><sub>1</sub>, <i class="emphasis">a</i><sub>2</sub>, ..., <i class="emphasis">a</i><sub><i class="emphasis">n</i></sub>)). Show that the gcd function returns the same answer independent of the order in which its arguments are specified. Also show how to find integers <i class="emphasis">x</i><sub>0</sub>, <i class="emphasis">x</i><sub>1</sub>, ..., <i class="emphasis">x<sub>n</sub></i> such that gcd(<i class="emphasis">a</i><sub>0</sub>, <i class="emphasis">a</i><sub>1</sub>, ..., <i class="emphasis">a<sub>n</sub></i>) = <i class="emphasis">a</i><sub>0</sub><i class="emphasis">x</i><sub>0</sub> + <i class="emphasis">a</i><sub>1</sub><i class="emphasis">x</i><sub>1</sub> + <span class="unicode">&middot;</span><span class="unicode">&middot;</span><span class="unicode">&middot;</span> + <i class="emphasis">a<sub>n</sub></i><i class="emphasis">x<sub>n</sub></i>. Show that the number of divisions performed by your algorithm is <i class="emphasis">O</i>(<i class="emphasis">n</i> + lg(max {<i class="emphasis">a</i><sub>0</sub>, <i class="emphasis">a</i><sub>1</sub>, ..., <i class="emphasis">a<sub>n</sub></i>})).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.2-8</span></span><a name="2687"></a><a name="ch31ex31"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Define lcm(<i class="emphasis">a</i><sub>1</sub>, <i class="emphasis">a</i><sub>2</sub>, ..., <i class="emphasis">a<sub>n</sub></i>) to be the <b class="bold"><i class="emphasis">least common multiple</i></b> of the <i class="emphasis">n</i> integers <i class="emphasis">a</i><sub>1</sub>, <i class="emphasis">a</i><sub>2</sub>, ..., <i class="emphasis">a<sub>n</sub></i>, that is, the least nonnegative integer that is a multiple of each <i class="emphasis">a<sub>i</sub></i>. <a name="2688"></a><a name="IDX-862"></a>Show how to compute lcm(<i class="emphasis">a</i><sub>1</sub>, <i class="emphasis">a</i><sub>2</sub>, ..., <i class="emphasis">a<sub>n</sub></i>) efficiently using the (two-argument) gcd operation as a subroutine.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.2-9</span></span><a name="2689"></a><a name="ch31ex32"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Prove that <i class="emphasis">n</i><sub>1</sub>, <i class="emphasis">n</i><sub>2</sub>, <i class="emphasis">n</i><sub>3</sub>, and <i class="emphasis">n</i><sub>4</sub> are pairwise relatively prime if and only if</p>
<p class="para">gcd(<i class="emphasis">n</i><sub>1</sub><i class="emphasis">n</i><sub>2</sub>, <i class="emphasis">n</i><sub>3</sub><i class="emphasis">n</i><sub>4</sub>) = gcd(<i class="emphasis">n</i><sub>1</sub><i class="emphasis">n</i><sub>3</sub>, <i class="emphasis">n</i><sub>2</sub><i class="emphasis">n</i><sub>4</sub>) = 1.</p>
<p class="last-para">Show more generally that <i class="emphasis">n</i><sub>1</sub>, <i class="emphasis">n</i><sub>2</sub>, ..., <i class="emphasis">n<sub>k</sub></i> are pairwise relatively prime if and only if a set of <span class="unicode">&lceil;</span>lg <i class="emphasis">k</i><span class="unicode">&rceil;</span> pairs of numbers derived from the <i class="emphasis">n<sub>i</sub></i> are relatively prime.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0200.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0202.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
