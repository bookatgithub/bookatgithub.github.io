<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>31.4 Solving modular linear equations</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0202.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0204.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch31"></a>
<div class="section">
<h2 class="first-section-title">
<a name="2715"></a><a name="ch31lev1sec4"></a><span class="section-titlelabel">31.4 </span>Solving modular linear equations</h2>
<a name="2716"></a><a name="IDX-869"></a>
<p class="para">We now consider the problem of finding solutions to the equation</p>
<div class="equation">
<a name="2717"></a><a name="ch31eq21"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.21)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig891_01.jpg" height="15" width="112" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">where <i class="emphasis">a</i> <span class="unicode">&gt;</span> 0 and <i class="emphasis">n</i> <span class="unicode">&gt;</span> 0. There are several applications for this problem; for example, we will use it as part of the procedure for finding keys in the RSA public-key cryptosystem in <a href="DDU0206.html#2762" target="_parent" class="chapterjump">Section 31.7.</a> We assume that <i class="emphasis">a</i>, <i class="emphasis">b</i>, and <i class="emphasis">n</i> are given, and we are to find all values of <i class="emphasis">x</i>, modulo <i class="emphasis">n</i>, that satisfy <a class="internaljump" href="#ch31eq21">equation (31.21)</a>. There may be zero, one, or more than one such solution.</p>
<p class="para">Let <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span> denote the subgroup of <b class="bold">Z</b><sub><i class="emphasis">n</i></sub> generated by <i class="emphasis">a</i>. Since <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span> = {<i class="emphasis">a</i><sup>(<i class="emphasis">x</i>)</sup> : <i class="emphasis">x</i> <span class="unicode">&gt;</span> 0} = {<i class="emphasis">ax</i> mod <i class="emphasis">n</i> : <i class="emphasis">x</i> <span class="unicode">&gt;</span> 0}, <a href="DDU0201.html#2667" target="_parent" class="chapterjump">equation (31.21)</a> has a solution if and only if <i class="emphasis">b</i> <span class="unicode">&isin;</span> <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>. Lagrange's theorem (<a href="DDU0202.html#2702" target="_parent" class="chapterjump">Theorem 31.15</a>) tells us that |<span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>| must be a divisor of <i class="emphasis">n</i>. The following theorem gives us a precise characterization of <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.20</span></span><a name="2718"></a><a name="ch31ex46"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">For any positive integers <i class="emphasis">a</i> and <i class="emphasis">n</i>, if <i class="emphasis">d</i> = gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>), then</p>
<p class="para">
<div class="equation">
<a name="2719"></a><a name="ch31eq22"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.22)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig891_02.jpg" height="16" width="257" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="para">in <b class="bold">Z</b><sub><i class="emphasis">n</i></sub>, and thus</p>
<p class="para">|<span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>| = <i class="emphasis">n</i>/<i class="emphasis">d</i>.</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> We begin by showing that <i class="emphasis">d</i> <span class="unicode">&isin;</span> <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>. Recall that EXTENDED-EUCLID(<i class="emphasis">a</i>, <i class="emphasis">n</i>) produces integers <i class="emphasis">x</i><span class="unicode">&prime;</span> and <i class="emphasis">y</i><span class="unicode">&prime;</span> such that <i class="emphasis">ax</i><span class="unicode">&prime;</span> + <i class="emphasis">ny</i><span class="unicode">&prime;</span> = <i class="emphasis">d</i>. Thus, <i class="emphasis">ax</i><span class="unicode">&prime;</span> <span class="unicode">&equiv;</span> <i class="emphasis">d</i> (mod <i class="emphasis">n</i>), so that <i class="emphasis">d</i> <span class="unicode">&isin;</span> <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>.</p>
<p class="para">Since <i class="emphasis">d</i> <span class="unicode">&isin;</span> <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>, it follows that every multiple of <i class="emphasis">d</i> belongs to <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>, because any multiple of a multiple of <i class="emphasis">a</i> is itself a multiple of <i class="emphasis">a</i>. Thus, <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span> contains every element in {0, <i class="emphasis">d</i>, 2<i class="emphasis">d</i>, ..., ((<i class="emphasis">n</i>/<i class="emphasis">d</i>) - 1)<i class="emphasis">d</i>}. That is, <span class="unicode">&#12296;</span><i class="emphasis">d</i><span class="unicode">&#12297;</span> <span class="unicode">&sube;</span> <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>.</p>
<p class="para">We now show that <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span> <span class="unicode">&sube;</span> <span class="unicode">&#12296;</span><i class="emphasis">d</i><span class="unicode">&#12297;</span>. If <i class="emphasis">m</i> <span class="unicode">&isin;</span> <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>, then <i class="emphasis">m</i> = <i class="emphasis">ax</i> mod <i class="emphasis">n</i> for some integer <i class="emphasis">x</i>, and so <i class="emphasis">m</i> = <i class="emphasis">ax</i> + <i class="emphasis">ny</i> for some integer <i class="emphasis">y</i>. However, <i class="emphasis">d</i> | <i class="emphasis">a</i> and <i class="emphasis">d</i> | <i class="emphasis">n</i>, and so <i class="emphasis">d</i> | <i class="emphasis">m</i> by <a href="DDU0200.html#2643" target="_parent" class="chapterjump">equation (31.4)</a>. Therefore, <i class="emphasis">m</i> <span class="unicode">&isin;</span> <span class="unicode">&#12296;</span><i class="emphasis">d</i><span class="unicode">&#12297;</span>.</p>
<p class="last-para">Combining these results, we have that <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span> = <span class="unicode">&#12296;</span><i class="emphasis">d</i><span class="unicode">&#12297;</span>. To see that |<span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>| = <i class="emphasis">n</i>/<i class="emphasis">d</i>, observe that there are exactly <i class="emphasis">n</i>/<i class="emphasis">d</i> multiples of <i class="emphasis">d</i> between 0 and <i class="emphasis">n</i> - 1, inclusive.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Corollary 31.21</span></span><a name="2720"></a><a name="ch31ex47"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">The equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>) is solvable for the unknown <i class="emphasis">x</i> if and only if gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) | <i class="emphasis">b</i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="2721"></a><a name="IDX-870"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Corollary 31.22</span></span><a name="2722"></a><a name="ch31ex48"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">The equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>) either has <i class="emphasis">d</i> distinct solutions modulo <i class="emphasis">n</i>, where <i class="emphasis">d</i> = gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>), or it has no solutions.</p>
<p class="last-para">
<b class="bold"><i class="emphasis">Proof</i></b> If <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>) has a solution, then <i class="emphasis">b</i> <span class="unicode">&isin;</span> <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>. By <a href="DDU0202.html#2703" target="_parent" class="chapterjump">Theorem 31.17</a>, ord(<i class="emphasis">a</i>) = |<span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>|, and so <a href="DDU0202.html#2708" target="_parent" class="chapterjump">Corollary 31.18</a> and <a class="internaljump" href="#ch31ex46">Theorem 31.20</a> imply that the sequence <i class="emphasis">ai</i> mod <i class="emphasis">n</i>, for <i class="emphasis">i</i> = 0, 1, ..., is periodic with period |<span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>| = <i class="emphasis">n</i>/<i class="emphasis">d</i>. If <i class="emphasis">b</i> <span class="unicode">&isin;</span> <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span>, then <i class="emphasis">b</i> appears exactly <i class="emphasis">d</i> times in the sequence <i class="emphasis">ai</i> mod <i class="emphasis">n</i>, for <i class="emphasis">i</i> = 0, 1, ..., <i class="emphasis">n</i> - 1, since the length-(<i class="emphasis">n</i>/<i class="emphasis">d</i>) block of values <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span> is repeated exactly <i class="emphasis">d</i> times as <i class="emphasis">i</i> increases from 0 to <i class="emphasis">n</i> - 1. The indices <i class="emphasis">x</i> of the <i class="emphasis">d</i> positions for which <i class="emphasis">ax</i> mod <i class="emphasis">n</i> = <i class="emphasis">b</i> are the solutions of the equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.23</span></span><a name="2723"></a><a name="ch31ex49"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">d</i> = gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>), and suppose that <i class="emphasis">d</i> = <i class="emphasis">ax</i><span class="unicode">&prime;</span> + <i class="emphasis">ny</i><span class="unicode">&prime;</span> for some integers <i class="emphasis">x</i><span class="unicode">&prime;</span> and <i class="emphasis">y</i><span class="unicode">&prime;</span> (for example, as computed by EXTENDED-EUCLID). If <i class="emphasis">d</i> | <i class="emphasis">b</i>, then the equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>) has as one of its solutions the value <i class="emphasis">x</i><sub>0</sub>, where</p>
<p class="para">
<i class="emphasis">x</i><sub>0</sub> = <i class="emphasis">x</i><span class="unicode">&prime;</span>(<i class="emphasis">b</i>/<i class="emphasis">d</i>) mod <i class="emphasis">n</i>.</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> We have</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">ax</i><sub>0</sub>
</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&equiv;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">ax</i><span class="unicode">&prime;</span>(<i class="emphasis">b</i>/<i class="emphasis">d</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(mod <i class="emphasis">n</i>)</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&equiv;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">d</i>(<i class="emphasis">b</i>/<i class="emphasis">d</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(mod <i class="emphasis">n</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(because <i class="emphasis">ax</i><span class="unicode">&prime;</span> <span class="unicode">&equiv;</span> <i class="emphasis">d</i> (mod <i class="emphasis">n</i>))</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&equiv;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i>
</p>
</td><td class="td" align="left">
<p class="table-para">(mod <i class="emphasis">n</i>),</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<p class="last-para">and thus <i class="emphasis">x</i><sub>0</sub> is a solution to <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.24</span></span><a name="2724"></a><a name="ch31ex50"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Suppose that the equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>) is solvable (that is, <i class="emphasis">d</i> | <i class="emphasis">b</i>, where <i class="emphasis">d</i> = gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>)) and that <i class="emphasis">x</i><sub>0</sub> is any solution to this equation. Then, this equation has exactly <i class="emphasis">d</i> distinct solutions, modulo <i class="emphasis">n</i>, given by <i class="emphasis">x<sub>i</sub></i> = <i class="emphasis">x</i><sub>0</sub> + <i class="emphasis">i</i>(<i class="emphasis">n</i>/<i class="emphasis">d</i>) for <i class="emphasis">i</i> = 0, 1, ..., <i class="emphasis">d</i> - 1.</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> Since <i class="emphasis">n</i>/<i class="emphasis">d</i> <span class="unicode">&gt;</span> 0 and 0 <span class="unicode">&le;</span> <i class="emphasis">i</i>(<i class="emphasis">n</i>/<i class="emphasis">d</i>) <span class="unicode">&lt;</span> <i class="emphasis">n</i> for <i class="emphasis">i</i> = 0, 1, ..., <i class="emphasis">d</i> - 1, the values <i class="emphasis">x</i><sub>0</sub>, <i class="emphasis">x</i><sub>1</sub>, ..., <i class="emphasis">x</i><sub><i class="emphasis">d</i>-1</sub> are all distinct, modulo <i class="emphasis">n</i>. Since <i class="emphasis">x</i><sub>0</sub> is a solution of <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>), we have <i class="emphasis">ax</i><sub>0</sub> mod <i class="emphasis">n</i> = <i class="emphasis">b</i>. Thus, for <i class="emphasis">i</i> = 0, 1, ..., <i class="emphasis">d</i> - 1, we have</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">ax<sub>i</sub></i> mod <i class="emphasis">n</i>
</p>
</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">a</i>(<i class="emphasis">x</i><sub>0</sub> + <i class="emphasis">in</i>/<i class="emphasis">d</i>) mod <i class="emphasis">n</i>
</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">(<i class="emphasis">ax</i><sub>0</sub> + <i class="emphasis">ain</i>/<i class="emphasis">d</i>) mod <i class="emphasis">n</i>
</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">ax</i><sub>0</sub> mod <i class="emphasis">n</i>
</p>
</td><td class="td" align="left">
<p class="table-para">(because <i class="emphasis">d</i> | <i class="emphasis">a</i>)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">=</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">b</i>,</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<p class="last-para">and so <i class="emphasis">x<sub>i</sub></i> is a solution, too. By <a class="internaljump" href="#ch31ex48">Corollary 31.22</a>, there are exactly <i class="emphasis">d</i> solutions, so that <i class="emphasis">x</i><sub>0</sub>, <i class="emphasis">x</i><sub>1</sub>, ..., <i class="emphasis">x</i><sub><i class="emphasis">d</i>-1</sub> must be all of them.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="2725"></a><a name="IDX-871"></a>
<p class="para">We have now developed the mathematics needed to solve the equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>); the following algorithm prints all solutions to this equation. The inputs <i class="emphasis">a</i> and <i class="emphasis">n</i> are arbitrary positive integers, and <i class="emphasis">b</i> is an arbitrary integer.</p>
<div class="informalexample">
<pre class="literallayout-normal">
MODULAR-LINEAR-EQUATION-SOLVER(<i class="emphasis">a</i>, <i class="emphasis">b</i>, <i class="emphasis">n</i>)
1  (<i class="emphasis">d</i>, <i class="emphasis">x</i><span class="unicode">&prime;</span>, <i class="emphasis">y</i><span class="unicode">&prime;</span>) <span class="unicode">&larr;</span> EXTENDED-EUCLID(<i class="emphasis">a</i>, <i class="emphasis">n</i>)
2  <b class="bold">if</b> <i class="emphasis">d</i> | <i class="emphasis">b</i>
3      <b class="bold">then</b> <i class="emphasis">x</i><sub>0</sub> <span class="unicode">&larr;</span> <i class="emphasis">x</i><span class="unicode">&prime;</span>(<i class="emphasis">b</i>/<i class="emphasis">d</i>) mod <i class="emphasis">n</i>
4           <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> 0 <b class="bold">to</b> <i class="emphasis">d</i> - 1
5                <b class="bold">do</b> print (<i class="emphasis">x</i><sub>0</sub> + <i class="emphasis">i</i>(<i class="emphasis">n</i>/<i class="emphasis">d</i>)) mod <i class="emphasis">n</i>
6      <b class="bold">else</b> print "no solutions"
</pre>
</div>
<p class="para">As an example of the operation of this procedure, consider the equation 14<i class="emphasis">x</i> <span class="unicode">&equiv;</span> 30 (mod 100) (here, <i class="emphasis">a</i> = 14, <i class="emphasis">b</i> = 30, and <i class="emphasis">n</i> = 100). Calling EXTENDED-EUCLID in line 1, we obtain (<i class="emphasis">d</i>, <i class="emphasis">x</i>, <i class="emphasis">y</i>) = (2, -7, 1). Since 2 | 30, lines 3<span class="unicode">-</span>5 are executed. In line 3, we compute <i class="emphasis">x</i><sub>0</sub> = (-7)(15) mod 100 = 95. The loop on lines 4<span class="unicode">-</span>5 prints the two solutions 95 and 45.</p>
<p class="para">The procedure MODULAR-LINEAR-EQUATION-SOLVER works as follows. Line 1 computes <i class="emphasis">d</i> = gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) as well as two values <i class="emphasis">x</i><span class="unicode">&prime;</span> and <i class="emphasis">y</i><span class="unicode">&prime;</span> such that <i class="emphasis">d</i> = <i class="emphasis">ax</i><span class="unicode">&prime;</span>+<i class="emphasis">ny</i><span class="unicode">&prime;</span>, demonstrating that <i class="emphasis">x</i><span class="unicode">&prime;</span> is a solution to the equation <i class="emphasis">ax</i><span class="unicode">&prime;</span> <span class="unicode">&equiv;</span> <i class="emphasis">d</i> (mod <i class="emphasis">n</i>). If <i class="emphasis">d</i> does not divide <i class="emphasis">b</i>, then the equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>) has no solution, by <a class="internaljump" href="#ch31ex47">Corollary 31.21</a>. Line 2 checks if <i class="emphasis">d</i> | <i class="emphasis">b</i>; if not, line 6 reports that there are no solutions. Otherwise, line 3 computes a solution <i class="emphasis">x</i><sub>0</sub> to <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>), in accordance with <a class="internaljump" href="#ch31ex49">Theorem 31.23</a>. Given one solution, <a class="internaljump" href="#ch31ex50">Theorem 31.24</a> states that the other <i class="emphasis">d</i> - 1 solutions can be obtained by adding multiples of (<i class="emphasis">n</i>/<i class="emphasis">d</i>), modulo <i class="emphasis">n</i>. The <b class="bold">for</b> loop of lines 4<span class="unicode">-</span>5 prints out all <i class="emphasis">d</i> solutions, beginning with <i class="emphasis">x</i><sub>0</sub> and spaced (<i class="emphasis">n</i>/<i class="emphasis">d</i>) apart, modulo <i class="emphasis">n</i>.</p>
<p class="para">MODULAR-LINEAR-EQUATION-SOLVER performs <i class="emphasis">O</i>(lg <i class="emphasis">n</i> + gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>)) arithmetic operations, since EXTENDED-EUCLID performs <i class="emphasis">O</i>(lg <i class="emphasis">n</i>) arithmetic operations, and each iteration of the <b class="bold">for</b> loop of lines 4<span class="unicode">-</span>5 performs a constant number of arithmetic operations.</p>
<p class="para">The following corollaries of <a class="internaljump" href="#ch31ex50">Theorem 31.24</a> give specializations of particular interest.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Corollary 31.25</span></span><a name="2726"></a><a name="ch31ex51"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">For any <i class="emphasis">n</i> <span class="unicode">&gt;</span> 1, if gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) = 1, then the equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">b</i> (mod <i class="emphasis">n</i>) has a unique solution, modulo <i class="emphasis">n</i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">If <i class="emphasis">b</i> = 1, a common case of considerable interest, the <i class="emphasis">x</i> we are looking for is a <b class="bold"><i class="emphasis">multiplicative inverse</i></b> of <i class="emphasis">a</i>, modulo <i class="emphasis">n</i>.<a name="2727"></a><a name="IDX-872"></a>
</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Corollary 31.26</span></span><a name="2728"></a><a name="ch31ex52"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">For any <i class="emphasis">n</i> <span class="unicode">&gt;</span> 1, if gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) = 1, then the equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> 1 (mod <i class="emphasis">n</i>) has a unique solution, modulo <i class="emphasis">n</i>. Otherwise, it has no solution.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">
<a class="internaljump" href="#ch31ex52">Corollary 31.26</a> allows us to use the notation (<i class="emphasis">a</i><sup>-1</sup> mod <i class="emphasis">n</i>) to refer to <i class="emphasis">the</i> multiplicative inverse of <i class="emphasis">a</i>, modulo <i class="emphasis">n</i>, when <i class="emphasis">a</i> and <i class="emphasis">n</i> are relatively prime. If gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) = 1, then one solution to the equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> 1 (mod <i class="emphasis">n</i>) is the integer <i class="emphasis">x</i> returned by EXTENDED-EUCLID, since the equation</p>
<p class="para">gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) = 1 = <i class="emphasis">ax</i> + <i class="emphasis">ny</i>
</p>
<p class="para">implies <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> 1 (mod <i class="emphasis">n</i>). Thus, we can compute (<i class="emphasis">a</i><sup>-1</sup> mod <i class="emphasis">n</i>) efficiently using EXTENDED-EUCLID.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.4-1</span></span><a name="2729"></a><a name="ch31ex53"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Find all solutions to the equation 35<i class="emphasis">x</i> <span class="unicode">&equiv;</span> 10 (mod 50).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.4-2</span></span><a name="2730"></a><a name="ch31ex54"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Prove that the equation <i class="emphasis">ax</i> <span class="unicode">&equiv;</span> <i class="emphasis">ay</i> (mod <i class="emphasis">n</i>) implies <i class="emphasis">x</i> <span class="unicode">&equiv;</span> <i class="emphasis">y</i> (mod <i class="emphasis">n</i>) whenever gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) = 1. Show that the condition gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) = 1 is necessary by supplying a counterexample with gcd(<i class="emphasis">a</i>, <i class="emphasis">n</i>) <span class="unicode">&gt;</span> 1.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.4-3</span></span><a name="2731"></a><a name="ch31ex55"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Consider the following change to line 3 of the procedure MODULAR-LINEAR-EQUATION-SOLVER:</p>
<p class="last-para">3 <b class="bold">then</b> <i class="emphasis">x</i><sub>0</sub> <span class="unicode">&larr;</span> <i class="emphasis">x</i><span class="unicode">&prime;</span>(<i class="emphasis">b</i>/<i class="emphasis">d</i>) mod (<i class="emphasis">n</i>/<i class="emphasis">d</i>)</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">Will this work? Explain why or why not.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.4-4: </span><span class="unicode">&#9733;</span></span><a name="2732"></a><a name="ch31ex56"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">f</i>(<i class="emphasis">x</i>) <span class="unicode">&equiv;</span> <i class="emphasis">f</i><sub>0</sub> + <i class="emphasis">f</i><sub>1</sub><i class="emphasis">x</i> + <span class="unicode">&middot;</span><span class="unicode">&middot;</span><span class="unicode">&middot;</span> + <i class="emphasis">f<sub>t</sub></i> x<sup><i class="emphasis">t</i></sup> (mod <i class="emphasis">p</i>) be a polynomial of degree <i class="emphasis">t</i>, with coefficients <i class="emphasis">f<sub>i</sub></i> drawn from <b class="bold">Z</b><sub><i class="emphasis">p</i></sub>, where <i class="emphasis">p</i> is prime. We say that <i class="emphasis">a</i> <span class="unicode">&isin;</span> <b class="bold">Z</b><sub><i class="emphasis">p</i></sub> is a <b class="bold"><i class="emphasis">zero</i></b> of <i class="emphasis">f</i> if <i class="emphasis">f</i>(<i class="emphasis">a</i>) <span class="unicode">&equiv;</span> 0 (mod <i class="emphasis">p</i>). Prove that if <i class="emphasis">a</i> is a zero of <i class="emphasis">f</i>, then <i class="emphasis">f</i>(<i class="emphasis">x</i>) <span class="unicode">&equiv;</span> (<i class="emphasis">x</i> - <i class="emphasis">a</i>)<i class="emphasis">g</i>(<i class="emphasis">x</i>) (mod <i class="emphasis">p</i>) for some polynomial <i class="emphasis">g</i>(<i class="emphasis">x</i>) of degree <i class="emphasis">t</i> - 1. Prove by induction on <i class="emphasis">t</i> that a polynomial <i class="emphasis">f</i>(<i class="emphasis">x</i>) of degree <i class="emphasis">t</i> can have at most <i class="emphasis">t</i> distinct zeros modulo a prime <i class="emphasis">p</i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0202.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0204.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
