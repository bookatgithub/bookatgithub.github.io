<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>31.6 Powers of an element</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0204.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0206.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch31"></a>
<div class="section">
<h2 class="first-section-title">
<a name="2746"></a><a name="ch31lev1sec6"></a><span class="section-titlelabel">31.6 </span>Powers of an element</h2>
<p class="first-para">Just as it is natural to consider the multiples of a given element <i class="emphasis">a</i>, modulo <i class="emphasis">n</i>, it is often natural to consider the sequence of powers of <i class="emphasis">a</i>, modulo <i class="emphasis">n</i>, where <span class="inlinemediaobject"><img src="images/fig898_02.jpg" height="13" width="32" alt="" border="0"></span>:</p>
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.29)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig898_03.jpg" height="19" width="109" alt="" border="0"></span></td>
</tr>
</table>
</div>
<p class="para">modulo <i class="emphasis">n</i>. Indexing from 0, the 0th value in this sequence is <i class="emphasis">a</i><sup>0</sup> mod <i class="emphasis">n</i> = 1, and the <i class="emphasis">i</i>th value is <i class="emphasis">a<sup>i</sup></i> mod <i class="emphasis">n</i>. For example, the powers of 3 modulo 7 are</p>
<div class="informaltable">
<table border="0">
<thead>
<tr valign="top">
<th class="th" scope="col" align="center">
<p class="table-para">
<i class="emphasis">i</i>
</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">0</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">1</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">2</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">3</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">4</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">5</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">6</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">7</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">8</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">9</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">10</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">11</p>
</th>
</tr>
</thead>
<tbody>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">3<sup><i class="emphasis">i</i></sup> mod 7</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">2</p>
</td><td class="td" align="center">
<p class="table-para">6</p>
</td><td class="td" align="center">
<p class="table-para">4</p>
</td><td class="td" align="center">
<p class="table-para">5</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">3</p>
</td><td class="td" align="center">
<p class="table-para">2</p>
</td><td class="td" align="center">
<p class="table-para">6</p>
</td><td class="td" align="center">
<p class="table-para">4</p>
</td><td class="td" align="center">
<p class="table-para">5</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">whereas the powers of 2 modulo 7 are</p>
<div class="informaltable">
<table border="0">
<thead>
<tr valign="top">
<th class="th" scope="col" align="center">
<p class="table-para">
<i class="emphasis">i</i>
</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">0</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">1</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">2</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">3</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">4</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">5</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">6</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">7</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">8</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">9</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">10</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">11</p>
</th>
</tr>
</thead>
<tbody>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">2<sup><i class="emphasis">i</i></sup> mod 7</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">2</p>
</td><td class="td" align="center">
<p class="table-para">4</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">2</p>
</td><td class="td" align="center">
<p class="table-para">4</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">2</p>
</td><td class="td" align="center">
<p class="table-para">4</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">2</p>
</td><td class="td" align="center">
<p class="table-para">4</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="para">In this section, let <span class="unicode">&#12296;</span><i class="emphasis">a</i><span class="unicode">&#12297;</span> denote the subgroup of <span class="inlinemediaobject"><img src="images/fig898_04.jpg" height="12" width="13" alt="" border="0"></span> generated by <i class="emphasis">a</i> by repeated multiplication, and let ord<sub><i class="emphasis">n</i></sub>(<i class="emphasis">a</i>) (the "order of <i class="emphasis">a</i>, modulo <i class="emphasis">n</i>") denote the order of <i class="emphasis">a</i> <a name="2747"></a><a name="IDX-877"></a>in <span class="inlinemediaobject"><img src="images/fig899_01.jpg" height="13" width="13" alt="" border="0"></span>. For example, <span class="unicode">&#12296;</span>2<span class="unicode">&#12297;</span> = {1, 2, 4} in <span class="inlinemediaobject"><img src="images/fig899_02.jpg" height="13" width="13" alt="" border="0"></span>, and ord<sub>7</sub>(2) = 3. Using the definition of the Euler phi function <i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>) as the size of <span class="inlinemediaobject"><img src="images/fig899_03.jpg" height="13" width="13" alt="" border="0"></span> (see <a href="DDU0202.html#2690" target="_parent" class="chapterjump">Section 31.3</a>), we now translate <a href="DDU0202.html#2709" target="_parent" class="chapterjump">Corollary 31.19</a> into the notation of <span class="inlinemediaobject"><img src="images/fig899_04.jpg" height="13" width="13" alt="" border="0"></span> to obtain Euler's theorem and specialize it to <span class="inlinemediaobject"><img src="images/fig899_05.jpg" height="14" width="13" alt="" border="0"></span>, where <i class="emphasis">p</i> is prime, to obtain Fermat's theorem.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.30: </span>(Euler's theorem)</span>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">For any integer <i class="emphasis">n</i> <span class="unicode">&gt;</span> 1,</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig899_06.jpg" height="20" width="207" alt="" border="0"></span>
</div>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.31: </span>(Fermat's theorem)</span><a name="2748"></a><a name="ch31ex65"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">If <i class="emphasis">p</i> is prime, then</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig899_07.jpg" height="22" width="209" alt="" border="0"></span>
</div>
<p class="last-para">
<b class="bold"><i class="emphasis">Proof</i></b> By <a href="DDU0202.html#2699" target="_parent" class="chapterjump">equation (31.20)</a>, <i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">p</i>) = <i class="emphasis">p</i> - 1 if <i class="emphasis">p</i> is prime.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">This corollary applies to every element in <b class="bold">Z</b><sub><i class="emphasis">p</i></sub> except 0, since <span class="inlinemediaobject"><img src="images/fig899_08.jpg" height="14" width="35" alt="" border="0"></span>. For all <i class="emphasis">a</i> <span class="unicode">&isin;</span> <b class="bold">Z</b><sub><i class="emphasis">p</i></sub>, however, we have <i class="emphasis">a<sup>p</sup></i> <span class="unicode">&equiv;</span> <i class="emphasis">a</i> (mod <i class="emphasis">p</i>) if <i class="emphasis">p</i> is prime.</p>
<p class="para">If <span class="inlinemediaobject"><img src="images/fig899_09.jpg" height="13" width="68" alt="" border="0"></span>, then every element in <span class="inlinemediaobject"><img src="images/fig899_10.jpg" height="13" width="13" alt="" border="0"></span> is a power of <i class="emphasis">g</i>, modulo <i class="emphasis">n</i>, and we say that <i class="emphasis">g</i> is a <b class="bold"><i class="emphasis">primitive root</i></b> or a <b class="bold"><i class="emphasis">generator</i></b> of <span class="inlinemediaobject"><img src="images/fig899_11.jpg" height="13" width="13" alt="" border="0"></span>. For example, 3 is a primitive root, modulo 7, but 2 is not a primitive root, modulo 7. If <span class="inlinemediaobject"><img src="images/fig899_12.jpg" height="13" width="13" alt="" border="0"></span> possesses a primitive root, we say that the group <span class="inlinemediaobject"><img src="images/fig899_13.jpg" height="13" width="13" alt="" border="0"></span> is <b class="bold"><i class="emphasis">cyclic</i></b>. We omit the proof of the following theorem, which is proven by <a href="DDU0259.html#3786" target="_parent" class="chapterjump">Niven and Zuckerman [231]</a>.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.32</span></span><a name="2749"></a><a name="ch31ex66"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">The values of <i class="emphasis">n</i> <span class="unicode">&gt;</span> 1 for which <span class="inlinemediaobject"><img src="images/fig899_14.jpg" height="13" width="13" alt="" border="0"></span> is cyclic are 2, 4, <i class="emphasis">p<sup>e</sup></i>, and 2<i class="emphasis">p<sup>e</sup></i>, for all primes <i class="emphasis">p</i> <span class="unicode">&gt;</span> 2 and all positive integers <i class="emphasis">e</i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">If <i class="emphasis">g</i> is a primitive root of <span class="inlinemediaobject"><img src="images/fig899_15.jpg" height="13" width="13" alt="" border="0"></span> and <i class="emphasis">a</i> is any element of <span class="inlinemediaobject"><img src="images/fig899_16.jpg" height="13" width="13" alt="" border="0"></span>, then there exists a <i class="emphasis">z</i> such that <i class="emphasis">g<sup>z</sup></i> <span class="unicode">&equiv;</span> <i class="emphasis">a</i> (mod <i class="emphasis">n</i>). This <i class="emphasis">z</i> is called the <b class="bold"><i class="emphasis">discrete logarithm</i></b> or <b class="bold"><i class="emphasis">index</i></b> of <i class="emphasis">a</i>, modulo <i class="emphasis">n</i>, to the base <i class="emphasis">g</i>; we denote this value as ind<sub><i class="emphasis">n</i>,<i class="emphasis">g</i></sub>(<i class="emphasis">a</i>).</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.33: </span>(Discrete logarithm theorem)</span><a name="2750"></a><a name="ch31ex67"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">If <i class="emphasis">g</i> is a primitive root of <span class="inlinemediaobject"><img src="images/fig899_17.jpg" height="13" width="13" alt="" border="0"></span>, then the equation <i class="emphasis">g<sup>x</sup></i> <span class="unicode">&equiv;</span> <i class="emphasis">g<sup>y</sup></i> (mod <i class="emphasis">n</i>) holds if and only if the equation <i class="emphasis">x</i> <span class="unicode">&equiv;</span> <i class="emphasis">y</i> (mod <i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>)) holds.</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> Suppose first that <i class="emphasis">x</i> <span class="unicode">&equiv;</span> <i class="emphasis">y</i> (mod <i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>)). Then, <i class="emphasis">x</i> = <i class="emphasis">y</i> + <i class="emphasis">k<span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>) for some integer <i class="emphasis">k</i>. Therefore,<a name="2751"></a><a name="IDX-878"></a>
</p>
<div class="informaltable">
<table border="0">
<tbody>
<tr valign="top">
<td class="td" align="left">
<p class="table-para">
<i class="emphasis">g<sup>x</sup></i>
</p>
</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&equiv;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">g</i><sup><i class="emphasis">y</i>+<i class="emphasis">k<span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>)</sup>
</p>
</td><td class="td" align="left">
<p class="table-para">(mod <i class="emphasis">n</i>)</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&equiv;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">g<sup>y</sup></i> <span class="unicode">&middot;</span> (<i class="emphasis">g</i><sup><i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>))<i class="emphasis">k</i></sup>
</p>
</td><td class="td" align="left">
<p class="table-para">(mod <i class="emphasis">n</i>)</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&equiv;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">g<sup>y</sup></i> <span class="unicode">&middot;</span> 1<sup><i class="emphasis">k</i></sup>
</p>
</td><td class="td" align="left">
<p class="table-para">(mod <i class="emphasis">n</i>)</p>
</td><td class="td" align="left">
<p class="table-para">(by Euler's theorem)</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="left">&nbsp;</td><td class="td" align="center">
<p class="table-para">
<span class="unicode">&equiv;</span>
</p>
</td><td class="td" align="left">
<p class="table-para">
<i class="emphasis">g<sup>y</sup></i>
</p>
</td><td class="td" align="left">
<p class="table-para">(mod <i class="emphasis">n</i>).</p>
</td><td class="td" align="left">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<p class="last-para">Conversely, suppose that <i class="emphasis">g<sup>x</sup></i> <span class="unicode">&equiv;</span> <i class="emphasis">g<sup>y</sup></i> (mod <i class="emphasis">n</i>). Because the sequence of powers of <i class="emphasis">g</i> generates every element of <span class="unicode">&#12296;</span><i class="emphasis">g</i><span class="unicode">&#12297;</span> and |<span class="unicode">&#12296;</span><i class="emphasis">g</i><span class="unicode">&#12297;</span>| = <i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>), <a href="DDU0202.html#2708" target="_parent" class="chapterjump">Corollary 31.18</a> implies that the sequence of powers of <i class="emphasis">g</i> is periodic with period <i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>). Therefore, if <i class="emphasis">g<sup>x</sup></i> <span class="unicode">&equiv;</span> <i class="emphasis">g<sup>y</sup></i> (mod <i class="emphasis">n</i>), then we must have <i class="emphasis">x</i> <span class="unicode">&equiv;</span> <i class="emphasis">y</i> (mod <i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>)).</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">Taking discrete logarithms can sometimes simplify reasoning about a modular equation, as illustrated in the proof of the following theorem.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem 31.34</span></span><a name="2752"></a><a name="ch31ex68"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">If <i class="emphasis">p</i> is an odd prime and <i class="emphasis">e</i> <span class="unicode">&ge;</span> 1, then the equation</p>
<p class="para">
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.30)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig900_01.jpg" height="19" width="109" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="para">has only two solutions, namely <i class="emphasis">x</i> = 1 and <i class="emphasis">x</i> = -1.</p>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> Let <i class="emphasis">n</i> = <i class="emphasis">p<sup>e</sup></i>. <a class="internaljump" href="#ch31ex66">Theorem 31.32</a> implies that <span class="inlinemediaobject"><img src="images/fig900_02.jpg" height="13" width="12" alt="" border="0"></span> has a primitive root <i class="emphasis">g</i>. <a href="DDU0201.html#2686" target="_parent" class="chapterjump">Equation (31.30)</a> can be written</p>
<p class="para">
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.31)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig900_03.jpg" height="19" width="197" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="para">After noting that ind<sub><i class="emphasis">n</i>,<i class="emphasis">g</i></sub>(1) = 0, we observe that <a class="internaljump" href="#ch31ex67">Theorem 31.33</a> implies that <a href="DDU0201.html#2687" target="_parent" class="chapterjump">equation (31.31)</a> is equivalent to</p>
<p class="para">
<div class="equation">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(31.32)&nbsp;</span></td><td valign="top"><span class="equation-image"><img src="images/fig900_04.jpg" height="18" width="187" alt="" border="0"></span></td>
</tr>
</table>
</div>
</p>
<p class="last-para">To solve this equation for the unknown ind<sub><i class="emphasis">n</i>,<i class="emphasis">g</i></sub>(<i class="emphasis">x</i>), we apply the methods of <a href="DDU0203.html#2715" target="_parent" class="chapterjump">Section 31.4.</a> By <a href="DDU0200.html#2663" target="_parent" class="chapterjump">equation (31.19)</a>, we have <i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>) = <i class="emphasis">p<sup>e</sup></i>(1 - 1/<i class="emphasis">p</i>) = (<i class="emphasis">p</i> - 1)<i class="emphasis">p</i><sup><i class="emphasis">e</i>-1</sup>. Letting <i class="emphasis">d</i> = gcd(2, <i class="emphasis"><span class="unicode">&phi;</span></i>(<i class="emphasis">n</i>)) = gcd(2, (<i class="emphasis">p</i> - 1) <i class="emphasis">p</i><sup><i class="emphasis">e</i>-1</sup>) = 2, and noting that <i class="emphasis">d</i> | 0, we find from <a href="DDU0203.html#2724" target="_parent" class="chapterjump">Theorem 31.24</a> that <a href="DDU0201.html#2689" target="_parent" class="chapterjump">equation (31.32)</a> has exactly <i class="emphasis">d</i> = 2 solutions. Therefore, <a href="DDU0201.html#2686" target="_parent" class="chapterjump">equation (31.30)</a> has exactly 2 solutions, which are <i class="emphasis">x</i> = 1 and <i class="emphasis">x</i> = -1 by inspection.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<p class="para">A number <i class="emphasis">x</i> is a <b class="bold"><i class="emphasis">nontrivial square root of 1, modulo n</i></b>, if it satisfies the equation <i class="emphasis">x</i><sup>2</sup> <span class="unicode">&equiv;</span> 1 (mod <i class="emphasis">n</i>) but <i class="emphasis">x</i> is equivalent to neither of the two "trivial" square roots: 1 or -1, modulo <i class="emphasis">n</i>. For example, 6 is a nontrivial square root of 1, modulo 35. The following corollary to <a class="internaljump" href="#ch31ex68">Theorem 31.34</a> will be used in the correctness proof for the Miller-Rabin primality-testing procedure in <a href="DDU0207.html#2780" target="_parent" class="chapterjump">Section 31.8.</a>
</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Corollary 31.35</span></span><a name="2753"></a><a name="ch31ex69"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">If there exists a nontrivial square root of 1, modulo <i class="emphasis">n</i>, then <i class="emphasis">n</i> is composite.<a name="2754"></a><a name="IDX-879"></a>
</p>
<p class="last-para">
<b class="bold"><i class="emphasis">Proof</i></b> By the contrapositive of <a class="internaljump" href="#ch31ex68">Theorem 31.34</a>, if there exists a nontrivial square root of 1, modulo <i class="emphasis">n</i>, then <i class="emphasis">n</i> can't be an odd prime or a power of an odd prime. If <i class="emphasis">x</i><sup>2</sup> <span class="unicode">&equiv;</span> 1 (mod 2), then <i class="emphasis">x</i> <span class="unicode">&equiv;</span> 1 (mod 2), so all square roots of 1, modulo 2, are trivial. Thus, <i class="emphasis">n</i> cannot be prime. Finally, we must have <i class="emphasis">n</i> <span class="unicode">&gt;</span> 1 for a nontrivial square root of 1 to exist. Therefore, <i class="emphasis">n</i> must be composite.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="section">
<h4 class="sect4-title">
<a name="2755"></a><a name="ch31lev3sec15"></a>Raising to powers with repeated squaring</h4>
<p class="first-para">A frequently occurring operation in number-theoretic computations is raising one number to a power modulo another number, also known as <b class="bold"><i class="emphasis">modular exponentiation</i></b>. More precisely, we would like an efficient way to compute <i class="emphasis">a<sup>b</sup></i> mod <i class="emphasis">n</i>, where <i class="emphasis">a</i> and <i class="emphasis">b</i> are nonnegative integers and <i class="emphasis">n</i> is a positive integer. Modular exponentiation is an essential operation in many primality-testing routines and in the RSA public-key cryptosystem. The method of <b class="bold"><i class="emphasis">repeated squaring</i></b> solves this problem efficiently using the binary representation of <i class="emphasis">b</i>.</p>
<p class="para">Let <span class="unicode">&#12296;</span><i class="emphasis">b<sub>k</sub></i>, <i class="emphasis">b</i><sub><i class="emphasis">k</i>-1</sub>, ..., <i class="emphasis">b</i><sub>1</sub>, <i class="emphasis">b</i><sub>0</sub><span class="unicode">&#12297;</span> be the binary representation of <i class="emphasis">b</i>. (That is, the binary representation is <i class="emphasis">k</i> + 1 bits long, <i class="emphasis">b<sub>k</sub></i> is the most significant bit, and <i class="emphasis">b</i><sub>0</sub> is the least significant bit.) The following procedure computes <i class="emphasis">a<sup>c</sup></i> mod <i class="emphasis">n</i> as <i class="emphasis">c</i> is increased by doublings and incrementations from 0 to <i class="emphasis">b</i>.</p>
<div class="informalexample">
<pre class="literallayout-normal">
MODULAR-EXPONENTIATION(<i class="emphasis">a</i>, <i class="emphasis">b</i>, <i class="emphasis">n</i>)
 1  <i class="emphasis">c</i> <span class="unicode">&larr;</span> 0
 2  <i class="emphasis">d</i> <span class="unicode">&larr;</span> 1
 3  let <span class="unicode">&#12296;</span><i class="emphasis">b<sub>k</sub></i>, <i class="emphasis">b</i><sub><i class="emphasis">k</i>-1</sub>, ..., <i class="emphasis">b</i><sub>0</sub><span class="unicode">&#12297;</span> be the binary representation of <i class="emphasis">b</i>
 4  <b class="bold">for</b> <i class="emphasis">i</i> <span class="unicode">&larr;</span> <i class="emphasis">k</i> <b class="bold">downto</b> 0
 5        <b class="bold">do</b> <i class="emphasis">c</i> <span class="unicode">&larr;</span> 2<i class="emphasis">c</i>
 6                  <i class="emphasis">d</i> <span class="unicode">&larr;</span> (<i class="emphasis">d</i> <span class="unicode">&middot;</span> <i class="emphasis">d</i>) mod <i class="emphasis">n</i>
 7                  <b class="bold">if</b> <i class="emphasis">b<sub>i</sub></i> = <i class="emphasis">1</i>
 8                            <b class="bold">then</b> <i class="emphasis">c</i> <span class="unicode">&larr;</span> <i class="emphasis">c</i> + 1
 9                                   <i class="emphasis">d</i> <span class="unicode">&larr;</span> (<i class="emphasis">d</i> <span class="unicode">&middot;</span> <i class="emphasis">a</i>) mod <i class="emphasis">n</i>
10  <b class="bold">return</b> <i class="emphasis">d</i>
</pre>
</div>
<p class="para">The essential use of squaring in line 6 of each iteration explains the name "repeated squaring." As an example, for <i class="emphasis">a</i> = 7, <i class="emphasis">b</i> = 560, and <i class="emphasis">n</i> = 561, the algorithm computes the sequence of values modulo 561 shown in <a class="internaljump" href="#ch31fig04">Figure 31.4</a>; the sequence of exponents used is shown in the row of the table labeled by <i class="emphasis">c</i>.</p>
<div class="miscfigure">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start Figure" border="0"></b></font></td>
</tr>
</table>
<a name="2756"></a><a name="ch31fig04"></a>
<div class="miscfigure-informaltable">
<table border="0">
<thead>
<tr valign="top">
<th class="th" scope="col" align="center">
<p class="table-para">
<i class="emphasis">i</i>
</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">9</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">8</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">7</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">6</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">5</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">4</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">3</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">2</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">1</p>
</th><th class="th" scope="col" align="center">
<p class="table-para">0</p>
</th>
</tr>
<tr>
<td colspan="11">
<hr>
</td>
</tr>
</thead>
<tbody>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">
<i class="emphasis">b<sub>i</sub></i>
</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td><td class="td" align="center">
<p class="table-para">0</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">
<i class="emphasis">c</i>
</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td><td class="td" align="center">
<p class="table-para">2</p>
</td><td class="td" align="center">
<p class="table-para">4</p>
</td><td class="td" align="center">
<p class="table-para">8</p>
</td><td class="td" align="center">
<p class="table-para">17</p>
</td><td class="td" align="center">
<p class="table-para">35</p>
</td><td class="td" align="center">
<p class="table-para">70</p>
</td><td class="td" align="center">
<p class="table-para">140</p>
</td><td class="td" align="center">
<p class="table-para">280</p>
</td><td class="td" align="center">
<p class="table-para">560</p>
</td>
</tr>
<tr valign="top">
<td class="td" align="center">
<p class="table-para">
<i class="emphasis">d</i>
</p>
</td><td class="td" align="center">
<p class="table-para">7</p>
</td><td class="td" align="center">
<p class="table-para">49</p>
</td><td class="td" align="center">
<p class="table-para">157</p>
</td><td class="td" align="center">
<p class="table-para">526</p>
</td><td class="td" align="center">
<p class="table-para">160</p>
</td><td class="td" align="center">
<p class="table-para">241</p>
</td><td class="td" align="center">
<p class="table-para">298</p>
</td><td class="td" align="center">
<p class="table-para">166</p>
</td><td class="td" align="center">
<p class="table-para">67</p>
</td><td class="td" align="center">
<p class="table-para">1</p>
</td>
</tr>
</tbody>
</table>
</div>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End Figure" border="0"></b></font></td>
</tr>
</table>
<br style="line-height: 1">
<span class="miscfigure-title"><span class="figure-titlelabel">Figure 31.4: </span>The results of MODULAR-EXPONENTIATION when computing <i class="emphasis">a<sup>b</sup></i> (mod <i class="emphasis">n</i>), where <i class="emphasis">a</i> = 7, <i class="emphasis">b</i> = 560 = <span class="unicode">&#12296;</span>1000110000<span class="unicode">&#12297;</span>, and <i class="emphasis">n</i> = 561. The values are shown after each execution of the <i class="emphasis">for</i> loop. The final result is 1.</span>
</div>
<p class="para">The variable <i class="emphasis">c</i> is not really needed by the algorithm but is included for explanatory purposes; the algorithm maintains the following two-part loop invariant:</p>
<p class="para">Just prior to each iteration of the <b class="bold">for</b> loop of lines 4<span class="unicode">-</span>9,<a name="2757"></a><a name="IDX-880"></a>
</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">The value of <i class="emphasis">c</i> is the same as the prefix <span class="unicode">&#12296;</span><i class="emphasis">b<sub>k</sub></i>, <i class="emphasis">b</i><sub><i class="emphasis">k</i>-1</sub>, ..., <i class="emphasis">b</i><sub><i class="emphasis">i</i>+1</sub><span class="unicode">&#12297;</span> of the binary representation of <i class="emphasis">b</i>, and</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">d</i> = <i class="emphasis">a<sup>c</sup></i> mod <i class="emphasis">n</i>.</p>
</li>
</ol>
<p class="para">We use this loop invariant as follows:</p>
<ul class="simple-list">
<li class="first-listitem">
<p class="para">
<b>Initialization:</b> Initially, <i class="emphasis">i</i> = <i class="emphasis">k</i>, so that the prefix <span class="unicode">&#12296;</span><i class="emphasis">b<sub>k</sub></i>, <i class="emphasis">b</i><sub><i class="emphasis">k</i>-1</sub>, ..., <i class="emphasis">b</i><sub><i class="emphasis">i</i>+1</sub><span class="unicode">&#12297;</span> is empty, which corresponds to <i class="emphasis">c</i> = 0. Moreover, <i class="emphasis">d</i> = 1 = <i class="emphasis">a</i><sup>0</sup> mod <i class="emphasis">n</i>.</p>
</li>
<li class="listitem">
<p class="para">
<b>Maintenance:</b> Let <i class="emphasis">c</i><span class="unicode">&prime;</span> and <i class="emphasis">d</i><span class="unicode">&prime;</span> denote the values of <i class="emphasis">c</i> and <i class="emphasis">d</i> at the end of an iteration of the <b class="bold">for</b> loop, and thus the values prior to the next iteration. Each iteration updates <i class="emphasis">c</i><span class="unicode">&prime;</span> <span class="unicode">&larr;</span> 2<i class="emphasis">c</i> (if <i class="emphasis">b<sub>i</sub></i> = 0) or <i class="emphasis">c</i><span class="unicode">&prime;</span> <span class="unicode">&larr;</span> 2<i class="emphasis">c</i> + 1 (if <i class="emphasis">b<sub>i</sub></i> = 1), so that <i class="emphasis">c</i> will be correct prior to the next iteration. If <i class="emphasis">b<sub>i</sub></i> = 0, then <i class="emphasis">d</i><span class="unicode">&prime;</span> = <i class="emphasis">d</i><sup>2</sup> mod <i class="emphasis">n</i> = (<i class="emphasis">a<sup>c</sup></i>)<sup>2</sup> mod <i class="emphasis">n</i> = <i class="emphasis">a<sup>2c</sup></i> mod <span class="inlinemediaobject"><img src="images/fig902_01.jpg" height="14" width="36" alt="" border="0"></span> mod <i class="emphasis">n</i>. If <i class="emphasis">b<sub>i</sub></i> = 1, then <i class="emphasis">d</i><span class="unicode">&prime;</span> = <i class="emphasis">d<sup>2</sup> a</i> mod <i class="emphasis">n</i> = (<i class="emphasis">a<sup>c</sup></i>)<sup>2</sup><i class="emphasis">a</i> mod <i class="emphasis">n</i> =<i class="emphasis">a</i><sup>2<i class="emphasis">c</i>+1</sup> mod <span class="inlinemediaobject"><img src="images/fig902_02.jpg" height="14" width="39" alt="" border="0"></span> mod <i class="emphasis">n</i>. In either case, <i class="emphasis">d</i> = <i class="emphasis">a<sup>c</sup></i> mod <i class="emphasis">n</i> prior to the next iteration.</p>
</li>
<li class="listitem">
<p class="para">
<b>Termination:</b> At termination, <i class="emphasis">i</i> = -1. Thus, <i class="emphasis">c</i> = <i class="emphasis">b</i>, since <i class="emphasis">c</i> has the value of the prefix <span class="unicode">&#12296;</span><i class="emphasis">b<sub>k</sub></i>, <i class="emphasis">b</i><sub><i class="emphasis">k</i>-1</sub>, ...,<i class="emphasis">b<sub>0</sub></i><span class="unicode">&#12297;</span> of <i class="emphasis">b</i><span class="unicode">&prime;</span>s binary representation. Hence <i class="emphasis">d</i> = <i class="emphasis">a<sup>c</sup></i> mod <i class="emphasis">n</i> = <i class="emphasis">a<sup>b</sup></i> mod <i class="emphasis">n</i>.</p>
</li>
</ul>
<p class="para">If the inputs <i class="emphasis">a</i>, <i class="emphasis">b</i>, and <i class="emphasis">n</i> are <i class="emphasis"><span class="unicode">&beta;</span></i>-bit numbers, then the total number of arithmetic operations required is <i class="emphasis">O</i>(<i class="emphasis"><span class="unicode">&beta;</span></i>) and the total number of bit operations required is <i class="emphasis">O</i>(<i class="emphasis"><span class="unicode">&beta;</span></i><sup>3</sup>).</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.6-1</span></span><a name="2758"></a><a name="ch31ex70"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Draw a table showing the order of every element in <span class="inlinemediaobject"><img src="images/fig902_03.jpg" height="14" width="16" alt="" border="0"></span>. Pick the smallest primitive root <i class="emphasis">g</i> and compute a table giving ind<sub>11,<i class="emphasis">g</i></sub>(<i class="emphasis">x</i>) for all <span class="inlinemediaobject"><img src="images/fig902_04.jpg" height="14" width="35" alt="" border="0"></span>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.6-2</span></span><a name="2759"></a><a name="ch31ex71"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Give a modular exponentiation algorithm that examines the bits of <i class="emphasis">b</i> from right to left instead of left to right.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="2760"></a><a name="IDX-881"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 31.6-3</span></span><a name="2761"></a><a name="ch31ex72"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Assuming that you know <i class="emphasis"><span class="unicode">&phi;</span></i> (<i class="emphasis">n</i>), explain how to compute <i class="emphasis">a</i><sup>-1</sup> mod <i class="emphasis">n</i> for any <span class="inlinemediaobject"><img src="images/fig903_01.jpg" height="15" width="33" alt="" border="0"></span> using the procedure MODULAR-EXPONENTIATION.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0204.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0206.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
