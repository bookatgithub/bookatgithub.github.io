<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>33.1 Line-segment properties</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0217.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0219.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="chapter">
<a name="ch33"></a>
<div class="section">
<h2 class="first-section-title">
<a name="2912"></a><a name="ch33lev1sec1"></a><span class="section-titlelabel">33.1 </span>Line-segment properties</h2>
<a name="2913"></a><a name="IDX-934"></a>
<p class="para">Several of the computational-geometry algorithms in this chapter will require answers to questions about the properties of line segments. A <b class="bold"><i class="emphasis">convex combination</i></b> of two distinct points <i class="emphasis">p</i><sub>1</sub> = (<i class="emphasis">x</i><sub>1</sub>, <i class="emphasis">y</i><sub>1</sub>) and <i class="emphasis">p</i><sub>2</sub> = (<i class="emphasis">x</i><sub>2</sub>, <i class="emphasis">y</i><sub>2</sub>) is any point <i class="emphasis">p</i><sub>3</sub> = (<i class="emphasis">x</i><sub>3</sub>, <i class="emphasis">y</i><sub>3</sub>) such that for some <span class="unicode">&alpha;</span> in the range 0 <span class="unicode">&le;</span> <span class="unicode">&alpha;</span> <span class="unicode">&le;</span> 1, we have <i class="emphasis">x</i><sub>3</sub> = <span class="unicode">&alpha;</span><i class="emphasis">x</i><sub>1</sub> + (1 - <span class="unicode">&alpha;</span>)<i class="emphasis">x</i><sub>2</sub> and <i class="emphasis">y</i><sub>3</sub> = <span class="unicode">&alpha;</span><i class="emphasis">y</i><sub>1</sub> + (1 - <span class="unicode">&alpha;</span>)<i class="emphasis">y</i><sub>2</sub>. We also write that <i class="emphasis">p</i><sub>3</sub> = <span class="unicode">&alpha;</span><i class="emphasis">p</i><sub>1</sub> + (1 - <span class="unicode">&alpha;</span>)<i class="emphasis">p</i><sub>2</sub>. Intuitively, <i class="emphasis">p</i><sub>3</sub> is any point that is on the line passing through <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub> and is on or between <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub> on the line. Given two distinct points <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub>, the <b class="bold"><i class="emphasis">line segment</i></b> <span class="inlinemediaobject"><img src="images/fig956_01.jpg" height="12" width="25" alt="" border="0"></span> is the set of convex combinations of <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub>. We call <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub> the <b class="bold"><i class="emphasis">endpoints</i></b> of segment <span class="inlinemediaobject"><img src="images/fig956_02.jpg" height="12" width="25" alt="" border="0"></span>. Sometimes the ordering of <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub> matters, and we speak of the <b class="bold"><i class="emphasis">directed segment</i></b> <span class="inlinemediaobject"><img src="images/fig956_03.jpg" height="14" width="23" alt="" border="0"></span>. If <i class="emphasis">p</i><sub>1</sub> is the <b class="bold"><i class="emphasis">origin</i></b> (0, 0), then we can treat the directed segment <span class="inlinemediaobject"><img src="images/fig956_04.jpg" height="14" width="23" alt="" border="0"></span> as the <b class="bold"><i class="emphasis">vector</i></b> <i class="emphasis">p</i><sub>2</sub>.</p>
<p class="para">In this section, we shall explore the following questions:</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">Given two directed segments <span class="inlinemediaobject"><img src="images/fig956_05.jpg" height="14" width="23" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig956_06.jpg" height="13" width="23" alt="" border="0"></span>, is <span class="inlinemediaobject"><img src="images/fig956_07.jpg" height="14" width="22" alt="" border="0"></span> clockwise from <span class="inlinemediaobject"><img src="images/fig956_08.jpg" height="14" width="24" alt="" border="0"></span> with respect to their common endpoint <i class="emphasis">p</i><sub>0</sub>?</p>
</li>
<li class="listitem">
<p class="first-para">Given two line segments <span class="inlinemediaobject"><img src="images/fig956_09.jpg" height="12" width="24" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig956_10.jpg" height="11" width="23" alt="" border="0"></span>, if we traverse <span class="inlinemediaobject"><img src="images/fig956_11.jpg" height="12" width="24" alt="" border="0"></span> and then <span class="inlinemediaobject"><img src="images/fig956_12.jpg" height="12" width="24" alt="" border="0"></span>, do we make a left turn at point <i class="emphasis">p</i><sub>1</sub>?</p>
</li>
<li class="listitem">
<p class="first-para">Do line segments <span class="inlinemediaobject"><img src="images/fig956_13.jpg" height="12" width="24" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig956_14.jpg" height="12" width="24" alt="" border="0"></span> intersect?</p>
</li>
</ol>
<p class="para">There are no restrictions on the given points.</p>
<p class="para">We can answer each question in <i class="emphasis">O</i>(1) time, which should come as no surprise since the input size of each question is <i class="emphasis">O</i>(1). Moreover, our methods will use only additions, subtractions, multiplications, and comparisons. We need neither division nor trigonometric functions, both of which can be computationally expensive and prone to problems with round-off error. For example, the "straightforward" method of determining whether two segments intersect<span class="unicode">-</span>compute the line equation of the form <i class="emphasis">y</i> = <i class="emphasis">mx</i> + <i class="emphasis">b</i> for each segment (<i class="emphasis">m</i> is the slope and <i class="emphasis">b</i> is the <i class="emphasis">y</i>-intercept), find the point of intersection of the lines, and check whether this point is on both segments<span class="unicode">-</span>uses division to find the point of intersection. When the segments are nearly parallel, this method is very sensitive to the precision of the division operation on real computers. The method in this section, which avoids division, is much more accurate.</p>
<div class="section">
<h4 class="sect4-title">
<a name="2914"></a><a name="ch33lev3sec1"></a>Cross products</h4>
<p class="first-para">Computing cross products is at the heart of our line-segment methods. Consider vectors <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub>, shown in <a class="internaljump" href="#ch33fig01">Figure 33.1(a)</a>. The <b class="bold"><i class="emphasis">cross product</i></b> <i class="emphasis">p</i><sub>1</sub> <span class="unicode">&times;</span> <i class="emphasis">p</i><sub>2</sub> can be interpreted as the signed area of the parallelogram formed by the points (0, 0), <i class="emphasis">p</i><sub>1</sub>, <i class="emphasis">p</i><sub>2</sub>, and <i class="emphasis">p</i><sub>1</sub> + <i class="emphasis">p</i><sub>2</sub> = (<i class="emphasis">x</i><sub>1</sub> + <i class="emphasis">x</i><sub>2</sub>, <i class="emphasis">y</i><sub>1</sub> + <i class="emphasis">y</i><sub>2</sub>). An equivalent, but more useful, definition <a name="2915"></a><a name="IDX-935"></a>gives the cross product as the determinant of a matrix:<sup>[<a name="N535" href="#ftn.N535">1</a>]</sup>
</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig957_02.jpg" height="77" width="171" alt="" border="0"></span>
</div>
<div class="figure">
<a name="2916"></a><a name="ch33fig01"></a><span class="figuremediaobject"><a href="images/fig957%5F01%5F0%2Ejpg" NAME="IMG_1723" target="_parent"><img src="images/fig957_01.jpg" height="128" width="311" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 33.1: </span><i class="emphasis">(a)</i> The cross product of vectors <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub> is the signed area of the parallelogram. <i class="emphasis">(b)</i> The lightly shaded region contains vectors that are clockwise from <i class="emphasis">p</i>. The darkly shaded region contains vectors that are counterclockwise from <i class="emphasis">p</i>.</span>
</div>
<p class="para">If <i class="emphasis">p</i><sub>1</sub> <span class="unicode">&times;</span> <i class="emphasis">p</i><sub>2</sub> is positive, then <i class="emphasis">p</i><sub>1</sub> is clockwise from <i class="emphasis">p</i><sub>2</sub> with respect to the origin (0, 0); if this cross product is negative, then <i class="emphasis">p</i><sub>1</sub> is counterclockwise from <i class="emphasis">p</i><sub>2</sub>. (See <a class="internaljump" href="#ch33ex01">Exercise 33.1-1</a>.) <a class="internaljump" href="#ch33fig01">Figure 33.1(b)</a> shows the clockwise and counterclockwise regions relative to a vector <i class="emphasis">p</i>. A boundary condition arises if the cross product is 0; in this case, the vectors are <b class="bold"><i class="emphasis">collinear</i></b>, pointing in either the same or opposite directions.</p>
<p class="para">To determine whether a directed segment <span class="inlinemediaobject"><img src="images/fig957_03.jpg" height="14" width="23" alt="" border="0"></span> is clockwise from a directed segment <span class="inlinemediaobject"><img src="images/fig957_04.jpg" height="14" width="23" alt="" border="0"></span> with respect to their common endpoint <i class="emphasis">p</i><sub>0</sub>, we simply translate to use <i class="emphasis">p</i><sub>0</sub> as the origin. That is, we let <i class="emphasis">p</i><sub>1</sub> - <i class="emphasis">p</i><sub>0</sub> denote the vector <span class="inlinemediaobject"><img src="images/fig957_05.jpg" height="13" width="59" alt="" border="0"></span>, where <span class="inlinemediaobject"><img src="images/fig957_06.jpg" height="13" width="58" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig957_07.jpg" height="13" width="58" alt="" border="0"></span>, and we define <i class="emphasis">p</i><sub>2</sub> - <i class="emphasis">p</i><sub>0</sub> similarly. We then compute the cross product</p>
<p class="para">(<i class="emphasis">p</i><sub>1</sub> - <i class="emphasis">p</i><sub>0</sub>) <span class="unicode">&times;</span> (<i class="emphasis">p</i><sub>2</sub> - <i class="emphasis">p</i><sub>0</sub>) = (<i class="emphasis">x</i><sub>1</sub> - <i class="emphasis">x</i><sub>0</sub>)(<i class="emphasis">y</i><sub>2</sub> - <i class="emphasis">y</i><sub>0</sub>) - (<i class="emphasis">x</i><sub>2</sub> - <i class="emphasis">x</i><sub>0</sub>)(<i class="emphasis">y</i><sub>1</sub> - <i class="emphasis">y</i><sub>0</sub>).</p>
<p class="last-para">If this cross product is positive, then <span class="inlinemediaobject"><img src="images/fig957_08.jpg" height="14" width="23" alt="" border="0"></span> is clockwise from <span class="inlinemediaobject"><img src="images/fig957_09.jpg" height="14" width="23" alt="" border="0"></span>; if negative, it is counterclockwise.<a name="2917"></a><a name="IDX-936"></a>
</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="2918"></a><a name="ch33lev3sec2"></a>Determining whether consecutive segments turn left or right</h4>
<p class="first-para">Our next question is whether two consecutive line segments <span class="inlinemediaobject"><img src="images/fig958_06.jpg" height="13" width="25" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig958_07.jpg" height="13" width="24" alt="" border="0"></span> turn left or right at point <i class="emphasis">p</i><sub>1</sub>. Equivalently, we want a method to determine which way a given angle <span class="unicode">&ang;</span> <i class="emphasis">p</i><sub>0</sub><i class="emphasis">p</i><sub>1</sub><i class="emphasis">p</i><sub>2</sub> turns. Cross products allow us to answer this question without computing the angle. As shown in <a class="internaljump" href="#ch33fig02">Figure 33.2</a>, we simply check whether directed segment <span class="inlinemediaobject"><img src="images/fig958_08.jpg" height="14" width="23" alt="" border="0"></span> is clockwise or counterclockwise relative to directed segment <span class="inlinemediaobject"><img src="images/fig958_09.jpg" height="14" width="23" alt="" border="0"></span>. To do this, we compute the cross product (<i class="emphasis">p</i><sub>2</sub> - <i class="emphasis">p</i><sub>0</sub>) <span class="unicode">&times;</span> (<i class="emphasis">p</i><sub>1</sub> - <i class="emphasis">p</i><sub>0</sub>). If the sign of this cross product is negative, then <span class="inlinemediaobject"><img src="images/fig958_10.jpg" height="14" width="23" alt="" border="0"></span> is counterclockwise with respect to <span class="inlinemediaobject"><img src="images/fig958_11.jpg" height="14" width="22" alt="" border="0"></span>, and thus we make a left turn at <i class="emphasis">p</i><sub>1</sub>. A positive cross product indicates a clockwise orientation and a right turn. A cross product of 0 means that points <i class="emphasis">p</i><sub>0</sub>, <i class="emphasis">p</i><sub>1</sub>, and <i class="emphasis">p</i><sub>2</sub> are collinear.</p>
<div class="figure">
<a name="2919"></a><a name="ch33fig02"></a><span class="figuremediaobject"><a href="images/fig958%5F05%2Ejpg" NAME="IMG_1741" target="_parent"><img src="images/fig958_05.jpg" height="123" width="400" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 33.2: </span>Using the cross product to determine how consecutive line segments <span class="inlinemediaobject"><img src="images/fig958_01.jpg" height="11" width="22" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig958_02.jpg" height="10" width="22" alt="" border="0"></span> turn at point <i class="emphasis">p</i><sub>1</sub>. We check whether the directed segment <span class="inlinemediaobject"><img src="images/fig958_03.jpg" height="12" width="20" alt="" border="0"></span> is clockwise or counterclockwise relative to the directed segment <span class="inlinemediaobject"><img src="images/fig958_04.jpg" height="12" width="20" alt="" border="0"></span>. <i class="emphasis">(a)</i> If counterclockwise, the points make a left turn. <i class="emphasis">(b)</i> If clockwise, they make a right turn.</span>
</div>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="2920"></a><a name="ch33lev3sec3"></a>Determining whether two line segments intersect</h4>
<p class="first-para">To determine whether two line segments intersect, we check whether each segment straddles the line containing the other. A segment <span class="inlinemediaobject"><img src="images/fig958_12.jpg" height="12" width="24" alt="" border="0"></span> <b class="bold"><i class="emphasis">straddles</i></b> a line if point <i class="emphasis">p</i><sub>1</sub> lies on one side of the line and point <i class="emphasis">p</i><sub>2</sub> lies on the other side. A boundary case arises if <i class="emphasis">p</i><sub>1</sub> or <i class="emphasis">p</i><sub>2</sub> lies directly on the line. Two line segments intersect if and only if either (or both) of the following conditions holds:</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">Each segment straddles the line containing the other.</p>
</li>
<li class="listitem">
<p class="first-para">An endpoint of one segment lies on the other segment. (This condition comes from the boundary case.)</p>
</li>
</ol>
<p class="para">The following procedures implement this idea. SEGMENTS-INTERSECT returns TRUE if segments <span class="inlinemediaobject"><img src="images/fig958_13.jpg" height="12" width="25" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig958_14.jpg" height="12" width="25" alt="" border="0"></span> intersect and FALSE if they do not. It calls the subroutines DIRECTION, which computes relative orientations using the cross-product method above, and ON-SEGMENT, which determines whether a point known to be collinear with a segment lies on that segment.<a name="2921"></a><a name="IDX-937"></a>
</p>
<div class="informalexample">
<pre class="literallayout-normal">
SEGMENTS-INTERSECT(<i class="emphasis">p</i><sub>1</sub>, <i class="emphasis">p</i><sub>2</sub>, <i class="emphasis">p</i><sub>3</sub>, <i class="emphasis">p</i><sub>4</sub>)
 1  <i class="emphasis">d</i><sub>1</sub> <span class="unicode">&larr;</span> DIRECTION(<i class="emphasis">p</i><sub>3</sub>, <i class="emphasis">p</i><sub>4</sub>, <i class="emphasis">p</i><sub>1</sub>)
 2  <i class="emphasis">d</i><sub>2</sub> <span class="unicode">&larr;</span> DIRECTION(<i class="emphasis">p</i><sub>3</sub>, <i class="emphasis">p</i><sub>4</sub>, <i class="emphasis">p</i><sub>2</sub>)
 3  <i class="emphasis">d</i><sub>3</sub> <span class="unicode">&larr;</span> DIRECTION(<i class="emphasis">p</i><sub>1</sub>, <i class="emphasis">p</i><sub>2</sub>, <i class="emphasis">p</i><sub>3</sub>)
 4  <i class="emphasis">d</i><sub>4</sub> <span class="unicode">&larr;</span> DIRECTION(<i class="emphasis">p</i><sub>1</sub>, <i class="emphasis">p</i><sub>2</sub>, <i class="emphasis">p</i><sub>4</sub>)
 5  <b class="bold">if</b> ((<i class="emphasis">d</i><sub>1</sub> <span class="unicode">&gt;</span> 0 and <i class="emphasis">d</i><sub>2</sub> <span class="unicode">&lt;</span> 0) or (<i class="emphasis">d</i><sub>1</sub> <span class="unicode">&lt;</span> 0 and <i class="emphasis">d</i><sub>2</sub> <span class="unicode">&gt;</span> 0)) and
             ((<i class="emphasis">d</i><sub>3</sub> <span class="unicode">&gt;</span> 0 and <i class="emphasis">d</i><sub>4</sub> <span class="unicode">&lt;</span> 0) or (<i class="emphasis">d</i><sub>3</sub> <span class="unicode">&lt;</span> 0 and <i class="emphasis">d</i><sub>4</sub> <span class="unicode">&gt;</span> 0))
 6     <b class="bold">then return</b> TRUE
 7  <b class="bold">elseif</b> <i class="emphasis">d</i><sub>1</sub> = 0 and ON-SEGMENT(<i class="emphasis">p</i><sub>3</sub>, <i class="emphasis">p</i><sub>4</sub>, <i class="emphasis">p</i><sub>1</sub>)
 8     <b class="bold">then return</b> TRUE
 9  <b class="bold">elseif</b> <i class="emphasis">d</i><sub>2</sub> = 0 and ON-SEGMENT(<i class="emphasis">p</i><sub>3</sub>, <i class="emphasis">p</i><sub>4</sub>, <i class="emphasis">p</i><sub>2</sub>)
10     <b class="bold">then return</b> TRUE
11  <b class="bold">elseif</b> <i class="emphasis">d</i><sub>3</sub> = 0 and ON-SEGMENT(<i class="emphasis">p</i><sub>1</sub>, <i class="emphasis">p</i><sub>2</sub>, <i class="emphasis">p</i><sub>3</sub>)
12     <b class="bold">then return</b> TRUE
13  <b class="bold">elseif</b> <i class="emphasis">d</i><sub>4</sub> = 0 and ON-SEGMENT(<i class="emphasis">p</i><sub>1</sub>, <i class="emphasis">p</i><sub>2</sub>, <i class="emphasis">p</i><sub>4</sub>)
14     <b class="bold">then return</b> TRUE
15  <b class="bold">else return</b> FALSE
</pre>
</div>
<div class="informalexample">
<pre class="literallayout-normal">
DIRECTION(<i class="emphasis">p<sub>i</sub>, p<sub>j</sub>, p<sub>k</sub></i>)
1  <b class="bold">return</b> (<i class="emphasis">p<sub>k</sub></i> - <i class="emphasis">p<sub>i</sub></i>) <span class="unicode">&times;</span> (<i class="emphasis">p<sub>j</sub></i> - <i class="emphasis">p<sub>i</sub></i>)
</pre>
</div>
<div class="informalexample">
<pre class="literallayout-normal">
ON-SEGMENT(<i class="emphasis">p<sub>i</sub>, p<sub>j</sub>, p<sub>k</sub></i>)
1  <b class="bold">if</b> min(<i class="emphasis">x<sub>i</sub>, x<sub>j</sub></i>) <span class="unicode">&le;</span> <i class="emphasis">x<sub>k</sub></i> <span class="unicode">&le;</span> max(<i class="emphasis">x<sub>i</sub>, x<sub>j</sub></i>) and min(<i class="emphasis">y<sub>i</sub>, y<sub>j</sub></i>) <span class="unicode">&le;</span> <i class="emphasis">y<sub>k</sub></i> <span class="unicode">&le;</span> max(<i class="emphasis">y<sub>i</sub>, y<sub>j</sub></i>)
2     <b class="bold">then return</b> TRUE
3     <b class="bold">else return</b> FALSE
</pre>
</div>
<p class="para">SEGMENTS-INTERSECT works as follows. Lines 1<span class="unicode">-</span>4 compute the relative orientation <i class="emphasis">d<sub>i</sub></i> of each endpoint <i class="emphasis">p<sub>i</sub></i> with respect to the other segment. If all the relative orientations are nonzero, then we can easily determine whether segments <span class="inlinemediaobject"><img src="images/fig959_01.jpg" height="11" width="23" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig959_02.jpg" height="12" width="24" alt="" border="0"></span> intersect, as follows. Segment <span class="inlinemediaobject"><img src="images/fig959_03.jpg" height="12" width="23" alt="" border="0"></span> straddles the line containing segment <span class="inlinemediaobject"><img src="images/fig959_04.jpg" height="11" width="24" alt="" border="0"></span> if directed segments <span class="inlinemediaobject"><img src="images/fig959_05.jpg" height="14" width="23" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig959_06.jpg" height="13" width="22" alt="" border="0"></span> have opposite orientations relative to <span class="inlinemediaobject"><img src="images/fig959_07.jpg" height="14" width="23" alt="" border="0"></span>. In this case, the signs of <i class="emphasis">d</i><sub>1</sub> and <i class="emphasis">d</i><sub>2</sub> differ. Similarly, <span class="inlinemediaobject"><img src="images/fig959_08.jpg" height="12" width="24" alt="" border="0"></span> straddles the line containing <span class="inlinemediaobject"><img src="images/fig959_09.jpg" height="12" width="24" alt="" border="0"></span> if the signs of <i class="emphasis">d</i><sub>3</sub> and <i class="emphasis">d</i><sub>4</sub> differ. If the test of line 5 is true, then the segments straddle each other, and SEGMENTS-INTERSECT returns TRUE. <a class="internaljump" href="#ch33fig03">Figure 33.3(a)</a> shows this case. Otherwise, the segments do not straddle each other's lines, although a boundary case may apply. If all the relative orientations are nonzero, no boundary case applies. All the tests against 0 in lines 7<span class="unicode">-</span>13 then fail, and SEGMENTS-INTERSECT returns FALSE in line 15. <a class="internaljump" href="#ch33fig03">Figure 33.3(b)</a> shows this case.</p>
<div class="figure">
<a name="2922"></a><a name="ch33fig03"></a><span class="figuremediaobject"><a href="images/fig960%5F13%5F0%2Ejpg" NAME="IMG_1766" target="_parent"><img src="images/fig960_13.jpg" height="172" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure 33.3: </span>Cases in the procedure SEGMENTS-INTERSECT. <i class="emphasis">(a)</i> The segments <span class="inlinemediaobject"><img src="images/fig960_01.jpg" height="11" width="23" alt="" border="0"></span> and <span class="inlinemediaobject"><img src="images/fig960_02.jpg" height="10" width="23" alt="" border="0"></span> straddle each other's lines. Because <span class="inlinemediaobject"><img src="images/fig960_03.jpg" height="10" width="22" alt="" border="0"></span> straddles the line containing <span class="inlinemediaobject"><img src="images/fig960_04.jpg" height="10" width="22" alt="" border="0"></span>, the signs of the cross products (<i class="emphasis">p</i><sub>3</sub> - <i class="emphasis">p</i><sub>1</sub>) <span class="unicode">&times;</span> (<i class="emphasis">p</i><sub>2</sub> - <i class="emphasis">p</i><sub>1</sub>) and (<i class="emphasis">p</i><sub>4</sub> - <i class="emphasis">p</i><sub>1</sub>) <span class="unicode">&times;</span> (<i class="emphasis">p</i><sub>2</sub> - <i class="emphasis">p</i><sub>1</sub>) differ. Because <span class="inlinemediaobject"><img src="images/fig960_05.jpg" height="10" width="22" alt="" border="0"></span> straddles the line containing <span class="inlinemediaobject"><img src="images/fig960_06.jpg" height="9" width="22" alt="" border="0"></span>, the signs of the cross products (<i class="emphasis">p</i><sub>1</sub> - <i class="emphasis">p</i><sub>3</sub>) <span class="unicode">&times;</span> (<i class="emphasis">p</i><sub>4</sub> - <i class="emphasis">p</i><sub>3</sub>) and (<i class="emphasis">p</i><sub>2</sub> - <i class="emphasis">p</i><sub>3</sub>) <span class="unicode">&times;</span> (<i class="emphasis">p</i><sub>4</sub> - <i class="emphasis">p</i><sub>3</sub>) differ. <i class="emphasis">(b)</i> Segment <span class="inlinemediaobject"><img src="images/fig960_07.jpg" height="10" width="23" alt="" border="0"></span> straddles the line containing <span class="inlinemediaobject"><img src="images/fig960_08.jpg" height="10" width="23" alt="" border="0"></span>, but <span class="inlinemediaobject"><img src="images/fig960_09.jpg" height="10" width="22" alt="" border="0"></span> does not straddle the line containing <span class="inlinemediaobject"><img src="images/fig960_10.jpg" height="10" width="21" alt="" border="0"></span>. The signs of the cross products (<i class="emphasis">p</i><sub>1</sub> - <i class="emphasis">p</i><sub>3</sub>) <span class="unicode">&times;</span> (<i class="emphasis">p</i><sub>4</sub> - <i class="emphasis">p</i><sub>3</sub>) and (<i class="emphasis">p</i><sub>2</sub> - <i class="emphasis">p</i><sub>3</sub>) <span class="unicode">&times;</span> (<i class="emphasis">p</i><sub>4</sub> - <i class="emphasis">p</i><sub>3</sub>) are the same. <i class="emphasis">(c)</i> Point <i class="emphasis">p</i><sub>3</sub> is collinear with <span class="inlinemediaobject"><img src="images/fig960_11.jpg" height="11" width="21" alt="" border="0"></span> and is between <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub>. <i class="emphasis">(d)</i> Point <i class="emphasis">p</i><sub>3</sub> is collinear with <span class="inlinemediaobject"><img src="images/fig960_12.jpg" height="11" width="21" alt="" border="0"></span>, but it is not between <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub>. The segments do not intersect.</span>
</div>
<p class="last-para">A boundary case occurs if any relative orientation <i class="emphasis">d<sub>k</sub></i> is 0. Here, we know that <i class="emphasis">p<sub>k</sub></i> is collinear with the other segment. It is directly on the other segment if and only if it is between the endpoints of the other segment. The procedure ON-SEGMENT <a name="2923"></a><a name="IDX-938"></a>returns whether <i class="emphasis">p<sub>k</sub></i> is between the endpoints of segment <span class="inlinemediaobject"><img src="images/fig960_14.jpg" height="12" width="23" alt="" border="0"></span>, which will be the other segment when called in lines 7<span class="unicode">-</span>13; the procedure assumes that <i class="emphasis">p<sub>k</sub></i> is collinear with segment <span class="inlinemediaobject"><img src="images/fig960_15.jpg" height="12" width="23" alt="" border="0"></span>. <a class="internaljump" href="#ch33fig03">Figures 33.3(c)</a> and <a class="internaljump" href="#ch33fig03">(d)</a> show cases with collinear points. In <a class="internaljump" href="#ch33fig03">Figure 33.3(c)</a>, <i class="emphasis">p</i><sub>3</sub> is on <span class="inlinemediaobject"><img src="images/fig960_16.jpg" height="12" width="23" alt="" border="0"></span>, and so SEGMENTS-INTERSECT returns TRUE in line 12. No endpoints are on other segments in <a class="internaljump" href="#ch33fig03">Figure 33.3(d)</a>, and so SEGMENTS-INTERSECT returns FALSE in line 15.</p>

</div>
<div class="section">
<h4 class="sect4-title">
<a name="2924"></a><a name="ch33lev3sec4"></a>Other applications of cross products</h4>
<p class="first-para">Later sections of this chapter will introduce additional uses for cross products. In <a href="DDU0220.html#2959" target="_parent" class="chapterjump">Section 33.3</a>, we shall need to sort a set of points according to their polar angles with respect to a given origin. As <a class="internaljump" href="#ch33ex03">Exercise 33.1-3</a> asks you to show, cross products can be used to perform the comparisons in the sorting procedure. In <a href="DDU0219.html#2935" target="_parent" class="chapterjump">Section 33.2</a>, we shall use red-black trees to maintain the vertical ordering of a set of line segments. Rather than keeping explicit key values, we shall replace each key compar<a name="2925"></a><a name="IDX-939"></a>ison in the red-black tree code by a cross-product calculation to determine which of two segments that intersect a given vertical line is above the other.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 33.1-1</span></span><a name="2926"></a><a name="ch33ex01"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Prove that if <i class="emphasis">p</i><sub>1</sub> <span class="unicode">&times;</span> <i class="emphasis">p</i><sub>2</sub> is positive, then vector <i class="emphasis">p</i><sub>1</sub> is clockwise from vector <i class="emphasis">p</i><sub>2</sub> with respect to the origin (0, 0) and that if this cross product is negative, then <i class="emphasis">p</i><sub>1</sub> is counterclockwise from <i class="emphasis">p</i><sub>2</sub>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 33.1-2</span></span><a name="2927"></a><a name="ch33ex02"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Professor Powell proposes that only the <i class="emphasis">x</i>-dimension needs to be tested in line 1 of ON-SEGMENT. Show why the professor is wrong.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 33.1-3</span></span><a name="2928"></a><a name="ch33ex03"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">The <b class="bold"><i class="emphasis">polar angle</i></b> of a point <i class="emphasis">p</i><sub>1</sub> with respect to an origin point <i class="emphasis">p</i><sub>0</sub> is the angle of the vector <i class="emphasis">p</i><sub>1</sub> - <i class="emphasis">p</i><sub>0</sub> in the usual polar coordinate system. For example, the polar angle of (3, 5) with respect to (2, 4) is the angle of the vector (1, 1), which is 45 degrees or <span class="unicode">&pi;</span>/4 radians. The polar angle of (3, 3) with respect to (2, 4) is the angle of the vector (1, -1), which is 315 degrees or 7<span class="unicode">&pi;</span>/4 radians. Write pseudocode to sort a sequence <span class="unicode">&#12296;</span><i class="emphasis">p</i><sub>1</sub>, <i class="emphasis">p</i><sub>2</sub>, ..., <i class="emphasis">p<sub>n</sub></i><span class="unicode">&#12297;</span> of <i class="emphasis">n</i> points according to their polar angles with respect to a given origin point <i class="emphasis">p</i><sub>0</sub>. Your procedure should take <i class="emphasis">O</i>(<i class="emphasis">n</i> lg <i class="emphasis">n</i>) time and use cross products to compare angles.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 33.1-4</span></span><a name="2929"></a><a name="ch33ex04"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show how to determine in <i class="emphasis">O</i>(<i class="emphasis">n</i><sup>2</sup> lg <i class="emphasis">n</i>) time whether any three points in a set of <i class="emphasis">n</i> points are collinear.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 33.1-5</span></span><a name="2930"></a><a name="ch33ex05"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">A <b class="bold"><i class="emphasis">polygon</i></b> is a piecewise-linear, closed curve in the plane. That is, it is a curve ending on itself that is formed by a sequence of straight-line segments, called the <b class="bold"><i class="emphasis">sides</i></b> of the polygon. A point joining two consecutive sides is called a <b class="bold"><i class="emphasis">vertex</i></b> of the polygon. If the polygon is <b class="bold"><i class="emphasis">simple</i></b>, as we shall generally assume, it does not cross itself. The set of points in the plane enclosed by a simple polygon forms the <b class="bold"><i class="emphasis">interior</i></b> of the polygon, the set of points on the polygon itself forms its <b class="bold"><i class="emphasis">boundary</i></b>, and the set of points surrounding the polygon forms its <b class="bold"><i class="emphasis">exterior</i></b>. A simple polygon is <b class="bold"><i class="emphasis">convex</i></b> if, given any two points on its boundary or in its interior, all points on the line segment drawn between them are contained in the polygon's boundary or interior.</p>
<p class="last-para">Professor Amundsen proposes the following method to determine whether a sequence <span class="unicode">&#12296;</span><i class="emphasis">p</i><sub>0</sub>, <i class="emphasis">p</i><sub>1</sub>, ..., <i class="emphasis">p</i><sub><i class="emphasis">n</i>-1</sub><span class="unicode">&#12297;</span> of <i class="emphasis">n</i> points forms the consecutive vertices of a convex polygon. Output "yes" if the set {<span class="unicode">&ang;</span> <i class="emphasis">p<sub>i</sub></i> <i class="emphasis">p</i><sub><i class="emphasis">i</i>+1</sub> <i class="emphasis">p</i><sub><i class="emphasis">i</i>+2</sub> : <i class="emphasis">i</i> = 0, 1, ..., <i class="emphasis">n</i> - 1}, where sub<a name="2931"></a><a name="IDX-940"></a>script addition is performed modulo <i class="emphasis">n</i>, does not contain both left turns and right turns; otherwise, output "no." Show that although this method runs in linear time, it does not always produce the correct answer. Modify the professor's method so that it always produces the correct answer in linear time.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 33.1-6</span></span><a name="2932"></a><a name="ch33ex06"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Given a point <i class="emphasis">p</i><sub>0</sub> = (<i class="emphasis">x</i><sub>0</sub>, <i class="emphasis">y</i><sub>0</sub>), the <b class="bold"><i class="emphasis">right horizontal ray</i></b> from <i class="emphasis">p</i><sub>0</sub> is the set of points {<i class="emphasis">p<sub>i</sub></i> = (<i class="emphasis">x<sub>i</sub>, y<sub>i</sub></i>) : <i class="emphasis">x<sub>i</sub></i> <span class="unicode">&ge;</span> <i class="emphasis">x</i><sub>0</sub> and <i class="emphasis">y<sub>i</sub></i> = <i class="emphasis">y</i><sub>0</sub>}, that is, it is the set of points due right of <i class="emphasis">p</i><sub>0</sub> along with <i class="emphasis">p</i><sub>0</sub> itself. Show how to determine whether a given right horizontal ray from <i class="emphasis">p</i><sub>0</sub> intersects a line segment <span class="inlinemediaobject"><img src="images/fig962_01.jpg" height="12" width="23" alt="" border="0"></span> in <i class="emphasis">O</i>(1) time by reducing the problem to that of determining whether two line segments intersect.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 33.1-7</span></span><a name="2933"></a><a name="ch33ex07"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">One way to determine whether a point <i class="emphasis">p</i><sub>0</sub> is in the interior of a simple, but not necessarily convex, polygon <i class="emphasis">P</i> is to look at any ray from <i class="emphasis">p</i><sub>0</sub> and check that the ray intersects the boundary of <i class="emphasis">P</i> an odd number of times but that <i class="emphasis">p</i><sub>0</sub> itself is not on the boundary of <i class="emphasis">P</i>. Show how to compute in <span class="unicode">&Theta;</span>(<i class="emphasis">n</i>) time whether a point <i class="emphasis">p</i><sub>0</sub> is in the interior of an <i class="emphasis">n</i>-vertex polygon <i class="emphasis">P</i>. (<i class="emphasis">Hint:</i> Use <a class="internaljump" href="#ch33ex06">Exercise 33.1-6</a>. Make sure your algorithm is correct when the ray intersects the polygon boundary at a vertex and when the ray overlaps a side of the polygon.)</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises 33.1-8</span></span><a name="2934"></a><a name="ch33ex08"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show how to compute the area of an <i class="emphasis">n</i>-vertex simple, but not necessarily convex, polygon in <span class="unicode">&Theta;</span>(<i class="emphasis">n</i>) time. (See <a class="internaljump" href="#ch33ex05">Exercise 33.1-5</a> for definitions pertaining to polygons.)</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
<div class="footnotes">
<div class="footnote">
<p>
<sup>[<a name="ftn.N535" href="#N535">1</a>]</sup>Actually, the cross product is a three-dimensional concept. It is a vector that is perpendicular to both <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub> according to the "right-hand rule" and whose magnitude is |<i class="emphasis">x</i><sub>1</sub> <i class="emphasis">y</i><sub>2</sub> - <i class="emphasis">x</i><sub>2</sub> <i class="emphasis">y</i><sub>1</sub>|. In this chapter, however, it will prove convenient to treat the cross product simply as the value <i class="emphasis">x</i><sub>1</sub> <i class="emphasis">y</i><sub>2</sub> - <i class="emphasis">x</i><sub>2</sub> <i class="emphasis">y</i><sub>1</sub>.</p>
</div>
</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0217.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0219.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
