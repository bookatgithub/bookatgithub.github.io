<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>B.5 Trees</title>
<link rel="STYLESHEET" type="text/css" href="images/xpolecat.css">
<link rel="STYLESHEET" type="text/css" href="images/ie.content.books24x7.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0250.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0252.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
<hr size="1">
<br>
<div class="appendix">
<a name="ap-b"></a>
<div class="section">
<h2 class="first-section-title">
<a name="3377"></a><a name="ap-blev1sec5"></a><span class="section-titlelabel">B.5 </span>Trees</h2>
<a name="3378"></a><a name="IDX-1085"></a>
<p class="para">As with graphs, there are many related, but slightly different, notions of trees. This section presents definitions and mathematical properties of several kinds of trees. <a href="DDU0061.html#675" target="_parent" class="chapterjump">Sections 10.4</a> and <a href="DDU0129.html#1581" target="_parent" class="chapterjump">22.1</a> describe how trees can be represented in a computer memory.</p>
<div class="section">
<h3 class="sect3-title">
<a name="3379"></a><a name="ap-blev2sec1"></a><span class="section-titlelabel">B.5.1 </span>Free trees</h3>
<p class="first-para">As defined in <a href="DDU0250.html#3364" target="_parent" class="chapterjump">Section B.4</a>, a <b class="bold"><i class="emphasis">free tree</i></b> is a connected, acyclic, undirected graph. We often omit the adjective "free" when we say that a graph is a tree. If an undirected graph is acyclic but possibly disconnected, it is a <b class="bold"><i class="emphasis">forest</i></b>. Many algorithms that work for trees also work for forests. <a class="internaljump" href="#ap-bfig04">Figure B.4(a)</a> shows a free tree, and <a class="internaljump" href="#ap-bfig04">Figure B.4(b)</a> shows a forest. The forest in <a class="internaljump" href="#ap-bfig04">Figure B.4(b)</a> is not a tree because it is not connected. The graph in <a class="internaljump" href="#ap-bfig04">Figure B.4(c)</a> is neither a tree nor a forest, because it contains a cycle.</p>
<div class="figure">
<a name="3380"></a><a name="ap-bfig04"></a><span class="figuremediaobject"><a href="images/fig1108%5F01%5F0%2Ejpg" NAME="IMG_2111" target="_parent"><img src="images/fig1108_01.jpg" height="84" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure B.4: </span><i class="emphasis">(a)</i> A free tree. <i class="emphasis">(b)</i> A forest. <i class="emphasis">(c)</i> A graph that contains a cycle and is therefore neither a tree nor a forest.</span>
</div>
<p class="para">The following theorem captures many important facts about free trees.</p>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Theorem B.2: </span>(Properties of free trees)</span><a name="3381"></a><a name="ap-bex23"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">G</i> = (<i class="emphasis">V, E</i>) be an undirected graph. The following statements are equivalent.</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">
<i class="emphasis">G</i> is a free tree.</p>
</li>
<li class="listitem">
<p class="first-para">Any two vertices in <i class="emphasis">G</i> are connected by a unique simple path.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">G</i> is connected, but if any edge is removed from <i class="emphasis">E</i>, the resulting graph is disconnected.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">G</i> is connected, and |<i class="emphasis">E</i>| = |<i class="emphasis">V</i> | - 1.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">G</i> is acyclic, and |<i class="emphasis">E</i>| = |<i class="emphasis">V</i> | - 1.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">G</i> is acyclic, but if any edge is added to <i class="emphasis">E</i>, the resulting graph contains a cycle.</p>
</li>
</ol>
<p class="para">
<b class="bold"><i class="emphasis">Proof</i></b> (1) <span class="unicode">&rArr;</span> (2): Since a tree is connected, any two vertices in <i class="emphasis">G</i> are connected by at least one simple path. Let <i class="emphasis">u</i> and <i class="emphasis">v</i> be vertices that are connected by two distinct simple paths <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub>, as shown in <a class="internaljump" href="#ap-bfig05">Figure B.5</a>. Let <i class="emphasis">w</i> be the vertex at which the paths first diverge; that is, <i class="emphasis">w</i> is the first vertex on both <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub> whose successor on <i class="emphasis">p</i><sub>1</sub> is <i class="emphasis">x</i> and whose successor on <i class="emphasis">p</i><sub>2</sub> is <i class="emphasis">y</i>, where <i class="emphasis">x</i> <span class="unicode">&ne;</span> <i class="emphasis">y</i>. Let <i class="emphasis">z</i> be the first vertex at which the paths reconverge; that is, <i class="emphasis">z</i> is the first vertex following <i class="emphasis">w</i> on <i class="emphasis">p</i><sub>1</sub> that is also on <i class="emphasis">p</i><sub>2</sub>. Let <i class="emphasis">p</i>' be the subpath of <i class="emphasis">p</i><sub>1</sub> from <i class="emphasis">w</i> through <i class="emphasis">x</i> to <i class="emphasis">z</i>, and let <i class="emphasis">p</i>'' be the subpath of <i class="emphasis">p</i><sub>2</sub> from <i class="emphasis">w</i> through <i class="emphasis">y</i> to <i class="emphasis">z</i>. Paths <i class="emphasis">p</i>' and <i class="emphasis">p</i>" share no vertices except their endpoints. Thus, the path obtained by concatenating <i class="emphasis">p</i>' and the reverse of <i class="emphasis">p"</i> is a cycle. This contradicts our assumption that <i class="emphasis">G</i> is a tree. Thus, if <i class="emphasis">G</i> is a tree, there can be at most one simple path between two vertices.</p>
<p class="para">
<div class="figure">
<a name="3382"></a><a name="ap-bfig05"></a><span class="figuremediaobject"><a href="images/fig1108%5F02%5F0%2Ejpg" NAME="IMG_2112" target="_parent"><img src="images/fig1108_02.jpg" height="98" width="221" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure B.5: </span>A step in the proof of Theorem B.2: if (1) <i class="emphasis">G</i> is a free tree, then (2) any two vertices in <i class="emphasis">G</i> are connected by a unique simple path. Assume for the sake of contradiction that vertices <i class="emphasis">u</i> and <i class="emphasis">v</i> are connected by two distinct simple paths <i class="emphasis">p</i><sub>1</sub> and <i class="emphasis">p</i><sub>2</sub>. These paths first diverge at vertex <i class="emphasis">w</i>, and they first reconverge at vertex <i class="emphasis">z</i>. The path <i class="emphasis">p</i>' concatenated with the reverse of the path <i class="emphasis">p</i>" forms a cycle, which yields the contradiction.</span>
</div>
</p>
<a name="3383"></a><a name="IDX-1086"></a>
<p class="para">(2) <span class="unicode">&rArr;</span> (3): If any two vertices in <i class="emphasis">G</i> are connected by a unique simple path, then <i class="emphasis">G</i> is connected. Let (<i class="emphasis">u, v</i>) be any edge in <i class="emphasis">E</i>. This edge is a path from <i class="emphasis">u</i> to <i class="emphasis">v</i>, and so it must be the unique path from <i class="emphasis">u</i> to <i class="emphasis">v</i>. If we remove (<i class="emphasis">u, v</i>) from <i class="emphasis">G</i>, there is no path from <i class="emphasis">u</i> to <i class="emphasis">v</i>, and hence its removal disconnects <i class="emphasis">G</i>.</p>
<p class="para">(3) <span class="unicode">&rArr;</span> (4): By assumption, the graph <i class="emphasis">G</i> is connected, and by <a href="DDU0250.html#3373" target="_parent" class="chapterjump">Exercise B.4-3</a>, we have |<i class="emphasis">E</i>| <span class="unicode">&ge;</span> |<i class="emphasis">V</i> | - 1. We shall prove |<i class="emphasis">E</i>| <span class="unicode">&le;</span> |<i class="emphasis">V</i> | - 1 by induction. A connected graph with <i class="emphasis">n</i> = 1 or <i class="emphasis">n</i> = 2 vertices has <i class="emphasis">n</i> - 1 edges. Suppose that <i class="emphasis">G</i> has <i class="emphasis">n</i> <span class="unicode">&ge;</span> 3 vertices and that all graphs satisfying (3) with fewer than <i class="emphasis">n</i> vertices also satisfy |<i class="emphasis">E</i>| <span class="unicode">&le;</span> |<i class="emphasis">V</i>| - 1. Removing an arbitrary edge from <i class="emphasis">G</i> separates the graph into <i class="emphasis">k</i> <span class="unicode">&ge;</span> 2 connected components (actually <i class="emphasis">k</i> = 2). Each component satisfies (3), or else <i class="emphasis">G</i> would not satisfy (3). Thus, by induction, the number of edges in all components combined is at most |<i class="emphasis">V</i> | - <i class="emphasis">k</i> <span class="unicode">&le;</span> |<i class="emphasis">V</i> | - 2. Adding in the removed edge yields |<i class="emphasis">E</i>| <span class="unicode">&le;</span> |<i class="emphasis">V</i>| - 1.</p>
<p class="para">(4) <span class="unicode">&rArr;</span> (5): Suppose that <i class="emphasis">G</i> is connected and that |<i class="emphasis">E</i>| = |<i class="emphasis">V</i> | - 1. We must show that <i class="emphasis">G</i> is acyclic. Suppose that <i class="emphasis">G</i> has a cycle containing <i class="emphasis">k</i> vertices <i class="emphasis">v</i><sub>1</sub>, <i class="emphasis">v</i><sub>2</sub>,..., <i class="emphasis">v<sub>k</sub></i>, and without loss of generality assume that this cycle is simple. Let <i class="emphasis">G<sub>k</sub></i> = (<i class="emphasis">V<sub>k</sub>, E<sub>k</sub></i>) <a name="3384"></a><a name="IDX-1087"></a>be the subgraph of <i class="emphasis">G</i> consisting of the cycle. Note that |<i class="emphasis">V<sub>k</sub></i>| = |<i class="emphasis">E<sub>k</sub></i>| = <i class="emphasis">k</i>. If <i class="emphasis">k</i> <span class="unicode">&lt;</span> |<i class="emphasis">V</i>|, there must be a vertex <i class="emphasis">v</i><sub><i class="emphasis">k</i>+1</sub> <span class="unicode">&isin;</span> <i class="emphasis">V</i> - <i class="emphasis">V<sub>k</sub></i> that is adjacent to some vertex <i class="emphasis">v<sub>i</sub></i> <span class="unicode">&isin;</span> <i class="emphasis">V<sub>k</sub></i>, since <i class="emphasis">G</i> is connected. Define <i class="emphasis">G</i><sub><i class="emphasis">k</i>+1</sub> = (<i class="emphasis">V</i><sub><i class="emphasis">k</i>+1</sub>, <i class="emphasis">E</i><sub><i class="emphasis">k</i>+1</sub>) to be the subgraph of <i class="emphasis">G</i> with <i class="emphasis">V</i><sub><i class="emphasis">k</i>+1</sub> = <i class="emphasis">V<sub>k</sub></i> <span class="unicode">&cup;</span> {<i class="emphasis">v</i><sub><i class="emphasis">k</i>+1</sub>} and <i class="emphasis">E</i><sub><i class="emphasis">k</i>+1</sub> = <i class="emphasis">E<sub>k</sub></i> <span class="unicode">&cup;</span> {(<i class="emphasis">v<sub>i</sub>, v</i><sub><i class="emphasis">k</i>+1</sub>)}. Note that |<i class="emphasis">V</i><sub><i class="emphasis">k</i>+1</sub>| = |<i class="emphasis">E</i><sub><i class="emphasis">k</i>+1</sub>| = <i class="emphasis">k</i> + 1. If <i class="emphasis">k</i> + 1 <span class="unicode">&lt;</span> |<i class="emphasis">V</i>|, we can continue, defining <i class="emphasis">G</i><sub><i class="emphasis">k</i>+2</sub> in the same manner, and so forth, until we obtain <i class="emphasis">G<sub>n</sub></i> = (<i class="emphasis">V<sub>n</sub>, E<sub>n</sub></i>), where <i class="emphasis">n</i> = |<i class="emphasis">V</i>|, <i class="emphasis">V<sub>n</sub></i> = <i class="emphasis">V</i>, and |<i class="emphasis">E<sub>n</sub></i>| = |<i class="emphasis">V<sub>n</sub></i>| = |<i class="emphasis">V</i>|. Since <i class="emphasis">G<sub>n</sub></i> is a subgraph of <i class="emphasis">G</i>, we have <i class="emphasis">E<sub>n</sub></i> <span class="unicode">&sube;</span> <i class="emphasis">E</i>, and hence |<i class="emphasis">E</i>| <span class="unicode">&ge;</span> |<i class="emphasis">V</i>|, which contradicts the assumption that |<i class="emphasis">E</i>| = |<i class="emphasis">V</i> | - 1. Thus, <i class="emphasis">G</i> is acyclic.</p>
<p class="para">(5) <span class="unicode">&rArr;</span> (6): Suppose that <i class="emphasis">G</i> is acyclic and that |<i class="emphasis">E</i>| = |<i class="emphasis">V</i>|-1. Let <i class="emphasis">k</i> be the number of connected components of <i class="emphasis">G</i>. Each connected component is a free tree by definition, and since (1) implies (5), the sum of all edges in all connected components of <i class="emphasis">G</i> is |<i class="emphasis">V</i>| - <i class="emphasis">k</i>. Consequently, we must have <i class="emphasis">k</i> = 1, and <i class="emphasis">G</i> is in fact a tree. Since (1) implies (2), any two vertices in <i class="emphasis">G</i> are connected by a unique simple path. Thus, adding any edge to <i class="emphasis">G</i> creates a cycle.</p>
<p class="last-para">(6) <span class="unicode">&rArr;</span> (1): Suppose that <i class="emphasis">G</i> is acyclic but that if any edge is added to <i class="emphasis">E</i>, a cycle is created. We must show that <i class="emphasis">G</i> is connected. Let <i class="emphasis">u</i> and <i class="emphasis">v</i> be arbitrary vertices in <i class="emphasis">G</i>. If <i class="emphasis">u</i> and <i class="emphasis">v</i> are not already adjacent, adding the edge (<i class="emphasis">u, v</i>) creates a cycle in which all edges but (<i class="emphasis">u, v</i>) belong to <i class="emphasis">G</i>. Thus, there is a path from <i class="emphasis">u</i> to <i class="emphasis">v</i>, and since <i class="emphasis">u</i> and <i class="emphasis">v</i> were chosen arbitrarily, <i class="emphasis">G</i> is connected.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>
<div class="section">
<h3 class="sect3-title">
<a name="3385"></a><a name="ap-blev2sec2"></a><span class="section-titlelabel">B.5.2 </span>Rooted and ordered trees</h3>
<p class="first-para">A <b class="bold"><i class="emphasis">rooted tree</i></b> is a free tree in which one of the vertices is distinguished from the others. The distinguished vertex is called the <b class="bold"><i class="emphasis">root</i></b> of the tree. We often refer to a vertex of a rooted tree as a <b class="bold"><i class="emphasis">node</i></b><sup>[<a name="N970" href="#ftn.N970">4</a>]</sup> of the tree. <a class="internaljump" href="#ap-bfig06">Figure B.6(a)</a> shows a rooted tree on a set of 12 nodes with root 7.</p>
<div class="figure">
<a name="3386"></a><a name="ap-bfig06"></a><span class="figuremediaobject"><a href="images/fig1110%5F01%5F0%2Ejpg" NAME="IMG_2113" target="_parent"><img src="images/fig1110_01.jpg" height="112" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure B.6: </span>Rooted and ordered trees. <i class="emphasis">(a)</i> A rooted tree with height 4. The tree is drawn in a standard way: the root (node 7) is at the top, its children (nodes with depth 1) are beneath it, their children (nodes with depth 2) are beneath them, and so forth. If the tree is ordered, the relative left-to-right order of the children of a node matters; otherwise it doesn't. <i class="emphasis">(b)</i> Another rooted tree. As a rooted tree, it is identical to the tree in (a), but as an ordered tree it is different, since the children of node 3 appear in a different order.</span>
</div>
<p class="para">Consider a node <i class="emphasis">x</i> in a rooted tree <i class="emphasis">T</i> with root <i class="emphasis">r</i>. Any node <i class="emphasis">y</i> on the unique path from <i class="emphasis">r</i> to <i class="emphasis">x</i> is called an <b class="bold"><i class="emphasis">ancestor</i></b> of <i class="emphasis">x</i>. If <i class="emphasis">y</i> is an ancestor of <i class="emphasis">x</i>, then <i class="emphasis">x</i> is a <b class="bold"><i class="emphasis">descendant</i></b> of <i class="emphasis">y</i>. (Every node is both an ancestor and a descendant of itself.) If <i class="emphasis">y</i> is an ancestor of <i class="emphasis">x</i> and <i class="emphasis">x</i> <span class="unicode">&ne;</span> <i class="emphasis">y</i>, then <i class="emphasis">y</i> is a <b class="bold"><i class="emphasis">proper ancestor</i></b> of <i class="emphasis">x</i> and <i class="emphasis">x</i> is a <b class="bold"><i class="emphasis">proper descendant</i></b> of <i class="emphasis">y</i>. The <b class="bold"><i class="emphasis">subtree rooted at x</i></b> is the tree induced by descendants of <i class="emphasis">x</i>, rooted at <i class="emphasis">x</i>. For example, the subtree rooted at node 8 in <a class="internaljump" href="#ap-bfig06">Figure B.6(a)</a> contains nodes 8, 6, 5, and 9.</p>
<p class="para">If the last edge on the path from the root <i class="emphasis">r</i> of a tree <i class="emphasis">T</i> to a node <i class="emphasis">x</i> is (<i class="emphasis">y, x</i>), then <i class="emphasis">y</i> is the <b class="bold"><i class="emphasis">parent</i></b> of <i class="emphasis">x</i>, and <i class="emphasis">x</i> is a <b class="bold"><i class="emphasis">child</i></b> of <i class="emphasis">y</i>. The root is the only node in <i class="emphasis">T</i> with <a name="3387"></a><a name="IDX-1088"></a>no parent. If two nodes have the same parent, they are <b class="bold"><i class="emphasis">siblings</i></b>. A node with no children is an <b class="bold"><i class="emphasis">external node</i></b> or <b class="bold"><i class="emphasis">leaf</i></b>. A nonleaf node is an <b class="bold"><i class="emphasis">internal node</i></b>.</p>
<p class="para">The number of children of a node <i class="emphasis">x</i> in a rooted tree <i class="emphasis">T</i> is called the <b class="bold"><i class="emphasis">degree</i></b> of <i class="emphasis">x</i>.<sup>[<a name="N1187" href="#ftn.N1187">5</a>]</sup> The length of the path from the root <i class="emphasis">r</i> to a node <i class="emphasis">x</i> is the <b class="bold"><i class="emphasis">depth</i></b> of <i class="emphasis">x</i> in <i class="emphasis">T</i>. The <b class="bold"><i class="emphasis">height</i></b> of a node in a tree is the number of edges on the longest simple downward path from the node to a leaf, and the height of a tree is the height of its root. The height of a tree is also equal to the largest depth of any node in the tree.</p>
<p class="last-para">An <b class="bold"><i class="emphasis">ordered tree</i></b> is a rooted tree in which the children of each node are ordered. That is, if a node has <i class="emphasis">k</i> children, then there is a first child, a second child,..., and a <i class="emphasis">k</i>th child. The two trees in <a class="internaljump" href="#ap-bfig06">Figure B.6</a> are different when considered to be ordered trees, but the same when considered to be just rooted trees.</p>

</div>
<div class="section">
<h3 class="sect3-title">
<a name="3388"></a><a name="ap-blev2sec3"></a><span class="section-titlelabel">B.5.3 </span>Binary and positional trees</h3>
<p class="first-para">Binary trees are defined recursively. A <b class="bold"><i class="emphasis">binary tree</i></b> <i class="emphasis">T</i> is a structure defined on a finite set of nodes that either <a name="3389"></a><a name="IDX-1089"></a>
</p>
<ul class="itemizedlist">
<li class="first-listitem">
<p class="first-para">contains no nodes, or</p>
</li>
<li class="listitem">
<p class="first-para">is composed of three disjoint sets of nodes: a <b class="bold"><i class="emphasis">root</i></b> node, a binary tree called its <b class="bold"><i class="emphasis">left subtree</i></b>, and a binary tree called its <b class="bold"><i class="emphasis">right subtree</i></b>.</p>
</li>
</ul>
<p class="para">The binary tree that contains no nodes is called the <b class="bold"><i class="emphasis">empty tree</i></b> or <b class="bold"><i class="emphasis">null tree</i></b>, sometimes denoted NIL. If the left subtree is nonempty, its root is called the <b class="bold"><i class="emphasis">left child</i></b> of the root of the entire tree. Likewise, the root of a nonnull right subtree is the <b class="bold"><i class="emphasis">right child</i></b> of the root of the entire tree. If a subtree is the null tree NIL, we say that the child is <b class="bold"><i class="emphasis">absent</i></b> or <b class="bold"><i class="emphasis">missing</i></b>. <a class="internaljump" href="#ap-bfig07">Figure B.7(a)</a> shows a binary tree.</p>
<div class="figure">
<a name="3390"></a><a name="ap-bfig07"></a><span class="figuremediaobject"><a href="images/fig1111%5F01%5F0%2Ejpg" NAME="IMG_2114" target="_parent"><img src="images/fig1111_01.jpg" height="105" width="350" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure B.7: </span>Binary trees. <i class="emphasis">(a)</i> A binary tree drawn in a standard way. The left child of a node is drawn beneath the node and to the left. The right child is drawn beneath and to the right. <i class="emphasis">(b)</i> A binary tree different from the one in (a). In (a), the left child of node 7 is 5 and the right child is absent. In (b), the left child of node 7 is absent and the right child is 5. As ordered trees, these trees are the same, but as binary trees, they are distinct. <i class="emphasis">(c)</i> The binary tree in (a) represented by the internal nodes of a full binary tree: an ordered tree in which each internal node has degree 2. The leaves in the tree are shown as squares.</span>
</div>
<p class="para">A binary tree is not simply an ordered tree in which each node has degree at most 2. For example, in a binary tree, if a node has just one child, the position of the child<span class="unicode">-</span>whether it is the <b class="bold"><i class="emphasis">left child</i></b> or the <b class="bold"><i class="emphasis">right child</i></b><span class="unicode">-</span>matters. In an ordered tree, there is no distinguishing a sole child as being either left or right. <a class="internaljump" href="#ap-bfig07">Figure B.7(b)</a> shows a binary tree that differs from the tree in <a class="internaljump" href="#ap-bfig07">Figure B.7(a)</a> because of the position of one node. Considered as ordered trees, however, the two trees are identical.</p>
<p class="para">The positioning information in a binary tree can be represented by the internal nodes of an ordered tree, as shown in <a class="internaljump" href="#ap-bfig07">Figure B.7(c)</a>. The idea is to replace each missing child in the binary tree with a node having no children. These leaf nodes are drawn as squares in the figure. The tree that results is a <b class="bold"><i class="emphasis">full binary tree</i></b>: each node is either a leaf or has degree exactly 2. There are no degree-1 nodes. Consequently, the order of the children of a node preserves the position information.<a name="3391"></a><a name="IDX-1090"></a>
</p>
<p class="para">The positioning information that distinguishes binary trees from ordered trees can be extended to trees with more than 2 children per node. In a <b class="bold"><i class="emphasis">positional tree</i></b>, the children of a node are labeled with distinct positive integers. The <i class="emphasis">i</i>th child of a node is <b class="bold"><i class="emphasis">absent</i></b> if no child is labeled with integer <i class="emphasis">i</i>. A <b class="bold"><i class="emphasis">k-ary</i></b> tree is a positional tree in which for every node, all children with labels greater than <i class="emphasis">k</i> are missing. Thus, a binary tree is a <i class="emphasis">k</i>-ary tree with <i class="emphasis">k</i> = 2.</p>
<p class="para">A <b class="bold"><i class="emphasis">complete k-ary tree</i></b> is a <i class="emphasis">k</i>-ary tree in which all leaves have the same depth and all internal nodes have degree <i class="emphasis">k</i>. <a class="internaljump" href="#ap-bfig08">Figure B.8</a> shows a complete binary tree of height 3. How many leaves does a complete <i class="emphasis">k</i>-ary tree of height <i class="emphasis">h</i> have? The root has <i class="emphasis">k</i> children at depth 1, each of which has <i class="emphasis">k</i> children at depth 2, etc. Thus, the number of leaves at depth <i class="emphasis">h</i> is <i class="emphasis">k<sup>h</sup></i>. Consequently, the height of a complete <i class="emphasis">k</i>-ary tree with <i class="emphasis">n</i> leaves is log<sub><i class="emphasis">k</i></sub> <i class="emphasis">n</i>. The number of internal nodes of a complete <i class="emphasis">k</i>-ary tree of height <i class="emphasis">h</i> is</p>
<div class="informalequation">
<span class="equation-image"><img src="images/fig1112_02.jpg" height="85" width="224" alt="" border="0"></span>
</div>
<p class="para">by <a href="DDU0244.html#3288" target="_parent" class="chapterjump">equation (A.5)</a>. Thus, a complete binary tree has 2<sup><i class="emphasis">h</i></sup> - 1 internal nodes.</p>
<div class="figure">
<a name="3392"></a><a name="ap-bfig08"></a><span class="figuremediaobject"><a href="images/fig1112%5F01%5F0%2Ejpg" NAME="IMG_2116" target="_parent"><img src="images/fig1112_01.jpg" height="119" width="336" alt="Click To expand" border="0"></a></span>
<br style="line-height: 1">
<span class="figure-title"><span class="figure-titlelabel">Figure B.8: </span>A complete binary tree of height 3 with 8 leaves and 7 internal nodes.</span>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises B.5-1</span></span><a name="3393"></a><a name="ap-bex24"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Draw all the free trees composed of the 3 vertices <i class="emphasis">A, B</i>, and <i class="emphasis">C</i>. Draw all the rooted trees with nodes <i class="emphasis">A, B</i>, and <i class="emphasis">C</i> with <i class="emphasis">A</i> as the root. Draw all the ordered trees with nodes <i class="emphasis">A, B</i>, and <i class="emphasis">C</i> with <i class="emphasis">A</i> as the root. Draw all the binary trees with nodes <i class="emphasis">A, B</i>, and <i class="emphasis">C</i> with <i class="emphasis">A</i> as the root.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<a name="3394"></a><a name="IDX-1091"></a>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises B.5-2</span></span><a name="3395"></a><a name="ap-bex25"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let <i class="emphasis">G</i> = (<i class="emphasis">V, E</i>) be a directed acyclic graph in which there is a vertex <i class="emphasis">v</i><sub>0</sub> <span class="unicode">&isin;</span> <i class="emphasis">V</i> such that there exists a unique path from <i class="emphasis">v</i><sub>0</sub> to every vertex <i class="emphasis">v</i> <span class="unicode">&isin;</span> <i class="emphasis">V</i>. Prove that the undirected version of <i class="emphasis">G</i> forms a tree.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises B.5-3</span></span><a name="3396"></a><a name="ap-bex26"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show by induction that the number of degree-2 nodes in any nonempty binary tree is 1 less than the number of leaves.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises B.5-4</span></span><a name="3397"></a><a name="ap-bex27"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Use induction to show that a nonempty binary tree with <i class="emphasis">n</i> nodes has height at least <span class="unicode">&lfloor;</span>lg <i class="emphasis">n</i><span class="unicode">&rfloor;</span>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises B.5-5: </span><span class="unicode">&#9733;</span></span><a name="3398"></a><a name="ap-bex28"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">The <b class="bold"><i class="emphasis">internal path length</i></b> of a full binary tree is the sum, taken over all internal nodes of the tree, of the depth of each node. Likewise, the <b class="bold"><i class="emphasis">external path length</i></b> is the sum, taken over all leaves of the tree, of the depth of each leaf. Consider a full binary tree with <i class="emphasis">n</i> internal nodes, internal path length <i class="emphasis">i</i>, and external path length <i class="emphasis">e</i>. Prove that <i class="emphasis">e</i> = <i class="emphasis">i</i> + 2<i class="emphasis">n</i>.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises B.5-6: </span><span class="unicode">&#9733;</span></span><a name="3399"></a><a name="ap-bex29"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Let us associate a "weight" <i class="emphasis">w</i>(<i class="emphasis">x</i>) = 2<sup>-<i class="emphasis">d</i></sup> with each leaf <i class="emphasis">x</i> of depth <i class="emphasis">d</i> in a binary tree <i class="emphasis">T</i>. Prove that <span class="unicode">&Sigma;</span><sub><i class="emphasis">x</i></sub> <i class="emphasis">w</i>(<i class="emphasis">x</i>) <span class="unicode">&le;</span> 1, where the sum is taken over all leaves <i class="emphasis">x</i> in <i class="emphasis">T</i>. (This is known as the <b class="bold"><i class="emphasis">Kraft inequality</i></b>.)</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Exercises B.5-7: </span><span class="unicode">&#9733;</span></span><a name="3400"></a><a name="ap-bex30"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Show that every binary tree with <i class="emphasis">L</i> leaves contains a subtree having between <i class="emphasis">L</i>/3 and 2<i class="emphasis">L</i>/3 leaves, inclusive.</p>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems B-1: </span>Graph coloring</span><a name="3401"></a><a name="ap-bex31"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Given an undirected graph <i class="emphasis">G</i> = (<i class="emphasis">V, E</i>), a <b class="bold"><i class="emphasis">k-coloring</i></b> of <i class="emphasis">G</i> is a function <i class="emphasis">c</i> : <i class="emphasis">V</i> <span class="unicode">&rarr;</span> {0,1,...,<i class="emphasis">k</i> - 1} such that <i class="emphasis">c</i>(<i class="emphasis">u</i>) <span class="unicode">&ne;</span> <i class="emphasis">c</i>(<i class="emphasis">v</i>) for every edge (<i class="emphasis">u, v</i>) <span class="unicode">&isin;</span> <i class="emphasis">E</i>. In other words, the numbers 0, 1,..., <i class="emphasis">k</i> - 1 represent the <i class="emphasis">k</i> colors, and adjacent vertices must have different colors.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Show that any tree is 2-colorable.</p>
</li>
<li class="listitem">
<p class="first-para">Show that the following are equivalent:<a name="3402"></a><a name="IDX-1092"></a>
</p>
<ol class="orderedlist">
<li class="first-listitem">
<p class="first-para">
<i class="emphasis">G</i> is bipartite.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">G</i> is 2-colorable.</p>
</li>
<li class="listitem">
<p class="first-para">
<i class="emphasis">G</i> has no cycles of odd length.</p>
</li>
</ol>
</li>
<li class="listitem">
<p class="first-para">Let <i class="emphasis">d</i> be the maximum degree of any vertex in a graph <i class="emphasis">G</i>. Prove that <i class="emphasis">G</i> can be colored with <i class="emphasis">d</i> + 1 colors.</p>
</li>
<li class="listitem">
<p class="first-para">Show that if <i class="emphasis">G</i> has <i class="emphasis">O</i>(|<i class="emphasis">V</i>|) edges, then <i class="emphasis">G</i> can be colored with <span class="inlinemediaobject"><img src="images/fig1114_01.jpg" height="14" width="45" alt="" border="0"></span> colors.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems B-2: </span>Friendly graphs</span><a name="3403"></a><a name="ap-bex32"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Reword each of the following statements as a theorem about undirected graphs, and then prove it. Assume that friendship is symmetric but not reflexive.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">In any group of <i class="emphasis">n</i> <span class="unicode">&ge;</span> 2 people, there are two people with the same number of friends in the group.</p>
</li>
<li class="listitem">
<p class="first-para">Every group of six people contains either three mutual friends or three mutual strangers.</p>
</li>
<li class="listitem">
<p class="first-para">Any group of people can be partitioned into two subgroups such that at least half the friends of each person belong to the subgroup of which that person is <i class="emphasis">not</i> a member.</p>
</li>
<li class="listitem">
<p class="first-para">If everyone in a group is the friend of at least half the people in the group, then the group can be seated around a table in such a way that everyone is seated between two friends.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
<div class="example">
<span class="example-title"><span class="example-titlelabel">Problems B-3: </span>Bisecting trees</span><a name="3404"></a><a name="ap-bex33"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="Start example" border="0"></b></font></td>
</tr>
</table>
<p class="first-para">Many divide-and-conquer algorithms that operate on graphs require that the graph be bisected into two nearly equal-sized subgraphs, which are induced by a partition of the vertices. This problem investigates bisections of trees formed by removing a small number of edges. We require that whenever two vertices end up in the same subtree after edges are removed, then they must be in the same partition.</p>
<ol class="orderedlist" type="a">
<li class="first-listitem">
<p class="first-para">Show that by removing a single edge, we can partition the vertices of any <i class="emphasis">n</i>-vertex binary tree into two sets <i class="emphasis">A</i> and <i class="emphasis">B</i> such that |<i class="emphasis">A</i>| <span class="unicode">&le;</span> 3<i class="emphasis">n</i>/4 and |<i class="emphasis">B</i>| <span class="unicode">&le;</span> 3<i class="emphasis">n</i>/4.</p>
</li>
<li class="listitem">
<p class="first-para">Show that the constant 3/4 in part (a) is optimal in the worst case by giving an example of a simple binary tree whose most evenly balanced partition upon removal of a single edge has |<i class="emphasis">A</i>| = 3<i class="emphasis">n</i>/4.</p>
<a name="3405"></a><a name="IDX-1093"></a>
</li>
<li class="listitem">
<p class="first-para">Show that by removing at most <i class="emphasis">O</i>(lg <i class="emphasis">n</i>) edges, we can partition the vertices of any <i class="emphasis">n</i>-vertex binary tree into two sets <i class="emphasis">A</i> and <i class="emphasis">B</i> such that |<i class="emphasis">A</i>| = <span class="unicode">&lfloor;</span><i class="emphasis">n</i>/2<span class="unicode">&rfloor;</span> and |<i class="emphasis">B</i>| = <span class="unicode">&lceil;</span><i class="emphasis">n</i>/2<span class="unicode">&rceil;</span>.</p>
</li>
</ol>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img src="_.gif" width="1" height="2" alt="End example" border="0"></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>

</div>

</div>
<div class="footnotes">
<div class="footnote">
<p>
<sup>[<a name="ftn.N970" href="#N970">4</a>]</sup>The term "node" is often used in the graph theory literature as a synonym for "vertex." We shall reserve the term "node" to mean a vertex of a rooted tree.</p>
</div>
<div class="footnote">
<p>
<sup>[<a name="ftn.N1187" href="#N1187">5</a>]</sup>Notice that the degree of a node depends on whether <i class="emphasis">T</i> is considered to be a rooted tree or a free tree. The degree of a vertex in a free tree is, as in any undirected graph, the number of adjacent vertices. In a rooted tree, however, the degree is the number of children<span class="unicode">-</span>the parent of a node does not count toward its degree.</p>
</div>
</div>
</div>
</div>
</div>
<br><hr size="1">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td align="left" width="30%">
<div STYLE="MARGIN-LEFT: 0.15in;">
<a href="DDU0250.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</div></td>
<td align="center" width="40%">
<a href="toc.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td align="right" width="30%">
<div STYLE="MARGIN-RIGHT: 0.15in"><a href="DDU0252.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr>
</table>
</body>
</html>
