<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>13.1. Emacs and Unix</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-13.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-13-SECT-2.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="gnu3-CHP-13-SECT-1"></A>
<H3 class="docSection1Title">13.1. Emacs and Unix</H3>

<P class="docText">Emacs was originally built
<A NAME="gnu3-CHP-13-ITERM-2921"></A><A NAME="gnu3-CHP-13-ITERM-2922"></A>on a Unix system and continues to run
on the multitude of Unix variants out there. We're
going to download the latest source and show you how to build Emacs
from scratch. It's not really that hard and it has
the salutary effect of keeping you up-to-date with future releases.</P>

<A NAME="gnu3-CHP-13-SECT-1.1"></A>
<H4 class="docSection2Title">13.1.1 Where to Get Emacs?</H4>

<P class="docText">If you can't wait, the primary source
<A NAME="gnu3-CHP-13-ITERM-2923"></A><A NAME="gnu3-CHP-13-ITERM-2924"></A>for
downloading Emacs is <A class="docLink" target="_blank" HREF="http://ftp.gnu.org/pub/gnu/emacs/">http://ftp.gnu.org/pub/gnu/emacs/</A>.
Alternatively, you can use CVS to nab the absolute latest build. But
more on that in a minute.</P>

<A NAME="gnu3-CHP-13-SECT-1.1.1"></A>
<H5 class="docSection3Title">13.1.1.1 Downloading Emacs from the Web</H5>

<P class="docText">You can get Emacs from any one
<A NAME="gnu3-CHP-13-ITERM-2925"></A><A NAME="gnu3-CHP-13-ITERM-2926"></A><A NAME="gnu3-CHP-13-ITERM-2927"></A>of many
sites—as long as your Internet connection is fast enough to
transfer a 20 MB file easily. You must also have at least 120 MB of
disk space free; this number will certainly grow in future Emacs
releases.</P>

<P class="docText">The Free Software Foundation maintains a definitive list of all
mirror sites. The FSF is the principal sponsor of the GNU Project and
it is housed at their site. If you want to look around a bit,
<A class="docLink" target="_blank" HREF="http://www.gnu.org/">http://www.gnu.org/</A> is the place
to start. Or as mentioned earlier, you can just jump directly to the
directly listing for Emacs at <A class="docLink" target="_blank" HREF="http://ftp.gnu.org/pub/gnu/emacs/">http://ftp.gnu.org/pub/gnu/emacs/</A>. You should
see a list similar to <A class="docLink" HREF="#gnu3-CHP-13-FIG-1">Figure 13-1</A>.</P>

<A NAME="gnu3-CHP-13-FIG-1"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 13-1. The emacs directory at gnu.org</H5>
<IMG BORDER="0" width="431" height="405" SRC="images/0596006489/figs/ge3_fig1301.gif" ALT=""></CENTER></p><br>

<P class="docText">Look for the latest version of Emacs (21.3 in <A class="docLink" HREF="#gnu3-CHP-13-FIG-1">Figure 13-1</A>) and download it.</P>



<A NAME="gnu3-CHP-13-SECT-1.2"></A>
<H4 class="docSection2Title">13.1.2 Where to Put Emacs?</H4>

<P class="docText">Regardless of where you go to get
<A NAME="gnu3-CHP-13-ITERM-2928"></A><A NAME="gnu3-CHP-13-ITERM-2929"></A>the
source, where you put the files you download is really up to you. For
our Unix-based systems, we downloaded everything into
<span class="docEmphasis">/usr/local/install</span>. This is a fine place to
start, but if you have a favorite download/development area, feel
free to use that. In fact, you can even put everything in your home
directory while you're building things.</P>

<P class="docText">The only thing to remember is that the build process involves a lot
of files that you won't need after
everything's done. Make sure you put things
somewhere that's easy to clean up when all is said
and done.</P>

<P class="docText">As for the final destination of the executable,
that's also up to you. Most Unix systems (including
Mac OS X) will do well to use the <span class="docEmphasis">/usr/local</span>
hierarchy. That directory is both common and the default choice in
the build scripts. If you're not on a machine that
you have complete control over, though, you can certainly install
Emacs into your home directory (or a subdirectory you keep for you
own software).</P>

<P class="docText">One quick note on using your home directory for the executable
version of Emacs: it does make it easy to back up Emacs or transfer
it to another machine if you upgrade your system (we know from
experience!). However, it can limit who has access to Emacs. If
another user works on the same machine and you both want to use
Emacs, installing to a common directory (like
<span class="docEmphasis">/usr/local</span> ) is definitely the way to go.</P>


<A NAME="gnu3-CHP-13-SECT-1.3"></A>
<H4 class="docSection2Title">13.1.3 Uncompressing and Unpacking</H4>

<P class="docText">Now that you have the file, you need
<A NAME="gnu3-CHP-13-ITERM-2930"></A><A NAME="gnu3-CHP-13-ITERM-2931"></A><A NAME="gnu3-CHP-13-ITERM-2932"></A><A NAME="gnu3-CHP-13-ITERM-2933"></A>to
do two things to it before you can actually build Emacs: uncompress
and unpack. You can use the <span class="docEmphBold">tar</span>
command to do both. Make sure you are in the directory where you
downloaded the Emacs file. Type the following command (changing the
<TT><I>n</I></TT> to the version number that matches the
file you downloaded), and you will see a list of files.</P>

<PRE>$ <span class="docEmphBold">tar xvzf emacs-21</span>.<TT><I>n</I></TT><span class="docEmphBold">.tar.gz</span>
x emacs-21.3, 0 bytes, 0 tape blocks
x emacs-21.3/AUTHORS, 77854 bytes, 153 tape blocks
x emacs-21.3/FTP, 8950 bytes, 18 tape blocks
x emacs-21.3/INSTALL, 42841 bytes, 84 tape blocks
x emacs-21.3/README, 4046 bytes, 8 tape blocks
x emacs-21.3/BUGS, 1042 bytes, 3 tape blocks
x emacs-21.3/move-if-change, 129 bytes, 1 tape blocks
x emacs-21.3/ChangeLog, 161418 bytes, 316 tape blocks
x emacs-21.3/Makefile.in, 25461 bytes, 50 tape blocks
. . .</PRE><BR>


<P class="docText">This list of created files goes on for quite a while—over 2500
files for Emacs 21.3. If you don't want to see the
list, omit the <span class="docEmphBold">v</span> (<span class="docEmphBold">verbose</span> option) from the <span class="docEmphBold">tar</span> command. When this command completes, you
have all of the files for Emacs.</P>

<P class="docText">Now that any necessary preparations are out of the way, you can go
through the steps to build and install Emacs itself.</P>


<A NAME="gnu3-CHP-13-SECT-1.4"></A>
<H4 class="docSection2Title">13.1.4 Downloading Emacs from CVS</H4>

<P class="docText">As we mentioned earlier,
<A NAME="gnu3-CHP-13-ITERM-2934"></A><A NAME="gnu3-CHP-13-ITERM-2935"></A><A NAME="gnu3-CHP-13-ITERM-2936"></A>you can also use
<span class="docEmphBold">CVS</span> to pull the source files. The
big advantage with CVS is that you get the absolute latest version.</P>

<div style="font-weight:bold"><OL class="docList" TYPE="1"><LI><div style="font-weight:normal"><P class="docList">Create or switch to a directory where your Emacs build can remain.
Don't do this in a temporary directory unless you
don't plan on keeping Emacs around. Once there, set
up the <span class="docEmphBold">CVS_RSH</span> environment variable:</P><PRE>% <B>setenv CVS_RSH ssh</B></PRE><BR>
</div></LI><LI><div style="font-weight:normal"><P class="docList">If the <span class="docEmphBold">setenv</span> command is not
recognized, you're probably running <span class="docEmphBold">bash</span> instead of a <span class="docEmphBold">csh</span>-derived shell. In that case, use the
following command for the environment variable.</P><PRE>$ <B>export CVS_RSH="ssh"</B></PRE><BR>
</div></LI><LI><div style="font-weight:normal"><P class="docList">Use the <span class="docEmphBold">cvs</span> command to grab the
source code.</P><PRE>% <B>cvs -z3 -d:ext:anoncvs@savannah.gnu.org:/cvsroot/emacs co emacs</B>
The authenticity of host 'savannah.gnu.org (199.232.41.3)' can't be established.
RSA key fingerprint is 80:5a:b0:0c:ec:93:66:29:49:7e:04:2b:fd:ba:2c:d5.
Are you sure you want to continue connecting (yes/no)?</PRE><BR>
</div></LI><LI><div style="font-weight:normal"><P class="docList">Verify that the public key matches this key:</P><PRE>80:5a:b0:0c:ec:93:66:29:49:7e:04:2b:fd:ba:2c:d5</PRE><BR>
</div></LI><LI><div style="font-weight:normal"><P class="docList">That just makes sure you actually got connected to the right system
and aren't being fed some malicious alternative.</P></div></LI><LI><div style="font-weight:normal"><P class="docList">If the keys match, type <span class="docEmphBold">yes</span> and
press <span class="docEmphBold">Enter</span>.</P><PRE>Warning: Permanently added 'savannah.gnu.org,199.232.41.3' 
(RSA) to the list of known hosts.
cvs server: Updating emacs
U emacs/.cvsignore
U emacs/AUTHORS
U emacs/BUGS
U emacs/COPYING
U emacs/ChangeLog
U emacs/FTP
U emacs/INSTALL
...</PRE><BR>
</div></LI></OL></div>

<P class="docText">You'll see thousands of filenames flying by. If you
have a slow network connection, this process could take a while. Hang
in there, though—you're on your way to
building the absolute latest version of Emacs!</P>


<A NAME="gnu3-CHP-13-SECT-1.5"></A>
<H4 class="docSection2Title">13.1.5 Building Emacs</H4>

<P class="docText">Unless you get a <A NAME="gnu3-CHP-13-ITERM-2937"></A><A NAME="gnu3-CHP-13-ITERM-2938"></A>prebuilt
version of Emacs that is right for your system, you will need to
build and install the many executable components of Emacs from source
code before you can use it. At this point, it
doesn't matter how you got the source code (HTTP or
CVS), you just need to compile it! Here is some information to get
you started on this task.</P>

<P class="docText">Your source code has a top-level directory with a name like
<span class="docEmphasis">emacs-21.3</span>. In this directory, you will find
files called <span class="docEmphasis">INSTALL</span> and
<span class="docEmphasis">README</span>. Examine <span class="docEmphasis">README</span>
first; it contains useful general information as well as last-minute
release notes that may be important for you to read before
proceeding. Then read <span class="docEmphasis">INSTALL</span>, which gives
step-by-step instructions for building Emacs. Even if you
aren't a Unix expert, you should be able to follow
these instructions. (For convenience, we provide a procedure you can
follow later in this section.)</P>

<P class="docText">The FSF's standard installation procedure gets more
comprehensive and bulletproof all the time. Still, the actual ease of
building Emacs depends primarily on what combination of hardware and
software you have. The FSF's installation script
includes a program called <span class="docEmphBold">configure</span>
that examines your system, figures out what hardware and software you
are running, and configures Emacs accordingly.</P>

<P class="docText"><span class="docEmphBold">configure</span> is likely to guess
correctly if you have a popular combination (such as a Sun SPARC CPU
and a recent release of Solaris). If this is true, you should be able
to build Emacs without lots of tweaking or technical expertise.
However, if you have an unusual setup—a wildly obsolete
computer or operating system version, an unusual hardware/software
combination, or unconventional system configuration—then you
will have no choice but to tweak the software.
That's beyond the scope of this book, but those
<span class="docEmphasis">README</span> and <span class="docEmphasis">INSTALL</span> files
that come with the source distribution are a great place to start
when dealing with uncommon setups.</P>

<P class="docText">Here's a procedure for building Emacs that you can
use as a guide:</P>

<div style="font-weight:bold"><OL class="docList" TYPE="1"><LI><div style="font-weight:normal"><P class="docList">Change to the directory where you uncompressed and unpacked Emacs.
For example, if you placed it in the
<span class="docEmphasis">/usr/local/install</span> directory:</P><PRE>$ <B>cd /usr/local/install/emacs-21.3</B></PRE><BR>
</div></LI><LI><div style="font-weight:normal"><P class="docList">Run the configure utility.<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-13-FNOTE-1">[1]</A></sup> You should see quite
a bit of output that shows what parts of the system the build script
is looking for.</P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-13-FNOTE-1">[1]</A></sup> Depending on your system
and its permissions, you may have to switch to the root user using
<span class="docEmphBold">su</span> to install Emacs. In that case,
you won't need to preface the final <span class="docEmphBold">make</span> command with <span class="docEmphBold">sudo</span>.</p></blockquote><PRE>$ <B>./configure</B>
creating cache ./config.cache
checking host system type... sparc-sun-solaris2.9
checking for gcc... gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... yes
checking whether gcc accepts -g... yes
checking whether ln -s works... yes
checking how to run the C preprocessor... gcc -E</PRE><BR>
</div></LI><LI><div style="font-weight:normal"><P class="docList">If <span class="docEmphBold">configure</span> is successful, you
should see a handy summary message similar to the following:</P><PRE>Configured for `sparc-sun-solaris2.9'.

  Where should the build process find the source code? /usr/local/install/emacs-21.3
  What operating system and machine description files should Emacs use?
        `s/sol2-5.h' and `m/sparc.h'
  What compiler should emacs be built with?               gcc -g -O2
  Should Emacs use the GNU version of malloc?             yes
  Should Emacs use a relocating allocator for buffers?    yes
  Should Emacs use mmap(2) for buffer allocation?         no
  What window system should Emacs use?                    x11
  What toolkit should Emacs use?                          LUCID
  Where do we find X Windows header files?                Standard dirs
  Where do we find X Windows libraries?                   Standard dirs
  Does Emacs use -lXaw3d?                                 no
  Does Emacs use -lXpm?                                   yes
  Does Emacs use -ljpeg?                                  no
  Does Emacs use -ltiff?                                  no
  Does Emacs use -lungif?                                 no
  Does Emacs use -lpng?                                   no
  Does Emacs use X toolkit scroll bars?                   no</PRE><BR>
<P class="docList">If the configuration process fails for any reason,
you'll want to go back and consult the
<span class="docEmphasis">INSTALL</span> document. It has several tips and tricks
for particular systems and situations.</P></div></LI><LI><div style="font-weight:normal"><P class="docList">If everything is properly configured, you can go ahead and compile
Emacs with the <span class="docEmphBold">make</span> utility. This
may take a while, so start it before you head out for lunch.</P><PRE>$ <B>make</B>
if [ ! -f /usr/local/install/emacs-21.3/lisp/abbrev.elc ]; then \
  make  bootstrap; \
fi
cd lib-src; make all  \
  CC='gcc' CFLAGS='-g -O2' CPPFLAGS='' \
  LDFLAGS='' MAKE='make'
gcc -DHAVE_CONFIG_H -I. -I../src -I/usr/local/install/emacs-21.3/lib-src 
-I/usr/local/install/emacs-21.3/lib-src/../src   -g -O2 -o test-distrib 
/usr/local/install/emacs-21.3/lib-src/test-distrib.c
./test-distrib /usr/local/install/emacs-21.3/lib-src/testfile
gcc -DHAVE_CONFIG_H -I. -I../src -I/usr/local/install/emacs-21.3/lib-src 
-I/usr/local/install/emacs-21.3/lib-src/../src   -g -O2 /usr/local/install/
emacs-21.3/lib-src/make-docfile.c -lsocket -lnsl -lkstat -o make-docfile
...</PRE><BR>
</div></LI><LI><div style="font-weight:normal"><P class="docList">When that completes, the <span class="docEmphasis">INSTALL</span> document
recommends testing your newly built Emacs with the following command:</P><PRE>$ <B>src/emacs -q</B></PRE><BR>
<P class="docList">Emacs should run and you should get an introduction screen similar to
<A class="docLink" HREF="#gnu3-CHP-13-FIG-2">Figure 13-2</A>.</P><A NAME="gnu3-CHP-13-FIG-2"></A><p><CENTER>
<H5 class="docFigureTitle">Figure 13-2. Emacs test after building on a Linux system</H5>
<IMG BORDER="0" width="391" height="273" SRC="images/0596006489/figs/ge3_fig1302.gif" ALT=""></CENTER></p><br></div></LI><LI><div style="font-weight:normal"><P class="docList">If you see the Emacs splash screen,<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-13-FNOTE-2">[2]</A></sup>
you're in good shape, so go ahead and install it:</P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-13-FNOTE-2">[2]</A></sup> One of the
authors was not able to see the splash screen, but the install worked
fine nonetheless. We say forge ahead even if you
don't see it.</p></blockquote><PRE>$ <B>sudo make install</B></PRE><BR>
<P class="docList">or, if you <span class="docEmphasis">su</span>'d to root
earlier, simply:</P><PRE>$ <B>make install</B></PRE><BR>
<P class="docList">You'll be prompted for your password. After the
install completes, you should be all set to use Emacs.
Congratulations!</P></div></LI></OL></div>


<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-13.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-13-SECT-2.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
