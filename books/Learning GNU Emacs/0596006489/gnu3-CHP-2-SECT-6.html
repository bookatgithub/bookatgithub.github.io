<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>2.6. Canceling Commands and Undoing Changes</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-2-SECT-5.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-2-SECT-7.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="gnu3-CHP-2-SECT-6"></A>
<H3 class="docSection1Title" >2.6. Canceling Commands and Undoing Changes</H3>

<P class="docText">Sometimes you start a command by accident or change your mind about
it. Don't worry: with Emacs, you can quit in the
middle or undo it.</P>

<A NAME="gnu3-CHP-2-SECT-6.1"></A>
<H4 class="docSection2Title">2.6.1 Canceling Commands</H4>

<P class="docText">When you want to cancel any
<A NAME="gnu3-CHP-2-ITERM-1788"></A><A NAME="gnu3-CHP-2-ITERM-1789"></A><A NAME="gnu3-CHP-2-ITERM-1790"></A>command
that's in progress, press <span class="docEmphBold">C-g</span>. The word <span class="docEmphBold">Quit</span> appears in the command area. This command
is helpful when you are stuck in the minibuffer and
didn't really mean to go there. Depending on what
you were doing, you may have to press <span class="docEmphBold">C-g</span> a few times.</P>


<A NAME="gnu3-CHP-2-SECT-6.2"></A>
<H4 class="docSection2Title">2.6.2 Undoing Changes</H4>

<P class="docText">What happens if you make a
<A NAME="gnu3-CHP-2-ITERM-1791"></A><A NAME="gnu3-CHP-2-ITERM-1792"></A><A NAME="gnu3-CHP-2-ITERM-1793"></A>mistake
while you're editing? You can undo your changes by
pressing <span class="docEmphBold">C-_</span> or <span class="docEmphBold">C-x u</span> (for <span class="docEmphBold">undo</span>; conveniently, the toolbar also has an
undo icon, a curved left arrow). By typing <span class="docEmphBold">undo</span> repeatedly, you can gradually work your
way back to a point before your mistake.<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-2-FNOTE-7">[7]</A></sup> Although the <span class="docEmphBold">undo</span>
command is very powerful, saving your file frequently, if not
compulsively, is nevertheless a good idea. We usually save a file
whenever we stop typing—even if only for a few seconds. Train
your fingers to press <span class="docEmphBold">C-x C-s</span>
whenever you pause; it's a good habit to form.</P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-2-FNOTE-7">[7]</A></sup> If you find
that you repeat the undo command frequently, it's
worth getting fluent with <span class="docEmphBold">C-_</span>.
It's true that this requires holding down <span class="docEmphBold">Ctrl</span> and <span class="docEmphBold">Shift</span> at the same time, but once
you've got that down, pressing <span class="docEmphBold">_</span> repeatedly is much easier than typing
<span class="docEmphBold">C-x u</span> again and again.</p></blockquote>

<P class="docText">If you're used to typing <span class="docEmphBold">C-z</span> to undo, you can easily change
Emacs's behavior to match your habits. See
"Making Emacs Work the Way You
Want" at the end of this chapter for information on
CUA mode.</P>

<P class="docText">What if you'd like to redo a command after you type
<span class="docEmphBold">undo</span>? There is no formal
<span class="docEmphasis">redo</span> command, but you can use <span class="docEmphBold">undo</span> in the following way. Just move the
cursor in any direction, and
<A NAME="gnu3-CHP-2-ITERM-1794"></A><A NAME="gnu3-CHP-2-ITERM-1795"></A>type <span class="docEmphBold">C-_</span> or <span class="docEmphBold">C-x u</span>
again. Emacs redoes the last command you undid. You can repeat it to
redo previous <span class="docEmphBold">undo</span>s.</P>

<P class="docText">Although <span class="docEmphBold">undo</span> is an important
command, it can be slow if you want to undo a large number of
changes. <A class="docLink" HREF="#gnu3-CHP-2-TABLE-11">Table 2-11</A> summarizes three methods for
undoing changes and circumstances in which you might want to use
them.</P>

<A NAME="gnu3-CHP-2-TABLE-11"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 2-11. Methods for undoing changes</h5></CAPTION><COLGROUP><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">If you</span>:</P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Use this command</span>:</P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText">Don't like the recent changes
you've made and want to undo them one by one</P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-_</span> <span class="docEmphasis">or</span> <span class="docEmphBold">C-x u</span> (<span class="docEmphBold">undo</span>)</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Want to undo all changes made since you last saved the file</P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">M-x revert-buffer Enter</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Want to go back to an earlier version of the file (the file as it was
when you started this editing session)</P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-x C-f</span>
<span class="docEmphasis">filename</span><span class="docEmphBold">~ Enter
C-x C-w</span> <span class="docEmphasis">filename</span> <span class="docEmphBold">Enter</span></P>
</TD></TR></TABLE></P><br>

<P class="docText">We've already talked about undoing changes with
<span class="docEmphBold">undo</span>; next we describe how to revert
a buffer from a file and how to go back to an earlier version.</P>


<A NAME="gnu3-CHP-2-SECT-6.3"></A>
<H4 class="docSection2Title">2.6.3 Reverting a Buffer from a File</H4>

<P class="docText">If the <span class="docEmphBold">undo</span> command
isn't
<A NAME="gnu3-CHP-2-ITERM-1796"></A><A NAME="gnu3-CHP-2-ITERM-1797"></A><A NAME="gnu3-CHP-2-ITERM-1798"></A>useful,
there's another way to restore a file to an earlier
state. If you want to get the file back to the state that is stored
on disk, type <span class="docEmphBold">M-x revert-buffer
Enter</span>. Emacs asks the following question:</P>

<PRE>Revert buffer from file <TT><I>filename</I></TT>? (yes or no)</PRE><BR>


<P class="docText">The filename is the name of your original file. Type <span class="docEmphBold">yes</span> if you want to restore the file, or
<span class="docEmphBold">no</span> if you've
changed your mind. Emacs copies the file stored on disk into the
buffer, conveniently forgetting everything that happened since the
last time you saved the file. Although this command is called
<span class="docEmphBold">revert-buffer</span>, note that it can
revert only buffers associated with files.</P>


<A NAME="gnu3-CHP-2-SECT-6.4"></A>
<H4 class="docSection2Title">2.6.4 Going Back to a Previous Version: Backup Files</H4>

<P class="docText">The first time you save a file during
<A NAME="gnu3-CHP-2-ITERM-1799"></A><A NAME="gnu3-CHP-2-ITERM-1800"></A><A NAME="gnu3-CHP-2-ITERM-1801"></A>an editing session, Emacs creates a
backup file. If something disastrous happens, and the other
techniques for undoing changes won't help you, you
can always return to the backup file. The <A NAME="gnu3-CHP-2-ITERM-1802"></A>name of the backup file is the same as the
name of the file you're editing, with a tilde
(<span class="docEmphBold">~</span>) added. For example, if you are
editing the file <span class="docEmphasis">text</span>, the backup file is
<span class="docEmphasis">text~</span>.</P>

<P class="docText">Emacs doesn't provide any special commands for
restoring a buffer from the backup copy. The easiest way to do this
is to edit the backup copy and then save it as the real file. For
example, if you were working with a file called
<span class="docEmphasis">text</span>, you could: exit Emacs by typing <span class="docEmphBold">C-x C-c</span>, then start Emacs again by typing
<span class="docEmphBold">emacs</span> <span class="docEmphasis">text~</span>.
After the backup file is displayed, save it as the real file by
typing <span class="docEmphBold">C-x C-w</span>
<span class="docEmphasis">text</span>
<span class="docEmphBold">Enter</span>. As a safeguard, Emacs asks you before it writes
over the original file:</P>

<PRE>File <TT><I>text</I></TT> exists; overwrite? (y or n)</PRE><BR>


<P class="docText">Type <span class="docEmphBold">y</span> to overwrite the original
<A NAME="gnu3-CHP-2-ITERM-1803"></A><A NAME="gnu3-CHP-2-ITERM-1804"></A>file with the backup file.</P>

<P class="docText">GNU Emacs also has a
<A NAME="gnu3-CHP-2-ITERM-1805"></A><A NAME="gnu3-CHP-2-ITERM-1806"></A><A NAME="gnu3-CHP-2-ITERM-1807"></A>numbered backup facility. If you turn
on numbered backups, Emacs creates a backup file (with the suffix
<span class="docEmphasis">~n~</span>) every time you save your file.
<span class="docEmphasis">n</span> increments with each successive save. If you
are nervous about deleting older versions, it might be worth using:
you can keep all of your old versions forever, if you want to.
However, numbered backups can also waste disk space; a happy medium
may be to tell Emacs to keep the last <span class="docEmphasis">n</span>
versions, where <span class="docEmphasis">n</span> is the number of versions you
want to keep. The variables that control numbered backups are
described in Appendix A. If you are interested in full-blown version
control, check out VC mode, discussed in <A class="docLink" HREF="gnu3-CHP-12.html#gnu3-CHP-12">Chapter 12</A>. <A class="docLink" HREF="#gnu3-CHP-2-TABLE-12">Table 2-12</A>
<A NAME="gnu3-CHP-2-ITERM-1808"></A><A NAME="gnu3-CHP-2-ITERM-1809"></A><A NAME="gnu3-CHP-2-ITERM-1810"></A><A NAME="gnu3-CHP-2-ITERM-1811"></A>summarizes the commands for
stopping commands and undoing changes.</P>

<A NAME="gnu3-CHP-2-TABLE-12"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 2-12. Stopping and undoing commands</h5></CAPTION><COLGROUP><COL><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Keystrokes</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Command name</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Action</span></P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-g</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">keyboard-quit</span></P>
</TD><TD class="docTableCell">
<P class="docText">Abort current command.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-x u</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">advertised-undo<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-2-FNOTE-8">[8]</A></sup></span></P>
</TD><TD class="docTableCell">
<P class="docText">Undo last edit (can be done repeatedly).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-_</span> <span class="docEmphasis">Edit</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Undo</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">undo</span></P>
</TD><TD class="docTableCell">
<P class="docText">Undo last edit (can be done repeatedly).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">(<span class="docEmphasis">none</span>)</P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">revert-buffer</span></P>
</TD><TD class="docTableCell">
<P class="docText">Restore buffer to the state it was in when the file was last saved
(or auto-saved).</P>
</TD></TR></TABLE></P><br> <blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-2-FNOTE-8">[8]</A></sup> There is no
real difference between <span class="docEmphBold">undo</span> and
<span class="docEmphBold">advertised-undo</span>. They work the same
way.</p></blockquote> 


<A NAME="gnu3-CHP-2-SECT-6.5"></A>
<H4 class="docSection2Title">2.6.5 Recovering Lost Changes</H4>

<P class="docText">We've just discussed how to
<A NAME="gnu3-CHP-2-ITERM-1812"></A><A NAME="gnu3-CHP-2-ITERM-1813"></A><A NAME="gnu3-CHP-2-ITERM-1814"></A>eliminate
changes you don't want to keep; getting back changes
you've lost is a different kind of problem. You
might lose changes if the power goes out momentarily or if the
computer you're working on suddenly freezes or is
turned off accidentally. You might also lose changes if you exit
Emacs abnormally. Luckily, Emacs, being the watchful editor that it
is, saves your file for you every so often in <span class="docEmphasis">auto-save
files</span>. If you watch carefully, you'll see
the message <span class="docEmphBold">Auto saving</span> in the
minibuffer from time to time. Using auto-save files, you can get back
most, if not all, of your changes. The name of an auto-save file is
the same as the name of the file you are editing, with a sharp
(<span class="docEmphBold">#</span>) added to the beginning and the
end. For example, if you are editing the file
<span class="docEmphasis">text</span>, its auto-save file is
<span class="docEmphasis">#text#</span>.</P>

<P class="docText">To recover text from an <A NAME="gnu3-CHP-2-ITERM-1815"></A><A NAME="gnu3-CHP-2-ITERM-1816"></A>auto-save file, type <span class="docEmphBold">M-x recover-file Enter</span>. Emacs opens a window
that lists both the file and its associated auto-save file so that
you can compare the time at which they were created, their size, and
so forth. Emacs asks you the following question:</P>

<PRE>Recover auto-save file <TT><I>#text#</I></TT>? (yes or no)</PRE><BR>


<P class="docText">Type <span class="docEmphBold">yes</span> to confirm that you want to
copy the contents of the auto-save file into the current file or
<span class="docEmphBold">no</span> if you change your mind. (If you
are unsure, you might want to use <span class="docEmphBold">C-x
C-f</span> to read the auto-save file <span class="docEmphasis">#text#</span>
into a buffer first and look it over carefully before using the
<span class="docEmphBold">recover-file</span> command. If you really
want to compare the differences between the two versions, see
"Comparing Files Between Windows"
in <A class="docLink" HREF="gnu3-CHP-4.html#gnu3-CHP-4">Chapter 4</A>.)</P>

<P class="docText">When does Emacs create <A NAME="gnu3-CHP-2-ITERM-1817"></A><A NAME="gnu3-CHP-2-ITERM-1818"></A>auto-save
files? Emacs creates an auto-save file every few hundred keystrokes
or if Emacs is terminated abnormally.<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-2-FNOTE-9">[9]</A></sup>
You can change the frequency with which Emacs creates auto-save files
by changing the variable <span class="docEmphBold">auto-save-interval</span>. By default, Emacs creates
an auto-save file every 300 keystrokes. For more information on
changing variable values, see <A class="docLink" HREF="gnu3-CHP-10.html#gnu3-CHP-10">Chapter 10</A>.</P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-2-FNOTE-9">[9]</A></sup> We should say
that Emacs <span class="docEmphasis">tries</span> to do this. In some cases,
Emacs can't, and there is really no guarantee. Power
surges and OS crashes are examples of times where things happen so
fast that Emacs may not be able to create an auto-save file. But we
are surprised at how often it manages to do so.</p></blockquote>

<P class="docText">There's one more important fact to know about Emacs
and auto-save files. If you delete a large portion of a file, Emacs
stops auto-saving the file and displays a message telling you so. To
make Emacs start auto-saving again, save the file with <span class="docEmphBold">C-x C-s</span> or type <span class="docEmphBold">M-1 M-x
auto-save Enter</span> (that's the number 1).</P>

<P class="docText">Now you've learned enough commands for most of the
editing you'll do with Emacs. At this point, you may
want to learn how to make Emacs turn on certain features like
auto-fill mode automatically, so you don't have to
turn them on every time you enter Emacs. The next section provides a
brief introduction to customization; this topic is covered in much
greater detail in <A class="docLink" HREF="gnu3-CHP-10.html#gnu3-CHP-10">Chapter 10</A>.</P>



<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-2-SECT-5.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-2-SECT-7.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
