<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>3.2. Search and Replace</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-3-SECT-1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-3-SECT-3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="gnu3-CHP-3-SECT-2"></A>
<H3 class="docSection1Title">3.2. Search and Replace</H3>

<P class="docText">Search and replace definitely go together, like coffee and cream.
Let's say you're working on a new
software application and at the last possible moment, the Marketing
Department decides to change the product's name.</P>

<P class="docText">Tere's a press release for Whirligig, an email
service that periodically reminds you to make healthy lifestyle
changes like exercising, drinking water, and taking vitamins. The
level of harassment or, as the marketing department says,
encouragement, can be set by the user. Whirligig
isn't really the most descriptive name, so at the
last minute the Marketing Department changes it to HealthBug.</P>

<A NAME="gnu3-CHP-3-SECT-2.1"></A>
<H4 class="docSection2Title">3.2.1 Simple Search and Replace Operations</H4>

<P class="docText">Assume you're in the <A NAME="gnu3-CHP-3-ITERM-1894"></A>situation
we just described. You want to replace every occurrence of one string
with another. You know that Whirligig is never correct, and there is
absolutely no ambiguity about how you want to replace it. When you
want to replace every instance of a given string, you can use a
simple command that tells Emacs to do just that. Type <span class="docEmphBold">M-x replace-string Enter</span>, then type the search
string and press <span class="docEmphBold">Enter</span>. Now type the
replacement string and press <span class="docEmphBold">Enter</span>
again. Emacs replaces all occurrences in the file from the cursor
position onward. If you want to search and replace throughout the
file, press <span class="docEmphBold">M-&lt;</span> to go to the
beginning of the file before typing this command.
Here's a quick example of using <span class="docEmphBold">replace-string</span>.</P>

<A NAME="ch03-6-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Initial state:</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="167" SRC="images/0596006489/figs/ge3_ch03scrn03.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Whirligig appears four times, but the cursor is positioned after the
first instance.</P>
</TD></TR></TABLE></P><br>

<P class="docText">Now we'll do the replacement.</P>

<A NAME="ch03-7-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">M-x replace-string Enter Whirligig Enter
HealthBug Enter</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="167" SRC="images/0596006489/figs/ge3_ch03scrn04.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs replaces all instances from the cursor position onward.</P>
</TD></TR></TABLE></P><br>

<P class="docText">The replacement occurs only from the cursor position onward;
<span class="docEmphasis">Whirligig</span> in the first sentence is still
incorrect. We'll work with this example again in a
moment.</P>


<A NAME="gnu3-CHP-3-SECT-2.2"></A>
<H4 class="docSection2Title">3.2.2 Query-Replace</H4>

<P class="docText">Few search and replace <A NAME="gnu3-CHP-3-ITERM-1895"></A><A NAME="gnu3-CHP-3-ITERM-1896"></A><A NAME="gnu3-CHP-3-ITERM-1897"></A>situations are as straightforward as
those we've described. Often you're
not sure that you want to replace every appearance of your search
string: a global replacement can be reckless. If you want to decide
whether to replace the string on a case-by-case basis, use a
query-replace, which allows you to change a string conditionally
throughout a file. After Emacs finds an occurrence of the search
string, it asks whether it should replace it, and you respond
accordingly.</P>

<P class="docText">To use query-replace, go to the beginning of the buffer using
<span class="docEmphBold">M-&lt;</span> and then type <span class="docEmphBold">M-%</span>. The prompt <TT>Query
replace</TT>: appears in the minibuffer. Type the search string
and press <span class="docEmphBold">Enter</span>. Now this appears:</P>

<PRE>Query replace <TT><I>searchstring </I></TT> with:</PRE><BR>


<P class="docText">Type the replacement string and press <span class="docEmphBold">Enter</span>. So far, this procedure is almost
identical to a <span class="docEmphBold">replace-string</span>
operation; only the prompts are different.</P>

<P class="docText">Emacs now searches for the first occurrence of the search string.
When it finds one, a new prompt appears:</P>

<PRE>Query replacing <TT><I>searchstring </I></TT> with <TT><I>newstring</I></TT></PRE><BR>


<P class="docText">Before performing the replacement, Emacs waits for a response to tell
it what to do. <A class="docLink" HREF="#gnu3-CHP-3-TABLE-3">Table 3-3</A> lists the possible
responses and
<A NAME="gnu3-CHP-3-ITERM-1898"></A>their
results.</P>

<A NAME="gnu3-CHP-3-TABLE-3"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 3-3. Responses during query-replace</h5></CAPTION><COLGROUP><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Keystrokes</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Action</span></P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">Space</span> or <span class="docEmphBold">y</span></P>
</TD><TD class="docTableCell">
<P class="docText">Replace <TT><I>searchstring</I></TT> with
<TT><I>newstring</I></TT> and go to the next instance of
the string.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">Del</span> or <span class="docEmphBold">n</span></P>
</TD><TD class="docTableCell">
<P class="docText">Don't replace; move to next instance.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">.</P>
</TD><TD class="docTableCell">
<P class="docText">Replace the current instance and quit.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">,</P>
</TD><TD class="docTableCell">
<P class="docText">Replace and let me see the result before moving on. (Press  <span class="docEmphBold">Space</span> or <span class="docEmphBold">y</span>
to move on.)</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">!</span></P>
</TD><TD class="docTableCell">
<P class="docText">Replace all the rest and don't ask.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">^</span></P>
</TD><TD class="docTableCell">
<P class="docText">Back up to the previous instance.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">Enter</span> or <span class="docEmphBold">q</span></P>
</TD><TD class="docTableCell">
<P class="docText">Exit query-replace.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">E</span></P>
</TD><TD class="docTableCell">
<P class="docText">Modify the replacement string.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-r</span></P>
</TD><TD class="docTableCell">
<P class="docText">Enter a recursive edit (discussed in detail later).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-w</span></P>
</TD><TD class="docTableCell">
<P class="docText">Delete this instance and enter a recursive edit (so you can make a
custom replacement).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-c</span></P>
</TD><TD class="docTableCell">
<P class="docText">Exit recursive edit and resume query-replace.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-]</span></P>
</TD><TD class="docTableCell">
<P class="docText">Exit recursive edit and exit query-replace.</P>
</TD></TR></TABLE></P><br>

<P class="docText">This list seems like a lot of keystrokes to remember, but you can get
away with knowing two or three. Most of the time
you'll respond to the prompt by pressing  <span class="docEmphBold">Space</span>, telling Emacs to perform the
replacement and go on to the next instance, or <span class="docEmphBold">n</span> to skip this replacement and go on to the
next instance. If you're not too sure what will
happen, enter a comma (,); Emacs
makes the replacement but doesn't go on until you
press <span class="docEmphBold">Space</span>. After performing the
first few replaces, you may realize that there's no
need to inspect every change individually. Typing an exclamation mark
(<span class="docEmphBold">!</span>) tells Emacs to go ahead and
finish the job without bothering you anymore. If you remember these
keystrokes, you're all set.</P>

<P class="docText">How does this work in practice? Let's revisit our
previous example, assuming that we want to change
<span class="docEmphasis">Whirligig</span> to <span class="docEmphasis">HealthBug</span>
throughout (and that we didn't save the changes we
made with <span class="docEmphBold">replace-string</span>).</P>

<A NAME="ch03-8-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">M-&lt; M-% Whirligig Enter HealthBug
Enter</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="167" SRC="images/0596006489/figs/ge3_ch03scrn05.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">You're ready to replace the first occurrence; press
 <span class="docEmphBold">Space</span> to go on.</P>
</TD></TR></TABLE></P><br>

<A NAME="ch03-9-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Press:  <span class="docEmphBold">Space</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="167" SRC="images/0596006489/figs/ge3_ch03scrn06.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">When you press <span class="docEmphBold">Space</span>, Emacs replaces
the first word; the query-replace operation then moves to the second
word.</P>
</TD></TR></TABLE></P><br>

<P class="docText">This procedure continues until you reach the end of the file. As
we've said, typing <span class="docEmphBold">!</span> fixes the rest of the file.</P>

<P class="docText">In <A class="docLink" HREF="#gnu3-CHP-3-TABLE-3">Table 3-3</A>, you might have noticed that several
keys, such as  <span class="docEmphBold">Space</span>, have
specialized meanings while the replacement is in progress. In
practice, using these keys for a different function is not confusing,
though it might sound bad on paper. You might want to try a
query-replace on a practice file to get the hang of using the
different responses. If you are easily amused, you might enjoy
opening the Emacs FAQ, saving it as another file, then replacing
Emacs throughout.</P>


<A NAME="gnu3-CHP-3-SECT-2.3"></A>
<H4 class="docSection2Title">3.2.3 Repeating Query-Replaces (and Other Complex Commands)</H4>

<P class="docText">Now that you've learned the
<A NAME="gnu3-CHP-3-ITERM-1899"></A><A NAME="gnu3-CHP-3-ITERM-1900"></A><A NAME="gnu3-CHP-3-ITERM-1901"></A><A NAME="gnu3-CHP-3-ITERM-1902"></A>basics
of query-replace, let's talk about a shortcut that
applies not only in query-replace but anywhere in Emacs: repeating
complex commands, with slight modifications. We often exit a
query-replace by mistake or decide that the replacement we really
wanted was just slightly different. Do we have to type it all again?
No. Simply go the beginning of the file and press <span class="docEmphBold">C-x Esc Esc</span>. The last complex command you
typed appears. If it's not the one you want, type
<span class="docEmphBold">M-p</span> to see the previous command (do
this as many times as necessary; <span class="docEmphBold">M-n</span>
goes to the next command). For example, let's go to
the beginning of the file and repeat the query-replace we just
carried out.</P>

<A NAME="ch03-10-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">M-&lt;</span> followed by <span class="docEmphBold">C-x Esc Esc</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="167" SRC="images/0596006489/figs/ge3_ch03scrn07.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs puts the last complex command in the minibuffer; in fact it
looks more complex than we remember it.</P>
</TD></TR></TABLE></P><br>

<P class="docText">When we press <span class="docEmphBold">M-&lt;</span>, we move to the
beginning of the file; <A NAME="gnu3-CHP-3-ITERM-1903"></A>when we press <span class="docEmphBold">C-x Esc Esc</span>, the last complex command is
displayed. Emacs speaks to itself in dark words, but we can still see
that this is the command that we want.</P>

<P class="docText">This is the right command, so we don't have to press
<span class="docEmphBold">M-p</span> to see a previous command. If we
wanted to, we could change the query-replace strings before pressing
<span class="docEmphBold">Enter</span>. In this case, the Marketing
Department has once again changed the product's name
from HealthBug (since bug could be construed as pest) to HealthBot
(neutral, but a bit less descriptive in our opinion). Our earlier
query replace changed Whirligig to HealthBug. We need to modify this
command so it replaces <span class="docEmphasis">Bug</span> with
<span class="docEmphasis">Bot</span>.</P>

<A NAME="ch03-11-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">In the minibuffer, change <span class="docEmphasis">Whirligig</span> to
<span class="docEmphasis">Bug</span> and <span class="docEmphasis">HealthBug</span> to
<span class="docEmphasis">Bot</span> and press <span class="docEmphBold">Enter</span>.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="167" SRC="images/0596006489/figs/ge3_ch03scrn08.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Pressing <span class="docEmphBold">Enter</span> executes the command
again with the modified search and replacement strings.</P>
</TD></TR></TABLE></P><br>

<P class="docText">As we mentioned, <span class="docEmphBold">C-x Esc Esc</span> works
for any command involving input in the minibuffer, not just
query-replace. But we use this feature most frequently in
query-replace. It is also good for repeating keyboard macros (see
<A class="docLink" HREF="gnu3-CHP-6.html#gnu3-CHP-6">Chapter 6</A>).</P>


<A NAME="gnu3-CHP-3-SECT-2.4"></A>
<H4 class="docSection2Title">3.2.4 Recursive Editing</H4>

<P class="docText">When you do a query-replace, you
<A NAME="gnu3-CHP-3-ITERM-1904"></A><A NAME="gnu3-CHP-3-ITERM-1905"></A>inevitably see something else you want
to change in the file. Try it a few
times—you'll see what we mean! We typically
try to remember the problem until we're done, then
get frustrated when we forget exactly what and where the problem was.</P>

<P class="docText">Fortunately, Emacs provides an easier way. It allows you to start a
recursive edit while you're in the middle of a
query-replace. By starting a recursive edit, you effectively put
query-replace on hold while you make any other desired edits. When
you exit the recursive edit, the query-replace resumes where you left
off.</P>

<P class="docText">To start a recursive edit while in
<A NAME="gnu3-CHP-3-ITERM-1906"></A>query-replace, press <span class="docEmphBold">C-r</span>. (Note that like many other key bindings,
<span class="docEmphBold">C-r</span> has a different meaning in
query-replace than it does in standard Emacs.) When you start a
recursive edit, square brackets (<TT>[ ]</TT>) appear on
the mode line. Let's go back, one more time, to our
public relations piece. You've used query-replace to
find the first Bug to change to Bot, and you are about to press
<span class="docEmphBold">Space</span> to fix it, when you remember
that the lawyers said that the "64 ounces of
water" statement was too specific and could be
construed as giving medical advice. A quick recursive edit saves the
day.</P>

<A NAME="ch03-12-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">C-r</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="167" SRC="images/0596006489/figs/ge3_ch03scrn09.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Notice the square brackets around <TT>(Text Fill)</TT>,
indicating a recursive edit in progress.</P>
</TD></TR></TABLE></P><br>

<P class="docText">Now do any editing you want to; you are in an editing mode just like
standard Emacs. Move down to the third line and delete
"64 ounces of." When you want to
resume the query-replace, press <span class="docEmphBold">C-M-c</span>. This command tells Emacs to leave the
recursive edit and reactivate the query-replace. Emacs moves back to
the point where you were when you started the recursive edit. You can
then continue making replacements just as if nothing had happened.</P>

<A NAME="ch03-13-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Delete "64 ounces of," then type
<span class="docEmphBold">C-M-c</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="167" SRC="images/0596006489/figs/ge3_ch03scrn10.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs goes back to query-replace and you press <span class="docEmphBold">Space</span> to fix the next Bug.</P>
</TD></TR></TABLE></P><br>

<P class="docText">If you decide to exit the recursive edit and cancel the query-replace
in one fell swoop, you can type <span class="docEmphBold">C-]</span>
(for <span class="docEmphBold">abort-recursive-edit</span>) or
<span class="docEmphBold">M-x top-level Enter</span> rather than
<span class="docEmphBold">C-M-c</span>.</P>

<P class="docText">In fact, you can start a recursive edit at any time, not just when
you're in a query-replace. The command <span class="docEmphBold">M-x recursive-edit Enter</span> puts you into a
recursive edit; <span class="docEmphBold">C-M-c</span> takes you out
of the recursive edit and brings you back to what you were doing
before. You can even have recursive edits within recursive edits,
although the possibility for confusion increases with each new level.</P>


<A NAME="gnu3-CHP-3-SECT-2.5"></A>
<H4 class="docSection2Title">3.2.5 Are Emacs Searches Case-Sensitive?</H4>

<P class="docText">By default, Emacs searches <A NAME="gnu3-CHP-3-ITERM-1907"></A><A NAME="gnu3-CHP-3-ITERM-1908"></A>are
not case-sensitive. Look at the Options menu and
you'll see that the
<A NAME="gnu3-CHP-3-ITERM-1909"></A><A NAME="gnu3-CHP-3-ITERM-1910"></A>option Case-Insensitive Search is the
only option that is checked by default.</P>

<P class="docText">What does this mean in practical terms? If you search for the word
<span class="docEmphasis">random</span>, the search finds
<span class="docEmphasis">random</span>, <span class="docEmphasis">Random</span>, and
<span class="docEmphasis">RANDOM</span>, as well as oddities like
<span class="docEmphasis">RanDoM</span> and <span class="docEmphasis">rANdOM</span>. When
doing replacements, Emacs pays attention to the form of the word
being replaced and replaces it with the same case. If you replaced
<span class="docEmphasis">random</span> with <span class="docEmphasis">tandem</span>,
<span class="docEmphasis">Random</span> would be replaced with
<span class="docEmphasis">Tandem</span>, and <span class="docEmphasis">RANDOM</span> would be
replaced with <span class="docEmphasis">TANDEM</span>. If you mix capitalization,
the replacement string appears just as you type it.
<span class="docEmphasis">healthbug</span> would be replaced with
<span class="docEmphasis">HealthBug</span> if that was the case in the replacement string.
In other words, the default search and replacement operations usually
do what you want: they find a search string regardless of its case
and adjust the replacement appropriately for its context. However,
sometimes you need finer control.</P>

<P class="docText">The variable <span class="docEmphBold">case-fold-search</span>
determines <A NAME="gnu3-CHP-3-ITERM-1911"></A><A NAME="gnu3-CHP-3-ITERM-1912"></A><A NAME="gnu3-CHP-3-ITERM-1913"></A>whether
searches are case-sensitive. It applies to all searches: incremental
searches, word searches, searches within search-and-replace
operations, and so on. By default, <span class="docEmphBold">case-fold-search</span> is set to <span class="docEmphBold">t</span>, which means "ignore case
unless the user types in mixed or uppercase." This
sensible default is usually just what you want. But if you need
case-sensitive searches, the Case-Insensitive Search option on the
Options menu provides an easy way to experiment with this variable.</P>

<P class="docText">Likewise, if you don't want Emacs to
<A NAME="gnu3-CHP-3-ITERM-1914"></A><A NAME="gnu3-CHP-3-ITERM-1915"></A><A NAME="gnu3-CHP-3-ITERM-1916"></A>adjust
the case of your replacement strings, you can set the variable
<span class="docEmphBold">case-replace</span>. Again, its value is
<span class="docEmphBold">t</span> (for
"true") by default, which means
"adjust the case of a replacement string to match
the original text"—that is, capitalize the
replacement if the original word was capitalized and so on. Setting
this variable to <span class="docEmphBold">nil</span> means
"never adjust the case of the replacement string;
always put it in exactly as I typed it." To change
the value of <span class="docEmphBold">case-replace</span>, type
<span class="docEmphBold">M-x</span> <span class="docEmphBold">set-variable</span> <span class="docEmphBold">Enter
case-replace Enter nil Enter</span> (there's no
menu option for this variable).</P>

<P class="docText">Both the menu option and the <span class="docEmphBold">set-variable</span> command change the behavior of
Emacs only temporarily. If you start a new editing session,
you'll be back to the default behavior. This is
probably what you want, because searching separately for capitalized
and lowercase words is inconvenient.</P>

<P class="docText">You can set the value for the Case-Insensitive Search option
permanently by selecting Save Options from the Options menu or by
adding this line to your <span class="docEmphasis">.emacs</span> file:</P>

<PRE>(setq-default case-fold-search nil)  ; require exact matches</PRE><BR>


<P class="docText">To set <span class="docEmphBold">case-replace</span> permanently, add
the following line to your <span class="docEmphasis">.emacs</span> file.
You'll need to restart Emacs to have the change take
effect.</P>

<PRE>(setq-default case-replace nil)      ; never change case when replacing</PRE><BR>


<P class="docText">You could change these variables through Emacs's
interactive customization facility, Custom, instead (see <A class="docLink" HREF="gnu3-CHP-10.html#gnu3-CHP-10">Chapter 10</A>).</P>


<A NAME="gnu3-CHP-3-SECT-2.6"></A>
<H4 class="docSection2Title">3.2.6 Regular Expressions for Search and Replacement Operations</H4>

<P class="docText">Sometimes none of the simpler <A NAME="gnu3-CHP-3-ITERM-1917"></A><A NAME="gnu3-CHP-3-ITERM-1918"></A>searches described in this chapter are
adequate. Regular expressions allow you to build searches with
strings that contain various wildcards.</P>

<P class="docText"><A class="docLink" HREF="#gnu3-CHP-3-TABLE-4">Table 3-4</A> shows some of the
<A NAME="gnu3-CHP-3-ITERM-1919"></A><A NAME="gnu3-CHP-3-ITERM-1920"></A>characters you can use in creating
a regular expression.</P>

<A NAME="gnu3-CHP-3-TABLE-4"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 3-4. Characters for creating regular expressions</h5></CAPTION><COLGROUP><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Character(s)</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Match</span></P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">^</span></P>
</TD><TD class="docTableCell">
<P class="docText">Matches the beginning of a line.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">$</span></P>
</TD><TD class="docTableCell">
<P class="docText">Matches the end of a line.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">.</P>
</TD><TD class="docTableCell">
<P class="docText">Matches any single character (like ? in filenames).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">.*</span></P>
</TD><TD class="docTableCell">
<P class="docText">Matches any group of zero or more characters (. matches any character
and * matches zero or more of the previous character).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">\&lt;</span></P>
</TD><TD class="docTableCell">
<P class="docText">Matches the beginning of a word.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">\&gt;</span></P>
</TD><TD class="docTableCell">
<P class="docText">Matches the end of a word.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">[ ]</span></P>
</TD><TD class="docTableCell">
<P class="docText">Matches any character specified within the brackets; for example,
[a-z] matches any alphabetic character.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">\s, \S</span></P>
</TD><TD class="docTableCell">
<P class="docText">Matches any whitespace character: space, a newline, a tab, a carriage
return, a formfeed, or a backspace; \S matches any character except
whitespace.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">\d, \D</span></P>
</TD><TD class="docTableCell">
<P class="docText">Matches any single digit, 0-9; \D matches any character but a digit.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">\w, \W</span></P>
</TD><TD class="docTableCell">
<P class="docText">Matches any "word" character
(upper- and lowercase letters, digits, and the underscore character);
\W matches any character but these.</P>
</TD></TR></TABLE></P><br>

<P class="docText">If you do a regular expression search for <span class="docEmphBold">^word$</span>, you would find instances of
<span class="docEmphasis">word</span> on a line by itself. The <span class="docEmphBold">^</span> says that the <span class="docEmphBold">w</span> must be the first character on the line, the
<span class="docEmphBold">$</span> says that the <span class="docEmphBold">d</span> must be the last character.</P>

<P class="docText">If you wanted to find all words starting with
<span class="docEmphasis">beg</span> and ending with the letter
<span class="docEmphasis">s</span>, you could use <span class="docEmphBold">beg[a-z]*s</span> as your regular expression. This
would find the words <span class="docEmphasis">begins</span>,
<span class="docEmphasis">begets</span>, and <span class="docEmphasis">begonias</span>, in
addition to really odd words like <span class="docEmphasis">shibegrees</span> and
<span class="docEmphasis">altbegaslia</span>. If you don't want
these mutants—that is, if you really want words that begin with
<span class="docEmphasis">beg</span> and end with <span class="docEmphasis">s</span>, use
<span class="docEmphBold">\&lt;beg[a-z]*s\&gt;</span>. The <span class="docEmphBold">\&lt;</span> is a special sequence that matches the
beginning of a word; <span class="docEmphBold">\&gt;</span> matches
the end of a word. If you wanted to find the words
<span class="docEmphasis">beg</span>, <span class="docEmphasis">big</span>, and
<span class="docEmphasis">bag</span>; but not <span class="docEmphasis">begonias</span>, and
certainly not any strange words with <span class="docEmphasis">beg</span> on the
inside, you would use <span class="docEmphBold">\&lt;b[a-z]g\&gt;</span> as the regular expression.</P>

<P class="docText">To search for a <span class="docEmphBold">^</span>, <span class="docEmphBold">$</span>, .,
<span class="docEmphBold">*</span>, <span class="docEmphBold">[</span>, <span class="docEmphBold">]</span>, or any
number of <A NAME="gnu3-CHP-3-ITERM-1921"></A><A NAME="gnu3-CHP-3-ITERM-1922"></A>other special characters, you
obviously can't use the character itself. Put a
backslash (\) first—i.e., to search for a period, search for \.
For example, to search for the electronic mail
address`:</P>

<PRE>howie@mcds.com</PRE><BR>


<P class="docText">the regular expression would be:</P>

<PRE>howie@mcds\.com</PRE><BR>


<P class="docText">This is a barebones introduction to regular expressions; see <A class="docLink" HREF="gnu3-CHP-11.html#gnu3-CHP-11">Chapter 11</A> for more details and <span class="docEmphasis">Mastering
Regular Expressions</span> by Jeffrey Friedl
(O'Reilly) for a book-length treatment of this
topic.</P>

<P class="docText">You can use regular expressions in <A NAME="gnu3-CHP-3-ITERM-1923"></A><A NAME="gnu3-CHP-3-ITERM-1924"></A><A NAME="gnu3-CHP-3-ITERM-1925"></A><A NAME="gnu3-CHP-3-ITERM-1926"></A>incremental
searches and in query-replace. <A class="docLink" HREF="#gnu3-CHP-3-TABLE-5">Table 3-5</A> lists the
commands you use for regular expression searches. Although they are
initiated with slightly <A NAME="gnu3-CHP-3-ITERM-1927"></A><A NAME="gnu3-CHP-3-ITERM-1928"></A><A NAME="gnu3-CHP-3-ITERM-1929"></A>different commands, the
searches are the same as those described earlier in this chapter.</P>

<A NAME="gnu3-CHP-3-TABLE-5"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 3-5. Regular expression search commands</h5></CAPTION><COLGROUP><COL><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Keystrokes</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Command name</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Action</span></P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-s Enter</span><span class="docEmphasis">Edit</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Search</span> <img src=images/ent/U2192.GIF border=0>
<span class="docEmphasis">Regexp Forward</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">re-search-forward</span></P>
</TD><TD class="docTableCell">
<P class="docText">Search for a regular expression forward.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-r Enter</span><span class="docEmphasis">Edit</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Search</span> <img src=images/ent/U2192.GIF border=0>
<span class="docEmphasis">Regexp Backwards</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">re-search-backward</span></P>
</TD><TD class="docTableCell">
<P class="docText">Search for a regular expression backward.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-s</span><span class="docEmphasis">Edit</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Search</span> <img src=images/ent/U2192.GIF border=0>
<span class="docEmphasis">Incremental Search</span> <img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Forward
Regexp</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">isearch-forward-regexp</span></P>
</TD><TD class="docTableCell">
<P class="docText">Search incrementally forward for a regular expression.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-r</span><span class="docEmphasis">Edit</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Search</span> <img src=images/ent/U2192.GIF border=0>
<span class="docEmphasis">Incremental Search</span> <img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Backward
Regexp</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">isearch-backward-regexp</span></P>
</TD><TD class="docTableCell">
<P class="docText">Search incrementally backward for a regular expression.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-%</span><span class="docEmphasis">Edit</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Replace</span> <img src=images/ent/U2192.GIF border=0>
<span class="docEmphasis">Replace Regexp</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">query-replace-regexp</span></P>
</TD><TD class="docTableCell">
<P class="docText">Query-replace a regular expression.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">(<span class="docEmphasis">none</span>)</P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">replace-regexp</span></P>
</TD><TD class="docTableCell">
<P class="docText">Globally replace a regular expression unconditionally (use with
caution).</P>
</TD></TR></TABLE></P><br>



<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-3-SECT-1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-3-SECT-3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
