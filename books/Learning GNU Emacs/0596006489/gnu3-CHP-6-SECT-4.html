<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>6.4. Editing a Macro</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-6-SECT-3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-6-SECT-5.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="gnu3-CHP-6-SECT-4"></A>
<H3 class="docSection1Title">6.4. Editing a Macro</H3>

<P class="docText">You can edit a macro and
<A NAME="gnu3-CHP-6-ITERM-2269"></A><A NAME="gnu3-CHP-6-ITERM-2270"></A>make
changes to it in a few different ways. For this example, we chose an
all-purpose editing command, <span class="docEmphBold">edit-kbd-macro</span>, which is bound to <span class="docEmphBold">C-x C-k e</span>. Several macro editing commands are
available, but this one works for all types of macros, so
it's good to learn.</P>

<P class="docText">Our macro could use a bit of tweaking. First of all, finding
references to Emacs in our copy of the Emacs
<span class="docEmphasis">NEWS</span> file is pretty lame. Perhaps
we're interested in using a mouse more frequently
with Emacs and would like to know about changes to that part of the
interface. We'll edit the macro to search for the
word <span class="docEmphasis">mouse</span>. We'll also modify
it so it marks a paragraph rather than a sentence since a sentence
doesn't really provide enough context to be helpful.</P>

<P class="docText">Let's start editing the macro.</P>

<A NAME="ch06-6-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">C-x C-k e</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="138" SRC="images/0596006489/figs/ge3_ch06scrn04.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs prompts you for the type of macro to edit.</P>
</TD></TR></TABLE></P><br>

<P class="docText">Emacs asks you if you want to edit the last keyboard macro (<span class="docEmphBold">C-x e</span>), a named macro (<span class="docEmphBold">M-x</span>), the last 100 keystrokes as a macro,
termed "lossage" (<span class="docEmphBold">C-h l</span>), or keys (meaning the keystrokes you
bound a macro to). Yes, that's a lot of choices, and
later in the chapter we describe named macros and binding macros to
keys (you can experiment on your own with creating a macro from
lossage). For now, just choose <span class="docEmphBold">C-x e</span>
to edit the last keyboard macro.</P>

<A NAME="ch06-7-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">C-x e</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="384" height="295" SRC="images/0596006489/figs/ge3_ch06scrn05.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs opens an <TT>*Edit Macro*</TT> buffer.</P>
</TD></TR></TABLE></P><br>

<P class="docText">Notice two fields near the top of this buffer,
<TT>Command</TT>: and <TT>Key</TT>:. Right now,
<TT>Command</TT>: says <TT>last-kbd-macro</TT>.
If this were a named macro, the command would be the name you gave
your macro. Additionally, for frequent use, you can bind your macro
to a key, at which point the <TT>Key</TT>: field lists the
keystrokes to execute this macro. Right now it says
<TT>none</TT> because we haven't defined
any keystrokes yet.</P>

<P class="docText">Note that Emacs inserts comments all through the macro.
It's attempting to map keystrokes to commands. You
do not need to update these comments or add comments if you add
commands to your macro; Emacs does that itself.</P>

<P class="docText">To tweak our macro, we change the search string on the second line
from <span class="docEmphasis">emacs</span> to <span class="docEmphasis">mouse</span>. Note
that we can just press <span class="docEmphBold">C-k</span> to wipe
out the line and type mouse. Now change <span class="docEmphBold">M-a</span> to <span class="docEmphBold">M-{</span>
and <span class="docEmphBold">M-e</span> to <span class="docEmphBold">M-}</span>. We change the buffer name from
<TT>emacsrefs</TT> to <TT>mouseinfo</TT>.</P>

<A NAME="ch06-8-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">We've made the edits from the previous paragraph.
The screen looks like this:</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="384" height="295" SRC="images/0596006489/figs/ge3_ch06scrn06.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">A modified macro that captures information about using a mouse in
Emacs.</P>
</TD></TR></TABLE></P><br>

<P class="docText">To exit the macro editing buffer, we have to type <span class="docEmphBold">C-c C-c</span> and go back to our
<TT>NEWS</TT> buffer. Let's do that and
then execute the macro again to see what happens.</P>

<A NAME="ch06-9-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">C-c C-c C-x b Enter M-&lt; M-5 F4 C-x b
Enter M-&lt;</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="257" SRC="images/0596006489/figs/ge3_ch06scrn07.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">The <TT>mouseinfo</TT> buffer shows paragraphs from our
copied <span class="docEmphasis">NEWS</span> file that mention the mouse.</P>
</TD></TR></TABLE></P><br>


<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-6-SECT-3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-6-SECT-5.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
