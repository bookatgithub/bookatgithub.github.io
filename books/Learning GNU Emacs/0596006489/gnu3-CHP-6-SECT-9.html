<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>6.9. Executing Macros on a Region</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-6-SECT-8.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-6-SECT-10.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="gnu3-CHP-6-SECT-9"></A>
<H3 class="docSection1Title">6.9. Executing Macros on a Region</H3>

<P class="docText">A special command
<A NAME="gnu3-CHP-6-ITERM-2290"></A><A NAME="gnu3-CHP-6-ITERM-2291"></A><A NAME="gnu3-CHP-6-ITERM-2292"></A>lets you
execute a macro on each line in a region. How frequently do you
encounter an email with text that you want to yank, but that is
quoted several indentation levels? Of course, we can think of several
ways to delete the indentation quickly, but a line-oriented macro is
a quick approach too. You define the macro and execute it on a region
by typing <span class="docEmphBold">C-x C-k r</span> (for <span class="docEmphBold">apply-macro-to-region-lines</span>). Remember that
earlier we said that macros should set themselves up to repeat? This
command is different because it expects to work on one line at a
time. You don't want to set it up to repeat by
moving to the next line; it does that automatically.</P>

<P class="docText"><A class="docLink" HREF="#gnu3-CHP-6-TABLE-5">Table 6-5</A> shows a quick line-oriented macro that
deletes indentation marks from text quoted in an email or
<A NAME="gnu3-CHP-6-ITERM-2293"></A>newsgroup message.</P>

<A NAME="gnu3-CHP-6-TABLE-5"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 6-5. Macro for deleting indentation marks</h5></CAPTION><COLGROUP><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText">Keystrokes</P>
</TH><TH class="thead" scope="col">
<P class="docText">Action</P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">F3</span></P>
</TD><TD class="docTableCell">
<P class="docText">Start the macro definition.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-a</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the beginning of the line.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">M-f</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move forward one word.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">M-b</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the beginning of this word.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-Space</span></P>
</TD><TD class="docTableCell">
<P class="docText">Set the mark.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-a</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the beginning of the line.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-w</span></P>
</TD><TD class="docTableCell">
<P class="docText">Delete the extraneous indentation characters.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">F4</span></P>
</TD><TD class="docTableCell">
<P class="docText">End the macro definition.</P>
</TD></TR></TABLE></P><br>

<A NAME="ch06-16-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Initial state:</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="214" SRC="images/0596006489/figs/ge3_ch06scrn12.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Text indented at various levels (Mac OS X).</P>
</TD></TR></TABLE></P><br>

<A NAME="ch06-17-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Mark the text as a region, move to the beginning of the region, then
type: <span class="docEmphBold">C-x C-k r</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0" width="425" height="211" SRC="images/0596006489/figs/ge3_ch06scrn13.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Indentation is deleted (Mac OS X).</P>
</TD></TR></TABLE></P><br>


<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-6-SECT-8.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-6-SECT-10.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
