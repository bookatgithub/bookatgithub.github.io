<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>8.4. Writing XML</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-8-SECT-3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-8-SECT-5.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="gnu3-CHP-8-SECT-4"></A>
<H3 class="docSection1Title" >8.4. Writing XML</H3>

<P class="docText">Writing XML involves entering structured <A NAME="gnu3-CHP-8-ITERM-2478"></A><A NAME="gnu3-CHP-8-ITERM-2479"></A>information
that complies with a document type definition or schema. Even within
Emacs, the XML support you receive varies. At the low end of the
spectrum, there is plain vanilla Fundamental mode. It provides simply
a screen where you type. Specialized modes like SGML mode provide
support for entering tags, as we saw earlier in our discussion of
HTML mode, a derivative of SGML mode. But neither of these approaches
help you parse or validate XML (SGML mode has a command for
validating, but it is tricky to set up correctly). More advanced Lisp
packages, though currently not included in Emacs, are available to
provide these functions. These add-on packages provide validation
against DTDs or schemas, parsing capabilities, and, typically, an
array of standard DTDs and schema definitions. In Emacs, these tools
primarily work in conjunction with one of two major modes. psgml mode
validates XML (and SGML) against DTDs. The newer nxml mode validates
against RELAX NG schemas. We cover both of these options in this
section. Before we go into detail on those modes, however,
let's look briefly what Emacs has built-in with SGML
mode.</P>

<A NAME="gnu3-CHP-8-SECT-4.1"></A>
<H4 class="docSection2Title">8.4.1 Writing XML with SGML Mode</H4>

<P class="docText">Emacs's own SGML mode
provides<A NAME="gnu3-CHP-8-ITERM-2480"></A><A NAME="gnu3-CHP-8-ITERM-2481"></A><A NAME="gnu3-CHP-8-ITERM-2482"></A><A NAME="gnu3-CHP-8-ITERM-2483"></A> support for entering tags. We covered much
of this earlier under HTML mode, so we provide just one brief example
here. Inserting, hiding, and showing tags are especially helpful
features provided by SGML mode.</P>

<P class="docText">Let's look at a chapter on enumerated types by
<span class="docEmphasis">Java in a Nutshell</span> author David Flanagan. This
chapter uses the DocBook DTD.</P>

<A NAME="ch08-20-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Initial state:</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="225" SRC="images/0596006489/figs/ge3_ch08scrn12.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Editing a document that uses the DocBook DTD (Mac OS X).</P>
</TD></TR></TABLE></P><br>

<P class="docText">Note that Emacs displays XML on the mode line. XML mode in this
context is a subset of SGML mode. Actually, despite this name, all
the commands in this mode start with sgml, not xml. The menu of
relevant commands is called SGML as well. Emacs
doesn't pretend to have extensive XML support.</P>

<P class="docText">We want to insert a paragraph before the first paragraph.</P>

<A NAME="ch08-21-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Add a blank line following the title and type: <span class="docEmphBold">C-c C-t</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="224" SRC="images/0596006489/figs/ge3_ch08scrn13.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs inserts an open angle bracket and prompts for the tag name (Mac
OS X).</P>
</TD></TR></TABLE></P><br>


<A NAME="ch08-22-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">para Enter</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="224" SRC="images/0596006489/figs/ge3_ch08scrn14.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs inserts opening and closing paragraph tags (Mac OS X).</P>
</TD></TR></TABLE></P><br>

<P class="docText">Note that Emacs is not following our indentation style. We can
correct it by moving to the beginning of the line and pressing
<span class="docEmphBold">Tab</span>. See <A class="docLink" HREF="gnu3-CHP-8-SECT-3.html#gnu3-CHP-8-TABLE-4">Table 8-4</A> earlier in this chapter for details on SGML
mode commands.</P>


<A NAME="gnu3-CHP-8-SECT-4.2"></A>
<H4 class="docSection2Title">8.4.2 TEI Emacs: XML Authoring for Linux and Windows</H4>

<P class="docText">The Text Encoding Initiative (TEI) <A NAME="gnu3-CHP-8-ITERM-2484"></A><A NAME="gnu3-CHP-8-ITERM-2485"></A>wanted an XML authoring
environment for Emacs, so it created (the somewhat misleadingly
named) TEI Emacs.<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-8-FNOTE-9">[9]</A></sup> Despite its name, TEI Emacs does not include
Emacs itself. Rather, it creates an authoring environment for writing
XML using nxml mode or psgml mode. It incorporates XSLT tools, along
with most of the standard DTDs, such as the three forms of XHTML DTDs
(strict, frameset, and transitional), DocBook DTDs, and more.
Naturally, the TEI's own DTDs and schemas are also
included.</P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-8-FNOTE-9">[9]</A></sup> We'd like to
thank Emacs guru Eric Pement for pointing out TEI Emacs to
Deb.</p></blockquote>

<P class="docText">The active development of this tool and its careful packaging led us
to describe this tool despite the fact that it is limited to Linux
and Windows at this writing.<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-8-FNOTE-10">[10]</A></sup> You should have Emacs 21.3 already installed
before you install this tool. Installing TEI Emacs is trivial. The
Windows version has an installer, and Linux users follow simple
instructions at <A class="docLink" target="_blank" HREF="http://www.tei-c.org/Software/tei-emacs/">http://www.tei-c.org/Software/tei-emacs/</A>, the
web site for downloading TEI Emacs.</P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-8-FNOTE-10">[10]</A></sup> We sincerely hope that
this support will be extended to Mac OS X as well, providing
developers and writers on that platform the benefits of this
tool's capabilities. Meanwhile, Mac users may want
to install nxml mode from <A class="docLink" target="_blank" HREF="http://thaiopensource.com/download/">http://thaiopensource.com/download/</A> and psgml
mode from <A class="docLink" target="_blank" HREF="http://www.lysator.liu.se/projects/about_psgml.html">http://www.lysator.liu.se/projects/about_psgml.html</A>.</p></blockquote>


<A NAME="gnu3-CHP-8-SECT-4.3"></A>
<H4 class="docSection2Title">8.4.3 Writing XHTML Using nxml Mode</H4>

<P class="docText">James Clark, an XML pioneer,
<A NAME="gnu3-CHP-8-ITERM-2486"></A><A NAME="gnu3-CHP-8-ITERM-2487"></A><A NAME="gnu3-CHP-8-ITERM-2488"></A>wrote
nxml mode to provide Emacs support for his schema standard RELAX NG.
For details on the standard, visit <A class="docLink" target="_blank" HREF="http://www.relaxng.org/">http://www.relaxng.org/</A> or pick up a copy of
<span class="docEmphasis">RELAX NG</span> by Eric van der Vlist
(O'Reilly). The important thing about nxml mode is
that it validates text as you type instead of making validation and
debugging separate steps.</P>

<P class="docText">If you did not install TEI Emacs, you can download nxml mode and its
schemas from <A class="docLink" target="_blank" HREF="http://thaiopensource.com/download/">http://thaiopensource.com/download/</A>. If you
decide to become an active nxml mode user, you may want to join a
related Yahoo Group discussion list (see <A class="docLink" target="_blank" HREF="http://groups.yahoo.com/group/emacs-nxml-mode/">http://groups.yahoo.com/group/emacs-nxml-mode/</A>).</P>

<P class="docText">In this section, we change our running HTML example to XHTML, first
using a RELAX NG schema and nxml mode. Open
<span class="docEmphasis">dickens.html</span>, then enter nxml mode.</P>

<A NAME="ch08-23-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">C-x C-f dickens.html Enter M-x nxml-mode
Enter</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="359" SRC="images/0596006489/figs/ge3_ch08scrn15.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Editing <span class="docEmphasis">dickens.html</span> in nxml mode.</P>
</TD></TR></TABLE></P><br>

<P class="docText">nxml mode tells you what schema it is using in the minibuffer.
It's smart enough to know that its XHTML schema is
best for this purpose.</P>

<P class="docText">The mode line tells us that this file is currently invalid. Emacs
highlights errors with red underscores. Let's deal
with these errors one at a time.</P>

<A NAME="ch08-24-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Move the cursor to the red underscore at the end of the html tag.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="359" SRC="images/0596006489/figs/ge3_ch08scrn16.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">The minibuffer describes what's missing.</P>
</TD></TR></TABLE></P><br>

<P class="docText">Editing XHTML with a schema requires a namespace definition in the
<TT>&lt;html&gt;</TT> tag. nxml mode knows what we need.
This is a good time to use nxml's completion feature
to let it supply the details for us. <span class="docEmphBold">C-Enter</span> completes the current tag.</P>

<A NAME="ch08-25-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">Space</span> <span class="docEmphBold">xmlns=</span>" <span class="docEmphBold">C-Enter</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="359" SRC="images/0596006489/figs/ge3_ch08scrn17.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs inserts the rest of the namespace declaration.</P>
</TD></TR></TABLE></P><br>

<P class="docText">The mode line tells us that this file is still invalid. Moving to the
underlined address tag gives us a fairly cryptic reason; it says,
<TT>Element not allowed in this context</TT>.
Let's move down to the closing body tag to see if
that error provides any more insight into the problem.</P>

<A NAME="ch08-26-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Move to <TT>&lt;/body&gt;</TT>.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="359" SRC="images/0596006489/figs/ge3_ch08scrn18.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">The minibuffer says <TT>Missing end-tag "p</TT>" .</P>
</TD></TR></TABLE></P><br>

<P class="docText">This message provides a clue. Although HTML authors are not
accustomed to adding closing tags to paragraphs, XHTML requires them.
Let's insert a closing tag after our paragraph.</P>

<A NAME="ch08-27-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Move to the line following the Dickens paragraph and type: <span class="docEmphBold">&lt;/</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="359" SRC="images/0596006489/figs/ge3_ch08scrn19.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs inserts a closing tag.</P>
</TD></TR></TABLE></P><br>

<P class="docText">Note that just typing <span class="docEmphBold">&lt;/</span> was
adequate to insert a closing tag for the current element. We
don't need to type <span class="docEmphBold">C-Enter</span> to invoke completion.
That's because in nxml mode, slash is bound to
<span class="docEmphBold">nxml-electric-slash</span>. It
automatically completes the nearest open element, another shortcut
for us.</P>

<P class="docText">A similar command is <span class="docEmphBold">C-c C-f</span> (for
<span class="docEmphBold">nxml-finish-element</span>). With <span class="docEmphBold">C-c C-f</span>, you don't have to
type anything; it inserts the relevant closing tag for you.</P>

<P class="docText">Look at the mode line now. It says valid. Using nxml mode,
it's not too tough to take an HTML file and change
it to valid XHTML.</P>

<P class="docText">Validating text as you type it is a key feature of nxml mode.
It's validating against a schema. To specify a
different schema, type <span class="docEmphBold">C-c C-s</span> (for
<span class="docEmphBold">rng-set-schema-and-validate</span>). The
minibuffer prompts for the file where the schema resides. A number of
schemas can be found online at <A class="docLink" target="_blank" HREF="http://www.relaxng.org/#schemas">http://www.relaxng.org/#schemas</A>. You can also
convert DTDs to schemas using tools listed on that page.</P>

<P class="docText">Your menus vary depending on whether you install nxml mode directly
or whether you use TEI's version. TEI provides
support for encoded characters using the UniChar menu. It also
provides extensive XSLT support. TEI's NXML menu
includes some TEI skeletons as well as nxml mode options. Nxml mode
installed from <span class="docEmphasis">thaiopensource.org</span> includes an
XML menu with options for setting the schema and customizing the
mode. <A class="docLink" HREF="#gnu3-CHP-8-TABLE-7">Table 8-7</A> lists some of the commands
available in nxml mode.</P>

<A NAME="gnu3-CHP-8-TABLE-7"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 8-7. Nxml mode commands</h5></CAPTION><COLGROUP><COL><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText">Keystrokes</P>
</TH><TH class="thead" scope="col">
<P class="docText">Command name</P>
</TH><TH class="thead" scope="col">
<P class="docText">Action</P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-Enter</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-complete</span></P>
</TD><TD class="docTableCell">
<P class="docText">Complete the current tag.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">/</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-electric-slash</span></P>
</TD><TD class="docTableCell">
<P class="docText">Add a closing tag for the last open element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-n</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">rng-next-error</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the next error.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-l</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">rng-save-schema-location</span></P>
</TD><TD class="docTableCell">
<P class="docText">Creates (or updates) a file called <span class="docEmphasis">schemas.xml</span>
in your home directory. This file associates schemas with files.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-s</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">rng-set-schema-and-validate</span></P>
</TD><TD class="docTableCell">
<P class="docText">Set the schema and validate against it.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-a</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">rng-auto-set-schema</span></P>
</TD><TD class="docTableCell">
<P class="docText">Set the schema automatically according to the contents of the file.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-w</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">rng-what-schema</span></P>
</TD><TD class="docTableCell">
<P class="docText">Show in the minibuffer the current schema associated with this file.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-v</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">rng-validate-mode</span></P>
</TD><TD class="docTableCell">
<P class="docText">Toggles whether the mode line indicates that the file is valid or
invalid.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-u</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-insert-named-char</span></P>
</TD><TD class="docTableCell">
<P class="docText">Insert a named character; press <span class="docEmphBold">Tab</span>
to see a list.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphasis">(none)</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-insert-xml-declaration</span></P>
</TD><TD class="docTableCell">
<P class="docText">Insert an XML declaration at the beginning of the file.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c Tab</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-balanced-close-start-tag-inline</span></P>
</TD><TD class="docTableCell">
<P class="docText">Insert the ending tag for the starting tag you are typing, putting
the ending tag on the current line.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-b</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-balanced-close-start-tag-block</span></P>
</TD><TD class="docTableCell">
<P class="docText">Insert the ending tag for the starting tag you are typing, putting
the ending tag on a separate line.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-f</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-finish-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Finish the current element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">M-h</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-mark-paragraph</span></P>
</TD><TD class="docTableCell">
<P class="docText">Mark the current paragraph.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">M-}</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-forward-paragraph</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move forward one paragraph.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">M-{</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-backward-paragraph</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move back one paragraph.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-p</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-backward-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move back one element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-n</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-forward-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move forward one element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-d</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-down-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move down one element (if nested).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-u</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">nxml-backward-up-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move up one element (if nested).</P>
</TD></TR></TABLE></P><br>


<A NAME="gnu3-CHP-8-SECT-4.4"></A>
<H4 class="docSection2Title">8.4.4 Using psgml Mode</H4>

<P class="docText">Lennart Stafflin's psgml mode has been
<A NAME="gnu3-CHP-8-ITERM-2492"></A><A NAME="gnu3-CHP-8-ITERM-2493"></A><A NAME="gnu3-CHP-8-ITERM-2494"></A>around for a while. It is more robust
than Emacs's own SGML mode, but, like any add-on,
you have to install it in order to use it. Either install TEI Emacs
as described earlier or download psgml mode from <A class="docLink" target="_blank" HREF="http://www.lysator.liu.se/projects/about_psgml.html">http://www.lysator.liu.se/projects/about_psgml.html</A>
and follow the installation instructions there. TEI Emacs includes a
functioning psgml mode, so if you've installed TEI
Emacs, your setup work is done.</P>

<P class="docText">psgml mode consists of two parts: sgml-mode for writing SGML and
xml-mode for writing XML (and in our case XHTML).</P>

<A NAME="ch08-_Toc475745106"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">To start psgml mode to edit our XHTML file, type <span class="docEmphBold">M-x xml-mode</span>.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="277" SRC="images/0596006489/figs/ge3_ch08scrn20.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">XML appears on the mode line and an <TT>*SGML LOG*</TT>
window opens. If you are using TEI Emacs, XSLT appears on the mode
line along with XML.</P>
</TD></TR></TABLE></P><br>

<P class="docText">The <TT>*SGML LOG*</TT> window displays messages about this
session. (If it doesn't appear immediately, click on
the first character in the file.) The log buffer complains that it
could not find an external entity called html. This file has been
changed to work with the XHTML RELAX NG schema. psgml mode expects it
to conform to an XHTML DTD. To get started with the (minimal) work
needed to undertake the transformation from a schema-based file to a
DTD-based file, we ask psgml to normalize the buffer.</P>

<A NAME="ch08-29-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">M-x sgml-normalize</span> or select
Normalize from the Modify menu</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="277" SRC="images/0596006489/figs/ge3_ch08scrn21.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">psgml mode eliminates the namespace declaration in the
<TT>&lt;html&gt;</TT> tag.</P>
</TD></TR></TABLE></P><br>

<P class="docText">More needs to be done, however. The first statements in an XHTML file
include an XML statement and a DOCTYPE entry that identifies the DTD
this document should be validated against. One of the nice things
about TEI Emacs is that it includes a variety of DTDs. (Users of
standard psgml mode don't have this feature;
sorry.<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-8-FNOTE-11">[11]</A></sup>)</P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-8-FNOTE-11">[11]</A></sup> A straightforward introduction to setting up a
complete environment for psgml mode can be found at <A class="docLink" target="_blank" HREF="http://openacs.org/doc/openacs-5-0-0/psgml-mode.html">http://openacs.org/doc/openacs-5-0-0/psgml-mode.html</A>.</p></blockquote>

<A NAME="ch08-30-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">At the beginning of the file, select DTD<img src=images/ent/U2192.GIF border=0> Insert
DTD<img src=images/ent/U2192.GIF border=0> XHTML Transitional.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="242" SRC="images/0596006489/figs/ge3_ch08scrn22.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">Emacs inserts the two required elements for us.</P>
</TD></TR></TABLE></P><br>

<P class="docText">That's all it takes to make this file a well-formed
XHTML file. psgml mode allows for validation against the DTD.
Let's validate it using <span class="docEmphBold">C-c
C-v</span> to make sure it's okay.</P>

<A NAME="ch08-31-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Type: <span class="docEmphBold">C-c C-v</span></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="242" SRC="images/0596006489/figs/ge3_ch08scrn23.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">psgml mode inserts the default validate command in the minibuffer;
press <span class="docEmphBold">Enter</span> to run it.</P>
</TD></TR></TABLE></P><br>

<A NAME="ch08-32-fm2xml"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><COLGROUP><COL></COLGROUP><THEAD></THEAD><TR><TD class="docTableCell">
<P class="docText">Press <span class="docEmphBold">Enter</span> and type <span class="docEmphBold">y</span> to save the buffer when prompted</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><IMG BORDER="0"  width="431" height="277" SRC="images/0596006489/figs/ge3_ch08scrn24.gif" ALT=""></P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">The <TT>*compilation*</TT> buffer indicates (somewhat
cryptically) that the document is valid.</P>
</TD></TR></TABLE></P><br>

<P class="docText">Of course, typical documents are far more complex than this one.
Options on the View menu provide selective hiding and showing of
elements, including an option to hide all tags, allowing you to focus
on the content of the file instead.</P>

<P class="docText">psgml mode also offers numerous options. If you are running TEI
Emacs, you'll find the File Options and User Options
submenus on the XML/SGML menu. If you've installed
psgml mode standalone, you'll find them on the SGML
menu. <A class="docLink" HREF="#gnu3-CHP-8-TABLE-8">Table 8-8</A> summarizes some of the psgml
commands.</P>

<A NAME="gnu3-CHP-8-TABLE-8"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 8-8. Bindings in psgml mode</h5></CAPTION><COLGROUP><COL><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText">Keystrokes</P>
</TH><TH class="thead" scope="col">
<P class="docText">Command name</P>
</TH><TH class="thead" scope="col">
<P class="docText">Action</P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-Space</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-mark-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Mark the current element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">M-Tab</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-complete</span></P>
</TD><TD class="docTableCell">
<P class="docText">Complete the current tag.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-t</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-transpose-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Transpose two elements.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-h</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-mark-current-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Mark the current element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-k</span> <span class="docEmphasis">Modify</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Kill Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-kill-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Delete the current element (and any child elements).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-u</span> <span class="docEmphasis">Move</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Backward Up Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-backward-up-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move up to the parent element for this element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-d</span> <span class="docEmphasis">Move</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Down Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-down-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move down to the next child element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-b</span> <span class="docEmphasis">Move</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Backward Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-backward-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the previous element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-f</span> <span class="docEmphasis">Move</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Forward Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-forward-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the next element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-e</span><span class="docEmphasis">Move</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">End of Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-end-of-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the end of the current element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-a</span> <span class="docEmphasis">Move</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Beginning of Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-beginning-of-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the beginning of the current element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-w</span> <span class="docEmphasis">SGML</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">What Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-what-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Similar to sgml-position but describes hierarchy in terms of tags
versus content (for example, start-tag in title in head in html).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-v</span> <span class="docEmphasis">SGML</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Validate</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-validate</span></P>
</TD><TD class="docTableCell">
<P class="docText">Insert validation command in the minibuffer so you can modify it if
necessary before pressing Enter to execute it.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-t</span> <span class="docEmphasis">SGML</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">List Valid Tags</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-list-valid-tags</span></P>
</TD><TD class="docTableCell">
<P class="docText">List tags that are valid in the current context.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-q</span> <span class="docEmphasis">Modify</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Fill Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-fill-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Fill element according to the mode's indentation
rules.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-o</span> <span class="docEmphasis">Move</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Next Trouble Spot</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-next-trouble-spot</span></P>
</TD><TD class="docTableCell">
<P class="docText">Find the next problem spot and display the problem in the minibuffer.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-n</span> <span class="docEmphasis">Move</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Up Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-up-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the parent element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c Enter</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-split-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Split current element.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-l</span> <span class="docEmphasis">SGML</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Show/Hide Warning Log</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-show-or-clear-log</span></P>
</TD><TD class="docTableCell">
<P class="docText">Display or delete the <TT>SGML LOG</TT> buffer (menu option
name is misleading).</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-k</span> <span class="docEmphasis">Modify</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Kill Markup</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-kill-markup</span></P>
</TD><TD class="docTableCell">
<P class="docText">Delete current tag.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c /</span> <span class="docEmphasis">Markup</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">End Current Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-insert-end-tag</span></P>
</TD><TD class="docTableCell">
<P class="docText">Insert closing tag for current tag.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c -</span> <span class="docEmphasis">Modify</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Untag Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-untag-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Delete the current tag pair.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c #</span> <span class="docEmphasis">Modify</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Make Character Reference</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-make-character-reference</span></P>
</TD><TD class="docTableCell">
<P class="docText">Change character under the cursor to the equivalent entity.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-f C-e</span> <span class="docEmphasis">View</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Fold Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-fold-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Hide the current element and its children if any.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-u C-e</span> <span class="docEmphasis">View</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Unfold Element</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-unfold-element</span></P>
</TD><TD class="docTableCell">
<P class="docText">Show the current element and its children if any.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-f C-s</span> <span class="docEmphasis">View</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Fold Subelement</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-fold-subelement</span></P>
</TD><TD class="docTableCell">
<P class="docText">Hide subelements.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-f C-r</span> <span class="docEmphasis">View</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Fold Region</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-fold-region</span></P>
</TD><TD class="docTableCell">
<P class="docText">Hide the region.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-c C-u C-a</span> <span class="docEmphasis">View</span>
<img src=images/ent/U2192.GIF border=0> <span class="docEmphasis">Unfold All</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">sgml-unfold-all</span></P>
</TD><TD class="docTableCell">
<P class="docText">Show all hidden tags and text.</P>
</TD></TR></TABLE></P><br>



<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-8-SECT-3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-8-SECT-5.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
