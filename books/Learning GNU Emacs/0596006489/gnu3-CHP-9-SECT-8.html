<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>9.8. The Lisp Modes</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-9-SECT-7.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-10.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="gnu3-CHP-9-SECT-8"></A>
<H3 class="docSection1Title">9.8. The Lisp Modes</H3>

<P class="docText">Emacs has three Lisp modes, listed <A NAME="gnu3-CHP-9-ITERM-2614"></A><A NAME="gnu3-CHP-9-ITERM-2615"></A>here by
their command names:</P>

<DL class="docList"><br><p><DT><span class="docPubcolor"><span class="docEmphBold">emacs-lisp-mode</span></span></DT></p>
<DD>
<P class="docList">Used for editing Emacs Lisp code, as covered in <A class="docLink" HREF="gnu3-CHP-11.html#gnu3-CHP-11">Chapter 11</A> (filename <span class="docEmphasis">.emacs</span> or
suffix <span class="docEmphasis">.el</span>).</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docEmphBold">lisp-mode</span></span></DT></p>
<DD>
<P class="docList">Used for editing Lisp code intended for another Lisp system (suffix
<span class="docEmphasis">.l</span> or <span class="docEmphasis">.lisp</span>).</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docEmphBold">lisp-interaction-mode</span></span></DT></p>
<DD>
<P class="docList">Used for editing and running Emacs Lisp code.</P>
</DD>
</DL>

<P class="docText">All three modes have the same basic functionality; they differ only
in the support they give to running Lisp code.</P>

<P class="docText">All three Lisp modes understand the basic syntax elements common to
all language modes. In addition, they have various commands that
apply to the more advanced syntactic concepts of S-expressions,
lists, and defuns. An <span class="docEmphasis">S-expression</span> (or syntactic
expression) is any syntactically correct Lisp expression, be it an
atom (number, symbol, variable, etc.), or parenthesized list.
<span class="docEmphasis">Lists</span> are special cases of S-expressions, and
<span class="docEmphasis">defuns</span> (function definitions) are special cases
of lists. Several commands deal with these syntactic concepts; you
will most likely become comfortable with a subset of them.</P>

<P class="docText"><A class="docLink" HREF="#gnu3-CHP-9-TABLE-11">Table 9-11</A> shows the commands that
<A NAME="gnu3-CHP-9-ITERM-2616"></A><A NAME="gnu3-CHP-9-ITERM-2617"></A><A NAME="gnu3-CHP-9-ITERM-2618"></A>handle S-expressions.</P>

<A NAME="gnu3-CHP-9-TABLE-11"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 9-11. S-expression commands</h5></CAPTION><COLGROUP><COL><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Keystrokes</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Command name</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Action</span></P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-b</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">backward-sexp</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move backward by one S-expression.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-f</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">forward-sexp</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move forward by one S-expression.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-t</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">transpose-sexps</span></P>
</TD><TD class="docTableCell">
<P class="docText">Transpose the two S-expressions around the cursor.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-@</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">mark-sexp</span></P>
</TD><TD class="docTableCell">
<P class="docText">Set mark to the end of the current S-expression; set the cursor to
the beginning.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-k</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">kill-sexp</span></P>
</TD><TD class="docTableCell">
<P class="docText">Delete the S-expression following the cursor.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">(<span class="docEmphasis">none</span>)</P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">backward-kill-sexp</span></P>
</TD><TD class="docTableCell">
<P class="docText">Delete the S-expression preceding the cursor.</P>
</TD></TR></TABLE></P><br>

<P class="docText">Since an S-expression can be a wide variety of things, the actions of
commands that handle S-expressions are determined by where your
cursor is when you invoke them. If your cursor is on a <span class="docEmphBold">(</span> or on a space preceding one, the
S-expression in question is taken to be the list that starts with
that <span class="docEmphBold">(</span>. If your cursor is on some
other character such as a letter or number (or preceding whitespace),
the S-expression is taken to be an atom (symbol, variable, or
constant).</P>

<P class="docText">For example, suppose your cursor is in this position:</P>

<PRE>(mary bob<span class="docEmphCursor"> </span>(dave (pete)) ed)</PRE><BR>


<P class="docText">If you type <span class="docEmphBold">C-M-f</span>, the cursor moves
like this:</P>

<PRE>(mary bob (dave (pete))<span class="docEmphCursor"> </span>ed)</PRE><BR>


<P class="docText">That is, the cursor moves forward past the S-expression <span class="docEmphBold">(dave (pete))</span>, which is a list. However, say
your cursor is positioned like this:</P>

<PRE>(mary<span class="docEmphCursor"> </span>bob (dave (pete)) ed)</PRE><BR>


<P class="docText">When you type <span class="docEmphBold">C-M-f</span>, it moves here:</P>

<PRE>(mary bob<span class="docEmphCursor"> </span>(dave (pete)) ed)</PRE><BR>


<P class="docText">In this case, the S-expression is the atom <span class="docEmphBold">bob</span>.</P>

<P class="docText">The commands moving in lists are shown in <A class="docLink" HREF="#gnu3-CHP-9-TABLE-12">Table 9-12</A>.</P>

<A NAME="gnu3-CHP-9-TABLE-12"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 9-12. Commands for moving in lists</h5></CAPTION><COLGROUP><COL><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Keystrokes</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Command name</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Action</span></P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-n</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">forward-list</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move forward by one list.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-p</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">backward-list</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move backward by one list.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-d</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">down-list</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move forward and down one parenthesis level.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText">(<span class="docEmphasis">none</span>)</P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">up-list</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move forward out of one parenthesis level.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-u</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">backward-up-list</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move backward out of one parenthesis level.</P>
</TD></TR></TABLE></P><br>

<P class="docText">As a mnemonic device, you can think of lists as analogous to lines
and S-expressions as analogous to characters; thus, <span class="docEmphBold">C-n</span> and <span class="docEmphBold">C-p</span>
appear in list motion commands, whereas <span class="docEmphBold">C-f</span> and <span class="docEmphBold">C-b</span>
appear in S-expression motion commands. <span class="docEmphBold">C-M-n</span> and <span class="docEmphBold">C-M-p</span> work similarly to <span class="docEmphBold">C-M-f</span> and <span class="docEmphBold">C-M-b</span>, respectively, except that you must
position the cursor so that there is a list in front or back of it to
move across—that is, there must be an opening or closing
parenthesis on, after, or before the cursor. If there is no
parenthesis, Emacs signals an error. For example, if your cursor is
positioned like this:</P>

<PRE>(fred bob (dave (pe<span class="docEmphCursor">t</span>e)<span class="docEmphasis">)</span> ed)</PRE><BR>


<P class="docText">and you type <span class="docEmphBold">C-M-n</span>, Emacs complains
with the message:</P>

<PRE>Containing expression ends prematurely</PRE><BR>


<P class="docText">However, if your cursor is here:</P>

<PRE>(fred <span class="docEmphCursor"> </span>b<span class="docEmphasis">o</span>b (dave (pete)) ed)</PRE><BR>


<P class="docText">the "next list" is actually
<span class="docEmphBold">(dave (pete))</span>, and the cursor ends
up like this if you type <span class="docEmphBold">C-M-n</span>:</P>

<PRE>(fred bob (dave (pete))<span class="docEmphCursor"> </span>ed)</PRE><BR>


<P class="docText">The commands for moving up or down lists enable you to get inside or
outside them. For example, say your cursor is here:</P>

<PRE><span class="docEmphCursor">(</span>fred bob (dave (pete)) ed)</PRE><BR>


<P class="docText">typing <span class="docEmphBold">C-M-d</span> moves the cursor here:</P>

<PRE>(<span class="docEmphCursor">f</span>red bob (dave (pete)) ed)</PRE><BR>


<P class="docText">This is the result because <span class="docEmphBold">fred</span> is
the next level down after its enclosing list. Typing <span class="docEmphBold">C-M-d</span> again has this result:</P>

<PRE>(fred bob (<span class="docEmphCursor">d</span>ave (pete)) ed)</PRE><BR>


<P class="docText">You are now inside the list <span class="docEmphBold">(dave
(pete))</span>. At this point, typing <span class="docEmphBold">C-M-u</span> does the opposite of what <span class="docEmphBold">C-M-d</span> does: it moves the cursor back and
outside of the two lists. But if you type <span class="docEmphBold">M-x
up-list Enter</span>, you will move forward as well as out,
resulting in this:</P>

<PRE>(fred bob (dave (pete))<span class="docEmphCursor"> </span>ed)</PRE><BR>


<P class="docText">The commands for defuns listed in <A class="docLink" HREF="#gnu3-CHP-9-TABLE-13">Table 9-13</A> are
more straightforward.</P>

<A NAME="gnu3-CHP-9-TABLE-13"></A><P><TABLE CELLSPACING="0" BORDER="1" RULES="all" CELLPADDING="4" WIDTH="100%"><CAPTION><h5 class="docTableTitle">Table 9-13. Commands for working with functions</h5></CAPTION><COLGROUP><COL><COL><COL></COLGROUP><THEAD><TR><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Keystrokes</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Command name</span></P>
</TH><TH class="thead" scope="col">
<P class="docText"><span class="docEmphBold">Action</span></P>
</TH></TR></THEAD><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-a</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">beginning-of-defun</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the beginning of the current function.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-e</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">end-of-defun</span></P>
</TD><TD class="docTableCell">
<P class="docText">Move to the end of the current function.</P>
</TD></TR><TR><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">C-M-h</span></P>
</TD><TD class="docTableCell">
<P class="docText"><span class="docEmphBold">mark-defun</span></P>
</TD><TD class="docTableCell">
<P class="docText">Put the cursor at the beginning of the function, put the mark at the
end.</P>
</TD></TR></TABLE></P><br>

<P class="docText">These commands work properly only when the <span class="docEmphBold">(defun</span> that starts the current function is at
the beginning of a line.</P>

<A NAME="gnu3-CHP-9-SECT-8.1"></A>
<H4 class="docSection2Title">9.8.1 Indentation in Lisp Modes</H4>

<P class="docText">The Lisp modes provide "flashing"
<A NAME="gnu3-CHP-9-ITERM-2619"></A><A NAME="gnu3-CHP-9-ITERM-2620"></A><A NAME="gnu3-CHP-9-ITERM-2621"></A>of
matching left parentheses; if the matching parenthesis is outside of
the current window, the line it is on appears in the minibuffer. The
Lisp modes also provide indentation via the <span class="docEmphBold">Tab</span> key and <span class="docEmphBold">C-j</span> for <span class="docEmphBold">newline-and-indent</span> (except in Lisp interaction
mode, described later in this chapter). The indentation style
supported by the Lisp modes "knows"
a lot about Lisp keywords and list syntax; unfortunately, it is not
easily customized.<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-9-FNOTE-12">[12]</A></sup></P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-9-FNOTE-12">[12]</A></sup> The indentation style is bound up
in the Emacs Lisp code for Lisp mode. If you are an experienced Lisp
hacker, you can examine the code for <span class="docEmphBold">lisp-mode.el</span> in the Emacs Lisp directory and
determine how to customize indentation the way you wish. A good place
to start looking is the function <span class="docEmphBold">lisp-indent-line</span>.</p></blockquote>

<P class="docText">Here is an example, a Lisp equivalent of the
"times" C function shown earlier in
the chapter, that illustrates the indentation style:</P>

<PRE>(defun times (x y)
  (let ((i 0)
        (result 0))
    (while (&lt; i x)
      (setq result (+ result y)
            i (1+ i)))
    result))</PRE><BR>


<P class="docText">The basic indentation value is 2; this value is used whenever code on
the next line goes down a level in nesting. For example, the body of
the function, after the line containing <span class="docEmphBold">defun</span>, is indented by 2. The <span class="docEmphBold">(while..</span>. and <span class="docEmphBold">result))</span> lines are indented by 2 with respect
to the <span class="docEmphBold">let</span> because they are the body
of the block <span class="docEmphBold">let</span> introduces.</P>

<P class="docText">Things like <span class="docEmphBold">defun</span>, <span class="docEmphBold">let</span>, and <span class="docEmphBold">while</span> are function calls, even though they act
like keywords. The indentation convention for function calls is that
if there are arguments on lines after the line where the function
name and first argument appear, the additional arguments line up with
the first one. In other words, this has the form:</P>

<PRE>(function-name arg1
               arg2
               arg3
               ...)</PRE><BR>


<P class="docText">The multiple arguments to <span class="docEmphBold">setq</span> in
the preceding function provide another example of this.</P>

<P class="docText">However, the indentation of the line <span class="docEmphBold">(result
0)</span> shows that something a bit different happens with lists
that are not function calls. The list in question is actually
<span class="docEmphBold">((i 0) (result 0))</span>, which is a list
with two elements (both of which are also lists). The indentation
style supported by the Lisp modes lines up these two elements.</P>

<P class="docText">Even though keyword-like terms such as <span class="docEmphBold">let</span> and <span class="docEmphBold">while</span>
are actually function calls, the Lisp modes
"understand" these functions to the
extent that special indentation conventions are set up for them. For
example, if we were to put the condition for the while-loop on a
separate line and press <span class="docEmphBold">Tab</span> to
indent it properly, the result would be:</P>

<PRE>    (while 
        (&lt; i x)
      (setq result (+ result y)
            i (1+ i)))</PRE><BR>


<P class="docText">Similar things happen with <span class="docEmphBold">if</span> and
<span class="docEmphBold">cond</span> control structures; <A class="docLink" HREF="gnu3-CHP-11.html#gnu3-CHP-11">Chapter 11</A> contains properly indented examples.</P>

<P class="docText">Another remark about indentation conventions: the Lisp modes are
geared toward a style in which multiple right parentheses are put on
the same line immediately following each other, instead of on
separate lines. For example, the line <span class="docEmphBold">i (1+
i)))</span> contains right parentheses that close off the
<span class="docEmphBold">1+</span> function, the <span class="docEmphBold">setq</span>, and the <span class="docEmphBold">while</span> respectively. If you prefer, you can put
your closing parentheses on separate lines, but if you press
<span class="docEmphBold">Tab</span> to indent them, they
won't line up properly with their matching open
parentheses; you have to indent them manually.</P>

<P class="docText">In addition to the <span class="docEmphBold">Tab</span> and <span class="docEmphBold">C-j</span> commands for indentation, the Lisp modes
support the command <span class="docEmphBold">C-M-q</span> (for
<span class="docEmphBold">indent-sexp</span>), which indents every
line in the S-expression just following the cursor. You can use this
command, for example, to indent an entire function definition: just
put the cursor right before the <span class="docEmphBold">defun</span> and type <span class="docEmphBold">C-M-q</span>.</P>


<A NAME="gnu3-CHP-9-SECT-8.2"></A>
<H4 class="docSection2Title">9.8.2 Comments in Lisp Modes</H4>

<P class="docText">Comments in the Lisp modes are handled <A NAME="gnu3-CHP-9-ITERM-2622"></A><A NAME="gnu3-CHP-9-ITERM-2623"></A><A NAME="gnu3-CHP-9-ITERM-2624"></A>by
the universal comment command <span class="docEmphBold">M-;</span>,
which indents out to <span class="docEmphBold">comment-column</span>
(or, if there is text at that column, one space past the last
character), inserts a semicolon, and puts the cursor just past it. If
you want a comment to occupy an entire line (or to start anywhere
other than at <span class="docEmphBold">comment-column</span>), you
must move to where you want the comment to start and type the
semicolon yourself. Note that if you press <span class="docEmphBold">Tab</span> on any line that contains only a comment,
the comment moves out to <span class="docEmphBold">comment-column</span>. To get around this, use two or
more semicolons; doing so causes <span class="docEmphBold">Tab</span>
to leave the comments where they are. The Lisp modes also support the
other comment commands discussed earlier in the chapter, including
<span class="docEmphBold">M-j</span> to extend a comment to another
line and <span class="docEmphBold">M-x kill-comment Enter</span> to
get rid of a single-line comment. These features are common to all
three Lisp modes; next, we discuss the features unique to each.</P>


<A NAME="gnu3-CHP-9-SECT-8.3"></A>
<H4 class="docSection2Title">9.8.3 Emacs Lisp Mode Differences</H4>

<P class="docText">Emacs Lisp mode was designed <A NAME="gnu3-CHP-9-ITERM-2625"></A>to be
used with code meant to run within Emacs itself, so it facilitates
running the code you type. Lisp is an interpreted (as opposed to
purely compiled) language, so it is possible to blur the line between
the write and run/debug phases of Lisp programming; Emacs Lisp mode
takes some advantage of this opportunity, whereas Lisp interaction
mode goes even further, as we'll see later. In Emacs
Lisp mode, the command <span class="docEmphBold">C-M-x</span>
(<span class="docEmphBold">eval-defun</span>) picks up the function
definition around or after the cursor and evaluates it, meaning that
it parses the function and stores it so that Emacs
"knows" about the function when you
invoke it.</P>

<P class="docText">Emacs Lisp mode also includes the command <span class="docEmphBold">M-Tab</span> (for <span class="docEmphBold">lisp-complete-symbol</span>),<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-9-FNOTE-13">[13]</A></sup> which performs
completion on the symbol (variable, function name, etc.) preceding
the cursor, as described in <A class="docLink" HREF="gnu3-CHP-14.html#gnu3-CHP-14">Chapter 14</A>. Thus,
you can type the shortest unambiguous prefix for the symbol, followed
by <span class="docEmphBold">M-Tab</span>, and Emacs tries to
complete the symbol's name for you as far as it can.
If it completes the symbol name, you can go on with whatever you are
doing. If it doesn't, you haven't
provided an unambiguous prefix. You can type more characters (to
disambiguate further), or you can type <span class="docEmphBold">M-Tab</span> again, and a help window showing the
choices pops up. Then you can type more characters and complete the
symbol yourself, or you can try for completion again.</P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-9-FNOTE-13">[13]</A></sup> This
key binding may not work on all platforms. If it is intercepted by
the operating system (as it is on Red Hat Linux), type <span class="docEmphBold">Esc Tab</span> instead (remember to release <span class="docEmphBold">Esc</span> before you press <span class="docEmphBold">Tab</span>).</p></blockquote>


<A NAME="gnu3-CHP-9-SECT-8.4"></A>
<H4 class="docSection2Title">9.8.4 Lisp Mode Differences</H4>

<P class="docText">Lisp mode (as opposed to Emacs Lisp mode) is meant for use with Lisp
processors other than the Emacs Lisp interpreter. Therefore it
includes a couple of commands for interfacing to an external Lisp
interpreter. The Lisp mode command <span class="docEmphBold">C-c
C-z</span> (<span class="docEmphBold">run-lisp</span>) starts up
your system's Lisp interpreter as a subprocess and
creates the <TT>*lisp*</TT> buffer (with an associated
window) for input and output.<sup class="docFootnote"><A class="docLink" HREF="#gnu3-CHP-9-FNOTE-14">[14]</A></sup> If a Lisp subprocess
already exists, <span class="docEmphBold">C-c C-z</span> uses it
rather than creating a second one. You can send function definitions
to the Lisp subprocess by putting the cursor anywhere within a
function's definition and using <span class="docEmphBold">C-M-x</span>, which in this case stands for <span class="docEmphBold">lisp-send-defun</span>. This procedure causes the
functions you define to become known to the Lisp interpreter so that
you can invoke them later.</P><blockquote><p class="docFootnote"><sup><A NAME="gnu3-CHP-9-FNOTE-14">[14]</A></sup> This Lisp mode command
(<span class="docEmphBold">run-lisp</span>) was designed to run with
the franz Lisp system on BSD Unix systems, though it should work with
other Lisp interpreters.</p></blockquote>


<A NAME="gnu3-CHP-9-SECT-8.5"></A>
<H4 class="docSection2Title">9.8.5 Working with Lisp Fragments</H4>

<P class="docText">Emacs Lisp mode is probably the best
<A NAME="gnu3-CHP-9-ITERM-2626"></A><A NAME="gnu3-CHP-9-ITERM-2627"></A>thing to use if you are editing entire
files of Emacs Lisp code, for example, if you are programming your
own mode (as described in <A class="docLink" HREF="gnu3-CHP-11.html#gnu3-CHP-11">Chapter 11</A>) or
modifying an existing one. However, if you are editing
"little" pieces of Lisp code (for
example, making additions or modifications to your
<span class="docEmphasis">.emacs</span> file), Emacs has more powerful features
you can use that further blur the line between writing and running
code.</P>

<A NAME="gnu3-CHP-9-SECT-8.5.1"></A>
<H5 class="docSection3Title">9.8.5.1 Commands for evaluating a line of Lisp</H5>

<P class="docText">The first of these <A NAME="gnu3-CHP-9-ITERM-2628"></A>is the command <span class="docEmphBold">M-</span>: (for <span class="docEmphBold">eval-expression</span>). This command enables you to
type a one-line Lisp expression of any kind in the minibuffer; the
expression is evaluated, and the result is printed in the minibuffer.
This is an excellent, quick way to check the values of Emacs
variables and to experiment with
"internal" Emacs functions that
aren't bound to keys or that require arguments. You
can use the symbol completion command <span class="docEmphBold">M-Tab</span> while you are using <span class="docEmphBold">eval-expression</span>.</P>

<P class="docText">Unfortunately (or fortunately, depending on your point of view),
Emacs doesn't normally let you use <span class="docEmphBold">eval-expression</span>. If you try pressing <span class="docEmphBold">M-</span>:, you will see the message <TT>loading
novice . . </TT>.  in the minibuffer. Then a window pops up with
a message on the order of, "You
didn't really mean to type that, did
you?" You get three options: press <span class="docEmphBold">Space</span> to try the command only once, <span class="docEmphBold">y</span> to try it and enable it for future use with
no questions asked, or <span class="docEmphBold">n</span> to do
nothing.</P>

<P class="docText">If you want to use <span class="docEmphBold">eval-expression</span>,
type <span class="docEmphBold">y</span>. This command actually
results in the following line being put in your
<span class="docEmphasis">.emacs</span> file:</P>

<PRE>(put 'eval-expression 'disabled nil)</PRE><BR>


<P class="docText">If you are a knowledgeable Lisp programmer, you will understand that
this addition sets the property <span class="docEmphBold">disabled</span> of the symbol <span class="docEmphBold">eval-expression</span> to <span class="docEmphBold">nil</span>. In other words, Emacs considers certain
commands to be verboten to novice users and thus allows commands to
be disabled. If you want to skip this entire procedure and just use
<span class="docEmphBold">eval-expression</span>, simply put the
above line in your <span class="docEmphasis">.emacs</span> file yourself (make
sure you include the single quotes).</P>

<P class="docText">Another feature that helps you exercise Emacs Lisp code is <span class="docEmphBold">C-x C-e</span> (for <span class="docEmphBold">eval-last-sexp</span>). This command runs the line of
Lisp that your cursor is on and prints its value in the minibuffer.
<span class="docEmphBold">C-x C-e</span> is handy for testing single
lines of code in an Emacs Lisp file.</P>



<A NAME="gnu3-CHP-9-SECT-8.5.2"></A>
<H5 class="docSection3Title">9.8.5.2 Using Lisp interaction mode</H5>

<P class="docText">An even more powerful feature is <A NAME="gnu3-CHP-9-ITERM-2629"></A><A NAME="gnu3-CHP-9-ITERM-2630"></A><A NAME="gnu3-CHP-9-ITERM-2631"></A>Lisp interaction mode. This is the mode the
default buffer <TT>*scratch*</TT> is in. Filenames with no
suffixes normally cause Emacs to go into Lisp interaction mode,
though you can change this using the variable <span class="docEmphBold">auto-mode-alist</span>, described earlier in this
chapter and in more detail in <A class="docLink" HREF="gnu3-CHP-10.html#gnu3-CHP-10">Chapter 10</A>. You
can also put any buffer in Lisp interaction mode by typing <span class="docEmphBold">M-x lisp-interaction-mode Enter</span>; to create an
extra Lisp interaction buffer, just type <span class="docEmphBold">C-x
b</span> (for <span class="docEmphBold">switch-to-buffer</span>),
supply a buffer name, and put it in Lisp interaction mode.</P>

<P class="docText">Lisp interaction mode is identical to Emacs Lisp mode except for one
important feature: <span class="docEmphBold">C-j</span> is bound to
the command <span class="docEmphBold">eval-print-last-sexp</span>.
This command takes the S-expression just before point, evaluates it,
and prints the result in the buffer. To get the usual <span class="docEmphBold">newline-and-indent</span> functionality attached to
<span class="docEmphBold">C-j</span> in other modes, you must press
<span class="docEmphBold">Enter</span>, followed by <span class="docEmphBold">Tab</span>.</P>

<P class="docText">Remember that an S-expression is any syntactically valid expression
in Lisp. Therefore, you can use <span class="docEmphBold">C-j</span>
in Lisp interaction mode to check the values of variables, enter
function definitions, run functions, and so on. For example, if you
type <span class="docEmphBold">auto-save-interval</span> and press
<span class="docEmphBold">C-j</span>, the value of that variable (300
by default) appears. If you type a <span class="docEmphBold">defun</span> and press <span class="docEmphBold">C-j</span> after the last right parenthesis, Emacs
stores the function defined (for future invocation) and prints its
name; in this case, <span class="docEmphBold">C-j</span> is similar
to <span class="docEmphBold">C-M-x</span> (for <span class="docEmphBold">eval-defun</span>) except that the cursor must be
after (as opposed to before or in the middle of) the function being
defined. If you invoke a function, Emacs evaluates (runs) the
expression and responds with whatever value the function returns.</P>

<P class="docText"><span class="docEmphBold">C-j</span> in Lisp interaction mode gives
you an excellent way to play with, incrementally develop, and debug
Emacs Lisp code, and since Emacs Lisp is
"true" Lisp, it is even useful for
developing some bits of code for other Lisp systems.</P>









<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="gnu3-CHP-9-SECT-7.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="gnu3-CHP-10.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
