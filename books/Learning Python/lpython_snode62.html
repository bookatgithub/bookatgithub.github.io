<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="5.9 Exercises"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="lpython_snode61.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="lpython_cnode63.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>5.9
Exercises</h3>


<ol TYPE="1">
<li><p><i>Basics, import</I>.
With your favorite text editor, write a Python module called
<I>mymod.py</I>, which exports three top-level names:</P>



<ul>
<li><P> A <TT Class="monofont">countLines(name)</tt> function that reads an input file
and counts the number of lines in it (hint:
<tt class="monofont">file.readlines()</tt> does most of the work for
you)</p>
</li>
<li><P>A <tT claSs="monofont">countChars(name)</TT> function
that reads an input file and counts the number of characters in it
(hint: <tT ClAsS="monofont">file.read()</TT> returns a single
string)</P>
</li>
<li><P>A <TT Class="monofont">test(name)</TT> function
that calls both counting functions with a given input
filename</P>
</Li>
</ul>

<p>A filename string should be passed into all three
<TT CLass="monofont">mymod</tt> functions. Now, test your module
interactively, using <tt class="monofont">import</tt> and name qualification
to fetch your exports. Does your <tt clasS="monofont">PYTHONPATH</tT>
include the directory where you created <i>mymod.py
</i>? Try running your module on itself: e.g.,
<tT cLAsS="monofont">test("mymod.py")</Tt>. Note that
<Tt CLASs="monofont">test</tt> opens the file twice; if you're feeling
ambitious, you might be able to improve this by passing an open file
object into the two count functions.</p>
</LI>
<LI><p><i>from/from</i>. Test
your <tT CLAss="monofont">mymod</tt> module from Exercise 1
<I>interactively</I>, by using <TT class="monofont">from</tt>
to load the exports directly, first by name, then using the
<tt class="monofont">from*</tt> variant to fetch everything.</p>
</li>
<lI><p>__<I>main</i>__. Now, add
a line in your <tt ClASs="monofont">mymod</TT> module that calls the
<tT cLASS="monofont">test</tt> function automatically only when the module
is run as a <i>script</i>. Try running your module from
the system command line; then import the module and test its
functions interactively. Does it still work in both modes?</P>
</LI>
<Li><p><i>Nested imports</i>.
Finally, write a second module, <I>myclient.py</I>,
which imports <TT clasS="monofont">mymod</TT> and tests its functions; run
<I>myclient</i> from the system command line. If
<i>myclient</i> uses <tt class="monofont">from</tt> to fetch
from <tt class="monofont">mymod</tT>, will
<tT claSs="monofont">mymod</TT>'s functions be
accessible from the top level of <i>myclient</I>? What
if it imports with <Tt ClASS="monofont">import</Tt> instead? Try coding both
variations in <i>myclient</i> and test interactively,
by importing <i>myclient</I> and inspecting its __
<TT Class="monofont">dict</TT>__.</P>
</Li>
<li><p><I>Reload</I>. Experiment with module reloads:
perform the tests in the <I>changer.py </I>example,
changing the called function's message and/or behavior
repeatedly, without stopping the Python interpreter. Depending on
your system, you might be able to edit <tt class="monofont">changer</tt> in
another window, or suspend the Python interpreter and edit in the
same window (on Unix, a Ctrl-Z key combination usually suspends the
current process, and a <tt class="monofont">fg</tt> command later resumes
it).</p>
</lI>
<lI><p><i>Circular imports
</i> (and other acts of cruelty).<FoNT sIZe="1"><SuP><A HRef="#FOOTNOTE-10">[10]</a></sUP></FOnt>
 In the section on recursive import gotchas, importing
<tt CLASs="monofont">recur1</tt> raised an error. But if we restart Python
and import <tT CLAss="monofont">recur2</tt> interactively, the error
doesn't occur: test and see this for yourself. Why do you think
it works to import <tt class="monofont">recur2</tt>, but not
<tt class="monofont">recur1</Tt>? (Hint: Python stores new modules in the
built-in <Tt clAsS="monofont">sys.modules</Tt> table (a dictionary) before
running their code; later imports fetch the module from this table
first, whether the module is "complete" yet or not.) Now
try running <TT cLaSS="monofont">recur1</TT> as a script:
<tt clASS="monofont">%</Tt> <tt cLASS="monofont">python</tt>
<tt CLASs="monofont">recur1.py</tt>. Do you get the same error that occurs
when <tt class="monofont">recur1</tt> is imported interactively? Why? (Hint:
when modules are run as programs they aren't imported, so this
case has the same effect as importing <tt class="monofont">recur2</tT>
interactively; <tT claSs="monofont">recur2</TT> is the first module
imported.) What happens when you run <tT ClAsS="monofont">recur2</TT> as a
script?<A name="idx471"></A></P>


<BLockqUOTE><font SIZE="1">
<p class="footnote">
<sup><a name="FOOTNOTE-10">[10]</a></sup>
We should
note that circular imports are extremely rare in practice. In fact,
we have never coded or come across a circular import in six years of
Python coding—except on the Internet (where such things receive
an inordinate amount of attention), and when writing books like this.
On the other hand, if you can understand why it's a potential
problem, you know a lot about Python's import semantics.</p>
</fOnT></bloCkQUoTE>


</lI>
</oL>

</FONt>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="lpython_snode61.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="lpython_cnode63.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>