<HTML><HEAD><TITLE>ch15-1-fm2xml</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252"><LINK 
href="image/style.css" type=text/css rel=STYLESHEET><LINK 
href="image/docsafari.css" type=text/css rel=STYLESHEET>

<META content="MSHTML 6.00.2800.1141" name=GENERATOR></HEAD>
<BODY leftMargin=0 topMargin=0 marginheight="0" marginwidth="0"><A 
name=toppage></A><SPAN class=v2></SPAN>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD align=middle>
      <TABLE width="95%">
        <TBODY>
        <TR>
          <TD class=v2 align=left>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=5 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top width=76 rowSpan=4><A 
                  ><IMG 
                  height=100 src="image/masteralgoc_xs.gif" width=76 
                  border=0></A></TD>
                <TD class=v2 vAlign=top><A class=t1 
                  >Mastering 
                  Algorithms with C</A><BR>By Kyle&nbsp;Loudon<BR>Slots : 
                1<BR></TD></TR>
              <TR>
                <TD class=v1><A class=v1 
                  href="table.html">Table 
                  of Contents</A></TD></TR>
              <TR>
                <TD></TD></TR>
              <TR>
                <TD class=t1 vAlign=bottom>Part III:&nbsp; 
              Algorithms</TD></TR></TBODY></TABLE>
            <HR SIZE=1>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=center>&nbsp; <A accessKey=2 
                  href="ch14-60-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=left border=0></A> &nbsp; <A  
href="table.html" align=center> Content </A>	<A accessKey=1                  href="ch15-2-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=right border=0></A></TD></TR></TBODY></TABLE>
            <BR>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top><A name=ch15-1-fm2xml></A>
                  <H2 class=docChapterTitle>Chapter 15. Data Encryption</H2>
                  <P class=docText><A name=ch15-idx-368952-1></A>Data <A 
                  name=IXT-15-314901></A>encryption, or <A 
                  name=IXT-15-314902></A><SPAN 
                  class=docEmphasis>cryptography</SPAN>, is the science of 
                  secrecy. Its purpose is to keep information in the hands of 
                  those who should have it and out of the hands of those who 
                  should not. Considering such a statement, it probably comes as 
                  no surprise that <A name=IXT-15-314903></A>cryptographic 
                  algorithms, called <SPAN class=docEmphasis>ciphers</SPAN><A 
                  name=IXT-15-314904></A>, historically have had profound 
                  political, social, and ethical implications. Data encryption, 
                  like data compression, is another product of <SPAN 
                  class=docEmphasis>information theory</SPAN>, <A 
                  name=IXT-15-314905></A>an area of mathematics that addresses 
                  various ways to manage and manipulate information. Data 
                  encryption entails two processes: in one process we <SPAN 
                  class=docEmphasis>encipher</SPAN> recognizable data, called<A 
                  name=IXT-15-314906></A> <SPAN 
                  class=docEmphasis>plaintext</SPAN>, into an unrecognizable 
                  form, called <SPAN class=docEmphasis>ciphertext </SPAN><A 
                  name=IXT-15-314907></A>; in a second process we <SPAN 
                  class=docEmphasis>decipher</SPAN> the ciphertext back into the 
                  original plaintext. The main idea behind a cipher is that the 
                  transformation from ciphertext to plaintext should be easy if 
                  we are allowed to read the data, yet impractical if we are 
                  not.</P>
                  <P class=docText>Ciphers use a special piece of information, 
                  called a <SPAN class=docEmphasis>key</SPAN>, for security. 
                  Once a key has been used to encipher some data, only someone 
                  who knows the correct key can decipher it. In fact, a 
                  fundamental characteristic of any good cipher is that its 
                  security revolves around a key, or even several. Furthermore, 
                  the security of a good cipher does not rely on keeping the 
                  cipher's algorithm a secret. This idea is similar to the 
                  security offered by a safe: even though everyone knows how a 
                  safe works, we cannot get inside without the combination that 
                  opens the door.</P>
                  <P class=docText>One way to classify modern ciphers is by how 
                  they use keys. In this regard, a cipher is either <SPAN 
                  class=docEmphasis>symmetric</SPAN> or <SPAN 
                  class=docEmphasis>asymmetric</SPAN>. <A 
                  name=IXT-15-314908></A>In symmetric ciphers, the same key is 
                  used both to encipher and decipher data. Consequently, anyone 
                  who knows the key is able to encipher data as well as decipher 
                  it. In asymmetric ciphers, usually called <SPAN 
                  class=docEmphasis>public-key ciphers</SPAN><A 
                  name=IXT-15-314909></A>, the key used to encipher data is 
                  different from the key used to decipher it. The key used to 
                  encipher data is called the <SPAN class=docEmphasis>public 
                  key</SPAN> ; the key used to decipher data is called the <SPAN 
                  class=docEmphasis>private key</SPAN>. The public and private 
                  keys work together so that only a specific private key 
                  deciphers the data enciphered using a specific public key. 
                  Thus, just because a party knows how to encipher data does not 
                  necessarily mean it can decipher data; it must possess the 
                  correct private key. <A class=docLink 
                  href="#ch15-44636">Example 
                  15.1</A> is a header for the ciphers presented in this 
                  chapter.</P>
                  <P class=docText>This chapter covers:</P><A 
                  name=IXT-15-314910></A><A name=IXT-15-314911></A><A 
                  name=IXT-15-314912></A>
                  <DL class=docList>
                    <DT><SPAN class=docPubcolor>DES (Data Encryption Standard) 
                    <A name=IXT-15-314910></A></SPAN>
                    <DD>
                    <P class=docList>One of the most popular symmetric ciphers. 
                    Today it is considered reasonably secure, but increases in 
                    the speed of computers continue to make this method less and 
                    less secure over time. DES is considered a very efficient 
                    cipher, even when implemented in software.</P>
                    <DT><SPAN class=docPubcolor>RSA (Rivest-Shamir-Adleman) <A 
                    name=IXT-15-314911></A><A name=IXT-15-314912></A></SPAN>
                    <DD>
                    <P class=docList>One of the most popular public-key ciphers. 
                    RSA is considered very secure. However, it is much slower 
                    than DES. Thus, it is often used to encrypt smaller amounts 
                    of data, such as keys for other types of encryption, and 
                    digital signatures.</P></DD></DL>
                  <P class=docText>Some applications of data encryption are:<A 
                  name=IXT-15-314913></A></P><A name=IXT-15-314914></A><A 
                  name=IXT-15-314915></A><A name=IXT-15-314916></A><A 
                  name=IXT-15-314917></A><A name=IXT-15-314918></A><A 
                  name=IXT-15-314919></A><A name=IXT-15-314920></A>
                  <DL class=docList>
                    <DT><SPAN class=docPubcolor>Digital cash <A 
                    name=IXT-15-314914></A></SPAN>
                    <DD>
                    <P class=docList>A means of conducting financial 
                    transactions so that they can be authenticated but not 
                    traced. Transactions must be authenticated so that parties 
                    involved in the transaction are not cheated. They must be 
                    untraceable so that the privacy of each party is protected. 
                    In practice, these are difficult requirements to support in 
                    tandem without special protocols.</P>
                    <DT><I><SPAN class=docPubcolor>Authentication servers 
                    </SPAN></I>
                    <DD>
                    <P class=docList><A name=IXT-15-314915></A>Servers charged 
                    with solving the problem of two parties at different ends of 
                    a network talking securely. The parties must be able to 
                    exchange keys while at the same time being sure that they 
                    are talking to one another rather than an impostor. 
                    Authentication servers accomplish this with a variety of 
                    protocols that rely on encryption.</P>
                    <DT><SPAN class=docPubcolor>Electronic mail <A 
                    name=IXT-15-314916></A></SPAN>
                    <DD>
                    <P class=docList>Data in email is typically sent across 
                    insecure channels, such as the Internet. The widespread use 
                    and abuse of the Internet has made encrypting sensitive 
                    electronic messages especially important in recent 
years.</P>
                    <DT><SPAN class=docPubcolor><A 
                    name=IXT-15-314917></A>National security </SPAN>
                    <DD>
                    <P class=docList>Matters of diplomacy and national defense. 
                    Historically, encryption has played a critical role in a 
                    great number of military matters. Embassies constantly 
                    transmit and receive sensitive diplomatic information, which 
                    must be kept secret, using encryption. National security has 
                    long been the main argument cited by the U.S. government for 
                    treating encryption technologies much like munitions, with 
                    strict controls over exportation.</P>
                    <DT><I><SPAN class=docPubcolor>Digital signatures 
</SPAN></I>
                    <DD>
                    <P class=docList><A name=IXT-15-314918></A>A method of 
                    validating to whom data really belongs, much like signing a 
                    name to a document. One method of creating a digital 
                    signature is with a public-key cipher. To do this, party 
                    <SPAN class=docEmphasis>A</SPAN> enciphers some data using 
                    its private key and sends it to another party <SPAN 
                    class=docEmphasis>B</SPAN>. <SPAN 
                    class=docEmphasis>B</SPAN>, thinking the data is from <SPAN 
                    class=docEmphasis>A</SPAN>, validates this by deciphering 
                    the data with <SPAN class=docEmphasis>A</SPAN>'s public key. 
                    If this deciphers the data, the data must be from <SPAN 
                    class=docEmphasis>A</SPAN>.</P>
                    <DT><I><SPAN class=docPubcolor>Computerized elections 
                    </SPAN></I>
                    <DD>
                    <P class=docList><A name=IXT-15-314919></A>A futuristic 
                    concept in which voting must be secure. Secure voting has 
                    several interesting requirements, many of which require 
                    varying degrees of secrecy. For example, no one should be 
                    able to determine for whom someone else voted, but it may be 
                    important to know whether someone voted at all.</P>
                    <DT><I><SPAN class=docPubcolor>Smart cards </SPAN></I>
                    <DD>
                    <P class=docList><A name=IXT-15-314920></A>Small plastic 
                    cards containing miniature computers and small amounts of 
                    memory. Typically, smart cards are used for various forms of 
                    credit, such as in paying for phone calls, train rides, or 
                    postage stamps. Other smart cards provide access to 
                    computers and open doors to buildings. Smart cards use 
                    encryption because they can do potentially powerful things 
                    like alter bank accounts and provide access to secure 
                    environments.</P></DD></DL>
                  <H5 class=docExampleTitle><A name=ch15-44636></A>Example 15.1. 
                  Header for Data Encryption </H5><PRE>/*****************************************************************************
*                                                                            *
*  ------------------------------- encrypt.h ------------------------------  *
*                                                                            *
*****************************************************************************/

#ifndef ENCRYPT_H
#define ENCRYPT_H

/*****************************************************************************
*                                                                            *
*  In a secure implementation, Huge should be at least 400 decimal digits,   *
*  instead of the 10 below (ULONG_MAX = 4294967295).                         *
*                                                                            *
*****************************************************************************/

typedef unsigned long Huge;

/*****************************************************************************
*                                                                            *
*  Define a structure for RSA public keys.                                   *
*                                                                            *
*****************************************************************************/

typedef struct <A name=IXT-15-314921></A>RsaPubKey_ {

Huge               e;
Huge               n;

} RsaPubKey;

/*****************************************************************************
*                                                                            *
*  Define a structure for RSA private keys.                                  *
*                                                                            *
*****************************************************************************/

typedef struct <A name=IXT-15-314922></A>RsaPriKey_ {

Huge               d;
Huge               n;

} RsaPriKey;

/*****************************************************************************
*                                                                            *
*  --------------------------- Public Interface ---------------------------  *
*                                                                            *
*****************************************************************************/

void des_encipher(const unsigned char *plaintext, unsigned char *ciphertext,
   const unsigned char *key);

void des_decipher(const unsigned char *ciphertext, unsigned char *plaintext,
   const unsigned char *key);

void rsa_encipher(Huge plaintext, Huge *ciphertext, RsaPubKey pubkey);

void rsa_decipher(Huge ciphertext, Huge *plaintext, RsaPriKey prikey);

#endif</PRE>                  <UL></UL></TD></TR></TBODY></TABLE>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=right>&nbsp; <A accessKey=2 
                  href="ch14-60-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=absMiddle border=0></A> &nbsp; <A accessKey=1 
                  href="ch15-2-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=absMiddle border=0></A></TD></TR></TBODY></TABLE>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top align=right><A class=v1 
                  href="#toppage">Top</A></TD></TR></TBODY></TABLE>
            </TD></TR></TBODY></TABLE></TD>
</BODY></HTML>
