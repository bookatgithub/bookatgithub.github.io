<HTML><HEAD><TITLE>ch16-19-fm2xml</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252"><LINK 
href="image/style.css" type=text/css rel=STYLESHEET><LINK 
href="image/docsafari.css" type=text/css rel=STYLESHEET>

<META content="MSHTML 6.00.2800.1141" name=GENERATOR></HEAD>
<BODY leftMargin=0 topMargin=0 marginheight="0" marginwidth="0"><A 
name=toppage></A><SPAN class=v2></SPAN>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD align=middle>
      <TABLE width="95%">
        <TBODY>
        <TR>
          <TD class=v2 align=left>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=5 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top width=76 rowSpan=4><A 
                  ><IMG 
                  height=100 src="image/masteralgoc_xs.gif" width=76 
                  border=0></A></TD>
                <TD class=v2 vAlign=top><A class=t1 
                  >Mastering 
                  Algorithms with C</A><BR>By Kyle&nbsp;Loudon<BR>Slots : 
                1<BR></TD></TR>
              <TR>
                <TD class=v1><A class=v1 
                  href="table.html">Table 
                  of Contents</A></TD></TR>
              <TR>
                <TD></TD></TR>
              <TR>
                <TD class=t1 vAlign=bottom>Chapter 16.&nbsp; Graph 
                Algorithms</TD></TR></TBODY></TABLE>
            <HR SIZE=1>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=center>&nbsp; <A accessKey=2 
                  href="ch16-18-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=left border=0></A> &nbsp; <A  
href="table.html" align=center> Content </A>	<A accessKey=1                  href="ch16-21-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=right border=0></A></TD></TR></TBODY></TABLE>
            <BR>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top><A name=ch16-19-fm2xml></A>
                  <H3 class=docSection1Title>16.8 Description of the 
                  Traveling-Salesman Problem</H3>
                  <P class=docText><A name=ch16-idx-711179-1></A><A 
                  name=ch16-idx-711179-2></A><A 
                  name=ch16-idx-711179-3></A>Imagine a salesman who needs to 
                  visit a number of cities as part of the route he works. His 
                  goal is to travel the shortest possible distance while 
                  visiting every city exactly once before returning to the point 
                  at which he starts. This is the idea behind the <SPAN 
                  class=docEmphasis>traveling-salesman problem</SPAN>.</P>
                  <P class=docText>In a graph, a tour in which we visit every 
                  other vertex exactly once before returning to the vertex at 
                  which we started is called a <SPAN 
                  class=docEmphasis>hamiltonian cycle</SPAN>. <A 
                  name=IXT-16-314785></A><A name=IXT-16-314786></A>To solve the 
                  traveling-salesman problem, we use a graph <SPAN 
                  class=docEmphasis>G</SPAN> = (<SPAN 
                  class=docEmphasis>V</SPAN>, <SPAN class=docEmphasis>E </SPAN>) 
                  as a model and look for the hamiltonian cycle with the 
                  shortest length. <SPAN class=docEmphasis>G</SPAN> is a 
                  complete, undirected, weighted graph, wherein <SPAN 
                  class=docEmphasis>V</SPAN> is a set of vertices representing 
                  the points we wish to visit and <SPAN 
                  class=docEmphasis>E</SPAN> is a set of edges representing 
                  connections between the points. Each edge in <SPAN 
                  class=docEmphasis>E</SPAN> is weighted by the distance between 
                  the vertices that define it. Since <SPAN 
                  class=docEmphasis>G</SPAN> is complete and undirected, <SPAN 
                  class=docEmphasis>E</SPAN> contains <SPAN 
                  class=docEmphasis>V</SPAN> (<SPAN class=docEmphasis>V</SPAN> - 
                  1)/2 edges.</P>
                  <P class=docText>One way to solve the traveling-salesman 
                  problem is by exploring all possible permutations of the 
                  vertices in <SPAN class=docEmphasis>G</SPAN>. Using this 
                  approach, since each permutation represents one possible tour, 
                  we simply determine which one results in the tour that is the 
                  shortest. Unfortunately, this approach is not at all practical 
                  because it does not run in polynomial time. A polynomial-time 
                  algorithm<A name=IXT-16-314787></A> is one whose complexity is 
                  less than or equal to <SPAN class=docEmphasis>O (nk</SPAN>), 
                  where <SPAN class=docEmphasis>k</SPAN> is some constant. This 
                  approach does not run in polynomial time because for a set of 
                  <SPAN class=docEmphasis>V</SPAN> vertices, there are <SPAN 
                  class=docEmphasis>V</SPAN> ! possible permutations; thus, 
                  exploring them all requires <SPAN class=docEmphasis>O 
                  (V</SPAN> !) time, where <SPAN class=docEmphasis>V</SPAN> ! is 
                  the factorial of <SPAN class=docEmphasis>V</SPAN>, which is 
                  the product of all numbers from <SPAN 
                  class=docEmphasis>V</SPAN> down to 1.</P>
                  <P class=docText>In general, nonpolynomial-time algorithms are 
                  avoided because even for small inputs, problems quickly become 
                  intractable. Actually, the traveling-salesman problem is a 
                  special type of nonpolynomial-time problem called <SPAN 
                  class=docEmphasis>NP-complete</SPAN>. NP-complete problems<A 
                  name=IXT-16-314788></A> are those for which no polynomial-time 
                  algorithms are known, but for which no proof refutes the 
                  possibility either; even so, the likelihood of finding such an 
                  algorithm is extremely slim. With this in mind, normally the 
                  traveling-salesman problem is solved using an 
                  approximation<SPAN class=docEmphasis> </SPAN>algorithm (see <A 
                  class=docLink 
                  href="ch01-1-fm2xml.html#ch01-1-fm2xml">Chapter 
                  1</A>).</P><A name=ch16-20-fm2xml></A>
                  <H4 class=docSection2Title>16.8.1 Applying the 
                  Nearest-Neighbor Heuristic</H4>
                  <P class=docText><A name=ch16-idx-711201-1></A>One way to 
                  compute an approximate traveling-salesman tour is to apply the 
                  <SPAN class=docEmphasis>nearest-neighbor heuristic</SPAN>. <A 
                  name=IXT-16-314789></A>This works as follows. We begin with a 
                  tour consisting of only the vertex at the start of the tour. 
                  We color this vertex black. All other vertices are white until 
                  added to the tour, at which point we color them black as well. 
                  Next, for each vertex <SPAN class=docEmphasis>v</SPAN> not 
                  already in the tour, we compute a weight for the edge between 
                  the last vertex <SPAN class=docEmphasis>u</SPAN> added to the 
                  tour and <SPAN class=docEmphasis>v</SPAN>. Recall that the 
                  weight of an edge from <SPAN class=docEmphasis>u</SPAN> to 
                  <SPAN class=docEmphasis>v</SPAN> in the traveling-salesman 
                  problem is the distance between <SPAN 
                  class=docEmphasis>u</SPAN> and <SPAN 
                  class=docEmphasis>v</SPAN>. We compute this using the 
                  coordinates of the points that each vertex represents. The 
                  distance <SPAN class=docEmphasis>r</SPAN> between two points 
                  (<SPAN class=docEmphasis>x</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>1</SUB>) and (<SPAN 
                  class=docEmphasis>x</SPAN><SUB>2</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>2</SUB>) is defined by the 
                  formula:</P>
                  <P class=docText><IMG height=29 alt=figs/equation.1601.gif 
                  src="image/equation.1601.gif" width=159 border=0></P>
                  <P class=docText>Using this formula, we select the vertex 
                  closest to <SPAN class=docEmphasis>u</SPAN>, color it black, 
                  and add it to the tour. We then repeat this process until all 
                  vertices have been colored black. At this point, we add the 
                  start vertex to the tour again to form a complete cycle.</P>
                  <P class=docText><A class=docLink 
                  href="#ch16-71882">Figure 
                  16.6</A> illustrates a solution to the traveling-salesman 
                  problem using the nearest-neighbor heuristic. Normally when a 
                  graph is drawn for the traveling-salesman problem, the edges 
                  connecting every vertex to each other are not explicitly shown 
                  since the edges are understood. In the figure, each vertex is 
                  displayed along with the coordinates of the point it 
                  represents. The dashed lines at each stage show the edges 
                  whose distances are being compared. The darkest line is the 
                  edge added to the tour. The tour obtained using the 
                  nearest-neighbor heuristic has a length of 15.95. The optimal 
                  tour has a length of 14.71, which is about 8% shorter.</P>
                  <CENTER><A name=IXT-16-314790></A><A name=IXT-16-314791></A>
                  <H5 class=docFigureTitle><A name=ch16-71882></A>Figure 16.6. 
                  Solving the traveling-salesman problem using the 
                  nearest-neighbor heuristic</H5><IMG height=448 
                  alt=figs/alc.1606.gif src="image/alc.1606.gif" width=502 
                  border=0></CENTER>
                  <P class=docText>The nearest-neighbor heuristic has some 
                  interesting properties. Like the other algorithms in this 
                  chapter, it resembles breadth-first search because it explores 
                  all of the vertices adjacent to the last vertex in the tour 
                  before exploring deeper in the graph. The heuristic is also 
                  greedy because each time it adds a vertex to the tour, it does 
                  so based on which looks best at the moment. Unfortunately, the 
                  nearest neighbor added at one point may affect the tour in a 
                  negative way later. Nevertheless, the heuristic always returns 
                  a tour whose length is within a factor of 2 of the optimal 
                  tour length, and in many cases it does better than this. Other 
                  techniques exist to improve a tour once we have computed it. 
                  One technique is to apply an <SPAN class=docEmphasis>exchange 
                  heuristic</SPAN> (see the related topics at the end of the<A 
                  name=IXTR3-178></A> chapter). <A name=IXTR3-179></A></P>
                  <UL></UL></TD></TR></TBODY></TABLE>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=right>&nbsp; <A accessKey=2 
                  href="ch16-18-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=absMiddle border=0></A> &nbsp; <A accessKey=1 
                  href="ch16-21-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=absMiddle border=0></A></TD></TR></TBODY></TABLE>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top align=right><A class=v1 
                  href="#toppage">Top</A></TD></TR></TBODY></TABLE>
            </TD></TR></TBODY></TABLE></TD>
</BODY></HTML>
