<HTML><HEAD><TITLE>ch17-11-fm2xml</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252"><LINK 
href="image/style.css" type=text/css rel=STYLESHEET><LINK 
href="image/docsafari.css" type=text/css rel=STYLESHEET>

<META content="MSHTML 6.00.2800.1141" name=GENERATOR></HEAD>
<BODY leftMargin=0 topMargin=0 marginheight="0" marginwidth="0"><A 
name=toppage></A><SPAN class=v2></SPAN>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD align=middle>
      <TABLE width="95%">
        <TBODY>
        <TR>
          <TD class=v2 align=left>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=5 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top width=76 rowSpan=4><A 
                  ><IMG 
                  height=100 src="image/masteralgoc_xs.gif" width=76 
                  border=0></A></TD>
                <TD class=v2 vAlign=top><A class=t1 
                  >Mastering 
                  Algorithms with C</A><BR>By Kyle&nbsp;Loudon<BR>Slots : 
                1<BR></TD></TR>
              <TR>
                <TD class=v1><A class=v1 
                  href="table.html">Table 
                  of Contents</A></TD></TR>
              <TR>
                <TD></TD></TR>
              <TR>
                <TD class=t1 vAlign=bottom>Chapter 17.&nbsp; Geometric 
                  Algorithms</TD></TR></TBODY></TABLE>
            <HR SIZE=1>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=center>&nbsp; <A accessKey=2 
                  href="ch17-10-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=left border=0></A> &nbsp; <A  
href="table.html" align=center> Content </A>	<A accessKey=1                  href="ch17-13-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=right border=0></A></TD></TR></TBODY></TABLE>
            <BR>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top><A name=ch17-11-fm2xml></A>
                  <H3 class=docSection1Title>17.4 Description of Convex 
                  Hulls</H3>
                  <P class=docText><A name=ch17-idx-990077-1></A>The <A 
                  name=IXT-17-314849></A>convex hull<A 
                  name=ch17-idx-990079-1></A> <A name=ch17-idx-990079-2></A>of a 
                  set of points is the smallest <A name=IXT-17-314850></A><A 
                  name=IXT-17-314851></A><A name=IXT-17-314852></A>convex 
                  polygon that encloses all points in the set. A polygon is 
                  convex if any line segment connecting two points inside the 
                  polygon lies completely inside the polygon itself (see <A 
                  class=docLink 
                  href="#ch17-32530">Figure 
                  17.3</A>a); otherwise, the polygon is <A 
                  name=IXT-17-314853></A><A name=IXT-17-314854></A>concave (see 
                  <A class=docLink 
                  href="#ch17-32530">Figure 
                  17.3</A>b). To picture the convex hull for a set of points, 
                  imagine a series of pegs on a board. If we wrap a string 
                  tightly around the outermost pegs, the shape of the string is 
                  the convex hull.</P>
                  <CENTER><A name=IXT-17-314855></A>
                  <H5 class=docFigureTitle><A name=ch17-32530></A>Figure 17.3. 
                  (a) A convex polygon and (b) a concave polygon</H5><IMG 
                  height=189 alt=figs/alc.1703.gif src="image/alc.1703.gif" 
                  width=502 border=0></CENTER><A name=ch17-12-fm2xml></A>
                  <H4 class=docSection2Title>17.4.1 Jarvis's March</H4>
                  <P class=docText>One way to construct the convex hull for a 
                  set of points <SPAN class=docEmphasis>P</SPAN> is to use a 
                  method called <SPAN class=docEmphasis>Jarvis's march</SPAN>. 
                  <A name=IXT-17-314856></A><A name=IXT-17-314857></A><A 
                  name=IXT-17-314858></A><A name=IXT-17-314859></A>Jarvis's 
                  march constructs a convex hull in two sections, called the 
                  <SPAN class=docEmphasis>right chain</SPAN> and <SPAN 
                  class=docEmphasis>left chain</SPAN>. The right chain consists 
                  of all points in the convex hull from the lowest point (the 
                  one with the smallest <SPAN 
                  class=docEmphasis>y</SPAN>-coordinate) to the highest. If two 
                  points are equally low, the lowest point is considered to be 
                  the one that is also the furthest to the left (the one with 
                  the smallest <SPAN class=docEmphasis>x</SPAN>-coordinate). The 
                  left chain consists of all points from the highest point back 
                  to the lowest. If two points are equally high, the highest 
                  point is considered to be the one that is also the furthest to 
                  the right.</P>
                  <P class=docText>We begin by finding the lowest point in <SPAN 
                  class=docEmphasis>P</SPAN> (as described a moment ago), adding 
                  it to the convex hull, and initializing another variable, 
                  <SPAN class=docEmphasis>p</SPAN><SUB>0</SUB>, to it. Next, we 
                  look at each point <SPAN class=docEmphasis>pi</SPAN> in <SPAN 
                  class=docEmphasis>P</SPAN>, excluding <SPAN 
                  class=docEmphasis>p</SPAN><SUB>0</SUB>, and locate the point 
                  <SPAN class=docEmphasis>pc</SPAN> that is clockwise from all 
                  others with respect to <SPAN 
                  class=docEmphasis>p</SPAN><SUB>0</SUB>. Picture a clock face 
                  centered on <SPAN class=docEmphasis>p</SPAN><SUB>0</SUB>. In 
                  the right chain, we start at the 3 o'clock position and sweep 
                  counterclockwise until we encounter a point. In the left 
                  chain, we start at 9 o'clock and sweep counterclockwise. Once 
                  we find <SPAN class=docEmphasis>pc </SPAN>, we add it to the 
                  convex hull, we set <SPAN 
                  class=docEmphasis>p</SPAN><SUB>0</SUB> to <SPAN 
                  class=docEmphasis>pc</SPAN> , and repeat the process until 
                  <SPAN class=docEmphasis>p</SPAN><SUB>0</SUB> is the point at 
                  which we started.</P>
                  <P class=docText>Returning to the peg analogy, in the right 
                  chain, selecting each point <SPAN class=docEmphasis>pc</SPAN> 
                  is similar to tying a string to the current <SPAN 
                  class=docEmphasis>p</SPAN><SUB>0</SUB>, pulling it taut to the 
                  right, and then advancing the string counterclockwise until it 
                  touches another point. In the left chain, the process is 
                  similar to pulling the string taut to the left before 
                  advancing it counterclockwise. <A class=docLink 
                  href="#ch17-58973">Figure 
                  17.4</A> illustrates this process.</P>
                  <CENTER><A name=IXT-17-314860></A><A name=IXTR3-186></A>
                  <H5 class=docFigureTitle><A name=ch17-58973></A>Figure 17.4. 
                  Computing the convex hull for a set of 10 points</H5><IMG 
                  height=420 alt=figs/alc.1704.gif src="image/alc.1704.gif" 
                  width=502 border=0></CENTER>
                  <P class=docText>Computationally, to determine the point 
                  clockwise from all other points with respect to <SPAN 
                  class=docEmphasis>p</SPAN><SUB>0</SUB>, we traverse each point 
                  <SPAN class=docEmphasis>pi</SPAN> in <SPAN 
                  class=docEmphasis>P</SPAN>, except <SPAN 
                  class=docEmphasis>p</SPAN><SUB>0</SUB>, and keep track of the 
                  best choice for <SPAN class=docEmphasis>pc</SPAN> as we go. 
                  For each <SPAN class=docEmphasis>pi</SPAN> in <SPAN 
                  class=docEmphasis>P</SPAN>, we compare the orientation of 
                  <SPAN class=docEmphasis>pi</SPAN> relative to the <SPAN 
                  class=docEmphasis>pc</SPAN> we have found thus far using the 
                  expression for <SPAN class=docEmphasis>z</SPAN> that follows. 
                  If <SPAN class=docEmphasis>z</SPAN> is greater than 0, <SPAN 
                  class=docEmphasis>pi</SPAN> is clockwise from <SPAN 
                  class=docEmphasis>pc</SPAN> with respect to <SPAN 
                  class=docEmphasis>p</SPAN><SUB>0</SUB>, and we reset <SPAN 
                  class=docEmphasis>pc</SPAN> to the current <SPAN 
                  class=docEmphasis>pi</SPAN>. One nice thing about this 
                  approach is that we do not need to worry about whether we are 
                  computing the right or left chain, as the mathematics handles 
                  this for us.</P>
                  <P class=docText><SPAN class=docEmphasis>z = ( x<SUB>i</SUB> - 
                  x <SUB>0</SUB> ) ( y<SUB>c</SUB> - y<SUB>0</SUB> ) - ( 
                  y<SUB>i</SUB> - y<SUB>0</SUB> ) ( x<SUB>c</SUB> - 
                  x<SUB>0</SUB> )</SPAN></P>
                  <P class=docText>One special case occurs when <SPAN 
                  class=docEmphasis>z</SPAN> is 0. This means that <SPAN 
                  class=docEmphasis>pi</SPAN> and <SPAN 
                  class=docEmphasis>pc</SPAN> are collinear with respect to 
                  <SPAN class=docEmphasis>p</SPAN><SUB>0</SUB>. In this case, 
                  the most clockwise point is considered to be the one furthest 
                  from <SPAN class=docEmphasis>p</SPAN><SUB>0</SUB> (in <A 
                  class=docLink 
                  href="#ch17-58973">Figure 
                  17.4</A>, see the computation of <SPAN 
                  class=docEmphasis>z</SPAN> where <SPAN 
                  class=docEmphasis>p</SPAN><SUB>0</SUB> = (-2, -4), <SPAN 
                  class=docEmphasis>pi</SPAN> = (0, -2), and <SPAN 
                  class=docEmphasis>pc</SPAN> = (2, 0) in step 1, and where 
                  <SPAN class=docEmphasis>p</SPAN><SUB>0</SUB> = (-3, 4), <SPAN 
                  class=docEmphasis>pi</SPAN> = (-3, 2), and <SPAN 
                  class=docEmphasis>pc</SPAN> = (-3, -1) in step 3). To 
                  determine the distance <SPAN class=docEmphasis>r</SPAN> 
                  between <SPAN class=docEmphasis>p</SPAN><SUB>0</SUB> = (<SPAN 
                  class=docEmphasis>x</SPAN><SUB>0</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>0</SUB> ) and a point <SPAN 
                  class=docEmphasis>p</SPAN> <SPAN class=docEmphasis>j</SPAN> = 
                  (<SPAN class=docEmphasis>x</SPAN> <SPAN 
                  class=docEmphasis>j</SPAN> , <SPAN class=docEmphasis>y</SPAN> 
                  <SPAN class=docEmphasis>j</SPAN> ), where <SPAN 
                  class=docEmphasis>p</SPAN> <SPAN class=docEmphasis>j</SPAN> is 
                  either <SPAN class=docEmphasis>p</SPAN> <SPAN 
                  class=docEmphasis>i</SPAN> or <SPAN 
                  class=docEmphasis>pc</SPAN>, we use the following 
equation:</P>
                  <P class=docText><IMG height=32 alt=figs/equation.1706.gif 
                  src="image/equation.1706.gif" width=157 border=0></P>                  <UL></UL></TD></TR></TBODY></TABLE>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=right>&nbsp; <A accessKey=2 
                  href="ch17-10-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=absMiddle border=0></A> &nbsp; <A accessKey=1 
                  href="ch17-13-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=absMiddle border=0></A></TD></TR></TBODY></TABLE>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top align=right><A class=v1 
                  href="#toppage">Top</A></TD></TR></TBODY></TABLE>
            </TD></TR></TBODY></TABLE></TD>
</BODY></HTML>
