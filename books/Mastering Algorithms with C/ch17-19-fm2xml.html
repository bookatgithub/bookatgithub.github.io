<HTML><HEAD><TITLE>ch17-19-fm2xml</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252"><LINK 
href="image/style.css" type=text/css rel=STYLESHEET><LINK 
href="image/docsafari.css" type=text/css rel=STYLESHEET>

<META content="MSHTML 6.00.2800.1141" name=GENERATOR></HEAD>
<BODY leftMargin=0 topMargin=0 marginheight="0" marginwidth="0"><A 
name=toppage></A><SPAN class=v2></SPAN>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD align=middle>
      <TABLE width="95%">
        <TBODY>
        <TR>
          <TD class=v2 align=left>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=5 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top width=76 rowSpan=4><A 
                  ><IMG 
                  height=100 src="image/masteralgoc_xs.gif" width=76 
                  border=0></A></TD>
                <TD class=v2 vAlign=top><A class=t1 
                  >Mastering 
                  Algorithms with C</A><BR>By Kyle&nbsp;Loudon<BR>Slots : 
                1<BR></TD></TR>
              <TR>
                <TD class=v1><A class=v1 
                  href="table.html">Table 
                  of Contents</A></TD></TR>
              <TR>
                <TD></TD></TR>
              <TR>
                <TD class=t1 vAlign=bottom>Chapter 17.&nbsp; Geometric 
                  Algorithms</TD></TR></TBODY></TABLE>
            <HR SIZE=1>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=center>&nbsp; <A accessKey=2 
                  href="ch17-18-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=left border=0></A> &nbsp; <A  
href="table.html" align=center> Content </A>	<A accessKey=1                  href="ch17-23-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=right border=0></A></TD></TR></TBODY></TABLE>
            <BR>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top><A name=ch17-19-fm2xml></A>
                  <H3 class=docSection1Title>17.7 Description of Arc Length on 
                  Spherical Surfaces</H3>
                  <P class=docText><A name=ch17-idx-989410-1></A>Many <A 
                  name=ch17-idx-989379-1></A>problems require <A 
                  name=ch17-idx-989389-1></A>computing the <A 
                  name=ch17-idx-989430-1></A>distance between two points. When 
                  we are interested in the distance between points along a 
                  straight line, we apply the well-known distance formula 
                  derived from the Pythagorean theorem. However, if we are 
                  interested in the distance between points along a curved 
                  surface, the problem becomes more difficult. Fortunately, 
                  computing the minimum distance, or <SPAN class=docEmphasis>arc 
                  length</SPAN>, between two points on a spherical surface is a 
                  special case that is relatively simple. To begin, let's look 
                  at two different coordinate systems, <SPAN 
                  class=docEmphasis>rectilinear coordinates </SPAN>and <SPAN 
                  class=docEmphasis>spherical coordinates</SPAN>.</P><A 
                  name=ch17-20-fm2xml></A>
                  <H4 class=docSection2Title>17.7.1 Rectilinear and Spherical 
                  Coordinates</H4>
                  <P class=docText>The rectilinear coordinate system<A 
                  name=IXT-17-314865></A><A name=IXT-17-314866></A> is the 
                  coordinate system that is most familiar to us. In rectilinear 
                  coordinates, a point's location is specified using three 
                  values, <SPAN class=docEmphasis>x</SPAN>, <SPAN 
                  class=docEmphasis>y</SPAN>, <SPAN class=docEmphasis>z</SPAN>, 
                  which are its positions along the <SPAN 
                  class=docEmphasis>x</SPAN>-axis, <SPAN 
                  class=docEmphasis>y</SPAN>-axis, and <SPAN 
                  class=docEmphasis>z</SPAN>-axis. Referring to <A class=docLink 
                  href="#ch17-53974">Figure 
                  17.5</A>, the <SPAN class=docEmphasis>z</SPAN>-axis is 
                  positive going upward. Standing at the arrow looking forward, 
                  the <SPAN class=docEmphasis>x</SPAN>-axis is positive to the 
                  right, and the <SPAN class=docEmphasis>y</SPAN>-axis is 
                  positive straight ahead. From this vantage point, the positive 
                  directions for <SPAN class=docEmphasis>x</SPAN> and <SPAN 
                  class=docEmphasis>y</SPAN> look the same as in two dimensions. 
                  Thus, to locate (3, 4, 5), for example, we move three units to 
                  the right along the <SPAN class=docEmphasis>x</SPAN>-axis, 
                  four units ahead parallel to the <SPAN 
                  class=docEmphasis>y</SPAN>-axis, and five units up parallel to 
                  the <SPAN class=docEmphasis>z</SPAN>-axis (see <A 
                  class=docLink 
                  href="#ch17-53974">Figure 
                  17.5</A>).</P>
                  <CENTER><A name=IXT-17-314867></A>
                  <H5 class=docFigureTitle><A name=ch17-53974></A>Figure 17.5. 
                  Locating the point (3, 4, 5) in a rectilinear coordinate 
                  system</H5><IMG height=185 alt=figs/alc.1705.gif 
                  src="image/alc.1705.gif" width=502 border=0></CENTER>
                  <P class=docText><A name=IXT-17-314868></A><A 
                  name=IXT-17-314869></A>In spherical coordinates, a point's 
                  location is specified in terms of a distance <SPAN 
                  class=docEmphasis><FONT face=symbol>r</FONT></SPAN> (rho) and 
                  two angles, <SPAN class=docEmphasis></SPAN>(theta) and <SPAN 
                  class=docEmphasis><FONT face=symbol>f</FONT></SPAN> (phi): 
                  <SPAN class=docEmphasis><FONT face=symbol>r</FONT></SPAN> is 
                  the distance along an imaginary line from the origin to the 
                  point (a radius), <SPAN class=docEmphasis></SPAN>is the angle 
                  the point forms from the positive <SPAN 
                  class=docEmphasis>x</SPAN>-axis toward the positive <SPAN 
                  class=docEmphasis>y</SPAN>-axis, and <SPAN 
                  class=docEmphasis><FONT face=symbol>f</FONT></SPAN> is the 
                  angle the point forms from the positive <SPAN 
                  class=docEmphasis>z</SPAN>-axis heading toward the positive 
                  <SPAN class=docEmphasis>x</SPAN>-axis. To locate (5, 30, 45), 
                  for example, we move five units up the <SPAN 
                  class=docEmphasis>z</SPAN>-axis, sweep 45 degrees from the 
                  positive <SPAN class=docEmphasis>z</SPAN>-axis toward the 
                  positive <SPAN class=docEmphasis>x</SPAN>-axis, and spin 30 
                  degrees from the positive <SPAN 
                  class=docEmphasis>x</SPAN>-axis toward the positive <SPAN 
                  class=docEmphasis>y</SPAN>-axis (see <A class=docLink 
                  href="#ch17-31523">Figure 
                  17.6</A>). (Notice that it is easier to visualize <SPAN 
                  class=docEmphasis><FONT face=symbol>f</FONT></SPAN> before 
                  <SPAN class=docEmphasis></SPAN>even though <SPAN 
                  class=docEmphasis></SPAN>precedes <SPAN 
                  class=docEmphasis><FONT face=symbol>f</FONT></SPAN> in the 
                  triple.)</P>
                  <CENTER><A name=IXT-17-314870></A>
                  <H5 class=docFigureTitle><A name=ch17-31523></A>Figure 17.6. 
                  Locating the point (5, 30, 45) in a spherical coordinate 
                  system</H5><IMG height=202 alt=figs/alc.1706.gif 
                  src="image/alc.1706.gif" width=502 border=0></CENTER><A 
                  name=ch17-21-fm2xml></A>
                  <H4 class=docSection2Title>17.7.2 Converting Between 
                  Coordinate Systems</H4>
                  <P class=docText><A name=IXT-17-314871></A>When speaking about 
                  an arc on a spherical surface, it is often convenient to have 
                  its endpoints specified in spherical coordinates. Therefore, 
                  the algorithm presented here assumes this representation to 
                  begin with. However, to compute an arc's length, we will need 
                  its endpoints in rectilinear coordinates. Consequently, the 
                  first step is to convert the points <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB> = (<SPAN 
                  class=docEmphasis><FONT face=symbol>r</FONT></SPAN>, <SPAN 
                  class=docEmphasis></SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis><FONT 
                  face=symbol>f</FONT></SPAN><SUB>1</SUB>) and <SPAN 
                  class=docEmphasis>p</SPAN><SUB>2</SUB> = (<SPAN 
                  class=docEmphasis><FONT face=symbol>r</FONT></SPAN>, <SPAN 
                  class=docEmphasis></SPAN><SUB>2</SUB>, <SPAN 
                  class=docEmphasis><FONT 
                  face=symbol>f</FONT></SPAN><SUB>2</SUB>) to the rectilinear 
                  equivalents <SPAN class=docEmphasis>p</SPAN><SUB>1</SUB> = 
                  (<SPAN class=docEmphasis>x</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>z</SPAN><SUB>1</SUB>) and <SPAN 
                  class=docEmphasis>p</SPAN><SUB>2</SUB> = (<SPAN 
                  class=docEmphasis>x</SPAN><SUB>2</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>2</SUB>, <SPAN 
                  class=docEmphasis>z</SPAN><SUB>2</SUB>). To do this, we start 
                  with the following equations. Of course, the locations of the 
                  points do not change, only their representations.</P>
                  <P class=docText><IMG height=53 alt=figs/equation.1707.gif 
                  src="image/equation.1707.gif" width=83 border=0></P>
                  <P class=docText>Another relationship between <SPAN 
                  class=docEmphasis><FONT face=symbol>r</FONT></SPAN> and the 
                  rectilinear coordinates <SPAN class=docEmphasis>x</SPAN>, 
                  <SPAN class=docEmphasis>y</SPAN>, and <SPAN 
                  class=docEmphasis>z</SPAN> is:</P>
                  <P class=docText><IMG height=30 alt=figs/equation.1708.gif 
                  src="image/equation.1708.gif" width=112 border=0></P>
                  <P class=docText>This formula calculates the distance from a 
                  point to the origin in three dimensions.</P><A 
                  name=ch17-22-fm2xml></A>
                  <H4 class=docSection2Title>17.7.3 Computing the Length of an 
                  Arc</H4>
                  <P class=docText><A name=IXT-17-314872></A>Now we are ready to 
                  compute the length of the arc between <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB> and <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>2</SUB> on the sphere. First, 
                  we picture two imaginary lines extending from the center of 
                  the sphere to each of the points (see <A class=docLink 
                  href="#ch17-88062">Figure 
                  17.7</A>a) and calculate <SPAN class=docEmphasis><FONT 
                  face=symbol>a</FONT></SPAN>, the angle between them. To do 
                  this, we use the formula:</P>
                  <P class=docText><IMG height=44 alt=figs/equation.1709.gif 
                  src="image/equation.1709.gif" width=185 border=0></P>
                  <P class=docText>where cos<SUP> -1</SUP> is the inverse cosine 
                  of the argument in parentheses. Think of an inverse cosine 
                  this way: the cosine of what angle gives us the value of the 
                  argument in parentheses? The expression in the numerator of 
                  the argument comes from treating the imaginary line segments 
                  from the center of the sphere to <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB> and <SPAN 
                  class=docEmphasis>p</SPAN><SUB> 2</SUB> as vectors <SPAN 
                  class=docEmphBold>U</SPAN> and <SPAN 
                  class=docEmphBold>V</SPAN> (see the related topics at the end 
                  of the chapter) and computing the dot product <SPAN 
                  class=docEmphBold>U</SPAN> <IMG src="image/U22C5.gif" 
                  border=0> <SPAN class=docEmphBold>V</SPAN>.</P>
                  <CENTER>
                  <H5 class=docFigureTitle><A name=ch17-88062></A>Figure 17.7. 
                  The length of an arc as viewed (a) on a sphere and (b) in the 
                  plane containing the lines from the center of the sphere to 
                  each point</H5><IMG height=188 alt=figs/alc.1707.gif 
                  src="image/alc.1707.gif" width=502 border=0></CENTER>
                  <P class=docText>The lines that form <SPAN 
                  class=docEmphasis><FONT face=symbol>a</FONT></SPAN> lie in a 
                  plane that slices across the sphere. The importance of <SPAN 
                  class=docEmphasis><FONT face=symbol>a</FONT></SPAN> is that 
                  where the sphere and this plane intersect, a circle is 
                  projected onto the plane with the same radius as the sphere 
                  (see <A class=docLink 
                  href="#ch17-88062">Figure 
                  17.7</A>b). Since the arc between points <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB> and <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>2</SUB> lies along a section 
                  of this circle, <SPAN class=docEmphasis><FONT 
                  face=symbol>a</FONT></SPAN> helps to determine how much of the 
                  circle's perimeter the arc covers. This is determined from the 
                  percentage <SPAN class=docEmphasis><FONT 
                  face=symbol>a</FONT></SPAN> /2<SPAN class=docEmphasis></SPAN>, 
                  since there are 2<SPAN class=docEmphasis></SPAN> radians in a 
                  circle. Using this and the circumference of the circle, 2<SPAN 
                  class=docEmphasis><FONT face=symbol>r</FONT></SPAN>, we see 
                  that the length <SPAN class=docEmphasis>s</SPAN> of the arc 
                  between <SPAN class=docEmphasis>p</SPAN><SUB>1</SUB> and <SPAN 
                  class=docEmphasis>p</SPAN><SUB>2</SUB> is (<SPAN 
                  class=docEmphasis><FONT face=symbol>a</FONT></SPAN>/2<SPAN 
                  class=docEmphasis></SPAN>)(2<SPAN class=docEmphasis><FONT 
                  face=symbol>r</FONT></SPAN>), which simplifies to the equation 
                  that follows. This is the equation that is used in the 
                  implementation presented<A name=IXTR3-190></A> later:</P>
                  <P class=docText><IMG height=17 alt=figs/equation.1710.gif 
                  src="image/equation.1710.gif" width=44 border=0></P>                  <UL></UL></TD></TR></TBODY></TABLE>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=right>&nbsp; <A accessKey=2 
                  href="ch17-18-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=absMiddle border=0></A> &nbsp; <A accessKey=1 
                  href="ch17-23-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=absMiddle border=0></A></TD></TR></TBODY></TABLE>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top align=right><A class=v1 
                  href="#toppage">Top</A></TD></TR></TBODY></TABLE>
            </TD></TR></TBODY></TABLE></TD>
</BODY></HTML>
