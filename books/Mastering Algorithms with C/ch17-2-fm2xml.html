<HTML><HEAD><TITLE>ch17-2-fm2xml</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252"><LINK 
href="image/style.css" type=text/css rel=STYLESHEET><LINK 
href="image/docsafari.css" type=text/css rel=STYLESHEET>

<META content="MSHTML 6.00.2800.1141" name=GENERATOR></HEAD>
<BODY leftMargin=0 topMargin=0 marginheight="0" marginwidth="0"><A 
name=toppage></A><SPAN class=v2></SPAN>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD align=middle>
      <TABLE width="95%">
        <TBODY>
        <TR>
          <TD class=v2 align=left>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=5 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top width=76 rowSpan=4><A 
                  ><IMG 
                  height=100 src="image/masteralgoc_xs.gif" width=76 
                  border=0></A></TD>
                <TD class=v2 vAlign=top><A class=t1 
                  >Mastering 
                  Algorithms with C</A><BR>By Kyle&nbsp;Loudon<BR>Slots : 
                1<BR></TD></TR>
              <TR>
                <TD class=v1><A class=v1 
                  href="table.html">Table 
                  of Contents</A></TD></TR>
              <TR>
                <TD></TD></TR>
              <TR>
                <TD class=t1 vAlign=bottom>Chapter 17.&nbsp; Geometric 
                  Algorithms</TD></TR></TBODY></TABLE>
            <HR SIZE=1>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=center>&nbsp; <A accessKey=2 
                  href="ch17-1-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=left border=0></A> &nbsp; <A  
href="table.html" align=center> Content </A>	<A accessKey=1                  href="ch17-5-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=right border=0></A></TD></TR></TBODY></TABLE>
            <BR>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top><A name=ch17-2-fm2xml></A>
                  <H3 class=docSection1Title>17.1 Description of Testing Whether 
                  Line Segments Intersect</H3>
                  <P class=docText><A name=IXT-17-314829></A><A 
                  name=IXT-17-314830></A><A name=ch17-idx-402212-3></A>One <A 
                  name=ch17-idx-989897-1></A>fundamental problem in 
                  computational geometry is determining whether two <SPAN 
                  class=docEmphasis>line segments</SPAN> intersect. Line 
                  segments are lines that have a beginning and an end. The 
                  points that define either end are a line segment's <SPAN 
                  class=docEmphasis>endpoints</SPAN><A name=IXT-17-314831></A>. 
                  To determine whether two line segments intersect, we first 
                  need to understand a little about lines and line segments in 
                  general.</P>
                  <P class=docText><A name=IXT-17-314832></A>One representation 
                  of a line is <SPAN class=docEmphasis>point-intercept 
                  form</SPAN><A name=IXT-17-314833></A> <A 
                  name=IXT-17-314834></A>, or <SPAN class=docEmphasis>y</SPAN> = 
                  <SPAN class=docEmphasis>mx</SPAN> + <SPAN 
                  class=docEmphasis>b</SPAN>, where <SPAN 
                  class=docEmphasis>m</SPAN> is the line's slope and <SPAN 
                  class=docEmphasis>b</SPAN> is where the line crosses the <SPAN 
                  class=docEmphasis>y</SPAN>-axis. Using this, for any value of 
                  <SPAN class=docEmphasis>x</SPAN>, we can compute a 
                  corresponding value for <SPAN class=docEmphasis>y</SPAN> (see 
                  <A class=docLink 
                  href="#ch17-81789">Figure 
                  17.1</A>a). For a line segment with endpoints <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB> = (<SPAN 
                  class=docEmphasis>x</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>1</SUB>) and <SPAN 
                  class=docEmphasis>p</SPAN><SUB>2</SUB> = (<SPAN 
                  class=docEmphasis>x</SPAN><SUB>2</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>2</SUB>), the slope <SPAN 
                  class=docEmphasis>m</SPAN> and <SPAN 
                  class=docEmphasis>y</SPAN>-intercept <SPAN class=docEmphasis>b 
                  </SPAN>are calculated by applying the following formulas:</P>
                  <P class=docText><IMG height=37 alt=figs/equation.1701.gif 
                  src="image/equation.1701.gif" width=156 border=0> </P>
                  <P class=docText>Using <SPAN class=docEmphasis>m</SPAN> and 
                  <SPAN class=docEmphasis>b</SPAN>, the line segment is 
                  represented as a line in point-intercept form with endpoints 
                  <SPAN class=docEmphasis>p</SPAN><SUB>1</SUB> and <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>2</SUB> understood (see <A 
                  class=docLink 
                  href="#ch17-81789">Figure 
                  17.1</A>b).</P>
                  <CENTER>
                  <H5 class=docFigureTitle><A name=ch17-81789></A>Figure 17.1. 
                  (a) A line and (b) a line segment with endpoints p<SUB>1</SUB> 
                  and p<SUB>2</SUB></H5><IMG height=224 alt=figs/alc.1701.gif 
                  src="image/alc.1701.gif" width=502 border=0></CENTER><A 
                  name=ch17-3-fm2xml></A>
                  <H4 class=docSection2Title>17.1.1 Standard Test for 
                  Intersecting Line Segments</H4>
                  <P class=docText><A name=IXT-17-314835></A>One way to 
                  determine whether two line segments intersect is first to 
                  determine the intersection point <SPAN 
                  class=docEmphasis>pi</SPAN> = (<SPAN class=docEmphasis>xi 
                  </SPAN>, <SPAN class=docEmphasis>y</SPAN> <SPAN 
                  class=docEmphasis>i</SPAN> ) of the two lines on which each 
                  segment lies, then determine whether <SPAN 
                  class=docEmphasis>pi</SPAN> is on both segments. If <SPAN 
                  class=docEmphasis>pi</SPAN> is on both segments, the line 
                  segments intersect. We start with the point-intercept 
                  representations of the two lines on which the segments lie, 
                  which are:</P>
                  <P class=docText><IMG height=16 alt=figs/equation.1702.gif 
                  src="image/equation.1702.gif" width=335 border=0></P>
                  <P class=docText>The following formulas are used to compute 
                  <SPAN class=docEmphasis>pi</SPAN> = (<SPAN 
                  class=docEmphasis>xi </SPAN>, <SPAN class=docEmphasis>y</SPAN> 
                  <SPAN class=docEmphasis>i</SPAN> ). Notice that one special 
                  case we must avoid when computing <SPAN 
                  class=docEmphasis>xi</SPAN> is two lines with slopes that are 
                  equal. In this case, the denominator in the expression for 
                  <SPAN class=docEmphasis>xi</SPAN> becomes 0. This occurs when 
                  two lines are parallel, in which case the segments will not 
                  intersect unless they lie on top of one another to some 
                  extent.</P>
                  <P class=docText><IMG height=39 alt=figs/equation.1703.gif 
                  src="image/equation.1703.gif" width=281 border=0></P>
                  <P class=docText>Once we've computed <SPAN 
                  class=docEmphasis>pi</SPAN>, we perform the following tests to 
                  determine whether the point is actually on both line segments. 
                  In these tests, <SPAN class=docEmphasis>p</SPAN><SUB>1</SUB> = 
                  (<SPAN class=docEmphasis>x</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>1</SUB>) and <SPAN 
                  class=docEmphasis>p</SPAN><SUB>2</SUB> = (<SPAN 
                  class=docEmphasis>x</SPAN><SUB>2</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>2</SUB>) are the endpoints of 
                  one line segment, and <SPAN 
                  class=docEmphasis>p</SPAN><SUB>3</SUB> = (<SPAN 
                  class=docEmphasis>x</SPAN><SUB>3</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>3</SUB>) and <SPAN 
                  class=docEmphasis>p</SPAN><SUB>4</SUB> = (<SPAN 
                  class=docEmphasis>x</SPAN><SUB>4</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>4</SUB> ) are the endpoints of 
                  the other. If each of the tests is true, the line segments 
                  intersect.</P>
                  <P class=docText><IMG height=85 alt=figs/equation.1704.gif 
                  src="image/equation.1704.gif" width=122 border=0></P>
                  <P class=docText>This approach is common for determining 
                  whether line segments intersect. However, because the division 
                  required while calculating <SPAN class=docEmphasis>xi</SPAN> 
                  is prone to round-off error and precision problems, in 
                  computing we take a different approach.</P><A 
                  name=ch17-4-fm2xml></A>
                  <H4 class=docSection2Title>17.1.2 Computer Test for 
                  Intersecting Line Segments</H4>
                  <P class=docText>In computing, to determine whether two lines 
                  intersect, a two-step process is used: <A 
                  name=IXT-17-314836></A><A name=IXT-17-314837></A><A 
                  name=IXT-17-314838></A><A name=IXT-17-314839></A><A 
                  name=IXT-17-314840></A>first, we perform a <SPAN 
                  class=docEmphasis>quick rejection test</SPAN>. If this test 
                  succeeds, we then perform a <SPAN class=docEmphasis>straddle 
                  test</SPAN>. Two line segments intersect only when the quick 
                  rejection test and straddle test both<A name=IXTR3-183></A> 
                  succeed.</P>
                  <P class=docText><A name=IXT-17-314841></A>We begin the quick 
                  rejection test by constructing a <SPAN 
                  class=docEmphasis>bounding box</SPAN><A 
                  name=IXT-17-314842></A> around each line segment. The bounding 
                  box of a line segment is the smallest rectangle that surrounds 
                  the segment and has sides that are parallel to the <SPAN 
                  class=docEmphasis>x</SPAN>-axis and <SPAN 
                  class=docEmphasis>y</SPAN>-axis. For a line segment with 
                  endpoints <SPAN class=docEmphasis>p</SPAN><SUB>1</SUB> = 
                  (<SPAN class=docEmphasis>x</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>1</SUB>) and <SPAN 
                  class=docEmphasis>p</SPAN><SUB>2</SUB> = (<SPAN 
                  class=docEmphasis>x</SPAN><SUB>2</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>2</SUB>), the bounding box is 
                  the rectangle with lower left point (min(<SPAN 
                  class=docEmphasis>x</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>x</SPAN><SUB>2</SUB>), min(<SPAN 
                  class=docEmphasis>y</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>2</SUB>)) and upper right point 
                  (max(<SPAN class=docEmphasis>x</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>x</SPAN><SUB>2</SUB>), max(<SPAN 
                  class=docEmphasis>y</SPAN><SUB>1</SUB>, <SPAN 
                  class=docEmphasis>y</SPAN><SUB>2</SUB>)) (see <A class=docLink 
                  href="#ch17-10234">Figure 
                  17.2</A>). The bounding boxes of two line segments intersect 
                  if all of the following tests are true:</P>
                  <P class=docText><IMG height=83 alt=figs/equation.1705.gif 
                  src="image/equation.1705.gif" width=146 border=0></P>
                  <CENTER>
                  <H5 class=docFigureTitle><A name=ch17-10234></A>Figure 17.2. 
                  Testing whether line segments intersect using the quick 
                  rejection test (step 1) and straddle test (step 2)</H5><IMG 
                  height=432 alt=figs/alc.1702.gif src="image/alc.1702.gif" 
                  width=502 border=0></CENTER>
                  <P class=docText>If the bounding boxes of the line segments 
                  intersect, we proceed with the straddle test. To determine 
                  whether one segment with endpoints <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB> and <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>2</SUB> straddles another with 
                  endpoints <SPAN class=docEmphasis>p</SPAN> <SUB>3</SUB> and 
                  <SPAN class=docEmphasis>p</SPAN> <SUB>4</SUB>, we compare the 
                  <SPAN class=docEmphasis>orientation</SPAN><A 
                  name=IXT-17-314843></A> of <SPAN class=docEmphasis>p</SPAN> 
                  <SUB>3</SUB> relative to <SPAN class=docEmphasis>p</SPAN> 
                  <SUB>2</SUB> with that of <SPAN 
                  class=docEmphasis>p</SPAN><SUB>4</SUB> relative to <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>2</SUB> (see <A class=docLink 
                  href="#ch17-10234">Figure 
                  17.2</A>). Each point's orientation conveys whether the point 
                  is clockwise or counterclockwise from <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>2</SUB> with respect to <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB>. To determine the 
                  orientation of <SPAN class=docEmphasis>p</SPAN> <SUB>3</SUB> 
                  relative to <SPAN class=docEmphasis>p</SPAN> <SUB>2</SUB> with 
                  respect to <SPAN class=docEmphasis>p</SPAN><SUB>1</SUB>, we 
                  look at the sign of:</P>
                  <P class=docText><SPAN class=docEmphasis>z<SUB>1</SUB> = ( 
                  x<SUB>3</SUB> - x<SUB>1</SUB> ) ( y<SUB>2</SUB> - 
                  y<SUB>1</SUB> ) - ( y<SUB>3</SUB> - y<SUB>1</SUB> ) ( 
                  x<SUB>2</SUB> - x<SUB>1</SUB> )</SPAN></P>
                  <P class=docText>If <SPAN 
                  class=docEmphasis>z</SPAN><SUB>1</SUB> is positive, <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>3</SUB> is clockwise from 
                  <SPAN class=docEmphasis>p</SPAN> <SUB>2</SUB>. If <SPAN 
                  class=docEmphasis>z</SPAN><SUB>1</SUB> is negative, <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>3</SUB> is counterclockwise 
                  from <SPAN class=docEmphasis>p</SPAN> <SUB>2</SUB>. If it is 
                  0, the points are on the same imaginary line extending from 
                  <SPAN class=docEmphasis>p</SPAN><SUB>1</SUB>. In this case, 
                  the points are said to be <SPAN 
                  class=docEmphasis>collinear</SPAN><A name=IXT-17-314844></A>. 
                  To determine the orientation of <SPAN 
                  class=docEmphasis>p</SPAN><SUB>4</SUB> relative to <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>2</SUB> with respect to <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB>, we look at the sign 
                  of:</P>
                  <P class=docText><SPAN class=docEmphasis>z<SUB>2</SUB> = ( 
                  x<SUB>4</SUB> - x<SUB>1</SUB> ) ( y<SUB>2</SUB> - 
                  y<SUB>1</SUB> ) - ( y<SUB>4</SUB> - y<SUB>1</SUB> ) ( 
                  x<SUB>2</SUB> - x<SUB>1</SUB> )</SPAN></P>
                  <P class=docText>If the signs of <SPAN 
                  class=docEmphasis>z</SPAN><SUB>1</SUB> and <SPAN 
                  class=docEmphasis>z</SPAN><SUB>2</SUB> are different, or if 
                  either is 0, the line segments straddle each other. Since if 
                  we perform this test, we have already shown that the bounding 
                  boxes intersect, the line segments intersect as well.</P>
                  <P class=docText><A class=docLink 
                  href="#ch17-10234">Figure 
                  17.2</A> illustrates testing whether various pairs of line 
                  segments intersect using the quick rejection and straddle 
                  tests. The equations just given come from representing the 
                  line segments from <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB> to <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>3</SUB>, <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB> to <SPAN 
                  class=docEmphasis>p</SPAN> <SUB>2</SUB>, and <SPAN 
                  class=docEmphasis>p</SPAN><SUB>1</SUB> to <SPAN 
                  class=docEmphasis>p</SPAN><SUB>4</SUB> as <A 
                  name=IXT-17-314845></A>vectors <SPAN 
                  class=docEmphBold>U</SPAN>, <SPAN class=docEmphBold>V</SPAN>, 
                  and <SPAN class=docEmphBold>W</SPAN> (see the related topics 
                  at the end of the chapter) and using the signs of the <SPAN 
                  class=docEmphasis>z</SPAN>-components of the cross products 
                  <SPAN class=docEmphBold>U</SPAN> x <SPAN 
                  class=docEmphBold>V</SPAN> and <SPAN 
                  class=docEmphBold>W</SPAN> x <SPAN class=docEmphBold>V</SPAN> 
                  as gauges of<A name=IXTR3-184></A> orientation.</P>
                  <UL></UL></TD></TR></TBODY></TABLE>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=right>&nbsp; <A accessKey=2 
                  href="ch17-1-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=absMiddle border=0></A> &nbsp; <A accessKey=1 
                  href="ch17-5-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=absMiddle border=0></A></TD></TR></TBODY></TABLE>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top align=right><A class=v1 
                  href="#toppage">Top</A></TD></TR></TBODY></TABLE>
            </TD></TR></TBODY></TABLE></TD>
</BODY></HTML>
