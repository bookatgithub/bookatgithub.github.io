<HTML><HEAD><TITLE>ch17-29-fm2xml</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252"><LINK 
href="image/style.css" type=text/css rel=STYLESHEET><LINK 
href="image/docsafari.css" type=text/css rel=STYLESHEET>

<META content="MSHTML 6.00.2800.1141" name=GENERATOR></HEAD>
<BODY leftMargin=0 topMargin=0 marginheight="0" marginwidth="0"><A 
name=toppage></A><SPAN class=v2></SPAN>
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR vAlign=top>
    <TD align=middle>
      <TABLE width="95%">
        <TBODY>
        <TR>
          <TD class=v2 align=left>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=5 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top width=76 rowSpan=4><A 
                  ><IMG 
                  height=100 src="image/masteralgoc_xs.gif" width=76 
                  border=0></A></TD>
                <TD class=v2 vAlign=top><A class=t1 
                  >Mastering 
                  Algorithms with C</A><BR>By Kyle&nbsp;Loudon<BR>Slots : 
                1<BR></TD></TR>
              <TR>
                <TD class=v1><A class=v1 
                  href="table.html">Table 
                  of Contents</A></TD></TR>
              <TR>
                <TD></TD></TR>
              <TR>
                <TD class=t1 vAlign=bottom>Chapter 17.&nbsp; Geometric 
                  Algorithms</TD></TR></TBODY></TABLE>
            <HR SIZE=1>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=center>&nbsp; <A accessKey=2 
                  href="ch17-28-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=left border=0></A> &nbsp; <A  
href="table.html" align=center> Content </A>	<A accessKey=1                  href="ch17-30-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=right border=0></A></TD></TR></TBODY></TABLE>
            <BR>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top><A name=ch17-29-fm2xml></A>
                  <H3 class=docSection1Title>17.10 Arc Length Example: 
                  Approximating Distances on Earth</H3>
                  <P class=docText><A name=IXT-17-314879></A><A 
                  name=ch17-idx-403248-1></A>One <A 
                  name=ch17-idx-989335-1></A>application <A 
                  name=ch17-idx-989448-1></A>of computing arc lengths on 
                  spherical surfaces is approximating distances between points 
                  on Earth. Sometimes these are called <SPAN 
                  class=docEmphasis>great-circle distances</SPAN><A 
                  name=IXT-17-314880></A>. Of course, the earth is not a perfect 
                  sphere but an ellipsoid slightly squatter from north to south 
                  than east to west. That is, if we were to orbit the earth 
                  along the prime meridian, we would find the distance traveled 
                  to be less than that of orbiting the earth along the equator. 
                  Still, treating the earth as a sphere usually gives reasonable 
                  approximations.</P>
                  <P class=docText><A name=IXT-17-314881></A>To compute the 
                  distance between two points on Earth, we first need a way to 
                  locate each point. In geography, points are usually located in 
                  terms of <SPAN class=docEmphasis>latitude</SPAN><A 
                  name=IXT-17-314882></A> and <SPAN 
                  class=docEmphasis>longitude</SPAN><A name=IXT-17-314883></A>. 
                  Latitudes sweep from at the equator to 90 degrees at either 
                  pole. For points north of the equator, the letter "N" is 
                  appended to the latitude, and for points south, an "S" is 
                  appended. Often, degrees north of the equator are thought of 
                  as positive and degrees south of the equator as negative. 
                  Longitudes sweep from at the prime meridian to 180 degrees in 
                  either direction. For points to the west of the prime 
                  meridian, the letter "W" is appended to the longitude, and for 
                  points to the east, an "E" is appended. Often, degrees west of 
                  the prime meridian are thought of as positive and degrees east 
                  of the prime meridian as negative. For example, Paris is 
                  approximately 49.010 degrees to the north of the equator and 
                  2.548 degrees to the east of the prime meridian. Therefore, 
                  its position is 49.010N, 2.548E, or 49.010, -2.548 (see <A 
                  class=docLink 
                  href="#ch17-19498">Figure 
                  17.8</A>a).</P>
                  <P class=docText><A name=IXT-17-314884></A>To approximate the 
                  distance between two points on Earth given their latitude and 
                  longitude, we first translate each point into spherical 
                  coordinates and convert all angles from degrees to radians. 
                  Then, we simply compute the length of the arc between the 
                  points. Recall that a point in spherical coordinates is given 
                  by the triple (<SPAN class=docEmphasis>r</SPAN>, <SPAN 
                  class=docEmphasis></SPAN>, <SPAN class=docEmphasis><FONT 
                  face=symbol>f</FONT></SPAN>). In terms of the earth, <SPAN 
                  class=docEmphasis>r</SPAN> is the distance along an imaginary 
                  line from the earth's center to a point on its surface; that 
                  is, <SPAN class=docEmphasis>r</SPAN> is the earth's radius, 
                  which is 3440.065 nautical miles. The coordinate <SPAN 
                  class=docEmphasis></SPAN>is the angle the point forms with the 
                  prime meridian. Thus, <SPAN 
                  class=docEmphasis></SPAN>corresponds to longitude. However, 
                  since positive longitudes are to the west and positive values 
                  of <SPAN class=docEmphasis></SPAN>are the opposite direction, 
                  to obtain <SPAN class=docEmphasis></SPAN>from degrees 
                  longitude, we reverse the sign of the longitude. The 
                  coordinate <SPAN class=docEmphasis><FONT 
                  face=symbol>f</FONT></SPAN> is the angle a point forms with an 
                  imaginary line extending vertically from the center of the 
                  earth to the north pole. Thus, <SPAN class=docEmphasis><FONT 
                  face=symbol>f</FONT></SPAN> corresponds to latitude. However, 
                  since latitudes are relative to the equator and not the north 
                  pole, to obtain <SPAN class=docEmphasis><FONT 
                  face=symbol>f</FONT></SPAN> from degrees latitude, we reverse 
                  the sign of the latitude and add 90 degrees.</P>
                  <P class=docText>As an example, to compute the distance 
                  between Paris, France (49.010N, 2.548E) and Perth, Australia 
                  (31.940S, 115.967E), we begin by converting their latitudes 
                  and longitudes to spherical equivalents: (3440.065, 2.548, 
                  40.990) for Paris and (3440.065, 115.967, 121.940) for Perth. 
                  Next, we convert the angles in each point to radians. Last, we 
                  compute the length of the arc between the points, which is 
                  7706 nautical miles (see <A class=docLink 
                  href="#ch17-19498">Figure 
                  17.8</A>b).</P>
                  <CENTER>
                  <H5 class=docFigureTitle><A name=ch17-19498></A>Figure 17.8. 
                  Computing the distance between (a) Paris and (b) 
                  Perth</H5><IMG height=189 alt=figs/alc.1708.gif 
                  src="image/alc.1708.gif" width=502 border=0></CENTER>
                  <P class=docText>This example presents a function, <SPAN 
                  class=docEmphasis>geodist</SPAN> (see Examples <A 
                  class=docLink 
                  href="#ch17-74458">Example 
                  17.5</A> and <A class=docLink 
                  href="#ch17-59712">Example 
                  17.6</A>), that approximates the distance between two points 
                  on Earth using the method just described. The function accepts 
                  the latitude and longitude for each point as 
                  <TT><I>lat1</I></TT> and <TT><I>lon1</I></TT>, and 
                  <TT><I>lat2</I></TT> and <TT><I>lon2</I></TT>. It returns the 
                  distance between the points in <TT><I>d</I></TT>. After 
                  performing some initial validation of the latitudes and 
                  longitudes, <SPAN class=docEmphasis>geodist</SPAN> converts 
                  the latitude and longitude representations into spherical 
                  coordinates, stores each representation in <TT><I>p1</I></TT> 
                  and <TT><I>p2</I></TT> with all angles converted to radians, 
                  and calls <SPAN class=docEmphasis>arclen</SPAN> to compute the 
                  distance.</P>
                  <P class=docText>The runtime complexity of <SPAN 
                  class=docEmphasis>geodist</SPAN> is <SPAN 
                  class=docEmphasis>O</SPAN> (1) because all of the steps in 
                  computing a great-circle distance run in a constant amount of 
                  time.</P>
                  <H5 class=docExampleTitle><A name=ch17-74458></A>Example 17.5. 
                  Header for a Function for Approximating Distances on Earth 
                  </H5><PRE>/*****************************************************************************
*                                                                            *
*  ------------------------------- geodist.h ------------------------------  *
*                                                                            *
*****************************************************************************/

#ifndef GEODIST_H
#define GEODIST_H

/*****************************************************************************
*                                                                            *
*  Define the radius of the earth in nautical miles.                         *
*                                                                            *
*****************************************************************************/

#define            EARTH_RADIUS          3440.065

/*****************************************************************************
*                                                                            *
*  --------------------------- Public Interface ---------------------------  *
*                                                                            *
*****************************************************************************/

int geodist(double lat1, double lon1, double lat2, double lon2, double *d);

#endif</PRE>
                  <H5 class=docExampleTitle><A name=ch17-59712></A>Example 17.6. 
                  Implementation of a Function for Approximating Distances on 
                  Earth </H5><PRE>/*****************************************************************************
*                                                                            *
*  ------------------------------- geodist.c ------------------------------  *
*                                                                            *
*****************************************************************************/

#include "geodist.h"
#include "geometry.h"

/*****************************************************************************
*                                                                            *
*  -------------------------------- geodist <A name=IXT-17-314885></A><A name=IXT-17-314886></A> -------------------------------  *
*                                                                            *
*****************************************************************************/

int geodist(double lat1, double lon1, double lat2, double lon2, double *d) {

SPoint             p1,
                   p2;

/*****************************************************************************
*                                                                            *
*  Validate the coordinates.                                                 *
*                                                                            *
*****************************************************************************/

if (lat1 &lt;  -90.0 || lat1 &gt;  90.0 || lat2 &lt;  -90.0 || lat2 &gt;  90.0)
   return -1;

if (lon1 &lt; -180.0 || lon1 &gt; 180.0 || lon2 &lt; -180.0 || lon2 &gt; 180.0)
   return -1;

/*****************************************************************************
*                                                                            *
*  Convert each latitude and longitude to spherical coordinates in radians   *
*  using the earth's radius for rho.                                         *
*                                                                            *
*****************************************************************************/

p1.rho = EARTH_RADIUS;
p1.theta = -1.0 * DEGTORAD(lon1);
p1.phi = (DEGTORAD(-1.0 * lat1)) + DEGTORAD(90.0);

p2.rho = EARTH_RADIUS;
p2.theta = -1.0 * DEGTORAD(lon2);
p2.phi = (DEGTORAD(-1.0 * lat2)) + DEGTORAD(90.0);

/*****************************************************************************
*                                                                            *
*  Compute the distance between the points.                                  *
*                                                                            *
*****************************************************************************/

arclen<A name=IXTR3-191></A>(p1, p2, <A name=IXTR3-192></A>d);

<A name=IXTR3-193></A>return 0;<A name=IXTR3-194></A>

}<A name=IXTR3-195></A><A name=IXTR3-196></A></PRE>                  <UL></UL></TD></TR></TBODY></TABLE>
            <HR SIZE=1>

            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR>
              <TR>
                <TD class=v2 vAlign=top align=right>&nbsp; <A accessKey=2 
                  href="ch17-28-fm2xml.html"><IMG 
                  height=16 src="image/btn_prev.gif" width=56 
                  align=absMiddle border=0></A> &nbsp; <A accessKey=1 
                  href="ch17-30-fm2xml.html"><IMG 
                  height=16 src="image/btn_next.gif" width=41 
                  align=absMiddle border=0></A></TD></TR></TBODY></TABLE>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD vAlign=top align=right><A class=v1 
                  href="#toppage">Top</A></TD></TR></TBODY></TABLE>
            </TD></TR></TBODY></TABLE></TD>
</BODY></HTML>
