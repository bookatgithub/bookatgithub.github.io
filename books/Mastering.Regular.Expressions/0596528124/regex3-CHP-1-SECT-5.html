<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 1.5.&nbsp; Expanding the Foundation</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=regex3-CHP-1-SECT-4.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=regex3-CHP-1-SECT-6.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a name="regex3-CHP-1-SECT-5"></a>
<H3 id="title-IDAEE0GK" class="docSection1Title">1.5. Expanding the Foundation</H3>
<p class="docText">I hope the examples and explanations so far have helped to establish the basis for a solid understanding of regular expressions, but please realize that what I've provided so far lacks depth. There's so much more out there.</P>
<a name="regex3-CHP-1-SECT-5.1"></a>
<H4 id="title-IDAME0GK" class="docSection2Title">1.5.1. Linguistic Diversification</h4>
<p class="docText">I mentioned a number of regular expression features that most versions of <span class="docEmphasis">egrep</span> support. There are other features, some of which are not supported by all versions, which I'll leave for later chapters.</P>
<p class="docText">Unfortunately, the regular expression language is no different from any other in that it has various dialects and accents. It seems each new program employing regular expressions devises its own "improvements." The state of the art continually moves forward, but changes over the years have resulted in a wide variety of regular expression "flavors." We'll see many examples in the following chapters.</p>

<a name="regex3-CHP-1-SECT-5.2"></a>
<h4 id="title-IDA0E0GK" class="docSection2Title">1.5.2. The Goal of a Regular Expression</H4>
<p class="docText">From the broadest top-down view, a regular expression either matches within a lump of text (with <span class="docEmphasis">egrep</span>, each line) or it doesn't. When crafting a regular expression, you must consider the ongoing tug-of-war between having your expression match the lines you want, yet still not matching lines you don't want.</P>
<p class="docText">Also, while <span class="docEmphasis">egrep</span> doesn't care where in the line the match occurs, this concern is important for many other regular-expression uses. If your text is something such as</p>
<pre>
    ...zip is 44272. If you write, send $4.95 to cover postage and...
</pre><br>

<p class="docText">and you merely want to find lines matching <img src=images/U2308.jpg border=0><tt>[0-9]+</tt><img src=images/U230B.jpg border=0>, you don't care which numbers are matched. However, if your intent is to <span class="docEmphasis">do something</span> with the number (such as save to a file, add, replace, and suchwe will see examples of this kind of processing in the next chapter), you'll care very much exactly <span class="docEmphasis">which</span> numbers are matched.</P>

<a name="regex3-CHP-1-SECT-5.3"></a>
<H4 id="title-IDAWF0GK" class="docSection2Title">1.5.3. A Few More Examples</H4>
<p class="docText">As with any language, experience is <span class="docEmphasis">a very good thing</span>, so I'm including a few more examples of regular expressions to match some common constructs.</p>
<p class="docText">Half the battle when writing regular expressions is getting successful matches when and where you want them. The other half is to <span class="docEmphasis">not</span> match when and where you don't want. In practice, both are important, but for the moment, I would like to concentrate on the "getting successful matches" aspect. Even though I don't take these examples to their fullest depths, they still provide useful insight.</P>
<a name="regex3-CHP-1-SECT-5.3.1"></a>
<H5 id="title-IDAGG0GK" class="docSection3Title">1.5.3.1. Variable names</h5>
<a name="IDX-CHP-1-0140"></a> 
<a name="IDX-CHP-1-0141"></a> 
<a name="IDX-CHP-1-0142"></a> 
<a name="IDX-CHP-1-0143"></a> 

<p class="docText">Many programming languages have identifiers<a name="IDX-CHP-1-0144"></a> 
 (variable names<a name="IDX-CHP-1-0145"></a> 
 and such) that are allowed to contain only alphanumeric characters and underscores, but which may not begin with a digit. They are matched by <img src=images/U2308.jpg border=0><tt>[a-zA-Z_][a-zA-Z_0-9]*</tt><img src=images/U230B.jpg border=0>. The first character class matches what the first character can be, the second (with its accompanying star) allows the rest of the identifier. If there is a limit on the length of an identifier, say 32 characters, you might replace the star with <img src=images/U2308.jpg border=0><tt>{0,31}</tt><img src=images/U230B.jpg border=0> if the <img src=images/U2308.jpg border=0><tt><span class="docEmphasis">{min,max}</span></tt><img src=images/U230B.jpg border=0> notation is supported. (This construct, the interval quantifier, was briefly mentioned on page 20.)</p>

<a name="regex3-CHP-1-SECT-5.3.2"></a>
<h5 id="title-IDASH0GK" class="docSection3Title">1.5.3.2. A string within double quotes</h5>
<p class="docText">A simple solution to matching a string within double quotes might be: <img src=images/U2308.jpg border=0><tt>"[^"]*"</tt><img src=images/U230B.jpg border=0></P>
<p class="docText">The double quotes at either end are to match the opening and closing double quotes of the string. Between them, we can have anything... except another double quote! So, we use <img src=images/U2308.jpg border=0><tt>[^"]</tt><img src=images/U230B.jpg border=0> to match all characters except a double quote, and apply using a star to indicate we can have any number of such non double-quote characters.</p>
<p class="docText">A more useful (but more complex) definition of a double-quoted string allows double quotes within the string if they are escaped with a backslash, such as in "<tt>nail&#8226;the&#8226;2\"x4\"&#8226;plank"</tt>. We'll see this example several times in future chapters while covering the many details of how a match is actually carried out.</p>

<a name="regex3-CHP-1-SECT-5.3.3"></a>
<H5 id="title-IDALI0GK" class="docSection3Title">1.5.3.3. Dollar amount (with optional cents)</h5>
<p class="docText">One approach to matching a dollar amount is: <img src=images/U2308.jpg border=0><tt>\$[0-9]+(\.[0-9][0-9])?</tt><img src=images/U230B.jpg border=0></p>
<p class="docText">From a top-level perspective, this is a simple regular expression with three parts: <img src=images/U2308.jpg border=0><tt>\$</tt><img src=images/U230B.jpg border=0> and <img src=images/U2308.jpg border=0><tt>&#8943;+</tt><img src=images/U230B.jpg border=0> and <img src=images/U2308.jpg border=0><tt>(&#8943;)?</tt><img src=images/U230B.jpg border=0>, which might be loosely paraphrased as "a literal dollar sign, a bunch of one thing, and finally perhaps another thing." In this case, the "one thing" is a digit (with a bunch of them being a number), and "another thing" is the combination of a decimal point followed by two digits.</p>
<p class="docText">This example is a bit na&iuml;ve for several reasons. For example, it considers dollar amounts like <tt>$1000</tt>, but not <tt>$1,000</tt>. It does allow for optional cents, but frankly, that's not really very useful when applied with <span class="docEmphasis">egrep</span>.<a name="IDX-CHP-1-0146"></a> 
<a name="IDX-CHP-1-0147"></a> 
 <span class="docEmphasis">egrep</span> never cares exactly <span class="docEmphasis">how much</span> is matched, but merely <span class="docEmphasis">whether</span> there is a match. Allowing something optional at the end never changes whether there's an overall match to begin with.</p>
<p class="docText">But, if you need to find lines that contain <span class="docEmphasis">just</span> a price, and nothing else, you can wrap the expression with <img src=images/U2308.jpg border=0><tt>^&#8943;$</tt><img src=images/U230B.jpg border=0>. In this case, the optional cents part becomes important since it might or might not come between the dollar amount and the end of the line, and allowing or disallowing it makes the difference in achieving an overall match.</p>
<p class="docText">One type of value our expression doesn't match is '<tt>$.49</tt>'. To solve this, you might be tempted to change the plus to a star, but that doesn't work. As to why, I'll leave it as a teaser until we look at a similar example in <a class="docLink" href="regex3-CHP-5.html#regex3-CHP-5">Chapter 5</a> (&#9758;194).</p>

<a name="regex3-CHP-1-SECT-5.3.4"></a>
<h5 id="title-IDAMK0GK" class="docSection3Title">1.5.3.4. An HTTP/HTML URL</h5>
<a name="IDX-CHP-1-0148"></a> 
<a name="IDX-CHP-1-0149"></a> 

<p class="docText">The format of web URLs can be complex, so constructing a regular expression to match any possible URL can be equally complex. However, relaxing your standards slightly can allow you to match most common URLs with a fairly simple expression. One common reason I might do this, for example, would be to search my email archive for a URL that I vaguely remember having received, but which I think I might recognize when I see it.</p>
<p class="docText">The general form of a common HTTP/HTML URL is along the lines of</p>
<pre>
    <span class="docEmphasis">http:</span>//<span class="docEmphasis">hostname</span>/<span class="docEmphasis">path.html</span>
</pre><br>

<p class="docText">although ending with <tt>.htm</tt> is common as well.</p>
<p class="docText">The rules about what can and can't be a <span class="docEmphasis">hostname</span> (computer name, such as <a class="docLink" target="_blank" href="http://www.yahoo.com">www.yahoo.com</a>) are complex, but for our needs we can realize that if it follows '<tt>http://</tt>', it's probably a hostname, so we can make do with something simple, such as <img src=images/U2308.jpg border=0><tt>[-a-z0-9_.]+</tt><img src=images/U230B.jpg border=0>. The <span class="docEmphasis">path</span> part can be even more varied, so we'll use <img src=images/U2308.jpg border=0><tt>[-a-z0-9_:@&amp;?=+,.!/~*%$]*</tt><img src=images/U230B.jpg border=0> for that. Notice that these classes have the dash first, to ensure that it's taken as a literal character and included in the list, as opposed to part of a range (&#9758;9).</p>
<p class="docText">Putting these all together, we might use as our first attempt something like:</p>
<pre>
    % egrep<a name="IDX-CHP-1-0150"></a> 
<a name="IDX-CHP-1-0151"></a> 
<a name="IDX-CHP-1-0152"></a> 

-i '\&lt;<span class="docEmphStrong">http://</span>[-a-z0-9_.:]+/[-a-z0-9_:@&amp;?=+,.!/~*%$]*\<span class="docEmphStrong">.html?</span>\&gt;' <span class="docEmphasis">files</span>
</pre><br>

<p class="docText">Again, since we've taken liberties and relaxed what we'll match, we could well match something such as '<tt>http:// .... /foo.html</tt>', which is certainly not a valid URL. Do we care about this? It all depends on what you're trying to do. For my scan of my email archive, it doesn't really matter if I get a few false matches. Heck, I could probably get away with even something as simple as:</p>
<pre>
    % egrep -i '\&lt;http://[^ ]*\.html?\&gt;' <span class="docEmphasis">files</span>...
</pre><br>

<p class="docText">As we'll learn when getting deeper into how to craft an expression, knowing the data you'll be searching is an important aspect of finding the balance between complexity and completeness. We'll visit this example again, in more detail, in the next chapter.</P>

<a name="regex3-CHP-1-SECT-5.3.5"></a>
<h5 id="title-IDAJN0GK" class="docSection3Title">1.5.3.5. An HTML tag</H5>
<a name="IDX-CHP-1-0153"></a> 

<a name="IDX-CHP-1-0154"></a> 

<a name="IDX-CHP-1-0155"></a> 

<p class="docText">With a tool like <span class="docEmphasis">egrep</span>, it doesn't seem particularly common or useful to simply match lines with HTML tags. But, exploring a regular expression that matches HTML tags exactly can be quite fruitful, especially when we delve into more advanced tools in the next chapter.</p>
<p class="docText">Looking at simple cases like '<tt>&lt;TITLE&gt;</tt>' and '<tt>&lt;HR&gt;</tt>', we might think to try <img src=images/U2308.jpg border=0><tt>&lt;.*&gt;</tt><img src=images/U230B.jpg border=0>. This simplistic approach is a frequent first thought, but it's certainly incorrect. Converting <img src=images/U2308.jpg border=0><tt>&lt;.*&gt;</tt><img src=images/U230B.jpg border=0> into English reads "match a '<tt>&lt;</tt>', followed by as much of anything as can be matched, followed by '<tt>&gt;</tt>'." Well, when phrased that way, it shouldn't be surprising that it can match more than just one tag, such as the marked portion of '<tt>this</tt> <img border="0" alt="" id="195131084199" width="97" height="13" SRC="images/regex3_u0111.jpg"> <tt>example</tt>'.</p>
<p class="docText">This might have been a bit surprising, but we're still in the first chapter, and our understanding at this point is only superficial. I have this example here to highlight that regular expressions are not a difficult subject, but they can be tricky if you don't truly understand them. Over the next few chapters, we'll look at all the details required to understand and solve this problem.</P>

<a name="regex3-CHP-1-SECT-5.3.6"></a>
<H5 id="title-IDA4O0GK" class="docSection3Title">1.5.3.6. Time of day, such as "9:17 am" or "12:30 pm"</H5>
<p class="docText">Matching a time can be taken to varying levels of strictness. Something such as</P>
<pre>
    <img src=images/U2308.jpg border=0>[0-9]?[0-9]:[0-9][0-9]&#8226;(am|pm)<img src=images/U230B.jpg border=0>
</pre><br>

<p class="docText">picks up both <tt>9:17</tt>&#8226;<tt>am</tt> and <tt>12:30</tt>&#8226; <tt>pm</tt>, but also allows something nonsensical like <tt>99:99</tt>&#8226;<tt>pm</tt>.</P>
<p class="docText">Looking at the hour, we realize that if it is a two-digit number, the first digit must be a one. But, <img src=images/U2308.jpg border=0><tt>1?[0-9]</tt><img src=images/U230B.jpg border=0> still allows an hour of <tt>19</tt> (and also an hour of 0), so maybe it is better to break the hour part into two possibilities: <img src=images/U2308.jpg border=0><tt>1[012]</tt><img src=images/U230B.jpg border=0> for two-digit hours and <img src=images/U2308.jpg border=0><tt>[1-9]</tt><img src=images/U230B.jpg border=0> for single-digit hours. The result is <img src=images/U2308.jpg border=0><tt>(1[012]|[1-9])</tt><img src=images/U230B.jpg border=0>.</p>
<p class="docText">The minute part is easier. The first digit should be <img src=images/U2308.jpg border=0><tt>[0-5]</tt><img src=images/U230B.jpg border=0>. For the second, we can stick with the current <img src=images/U2308.jpg border=0><tt>[0-9]</tt><img src=images/U230B.jpg border=0>. This gives <img src=images/U2308.jpg border=0><tt>(1[012];[1-9]):[0-5][0-9]&#8226;(am|pm)</tt><img src=images/U230B.jpg border=0> when we put it all together.</p>
<p class="docText">Using the same logic, can you extend this to handle 24-hour time with hours from <tt>0</tt> tHRough <tt>23?</tt> As a challenge, allow for a leading zero, at least through to <tt>09:59</tt>. <a class="docLink" href="#regex3-CHP-1-SIDEBAR-4">&#10070;</a> Try building your solution, and then turn the page to check mine.</P>


<a name="regex3-CHP-1-SECT-5.4"></a>
<h4 id="title-IDAAR0GK" class="docSection2Title">1.5.4. Regular Expression Nomenclature</h4>
<a name="IDX-CHP-1-0156"></a> 
<a name="IDX-CHP-1-0157"></a> 
<a name="IDX-CHP-1-0158"></a> 
<a name="IDX-CHP-1-0159"></a> 
<a name="IDX-CHP-1-0160"></a> 
<a name="IDX-CHP-1-0161"></a> 
<a name="IDX-CHP-1-0162"></a> 
<a name="IDX-CHP-1-0163"></a> 
<a name="IDX-CHP-1-0164"></a> 

<a name="regex3-CHP-1-SECT-5.4.1"></a>
<H5 id="title-IDARS0GK" class="docSection3Title">1.5.4.1. Regex</H5>
<p class="docText">As you might guess, using the full phrase "regular expression" can get a bit tiring, particularly in writing. Instead, I normally use "regex." It just rolls right off the tongue (it rhymes with "FedEx," with a hard <span class="docEmphasis">g</span> sound like "regular" and not a soft one like in "Regina") and it is amenable to a variety of uses like "when you regex...," "budding regexers," and even "regexification."<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-1-FN-10">[<img src=images/U2020.jpg border=0>]</a></sup> I use the phrase "regex engine" to refer to the part of a program that actually does the work of carrying out a match attempt.</P><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-1-FN-10">[<img src=images/U2020.jpg border=0>]</a></sup> You might also come across the decidedly unsightly "regexp." I'm not sure how one would pronounce that, but those with a lisp might find it a bit easier.</p></blockquote>

<a name="regex3-CHP-1-SECT-5.4.2"></a>
<H5 id="title-IDACT0GK" class="docSection3Title">1.5.4.2. Matching</H5>
<p class="docText">When I say a regex "matches" a string, I really mean that it matches <span class="docEmphasis">in</span> a string. Technically, the regex <img src=images/U2308.jpg border=0><tt>a</tt><img src=images/U230B.jpg border=0> doesn't <span class="docEmphasis">match</span><tt>cat</tt>, but matches the <tt>a</tt> <span class="docEmphasis">in</span> <img border="0" alt="" id="195131084199" width="23" height="12" SRC="images/regex3_u0112.jpg">. It's not something that people tend to confuse, but it's still worthy of mention.</p>

<a name="regex3-CHP-1-SECT-5.4.3"></a>
<h5 id="title-IDA2T0GK" class="docSection3Title">1.5.4.3. Metacharacter</h5>
<p class="docText">Whether a character is a metacharacter (or "metasequence"I use the words interchangeably) depends on exactly where in the regex it's used. For example, <img src=images/U2308.jpg border=0><tt>*</tt><img src=images/U230B.jpg border=0> is a metacharacter, but only when it's not within a character class and when not escaped. "Escaped" means that it has a backslash in front of itusually. The star is escaped in <img src=images/U2308.jpg border=0><tt>\*</tt><img src=images/U230B.jpg border=0>, but not in <img src=images/U2308.jpg border=0><tt>\\*</tt><img src=images/U230B.jpg border=0> (where the first backslash escapes the second), although the star "has a backslash in front of it" in both examples.</p>
<p class="docText">Depending upon the regex flavor, there are various situations when certain characters are and aren't metacharacters. <a class="docLink" href="regex3-CHP-3.html#regex3-CHP-3">Chapter 3</a> discusses this in more detail.</P>

<a name="regex3-CHP-1-SECT-5.4.4"></a>
<h5 id="title-IDAVU0GK" class="docSection3Title">1.5.4.4. Flavor</h5>
<a name="IDX-CHP-1-0165"></a> 

<p class="docText">As I've hinted, different tools use regular expressions for many different things, and the set of metacharacters and other features that each support can differ. Let's look at word boundaries again as an example. Some versions of <span class="docEmphasis">egrep</span> support the \&lt;&#8943;\&gt; notation we've seen. However, some do not support the separate word-start and word-end, but one catch-all <img src=images/U2308.jpg border=0><tt>\b</tt><img src=images/U230B.jpg border=0> metacharacter (which we haven't seen yetwe'll see it in the next chapter). Still others support both, and many others support neither.</P>
<p class="docText">I use the term "flavor" to describe the sum total of all these little implementation decisions. In the language analogy, it's the same as a dialect of an individual speaker. Superficially, this concept refers to which metacharacters are and aren't supported, but there's much more to it. Even if two programs both support<img src=images/U2308.jpg border=0><tt>\&lt;&#8943;\&gt;</tt><img src=images/U230B.jpg border=0>, they might disagree on exactly what they do and don't consider to be a word. This concern is important when you <span class="docEmphasis">use</span> the tool.</p>
<a name="regex3-CHP-1-SIDEBAR-4"></a><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<h2 class="docSidebarTitle">Extending the Time Regex to Handle a 24-Hour Clock</h2>
<p class="docText">&#10070; <span class="docEmphasis">Answer to the question on page 26</span>.</p>
<p class="docText">There are various solutions, but we can use similar logic as before. This time, I'll break the task into three groups: one for the morning (hours <tt>00</tt> through <tt>09</tt>, with the leading zero being optional), one for the daytime (hours <tt>10</tt> through <tt>19</tt>), and one for the evening (hours <tt>20</tt> through <tt>23</tt>). This can be rendered in a pretty straightforward way: <img src=images/U2308.jpg border=0><tt>0?[0-9]|1[0-9]|2[0-3]</tt><img src=images/U230B.jpg border=0>.</p>
<p class="docText">Actually, we can combine the first two alternatives, resulting in the shorter <img src=images/U2308.jpg border=0><tt>[01]?[0-9]&lt;2[0-3]</tt><img src=images/U230B.jpg border=0>. You might need to think about it a bit to convince yourself that they'll really match exactly the same text, but they do. The figure below might help, and it shows another approach as well. The shaded groups represent numbers that can be matched by a single alternative.</p><img border="0" alt="" id="195131084199" width="549" height="132" SRC="images/regex3_u0113.jpg">
</td></tr></table></p><br>
<p class="docText">Don't confuse "flavor" with "tool." Just as two people can speak the same dialect, two completely different programs can support exactly the same regex flavor. Also, two programs with the same name (and built to do the same task) often have slightly (and sometimes not-so-slightly) different flavors. Among the various programs called <span class="docEmphasis">egrep</span>, there is a wide variety of regex flavors supported.</p>
<p class="docText">In the late 1990s, the particularly expressive flavor offered by the Perl programming language was widely recognized for its power, and soon other languages were offering Perl-inspired regular expressions (many even acknowledging the inspirational source by labeling themselves "Perl-compatible"). The adopters include PHP, Python, many Java regex packages, Microsoft's .NET Framework, Tcl, and a variety of C libraries, to name a few. Yet, all are different in important respects. On top of this, Perl's regular expressions themselves are evolving and growing (sometimes, now, in response to advances seen with other tools). As always, the overall landscape continues to become more varied and confusing.</P>

<a name="regex3-CHP-1-SECT-5.4.5"></a>
<h5 id="title-IDA2W0GK" class="docSection3Title">1.5.4.5. Subexpression</H5>
<a name="IDX-CHP-1-0166"></a> 
<a name="IDX-CHP-1-0167"></a> 
<a name="IDX-CHP-1-0168"></a> 
<a name="IDX-CHP-1-0169"></a> 
<a name="IDX-CHP-1-0170"></a> 
<a name="IDX-CHP-1-0171"></a> 
<a name="IDX-CHP-1-0172"></a> 
<a name="IDX-CHP-1-0173"></a> 
<a name="IDX-CHP-1-0174"></a> 
<a name="IDX-CHP-1-0175"></a> 
<a name="IDX-CHP-1-0176"></a> 
<a name="IDX-CHP-1-0177"></a> 
<a name="IDX-CHP-1-0178"></a> 
<a name="IDX-CHP-1-0179"></a> 
<a name="IDX-CHP-1-0180"></a> 
<a name="IDX-CHP-1-0181"></a> 
<a name="IDX-CHP-1-0182"></a> 

<p class="docText">The term "subexpression" simply refers to part of a larger expression, although it often refers to some part of an expression within parentheses, or to an alternative of <img src=images/U2308.jpg border=0><tt>|</tt><img src=images/U230B.jpg border=0>. For example, with <img src=images/U2308.jpg border=0><tt>^(Subject|Date):&#8226;</tt><img src=images/U230B.jpg border=0>, the <img src=images/U2308.jpg border=0><tt>Subject|Date</tt><img src=images/U230B.jpg border=0> is usually referred to as a subexpression. Within that, the alternatives <img src=images/U2308.jpg border=0><tt>Subject</tt><img src=images/U230B.jpg border=0> and <img src=images/U2308.jpg border=0><tt>Date</tt><img src=images/U230B.jpg border=0> are each referred to as subexpressions as well. But technically, <img src=images/U2308.jpg border=0><tt>S</tt><img src=images/U230B.jpg border=0> is a subexpression, as is <img src=images/U2308.jpg border=0><tt>u</tt><img src=images/U230B.jpg border=0>, and <img src=images/U2308.jpg border=0><tt>b</tt><img src=images/U230B.jpg border=0>, and <img src=images/U2308.jpg border=0><tt>j</tt><img src=images/U230B.jpg border=0>,...</p>
<p class="docText">Something such as <tt>1-6</tt> isn't considered a subexpression of <img src=images/U2308.jpg border=0><tt>H[1-6]&#8226;*</tt><img src=images/U230B.jpg border=0>, since the '<tt>1-6</tt>' is part of an unbreakable "unit," the character class. But, <img src=images/U2308.jpg border=0><tt>H</tt><img src=images/U230B.jpg border=0>, <img src=images/U2308.jpg border=0><tt>[1-6]</tt><img src=images/U230B.jpg border=0>, and <img src=images/U2308.jpg border=0><tt>&#8226;*</tt><img src=images/U230B.jpg border=0> are all subexpressions of <img src=images/U2308.jpg border=0><tt>H[1-6]&#8226;*</tt><img src=images/U230B.jpg border=0>.</p>
<p class="docText">Unlike alternation, quantifiers (star, plus, and question mark) always work with the smallest immediately-preceding subexpression. This is why with <img src=images/U2308.jpg border=0><tt>mis+pell</tt><img src=images/U230B.jpg border=0>, the <tt>+</tt> governs the <img src=images/U2308.jpg border=0><tt>s</tt><img src=images/U230B.jpg border=0>, not the <img src=images/U2308.jpg border=0><tt>mis</tt><img src=images/U230B.jpg border=0> or <img src=images/U2308.jpg border=0><tt>is</tt><img src=images/U230B.jpg border=0>. Of course, when what immediately precedes a quantifier is a parenthesized subexpression, the entire subexpression (no matter how complex) is taken as one unit.</P>

<a name="regex3-CHP-1-SECT-5.4.6"></a>
<H5 id="title-IDAE10GK" class="docSection3Title">1.5.4.6. Character</H5>
<p class="docText">The word "character" can be a loaded term in computing. The character that a byte represents is merely a matter of interpretation. A byte with such-and-such a value has that same value in any context in which you might wish to consider it, but which <span class="docEmphasis">character</span> that value <span class="docEmphasis">represents</span> depends on the encoding in which it's viewed. As a concrete example, two bytes with decimal values <tt>64</tt> and <tt>53</tt> represent the characters "<tt>@</tt>" and "<tt>5</tt>" respectively, if considered in the ASCII<a name="IDX-CHP-1-0183"></a> 
 encoding,<a name="IDX-CHP-1-0184"></a> 
 yet on the other hand are completely different if considered in the EBCDIC<a name="IDX-CHP-1-0185"></a> 
 encoding (they are a space and some kind of a control character).</P>
<p class="docText">On the third hand, if those two bytes are considered in one of the popular encodings for Japanese characters, together they represent the single character <img border="0" alt="" id="195131084199" width="14" height="13" SRC="images/regex3_u0114.jpg">. Yet, to represent this same character in another of the Japanese encodings requires two completely different bytes. Those two different bytes, by the way, yield the two characters "&Agrave;&#956;" in the popular Latin-1<a name="IDX-CHP-1-0186"></a> 
 encoding, but yield the one Korean character <img border="0" alt="" id="195131084199" width="14" height="14" SRC="images/regex3_u0115.jpg"> in one of the Unicode encodings.<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-1-FN-11">[<img src=images/U2020.jpg border=0>]</a></sup> The point is this: how bytes are to be interpreted is a matter of perspective (called an <span class="docEmphasis">encoding</span>), and to be successful, you've got to make sure that your perspective agrees with the perspective taken by the tool you're using.</p><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-1-FN-11">[<img src=images/U2020.jpg border=0>]</a></sup> The definitive book on multiple-byte encodings is Ken Lunde's <span class="docEmphasis">CJKV Information Processing</span>,<a name="IDX-CHP-1-0187"></a> 
<a name="IDX-CHP-1-0188"></a> 
 also published by O'Reilly. The CJKV stands for <span class="docEmphasis">Chinese</span>, <span class="docEmphasis">Japanese</span>, <span class="docEmphasis">Korean</span>, and <span class="docEmphasis">Vietnamese</span>, which are languages that tend to require multiple-byte encodings. Ken and Adobe kindly provided many of the special fonts used in this book.</P></blockquote>
<p class="docText">Until recently, text-processing tools generally treated their data as a bunch of ASCII bytes, without regard to the encoding you might be intending. Recently, however, more and more systems are using some form of Unicode to process data internally (<a class="docLink" href="regex3-CHP-3.html#regex3-CHP-3">Chapter 3</a> includes an introduction to Unicode &#9758;105). On such systems, if the regular-expression subsystem has been implemented properly, the user doesn't normally have to pay much attention to these issues. That's a big "if," which is why <a class="docLink" href="regex3-CHP-3.html#regex3-CHP-3">Chapter 3</a> looks at this issue in depth.</p>


<a name="regex3-CHP-1-SECT-5.5"></a>
<h4 id="title-IDAE40GK" class="docSection2Title">1.5.5. Improving on the Status Quo</H4>
<p class="docText">When it comes down to it, regular expressions are not difficult. But, if you talk to the average user of a program or language that supports them, you will likely find someone that understands them "a bit," but does not feel secure enough to really use them for anything complex or with any tool but those they use most often.</P>
<p class="docText">Traditionally, regular expression documentation tends to be limited to a short and incomplete description of one or two metacharacters, followed by a table of the rest. Examples often use meaningless regular expressions like <img src=images/U2308.jpg border=0><tt>a*((ab)*|b*)</tt><img src=images/U230B.jpg border=0>, and text like '<tt>a&#8226;xxx&#8226;ce&#8226;xxxxxx&#8226;ci&#8226;xxx&#8226;d</tt>'. They also tend to completely ignore subtle but important points, and often claim that their flavor is the same as some other well-known tool, almost always forgetting to mention the exceptions where they inevitably differ. The state of regex documentation needs help.</p>
<p class="docText">Now, I don't mean to imply that this chapter fills the gap for all regular expressions, or even for <span class="docEmphasis">egrep</span> regular expressions. Rather, this chapter merely provides the foundation upon which the rest of this book is built. It may be ambitious, but I hope this book does fill the gaps for you. I received many gratifying responses to the first edition, and have worked very hard to make this one even better, both in breadth and in depth.</p>
<p class="docText">Perhaps because regular-expression documentation has traditionally been so lacking, I feel the need to make the extra effort to make things particularly clear. Because I want to make sure you can use regular expressions to their fullest potential, I want to make sure you really, <span class="docEmphasis">really</span> understand them.</P>
<p class="docText">This is both good and bad.</P>
<p class="docText">It is good because you will learn how to <span class="docEmphasis">think</span> regular expressions. You will learn which differences and peculiarities to watch out for when faced with a new tool with a different flavor. You will know how to express yourself even with a weak, stripped-down regular expression flavor. You will understand what makes one expression more efficient than another, and will be able to balance tradeoffs among complexity, efficiency, and match results. When faced with a particularly complex task, you will know how to work through an expression the way the program would, constructing it as you go. In short, you will be comfortable using regular expressions to their fullest.</P>
<p class="docText">The problem is that the learning curve of this method can be rather steep, with three separate issues to tackle:</p>
<UL><LI><p class="docList"><span class="docEmphStrong">How regular expressions are used</span> Most programs use regular expressions in ways that are more complex than <span class="docEmphasis">egrep</span>. Before we can discuss in detail how to write a really useful expression, we need to look at the ways regular expressions can be used. We start in the next chapter.</p></li><li><p class="docList"><span class="docEmphStrong">Regular expression features</span> Selecting the proper tool to use when faced with a problem seems to be half the battle, so I don't want to limit myself to only using one utility throughout this book. Different programs, and often even different versions of the same program, provide different features and metacharacters. We must survey the field before getting into the details of using them. This is the subject of <a class="docLink" href="regex3-CHP-3.html#regex3-CHP-3">Chapter 3</a>.</p></LI><li><p class="docList"><span class="docEmphStrong">How regular expressions really work</span> Before we can learn from useful (but often complex) examples, we need to "look under the hood" to understand just how a regular expression search is conducted. As we'll see, the order in which certain metacharacters are checked can be very important. In fact, regular expression engines can be implemented in different ways, so different programs sometimes do different things with the same expression. We examine this meaty subject in Chapters <a class="docLink" href="regex3-CHP-4.html#regex3-CHP-4">4</a>, <a class="docLink" href="regex3-CHP-5.html#regex3-CHP-5">5</a>, and <a class="docLink" href="regex3-CHP-6.html#regex3-CHP-6">6</a>.</p></LI></ul>
<p class="docText">This last point is the most important and the most difficult to address. The discussion is unfortunately sometimes a bit dry, with the reader chomping at the bit to get to the fun parttackling real problems. However, understanding how the regex engine really works is the key to <span class="docEmphasis">really understanding</span>.</p>
<p class="docText">You might argue that you don't want to be taught how a car works when you simply want to know how to drive. But, learning to drive a car is a poor analogy for learning about regular expressions. My goal is to teach you how to solve problems with regular expressions, and that means constructing regular expressions. The better analogy is not how to drive a car, but how to build one. Before you can build a car, you have to know how it works.</p>
<p class="docText"><a class="docLink" href="regex3-CHP-2.html#regex3-CHP-2">Chapter 2</a> gives more experience with driving. <a class="docLink" href="regex3-CHP-3.html#regex3-CHP-3">Chapter 3</a> takes a short look at the history of driving, and a detailed look at the bodywork of a regex flavor. <a class="docLink" href="regex3-CHP-4.html#regex3-CHP-4">Chapter 4</a> looks at the all-important engine of a regex flavor. <a class="docLink" href="regex3-CHP-5.html#regex3-CHP-5">Chapter 5</a> shows some extended examples, <a class="docLink" href="regex3-CHP-6.html#regex3-CHP-6">Chapter 6</a> shows you how to tune up certain kinds of engines, and the chapters after that examine some specific makes and models. Particularly in Chapters <a class="docLink" href="regex3-CHP-4.html#regex3-CHP-4">4</a>, <a class="docLink" href="regex3-CHP-5.html#regex3-CHP-5">5</a>, and <a class="docLink" href="regex3-CHP-6.html#regex3-CHP-6">6</a>, we'll spend a lot of time under the hood, so make sure to have your coveralls and shop rags handy.</p>

<a name="regex3-CHP-1-SECT-5.6"></a>
<h4 id="title-IDA2C1GK" class="docSection2Title">1.5.6. Summary</h4>
<a name="IDX-CHP-1-0189"></a> 

<p class="docText"><a class="docLink" href="#regex3-CHP-1-TABLE-3">Table 1-3</a> summarizes the <span class="docEmphasis">egrep</span> metacharacters we've looked at in this chapter.</p>
<a name="regex3-CHP-1-TABLE-3"></a><p><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><h5 class="docTableTitle">Table 1-3. Egrep Metacharacter Summary</h5></caption><colgroup span="3"><col><col><col></colgroup><thead><tr><th class="thead" scope="col" align="center" valign="bottom" colspan="3"><p class="docText">Items to Match a Single Character</p></th></tr><tr><th class="thead" scope="col" align="center" colspan="2"><p class="docText">Metacharacter</p></th><th class="thead" scope="col" align="left"><p class="docText">Matches</p></th></tr></thead><TR><td class="docTableCell" align="left"><p class="docText"><tt>.</tt></P></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">dot</span></P></TD><TD class="docTableCell" align="left"><p class="docText">Matches any one character</P></td></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>[&#8943;]</tt></P></TD><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">character class</span></p></TD><TD class="docTableCell" align="left"><p class="docText">Matches any one character listed</P></td></TR><TR><td class="docTableCell" align="left"><p class="docText"><tt>[^&#8943;]</tt></p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">negated character class</span></P></td><td class="docTableCell" align="left"><p class="docText">Matches any one character not listed</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt><span class="docEmphasis">\char</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">escaped character</span></p></td><td class="docTableCell" align="left"><p class="docText">When <span class="docEmphasis">char</span> is a metacharacter, or the escaped combination is not otherwise special, matches the literal <span class="docEmphasis">char</span></p></td></tr><tr><td class="docTableCell" align="center" colspan="3"><p class="docText"><span class="docEmphStrong">Items Appended to Provide "Counting": The Quantifiers</span></p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>?</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">question</span></P></TD><TD class="docTableCell" align="left"><p class="docText">One allowed, but it is optional</p></TD></tr><tr><TD class="docTableCell" align="left"><p class="docText"><tt>*</tt></P></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">star</span></P></TD><TD class="docTableCell" align="left"><p class="docText">Any number allowed, but all are optional</p></TD></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>+</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">plus</span></p></td><TD class="docTableCell" align="left"><p class="docText">At least one required; additional are optional</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">{<span class="docEmphasis">min,max</span>}</p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">specified range</span><a class="docLink" href="#regex3-CHP-1-TFN1"><img src=images/U2020.jpg border=0></a></p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">Min</span> required, <span class="docEmphasis">max</span> allowed</p></td></tr><tr><td class="docTableCell" align="center" colspan="3"><p class="docText"><span class="docEmphStrong">Items That Match a Position</span></p></TD></tr><TR><td class="docTableCell" align="left"><p class="docText"><tt>^</tt></p></TD><TD class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">caret</span></P></TD><td class="docTableCell" align="left"><p class="docText">Matches the position at the start of the line</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><tt>$</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">dollar</span></P></TD><td class="docTableCell" align="left"><p class="docText">Matches the position at the end of the line</P></TD></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\&lt;</tt></p></TD><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">word boundary</span><a class="docLink" href="#regex3-CHP-1-TFN1"><img src=images/U2020.jpg border=0></a></p></TD><td class="docTableCell" align="left"><p class="docText">Matches the position at the start of a word</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\&gt;</tt></p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">word boundary</span><a class="docLink" href="#regex3-CHP-1-TFN1"><img src=images/U2020.jpg border=0></a></p></td><td class="docTableCell" align="left"><p class="docText">Matches the position at the end of a word</p></td></tr><tr><td class="docTableCell" align="center" colspan="3"><p class="docText"><span class="docEmphStrong">Other</span></P></td></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>|</tt></P></TD><TD class="docTableCell" align="left"><p class="docText">alternation</P></td><TD class="docTableCell" align="left"><p class="docText">Matches either expression it separates</p></td></TR><TR><td class="docTableCell" align="left"><p class="docText"><tt>(&#8943;)</tt></p></TD><TD class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">parentheses</span></P></td><TD class="docTableCell" align="left"><p class="docText">Limits scope of alternation, provides grouping for the quantifiers, and "captures" for backreferences</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\1, \2, ...</tt></P></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">backreference</span><a class="docLink" href="#regex3-CHP-1-TFN1"><img src=images/U2020.jpg border=0></a></P></td><td class="docTableCell" align="left"><p class="docText">Matches text previously matched within first, second, etc., set of parentheses.</p></td></tr><tr><td class="docTableFooter" align="right" colspan="3"><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-1-TFN1">[<img src=images/U2020.jpg border=0>]</a></sup></td></tr></table></p><br><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-1-TFN1">[<img src=images/U2020.jpg border=0>]</a></sup> <span class="docEmphasis">not supported by all versions of egrep</span></p></blockquote>
<p class="docText">In addition, be sure that you understand the following points:</p>
<ul><li><p class="docList">Not all <span class="docEmphasis">egrep</span> programs are the same. The metacharacters supported, as well as their exact meanings, are often different  see your local documentation (&#9758;23).</p></li><LI><p class="docList">Three reasons for using parentheses are constraining alternation (&#9758;13), grouping (&#9758;14), and capturing (&#9758;21).</p></LI><li><p class="docList">Character classes are special, and have their own set of metacharacters totally distinct from the "main" regex language (&#9758;10).</p></LI><LI><p class="docList">Alternation and character classes are fundamentally different, providing unrelated services that appear, in only one limited situation, to overlap (&#9758;13).</P></LI><li><p class="docList">A negated character class is still a "positive assertion"even negated, a character class must match a character to be successful. Because the listing of characters to match is negated, the matched character must be one of those <span class="docEmphasis">not</span> listed in the class (&#9758;12).</P></li><li><p class="docList">The useful <tt>-i</tt> option discounts capitalization during a match (&#9758;15).</P></LI><li><p class="docList">There are three types of escaped items:</p><UL><LI><p class="docList"><span class="docEmphasis">1</span>. The pairing of <img src=images/U2308.jpg border=0><tt>\</tt><img src=images/U230B.jpg border=0> and a metacharacter is a metasequence to match the literal character (for example, <img src=images/U2308.jpg border=0><tt>\*</tt><img src=images/U230B.jpg border=0> matches a literal asterisk).</P></li><LI><p class="docList"><span class="docEmphasis">2</span>. The pairing of <img src=images/U2308.jpg border=0><tt>\</tt><img src=images/U230B.jpg border=0> and selected non-metacharacters becomes a metasequence with an implementation-defined meaning (for example, <img src=images/U2308.jpg border=0><tt>\&lt;</tt><img src=images/U230B.jpg border=0> often means "start of word").</P></li><li><p class="docList"><span class="docEmphasis">3</span>. The pairing of <img src=images/U2308.jpg border=0><tt>\</tt><img src=images/U230B.jpg border=0> and any other character defaults to simply matching the character (that is, the backslash is ignored).</p><p class="docList">Remember, though, that a backslash within a character class is not special at all with most versions of <span class="docEmphasis">egrep</span>, so it provides no "escape services" in such a situation.</p></LI></ul></li><LI><p class="docList">Items governed by a question mark or star don't need to actually match any characters to "match successfully." They are <span class="docEmphasis">always</span> successful, even if they don't match anything (&#9758;17).</p></li></ul>


</TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=regex3-CHP-1-SECT-4.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=regex3-CHP-1-SECT-6.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>