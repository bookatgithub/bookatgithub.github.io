<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 3.5.&nbsp; Common Metacharacters and Features</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=regex3-CHP-3-SECT-4.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=regex3-CHP-3-SECT-6.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a name="regex3-CHP-3-SECT-5"></a>
<H3 id="title-IDAHHRCF" class="docSection1Title">3.5. Common Metacharacters and Features</H3>
<p class="docText">The remainder of this chapterthe next 30 pages or sooffers an overview of common regex metacharacters and concepts, as outlined on the next page. Not every issue is discussed, and no one tool includes everything presented here.</P>
<p class="docText">In one respect, this section is just a summary of much of what you've seen in the first two chapters, but in light of the wider, more complex world presented at the beginning of this chapter. During your first pass through, a light glance should allow you to continue on to the next chapters. You can come back here to pick up details as you need them.</P>
<p class="docText">Some tools add a lot of new and rich functionality and some gratuitously change common notations to suit their whim or special needs. Although I'll sometimes comment about specific utilities, I won't address too many tool-specific concerns here. Rather, in this section I'll just try to cover some common metacharacters and their uses, and some concerns to be aware of. I encourage you to follow along with the manual of your favorite utility.</p>
<dl class="docList">
<dt><BR><p><i><span class="docPubcolor">Character Representations</span></I></P></dt>
<dd><p class="docList">&#9758;115 Character Shorthands: <tt><span class="docEmphStrong">\n, \t, \a, \b, \e, \f, \r, \v</span>, ...</tt></p>
<p class="docList">&#9758;116 Octal Escapes: <tt><span class="docEmphStrong">\</span><span class="docEmphasis">num</span></tt></p>
<p class="docList">&#9758;117 Hex/Unicode Escapes: <tt><span class="docEmphStrong">\x</span><span class="docEmphasis">num</span></tt>, <tt><span class="docEmphStrong">\x</span>{<span class="docEmphasis">num</span>}</tt>, <tt><span class="docEmphStrong">\u</span><span class="docEmphasis">num</span></tt>, <tt><span class="docEmphStrong">\U</span><span class="docEmphasis">num</span>, ...</tt></P>
<p class="docList">&#9758;117 Control Characters: <tt><span class="docEmphStrong">\c</span><span class="docEmphasis">char</span></tt></P></dd>

<dt><BR><p><I><span class="docPubcolor">Character Classes and Class-Like Constructs</span></I></p></dt>
<dd><p class="docList">&#9758;118 Normal classes: <tt><span class="docEmphStrong">[a-z]</span></tt> and <tt><span class="docEmphStrong">[^a-z]</span></tt></p>
<p class="docList">&#9758;119 Almost any character: dot</p>
<p class="docList">&#9758;120 Exactly one byte: <tt>\C</tt></p>
<p class="docList">&#9758;120 Unicode Combining Character Sequence: <tt><span class="docEmphStrong">\X</span></tt></P>
<p class="docList">&#9758;120 Class shorthands: <tt><span class="docEmphStrong">\w, \d, \s, \W, \D, \S</span></tt></p>
<p class="docList">&#9758;121 Unicode properties, blocks, and categories: <tt><span class="docEmphStrong">\p</span></tt>{<span class="docEmphasis">Prop</span>}, <tt>\P</tt>{<span class="docEmphasis">Prop</span>}</p>
<p class="docList">&#9758;125 Class set operations: <tt>[[a-z]<span class="docEmphStrong">&amp;&amp;</span>[^aeiou]]</tt></P>
<p class="docList">&#9758;127 POSIX bracket-expression "character class": <tt>[<span class="docEmphStrong">[:alpha:]</span>]</tt></p>
<p class="docList">&#9758;128 POSIX bracket-expression "collating sequences": <tt>[<span class="docEmphStrong">[.span-ll.]</span>]</tt></p>
<p class="docList">&#9758;128 POSIX bracket-expression "character equivalents": <tt>[<span class="docEmphStrong">[=n=]</span>]</tt></p>
<p class="docList">&#9758;128 Emacs syntax classes</p></dd>

<dt><br><p><i><span class="docPubcolor">Anchors and Other "Zero-Width Assertions"</span></i></p></dt>
<dd><p class="docList">&#9758;129 Start of line/string: ^, <tt><span class="docEmphStrong">\A</span></tt></p>
<p class="docList">&#9758;129 End of line/string: <tt><span class="docEmphStrong">$, \Z, \z</span></tt></p>
<p class="docList">&#9758;130 Start of match (or end of previous match): <tt><span class="docEmphStrong">\G</span></tt></p>
<p class="docList">&#9758;133 Word boundaries: <tt><span class="docEmphStrong">\b, \B, \&lt;, \&gt;</span>, ...</tt></p>
<p class="docList">&#9758;133 Lookahead (<tt><span class="docEmphStrong">?=</span></tt>&#8943;), (<tt><span class="docEmphStrong">?!</span></tt>&#8943;); Lookbehind, (<tt><span class="docEmphStrong">?&lt;=</span></tt>&#8943;), (<tt><span class="docEmphStrong">?&lt;!</span></tt>&#8943;)</p></dd>

<dt><br><p><i><span class="docPubcolor">Comments and Mode Modifiers</span></I></p></dt>
<dd><p class="docList">&#9758;135 Mode modifier: <tt><span class="docEmphStrong">(?</span><span class="docEmphasis">modifier</span><span class="docEmphStrong">)</span></tt>, such as <tt><span class="docEmphStrong">(?i)</span></tt> or <tt><span class="docEmphStrong">(?-i)</span></tt></P>
<p class="docList">&#9758;135 Mode-modified span: <tt><span class="docEmphStrong">(?</span><span class="docEmphasis">modifier</span>:&#8943;<span class="docEmphStrong">)</span></tt>, such as <tt><span class="docEmphStrong">(?i</span>:&#8943;<span class="docEmphStrong">)</span></tt></p>
<p class="docList">&#9758;136 Comments: <tt><span class="docEmphStrong">(?#</span>&#8943;<span class="docEmphStrong">)</span></tt> and <tt><span class="docEmphStrong">#</span>&#8943;</tt></p>
<p class="docList">&#9758;136 Literal-text span: <tt><span class="docEmphStrong">\Q</span>&#8943;<span class="docEmphStrong">\E</span></tt></P></dd>

<dt><BR><P><I><span class="docPubcolor">Grouping, Capturing, Conditionals, and Control</span></i></P></dt>
<dd><p class="docList">&#9758;Capturing/grouping parentheses: <tt>(&#8943;<span class="docEmphStrong">)</span>, <span class="docEmphStrong">\1</span>, <span class="docEmphStrong">\2</span>, ...</tt></p>
<p class="docList">&#9758;137 Grouping-only parentheses: <tt><span class="docEmphStrong">(?:</span>&#8943;<span class="docEmphStrong">)</span></tt></p>
<p class="docList">&#9758;138 Named capture: <tt><span class="docEmphStrong">(?</span>&lt;<span class="docEmphasis">Name</span>&gt;&#8943;<span class="docEmphStrong">)</span></tt></P>
<p class="docList">&#9758;139 Atomic grouping: <tt><span class="docEmphStrong">(?</span>&gt;&#8943;<span class="docEmphStrong">)</span></tt></P>
<p class="docList">&#9758;139 Alternation: <tt>&#8943;<span class="docEmphStrong">|</span>&#8943;<span class="docEmphStrong">|</span>&#8943;</tt></p>
<p class="docList">&#9758;140 Conditional: <tt><span class="docEmphStrong">(?</span><span class="docEmphasis">if then</span><span class="docEmphStrong">|</span><span class="docEmphasis">else</span><span class="docEmphStrong">)</span></tt></p>
<p class="docList">&#9758;141 Greedy quantifiers: <tt><span class="docEmphStrong">*, +, ?, {</span><span class="docEmphasis">num,num</span><span class="docEmphStrong">}</span></tt></P>
<p class="docList">&#9758;141 Lazy quantifiers: <tt><span class="docEmphStrong">*?, +?, ??, {</span><span class="docEmphasis">num,num</span><span class="docEmphStrong">}?</span></tt></P>
<p class="docList">&#9758;142 Possessive quantifiers: <tt><span class="docEmphStrong">*+, ++, ?+, {</span><span class="docEmphasis">num,num</span><span class="docEmphStrong">}+</span></tt></P></dd>
</dl>
<a name="regex3-CHP-3-SECT-5.1"></a>
<h4 id="title-IDAQURCF" class="docSection2Title">3.5.1. Character Representations</H4>
<p class="docText">This group of metacharacters provides visually pleasing ways to match specific characters that are otherwise difficult to represent.</P>
<a name="regex3-CHP-3-SECT-5.1.1"></a>
<h5 id="title-IDAYURCF" class="docSection3Title">3.5.1.1. Character shorthands</h5>
<a name="IDX-CHP-3-0705"></a> 

<a name="IDX-CHP-3-0706"></a> 
<a name="IDX-CHP-3-0707"></a> 
<a name="IDX-CHP-3-0708"></a> 
<a name="IDX-CHP-3-0709"></a> 
<a name="IDX-CHP-3-0710"></a> 
<a name="IDX-CHP-3-0711"></a> 
<a name="IDX-CHP-3-0712"></a> 
<a name="IDX-CHP-3-0713"></a> 
<a name="IDX-CHP-3-0714"></a> 

<p class="docText">Many utilities provide metacharacters to represent certain control characters that are sometimes machine-dependent, and which would otherwise be difficult to input or to visualize:</p>
<p><table cellspacing="0" border="1" RULES="all" cellpadding="4" width="100%"><colgroup span="2"><col><col></colgroup><thead></thead><TR><td class="docTableCell" align="left"><p class="docText"><tt>\a</tt><a name="IDX-CHP-3-0715"></a> 
<a name="IDX-CHP-3-0716"></a> 
</p></TD><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Alert</span> (e.g., to sound the bell when "printed") Usually maps to the ASCII<a name="IDX-CHP-3-0717"></a> 
 <tt>&lt;BEL&gt;</tt> character, 007 octal.</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\b</tt><a name="IDX-CHP-3-0718"></a> 
<a name="IDX-CHP-3-0719"></a> 
</p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Backspace</span> Usually maps to the ASCII <tt>&lt;BS&gt;</tt> character, 010 octal. (With many flavors, <img src=images/U2308.jpg border=0><tt>\b</tt><img src=images/U230B.jpg border=0> is a shorthand only within a character class, a word-boundary metacharacter outside &#9758;133.)</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\e</tt><a name="IDX-CHP-3-0720"></a> 
<a name="IDX-CHP-3-0721"></a> 
</p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Escape character</span> Usually maps to the ASCII <tt>&lt;ESC&gt;</tt> character, <tt>033</tt> octal.</P></td></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>\f</tt><a name="IDX-CHP-3-0722"></a> 
<a name="IDX-CHP-3-0723"></a> 
</P></TD><TD class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Form feed</span> Usually maps to the ASCII <tt>&lt;FF&gt;</tt> character, <tt>014</tt> octal.</P></td></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>\n</tt><a name="IDX-CHP-3-0724"></a> 
<a name="IDX-CHP-3-0725"></a> 
</P></TD><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Newline</span> On most platforms (including Unix and DOS/Windows), usually maps to the ASCII <tt>&lt;LF&gt;</tt> character, <tt>012</tt> octal. On MacOS<a name="IDX-CHP-3-0726"></a> 
 systems, usually maps to the ASCII <tt>&lt;CR&gt;</tt> character, <tt>015</tt> octal. With Java or any .NET language, always the ASCII <tt>&lt;LF&gt;</tt> character regardless of platform.</p></TD></TR><TR><td class="docTableCell" align="left"><p class="docText"><tt>\r</tt><a name="IDX-CHP-3-0727"></a> 
<a name="IDX-CHP-3-0728"></a> 
</P></TD><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Carriage return</span> Usually maps to the ASCII <tt>&lt;CR&gt;</tt> character. On MacOS systems, usually maps to the ASCII <tt>&lt;LF&gt;</tt> character. With Java or any .NET language, always the ASCII <tt>&lt;CR&gt;</tt> character regardless of platform.</p></td></tr><TR><td class="docTableCell" align="left"><p class="docText"><tt>\t</tt><a name="IDX-CHP-3-0729"></a> 
<a name="IDX-CHP-3-0730"></a> 
</p></TD><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Normal horizontal tab</span> Maps to the ASCII <tt>&lt;HT&gt;</tt> character, <tt>011</tt> octal.</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\v</tt><a name="IDX-CHP-3-0731"></a> 
<a name="IDX-CHP-3-0732"></a> 
</p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Vertical tab</span> Usually maps to the ASCII <tt>&lt;VT&gt;</tt> character, <tt>013</tt> octal.</p></td></tr></table></p><br>
<p class="docText"><a class="docLink" href="#regex3-CHP-3-TABLE-6">Table 3-6</a> lists a few common tools and some of the character shorthands they provide. As discussed earlier, some languages also provide many of the same shorthandsfor the string literals they support. Be sure to review that section (&#9758;101) for some of the associated pitfalls.</p>

<a name="regex3-CHP-3-SECT-5.1.2"></a>
<h5 id="title-IDA04RCF" class="docSection3Title">3.5.1.2. These are machine dependent?</h5>
<p class="docText">As noted in the list, <tt>\n</tt> and <tt>\r</tt> are operating-system dependent in many tools,<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-FN-11">[<img src=images/U2020.jpg border=0>]</a></sup> so, it's best to choose carefully when you use them. When you need, for example, "a newline" for whatever system your script will happen to run on, use <tt>\n</tt>. When you need a character with a specific value, such as when writing code for a defined protocol like HTTP, use <tt>\012</tt> or whatever the standard calls for. (\012 is an octal escape<a name="IDX-CHP-3-0733"></a> 
 for the ASCII linefeed character.) If you wish to match DOS line ending characters, use <img src=images/U2308.jpg border=0><tt>\015\012</tt><img src=images/U230B.jpg border=0>. To match either DOS or Unix line-ending characters, use <img src=images/U2308.jpg border=0><tt>\015?\012</tt><img src=images/U230B.jpg border=0>. (These actually match the line-ending characters  to match <span class="docEmphasis">at</span> the start or end of a line, use a line anchor &#9758;129).</P><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-FN-11">[<img src=images/U2020.jpg border=0>]</a></sup> If the tool itself is written in C or C++, and converts its regex backslash escapes into C backslash escapes, the resulting value is dependent upon the compiler. In practice, compilers for any particular platform are standardized around newline support, so it's safe to view these as operating-system dependent. Furthermore, only <tt>\n</tt> and <tt>\r</tt> tend to vary across operating systems (and less so as time goes on), so the others can be considered standard across all systems.</p></blockquote>
<a name="regex3-CHP-3-TABLE-6"></a><P><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><h5 class="docTableTitle">Table 3-6. A Few Utilities and Some of the Shorthand Metacharacters They Provide</h5></caption></table></P><BR>

<a name="regex3-CHP-3-SECT-5.1.3"></a>
<H5 id="title-IDARASCF" class="docSection3Title">3.5.1.3. Octal escape <tt>\num</tt></H5>
<p class="docText">Implementations supporting octal (base 8) escapes generally allow two- and three digit octal escapes to be used to indicate a byte or character with a particular value. For example, <img src=images/U2308.jpg border=0><tt>\015\012</tt><img src=images/U230B.jpg border=0> matches an ASCII CR/LF sequence. Octal escapes can be convenient for inserting hard-to-type characters into an expression. In Perl, for instance, you can use <img src=images/U2308.jpg border=0><tt>\e</tt><img src=images/U230B.jpg border=0> for the ASCII escape character, but you can't in awk.</p>
<p class="docText">Since awk does support octal escapes, you can use the ASCII code for the escape character directly: <img src=images/U2308.jpg border=0><tt>\033</tt><img src=images/U230B.jpg border=0>.</P>
<p class="docText"><a class="docLink" href="#regex3-CHP-3-TABLE-7">Table 3-7</a> on the next page shows the octal escapes some tools support.</p>
<p class="docText">Some implementations, as a special case, allow <img src=images/U2308.jpg border=0><tt>\0</tt><img src=images/U230B.jpg border=0><a name="IDX-CHP-3-0734"></a> 
<a name="IDX-CHP-3-0735"></a> 
 to match a NUL<a name="IDX-CHP-3-0736"></a> 
 byte. Some allow all one-digit octal escapes, but usually don't if backreferences such as <img src=images/U2308.jpg border=0><tt>\1</tt><img src=images/U230B.jpg border=0> are supported. When there's a conflict, backreferences generally take precedence over octal escapes. Some allow four-digit octal escapes, usually to support a requirement that any octal escape begin with a zero (such as with <tt>java.util.regex</tt>).</p>
<p class="docText">You might wonder what happens with out-of-range values like <tt>\565</tt> (8-bit octal values range from <tt>\000</tt> until only <tt>\377</tt>). It seems that half the implementations leave it as a larger-than-byte value (which may match a Unicode character if Unicode is supported), while the other half strip it to a byte. In general, it's best tolimit octal escapes to <tt>\377</tt> and below.</P>

<a name="regex3-CHP-3-SECT-5.1.4"></a>
<H5 id="title-IDANCSCF" class="docSection3Title">3.5.1.4. Hex and Unicode escapes: <tt>\xnum, \x{num}, \unum, \Unum, ...</tt></h5>
<a name="IDX-CHP-3-0737"></a> 

<a name="IDX-CHP-3-0738"></a> 

<a name="IDX-CHP-3-0739"></a> 
<a name="IDX-CHP-3-0740"></a> 
<a name="IDX-CHP-3-0741"></a> 

<p class="docText">Similar to octal escapes, many utilities allow a hexadecimal (base 16) value to be entered using <tt>\x</tt>, <tt>\u</tt>,<a name="IDX-CHP-3-0742"></a> 
<a name="IDX-CHP-3-0743"></a> 
 or sometimes <tt>\U</tt>.<a name="IDX-CHP-3-0744"></a> 
<a name="IDX-CHP-3-0745"></a> 
 If allowed with <tt>\x</tt>, for example, <img src=images/U2308.jpg border=0><tt>\x0D\x0A</tt><img src=images/U230B.jpg border=0> matches the CR/LF sequence. <a class="docLink" href="#regex3-CHP-3-TABLE-7">Table 3-7</a> shows the hex escapes that some tools support.</p>
<p class="docText">Besides the question of which escape is used, you must also know how many digits they recognize, and if braces may be (or must be) used around the digits. These are also indicated in <a class="docLink" href="#regex3-CHP-3-TABLE-7">Table 3-7</a>.</P>

<a name="regex3-CHP-3-SECT-5.1.5"></a>
<H5 id="title-IDAVESCF" class="docSection3Title">3.5.1.5. Control characters: <tt>\cchar</tt></H5>
<p class="docText">Many flavors offer the <img src=images/U2308.jpg border=0><tt>\c<span class="docEmphasis">char</span></tt><img src=images/U230B.jpg border=0> sequence to match <span class="docEmphasis">control<a name="IDX-CHP-3-0746"></a> 
 characters</span> with encoding values less than 32 (some allow a wider range). For example, <img src=images/U2308.jpg border=0><tt>\cH</tt><img src=images/U230B.jpg border=0> matches a Control-H, which represents a backspace in ASCII, while <img src=images/U2308.jpg border=0><tt>\cJ</tt><img src=images/U230B.jpg border=0> matches an ASCII linefeed (which is often also matched by <img src=images/U2308.jpg border=0><tt>\n</tt><img src=images/U230B.jpg border=0>, but sometimes by <img src=images/U2308.jpg border=0><tt>\r</tt><img src=images/U230B.jpg border=0>, depending on the platform &#9758;115).</p>
<p class="docText">Details aren't uniform among systems that offer this construct. You'll always be safe using uppercase English letters as in the examples. With most implementations, you can use lowercase letters as well, but Sun's Java regex package, for example, does not support them. And what exactly happens with non-alphabetics is very flavor-dependent, so I recommend using only uppercase letters with <tt>\c</tt>.</P>
<p class="docText">Related Note: GNU Emacs supports this functionality, but with the rather ungainly metasequence <img src=images/U2308.jpg border=0><tt>?\^<span class="docEmphasis">char</span></tt><img src=images/U230B.jpg border=0> (e.g., <img src=images/U2308.jpg border=0><tt>?\^H</tt><img src=images/U230B.jpg border=0> to match an ASCII backspace).</P>
<a name="regex3-CHP-3-TABLE-7"></a><p><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><h5 class="docTableTitle">Table 3-7. A Few Utilities and the Octal and Hex Regex Escapes Their Regexes Support</h5></caption><colgroup span="4"><col><col><col><col></colgroup><thead><tr><th class="thead" scope="col" align="center"><p class="docText">&nbsp;</P></th><th class="thead" scope="col" align="center"><p class="docText">Back-references</p></th><th class="thead" scope="col" align="center"><p class="docText">Octalescapes</p></th><th class="thead" scope="col" align="center"><p class="docText">Hex escapes</P></th></tr></thead><tr><td class="docTableCell" align="left"><p class="docText">Python</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\0, \07,\377</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\xFF</tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">Tcl</P></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\0, \77, \777</tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\x&#8943; \uFFFF; \UFFFFFFFF</tt></p></TD></tr><tr><TD class="docTableCell" align="left"><p class="docText">Perl</P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\0, \77, \777</tt></p></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\xF; \xFF; \x{&#8943;}</tt></p></td></tr><tr><TD class="docTableCell" align="left"><p class="docText">Java</p></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\07, \077, \0377</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\xFF; \uFFFF</tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">GNU awk</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="left"><p class="docText"><tt>\7, \77,\377</tt></P></td><TD class="docTableCell" align="left"><p class="docText"><tt>\x&#8943;</tt></p></td></TR><TR><TD class="docTableCell" align="left"><p class="docText">GNU sed</P></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText">GNU Emacs</P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">.NET</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\0, \77,\377</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\xFF, \uFFFF</tt></p></td></tr><TR><td class="docTableCell" align="left"><p class="docText">PHP (preg suite)</P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\0, \77, \377</tt></P></td><TD class="docTableCell" align="left"><p class="docText"><tt>\xF, \xFF, \x{&#8943;}</tt></p></td></TR><TR><td class="docTableCell" align="left"><p class="docText">MySQL</p></TD><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td></TR><tr><td class="docTableCell" align="left"><p class="docText">GNU egrep</P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">GNU grep</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD></TR><TR><td class="docTableCell" align="left"><p class="docText"><span class="docEmphasis">flex</span></P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD><td class="docTableCell" align="left"><p class="docText"><tt>\7, \77,\377</tt></p></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\xF, \xFF</tt></P></td></TR><TR><td class="docTableCell" align="left"><p class="docText">Ruby</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="left"><p class="docText"><tt>\7, \77,\377</tt></P></td><td class="docTableCell" align="left"><p class="docText"><tt>\xF, \xFF</tt></p></td></tr><tr><td class="docTableCell" align="left" colspan="4"><p class="docText">\0  <img src=images/U2308.jpg border=0><tt>\0</tt><img src=images/U230B.jpg border=0> matches a NUL byte, but other one-digit octal escapes are not supported</p></td></tr><tr><td class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\7, \77</tt>  one- and two- digit octal escapes are supported</p></td></tr><tr><td class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\07</tt>  two-digit octal escapes are supported if leading digit is a zero</P></td></TR><tr><td class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\077</tt>  tHRee-digit octal escapes are supported if leading digit is a zero</P></TD></TR><tr><TD class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\377</tt>  three-digit octal escapes are supported, until <tt>\377</tt></p></TD></TR><tr><td class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\0377</tt>  four-digit octal escapes are supported, until <tt>\0377</tt></P></TD></TR><tr><TD class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\777</tt>  tHRee-digit octal escapes are supported, until <tt>\777</tt></p></td></tr><tr><TD class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\x</tt>&#8943;  \x allows any number of digits</p></td></TR><tr><td class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\x</tt>{&#8943;}  <tt>\x</tt>{&#8943;} allows any number of digits</p></td></tr><tr><td class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\xF, \xFF</tt>  one- and two- digit hex escape is allowed with <tt>\x</tt></p></td></tr><tr><td class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\uFFFF</tt>  four-digit hex escape allowed with <tt>\u</tt></p></td></tr><tr><td class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\UFFFF</tt>  four-digit hex escape allowed with <tt>\U</tt></P></td></TR><tr><td class="docTableCell" align="left" colspan="4"><p class="docText"><tt>\UFFFFFFFF</tt>  eight-digit hex escape allowed with <tt>\U</tt> (See page 91 for version information.)</P></TD></TR></table></P><br>


<a name="regex3-CHP-3-SECT-5.2"></a>
<H4 id="title-IDAYVSCF" class="docSection2Title">3.5.2. Character Classes and Class-Like Constructs</h4>
<a name="IDX-CHP-3-0747"></a> 
<a name="IDX-CHP-3-0748"></a> 

<p class="docText">Modern flavors provide a number of ways to specify a set of characters allowed at a particular point in the regex, but the simple character class<a name="IDX-CHP-3-0749"></a> 
 is ubiquitous.</p>
<a name="regex3-CHP-3-SECT-5.2.1"></a>
<H5 id="title-IDANWSCF" class="docSection3Title">3.5.2.1. Normal classes: <tt>[a-z]</tt> and <tt>[^a-z]</tt></H5>
<p class="docText">The basic concept of a character class has already been well covered, but let me emphasize again that the metacharacter rules change depending on whether you're in a character class or not. For example, <img src=images/U2308.jpg border=0><tt>*</tt><img src=images/U230B.jpg border=0> is never a metacharacter within a class, while <img src=images/U2308.jpg border=0><tt>-</tt><img src=images/U230B.jpg border=0> usually is. Some metasequences, such as <img src=images/U2308.jpg border=0><tt>\b</tt><img src=images/U230B.jpg border=0>, sometimes have a different meaning within a class than outside of one (&#9758;116).</p>
<p class="docText">With most systems, the order that characters are listed in a class makes no difference, and using ranges instead of listing characters is irrelevant to the execution speed (e.g., <tt>[0-9]</tt> should be no different from <tt>[9081726354]</tt>). However, some implementations don't completely optimize classes (Sun's Java regex package comes to mind), so it's usually best to use ranges, which tend to be faster, wherever possible.</p>
<p class="docText">A character class is always a <span class="docEmphasis">positive assertion</span>.<a name="IDX-CHP-3-0750"></a> 
 In other words, it must always match a character to be successful. A negated class must still match a character, but one <span class="docEmphasis">not</span> listed. It might be convenient to consider a negated character class to be a "class to match characters not listed." (Be sure to see the warning about dot<a name="IDX-CHP-3-0751"></a> 
<a name="IDX-CHP-3-0752"></a> 
 and negated character classes, in the next section.) It used to be true that something like <img src=images/U2308.jpg border=0><tt>[^LMNOP]</tt><img src=images/U230B.jpg border=0> was the same as <img src=images/U2308.jpg border=0><tt>[\x00-KQ-\xFF]</tt><img src=images/U230B.jpg border=0>. In strictly eight-bit systems, it still is, but in a system such as Unicode where character ordinals go beyond <tt>255 (\xFF)</tt>, a negated class like <img src=images/U2308.jpg border=0><tt>[^LMNOP]</tt><img src=images/U230B.jpg border=0> suddenly includes all the tens of thousands of characters in the encodingall except <tt>L, M, N, O</tt>, and <tt>P</tt>.</P>
<p class="docText">Be sure to understand the underlying character set when using ranges. For example, <img src=images/U2308.jpg border=0><tt>[a-Z]</tt><img src=images/U230B.jpg border=0> is likely an error, and in any case certainly isn't "alphabetics." One specification for alphabetics is <img src=images/U2308.jpg border=0><tt>[a-zA-Z]</tt><img src=images/U230B.jpg border=0>, at least for the ASCII encoding. (See <tt>\p{L}</tt> in "<a class="docLink" href="regex3-CHP-8-SECT-1.html#regex3-CHP-8-SECT-1.1.1">Unicode properties</a>" &#9758;121.) Of course, when dealing with binary data, ranges like '<tt>\x80-\xFF</tt>' within a class make perfect sense.</P>

<a name="regex3-CHP-3-SECT-5.2.2"></a>
<H5 id="title-IDA3ATCF" class="docSection3Title">3.5.2.2. Almost any character: dot</h5>
<a name="IDX-CHP-3-0753"></a> 
<a name="IDX-CHP-3-0754"></a> 
<a name="IDX-CHP-3-0755"></a> 
<a name="IDX-CHP-3-0756"></a> 
<a name="IDX-CHP-3-0757"></a> 

<p class="docText">In some tools, dot is a shorthand for a character class that can match any character, while in most others, it is a shorthand to match any character <span class="docEmphasis">except a newline</span>. It's a subtle difference that is important when working with tools that allow target text to contain multiple logical lines (or to span logical lines, such as in a text editor). Concerns about dot include:</P>
<UL><li><p class="docList">In some Unicode-enabled systems, such as Sun's Java regex package, dot normally does not match a Unicode line terminator (&#9758;109).</p></li><li><p class="docList">A match mode (&#9758;111) can change the meaning of what dot matches.</P></li><li><p class="docList">The POSIX standard dictates that dot not match a NUL (a character with the value zero), although all the major scripting languages allow NULLs in their text (and dot matches them).</P></li></ul>
<a name="regex3-CHP-3-SECT-5.2.2.1"></a>
<h5 id="title-IDAPCTCF" class="docSection4Title">3.5.2.2.1. Dot versus a negated character class</h5>
<p class="docText">When working with tools that allow multiline text to be searched, take care to note that dot usually does not match a newline, while a negated class like <img src=images/U2308.jpg border=0><tt>[^"]</tt><img src=images/U230B.jpg border=0> usually does. This could yield surprises when changing from something such as <img src=images/U2308.jpg border=0><tt>".*"</tt><img src=images/U230B.jpg border=0> to <img src=images/U2308.jpg border=0><tt>"[^"]*"</tt><img src=images/U230B.jpg border=0>. The matching qualities of dot can often be changed by a match modesee "<a class="docLink" href="regex3-CHP-3-SECT-4.html#regex3-CHP-3-SECT-4.4.3">Dot-matches-all match mode</a>" on page 111.</p>


<a name="regex3-CHP-3-SECT-5.2.3"></a>
<h5 id="title-IDAGDTCF" class="docSection3Title">3.5.2.3. Exactly one byte</h5>
<p class="docText">Perl and PCRE (and hence PHP)<a name="IDX-CHP-3-0758"></a> 
 support <tt>\C</tt>,<a name="IDX-CHP-3-0759"></a> 
<a name="IDX-CHP-3-0760"></a> 
 which matches one <span class="docEmphasis">byte</span>, even if that byte is one of several that might encode a single <span class="docEmphasis">character</span> (on the other hand, everything else works on a per-<span class="docEmphasis">character</span> basis). This is dangerousits misuse can cause internal errors, so it shouldn't be used unless you really know what you're doing. I can't think of a good use for it, so I won't mention it further.</p>

<a name="regex3-CHP-3-SECT-5.2.4"></a>
<h5 id="title-IDAFETCF" class="docSection3Title">3.5.2.4. Unicode combining character sequence: <tt>\X</tt></h5>
<a name="IDX-CHP-3-0761"></a> 

<a name="IDX-CHP-3-0762"></a> 

<a name="IDX-CHP-3-0763"></a> 

<a name="IDX-CHP-3-0764"></a> 

<a name="IDX-CHP-3-0765"></a> 

<p class="docText">Perl and PHP support <tt>\X</tt> as a shorthand for <img src=images/U2308.jpg border=0><tt>\P{M}\p{M}*</tt><img src=images/U230B.jpg border=0>,<a name="IDX-CHP-3-0766"></a> 
<a name="IDX-CHP-3-0767"></a> 
<a name="IDX-CHP-3-0768"></a> 
 which is like an extended <img src=images/U2308.jpg border=0><tt>.</tt><img src=images/U230B.jpg border=0> (dot). It matches a <span class="docEmphasis">base<a name="IDX-CHP-3-0769"></a> 
 character</span><a name="IDX-CHP-3-0770"></a> 
 (anything not <tt>\p{M}</tt>), possibly followed by any number of <span class="docEmphasis">combining characters</span> (anything that is <tt>\p{M}</tt>).</p>
<p class="docText">As discussed earlier (&#9758;107), Unicode uses a system of base and combining characters which, in combination, create what look like single, accented characters like &agrave; ('a' <tt>U+0061</tt> combined with the grave accent '`' <tt>U+0300</tt>). You can use more than one combining character<a name="IDX-CHP-3-0771"></a> 
 if that's what you need to create the final result. For example, if for some reason you need '&Ccedil;&#774;', that would be 'c' followed by a combining cedilla '&#184;' and a combining breve '<img src=images/U02D8.jpg border=0>' (<tt>U+0063</tt> followed by <tt>U+0327</tt> and <tt>U+0306</tt>).</p>
<p class="docText">If you wanted to match either "francais" or "fran&Ccedil;ais," it wouldn't be safe to just use <img src=images/U2308.jpg border=0><tt>fran.ais</tt><img src=images/U230B.jpg border=0> or <img src=images/U2308.jpg border=0><tt>fran[c&Ccedil;]ais</tt><img src=images/U230B.jpg border=0>, as those assume that the '&Ccedil;' is rendered with the single Unicode code point <tt>U+00C7</tt>, rather than 'c' followed by the cedilla (<tt>U+0063</tt> followed by <tt>U+0327</tt>). You could perhaps use <img src=images/U2308.jpg border=0><tt>fran(c,?|&Ccedil;)ais</tt><img src=images/U230B.jpg border=0> if you needed to be very specific, but in this case, <img src=images/U2308.jpg border=0><tt>fran<span class="docEmphStrong">\X</span>ais</tt><img src=images/U230B.jpg border=0> is a good substitute for <img src=images/U2308.jpg border=0><tt>fran.ais</tt><img src=images/U230B.jpg border=0>.</p>
<p class="docText">Besides the fact that <tt>\X</tt> matches trailing combining characters, there are two differences between it and dot. One is that <tt>\X</tt> always matches a newline and other Unicode line terminators (&#9758;109), while dot is subject to dot-matches-all match-mode (&#9758;111), and perhaps other match modes depending on the tool. Another difference is that a dot-matches-all dot is guaranteed to match all characters at all times, while <img src=images/U2308.jpg border=0><tt>\X</tt><img src=images/U230B.jpg border=0> doesn't match a leading combining character.</p>

<a name="regex3-CHP-3-SECT-5.2.5"></a>
<h5 id="title-IDAHITCF" class="docSection3Title">3.5.2.5. Class shorthands: <tt>\w, \d, \s, \W, \D, \S</tt></h5>
<a name="IDX-CHP-3-0772"></a> 

<a name="IDX-CHP-3-0773"></a> 

<a name="IDX-CHP-3-0774"></a> 

<a name="IDX-CHP-3-0775"></a> 

<a name="IDX-CHP-3-0776"></a> 

<a name="IDX-CHP-3-0777"></a> 

<a name="IDX-CHP-3-0778"></a> 

<a name="IDX-CHP-3-0779"></a> 

<a name="IDX-CHP-3-0780"></a> 

<a name="IDX-CHP-3-0781"></a> 

<p class="docText">Support for the following shorthands is common:</p>
<P><table cellspacing="0" border="1" RULES="all" cellpadding="4" width="100%"><colgroup span="2"><col><col></colgroup><thead></thead><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\d</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Digit</span> Generally the same as <img src=images/U2308.jpg border=0><tt>[0-9]</tt><img src=images/U230B.jpg border=0> or, in some Unicode-enabled tools, all Unicode digits.</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\D</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Non-digit</span> Generally the same as <img src=images/U2308.jpg border=0><tt>[^\d]</tt><img src=images/U230B.jpg border=0></P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><tt>\w</tt></P></td><TD class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Part-of-word character</span> Often the same as <img src=images/U2308.jpg border=0><tt>[a-zA-Z0-9_]</tt><img src=images/U230B.jpg border=0>. Some tools omit the underscore, while others include all alphanumerics in the current locale (&#9758;87). If Unicode is supported, <tt>\w</tt> usually refers to all alphanumerics; notable exceptions include <tt>java.util.regex</tt> and PCRE (and by extension, PHP), whose <tt>\w</tt> are exactly <img src=images/U2308.jpg border=0><tt>[a-zA-Z0-9_]</tt><img src=images/U230B.jpg border=0>.</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\W</tt><a name="IDX-CHP-3-0782"></a> 
<a name="IDX-CHP-3-0783"></a> 
</P></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Non-word character</span> Generally the same as <img src=images/U2308.jpg border=0><tt>[^\w]</tt><img src=images/U230B.jpg border=0>.</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\s</tt><a name="IDX-CHP-3-0784"></a> 
<a name="IDX-CHP-3-0785"></a> 
</p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Whitespace character</span> On ASCII-only systems, this is often the same as <img src=images/U2308.jpg border=0><tt>[&#8226; \f\n\r\t\v]</tt><img src=images/U230B.jpg border=0>. Unicode-enabled systems sometimes also include the Unicode "next line" control character <tt>U+0085</tt>, and sometimes the "white space" property <tt>\p{Z}</tt><a name="IDX-CHP-3-0786"></a> 
<a name="IDX-CHP-3-0787"></a> 
<a name="IDX-CHP-3-0788"></a> 
 (described in the next section).</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\S</tt><a name="IDX-CHP-3-0789"></a> 
<a name="IDX-CHP-3-0790"></a> 
</p></td><td class="docTableCell" align="left"><p class="docText"><span class="docEmphStrong">Non-whitespace character</span> Generally the same as <img src=images/U2308.jpg border=0><tt>[^\s]</tt><img src=images/U230B.jpg border=0>.</p></td></TR></table></p><BR>
<p class="docText">As described on page 87, a POSIX locale could influence the meaning of these shorthands (in particular, <tt>\w</tt>). Unicode-enabled programs likely have <tt>\w</tt> match a much wider scope of characters, such as <tt>\p{L}</tt><a name="IDX-CHP-3-0791"></a> 
<a name="IDX-CHP-3-0792"></a> 
<a name="IDX-CHP-3-0793"></a> 
 (discussed in the next section) plus an underscore.</p>

<a name="regex3-CHP-3-SECT-5.2.6"></a>
<h5 id="title-IDAOQTCF" class="docSection3Title">3.5.2.6. Unicode properties, scripts, and blocks: <tt>\p{Prop}, \P{Prop}</tt></H5>
<a name="IDX-CHP-3-0794"></a> 

<a name="IDX-CHP-3-0795"></a> 

<a name="IDX-CHP-3-0796"></a> 
<a name="IDX-CHP-3-0797"></a> 
<a name="IDX-CHP-3-0798"></a> 
<a name="IDX-CHP-3-0799"></a> 
<a name="IDX-CHP-3-0800"></a> 
<a name="IDX-CHP-3-0801"></a> 
<a name="IDX-CHP-3-0802"></a> 
<a name="IDX-CHP-3-0803"></a> 
<a name="IDX-CHP-3-0804"></a> 
<a name="IDX-CHP-3-0805"></a> 
<a name="IDX-CHP-3-0806"></a> 
<a name="IDX-CHP-3-0807"></a> 
<a name="IDX-CHP-3-0808"></a> 
<a name="IDX-CHP-3-0809"></a> 
<a name="IDX-CHP-3-0810"></a> 
<a name="IDX-CHP-3-0811"></a> 
<a name="IDX-CHP-3-0812"></a> 
<a name="IDX-CHP-3-0813"></a> 
<a name="IDX-CHP-3-0814"></a> 
<a name="IDX-CHP-3-0815"></a> 
<a name="IDX-CHP-3-0816"></a> 
<a name="IDX-CHP-3-0817"></a> 
<a name="IDX-CHP-3-0818"></a> 
<a name="IDX-CHP-3-0819"></a> 
<a name="IDX-CHP-3-0820"></a> 
<a name="IDX-CHP-3-0821"></a> 
<a name="IDX-CHP-3-0822"></a> 
<a name="IDX-CHP-3-0823"></a> 
<a name="IDX-CHP-3-0824"></a> 
<a name="IDX-CHP-3-0825"></a> 
<a name="IDX-CHP-3-0826"></a> 
<a name="IDX-CHP-3-0827"></a> 
<a name="IDX-CHP-3-0828"></a> 
<a name="IDX-CHP-3-0829"></a> 
<a name="IDX-CHP-3-0830"></a> 
<a name="IDX-CHP-3-0831"></a> 
<a name="IDX-CHP-3-0832"></a> 
<a name="IDX-CHP-3-0833"></a> 
<a name="IDX-CHP-3-0834"></a> 
<a name="IDX-CHP-3-0835"></a> 
<a name="IDX-CHP-3-0836"></a> 
<a name="IDX-CHP-3-0837"></a> 
<a name="IDX-CHP-3-0838"></a> 
<a name="IDX-CHP-3-0839"></a> 
<a name="IDX-CHP-3-0840"></a> 
<a name="IDX-CHP-3-0841"></a> 
<a name="IDX-CHP-3-0842"></a> 
<a name="IDX-CHP-3-0843"></a> 
<a name="IDX-CHP-3-0844"></a> 
<a name="IDX-CHP-3-0845"></a> 
<a name="IDX-CHP-3-0846"></a> 
<a name="IDX-CHP-3-0847"></a> 
<a name="IDX-CHP-3-0848"></a> 
<a name="IDX-CHP-3-0849"></a> 
<a name="IDX-CHP-3-0850"></a> 
<a name="IDX-CHP-3-0851"></a> 
<a name="IDX-CHP-3-0852"></a> 
<a name="IDX-CHP-3-0853"></a> 
<a name="IDX-CHP-3-0854"></a> 
<a name="IDX-CHP-3-0855"></a> 
<a name="IDX-CHP-3-0856"></a> 
<a name="IDX-CHP-3-0857"></a> 
<a name="IDX-CHP-3-0858"></a> 
<a name="IDX-CHP-3-0859"></a> 
<a name="IDX-CHP-3-0860"></a> 
<a name="IDX-CHP-3-0861"></a> 
<a name="IDX-CHP-3-0862"></a> 
<a name="IDX-CHP-3-0863"></a> 
<a name="IDX-CHP-3-0864"></a> 
<a name="IDX-CHP-3-0865"></a> 
<a name="IDX-CHP-3-0866"></a> 
<a name="IDX-CHP-3-0867"></a> 
<a name="IDX-CHP-3-0868"></a> 
<a name="IDX-CHP-3-0869"></a> 
<a name="IDX-CHP-3-0870"></a> 
<a name="IDX-CHP-3-0871"></a> 
<a name="IDX-CHP-3-0872"></a> 
<a name="IDX-CHP-3-0873"></a> 
<a name="IDX-CHP-3-0874"></a> 
<a name="IDX-CHP-3-0875"></a> 
<a name="IDX-CHP-3-0876"></a> 
<a name="IDX-CHP-3-0877"></a> 
<a name="IDX-CHP-3-0878"></a> 
<a name="IDX-CHP-3-0879"></a> 
<a name="IDX-CHP-3-0880"></a> 
<a name="IDX-CHP-3-0881"></a> 
<a name="IDX-CHP-3-0882"></a> 
<a name="IDX-CHP-3-0883"></a> 
<a name="IDX-CHP-3-0884"></a> 
<a name="IDX-CHP-3-0885"></a> 
<a name="IDX-CHP-3-0886"></a> 
<a name="IDX-CHP-3-0887"></a> 
<a name="IDX-CHP-3-0888"></a> 
<a name="IDX-CHP-3-0889"></a> 
<a name="IDX-CHP-3-0890"></a> 
<a name="IDX-CHP-3-0891"></a> 
<a name="IDX-CHP-3-0892"></a> 
<a name="IDX-CHP-3-0893"></a> 
<a name="IDX-CHP-3-0894"></a> 
<a name="IDX-CHP-3-0895"></a> 
<a name="IDX-CHP-3-0896"></a> 
<a name="IDX-CHP-3-0897"></a> 
<a name="IDX-CHP-3-0898"></a> 
<a name="IDX-CHP-3-0899"></a> 
<a name="IDX-CHP-3-0900"></a> 
<a name="IDX-CHP-3-0901"></a> 
<a name="IDX-CHP-3-0902"></a> 
<a name="IDX-CHP-3-0903"></a> 
<a name="IDX-CHP-3-0904"></a> 
<a name="IDX-CHP-3-0905"></a> 
<a name="IDX-CHP-3-0906"></a> 
<a name="IDX-CHP-3-0907"></a> 
<a name="IDX-CHP-3-0908"></a> 
<a name="IDX-CHP-3-0909"></a> 
<a name="IDX-CHP-3-0910"></a> 
<a name="IDX-CHP-3-0911"></a> 
<a name="IDX-CHP-3-0912"></a> 
<a name="IDX-CHP-3-0913"></a> 
<a name="IDX-CHP-3-0914"></a> 
<a name="IDX-CHP-3-0915"></a> 
<a name="IDX-CHP-3-0916"></a> 
<a name="IDX-CHP-3-0917"></a> 
<a name="IDX-CHP-3-0918"></a> 
<a name="IDX-CHP-3-0919"></a> 
<a name="IDX-CHP-3-0920"></a> 
<a name="IDX-CHP-3-0921"></a> 
<a name="IDX-CHP-3-0922"></a> 
<a name="IDX-CHP-3-0923"></a> 
<a name="IDX-CHP-3-0924"></a> 
<a name="IDX-CHP-3-0925"></a> 
<a name="IDX-CHP-3-0926"></a> 
<a name="IDX-CHP-3-0927"></a> 
<a name="IDX-CHP-3-0928"></a> 
<a name="IDX-CHP-3-0929"></a> 
<a name="IDX-CHP-3-0930"></a> 
<a name="IDX-CHP-3-0931"></a> 
<a name="IDX-CHP-3-0932"></a> 
<a name="IDX-CHP-3-0933"></a> 
<a name="IDX-CHP-3-0934"></a> 
<a name="IDX-CHP-3-0935"></a> 
<a name="IDX-CHP-3-0936"></a> 
<a name="IDX-CHP-3-0937"></a> 
<a name="IDX-CHP-3-0938"></a> 
<a name="IDX-CHP-3-0939"></a> 
<a name="IDX-CHP-3-0940"></a> 
<a name="IDX-CHP-3-0941"></a> 
<a name="IDX-CHP-3-0942"></a> 
<a name="IDX-CHP-3-0943"></a> 
<a name="IDX-CHP-3-0944"></a> 
<a name="IDX-CHP-3-0945"></a> 
<a name="IDX-CHP-3-0946"></a> 
<a name="IDX-CHP-3-0947"></a> 
<a name="IDX-CHP-3-0948"></a> 
<a name="IDX-CHP-3-0949"></a> 
<a name="IDX-CHP-3-0950"></a> 
<a name="IDX-CHP-3-0951"></a> 
<a name="IDX-CHP-3-0952"></a> 
<a name="IDX-CHP-3-0953"></a> 
<a name="IDX-CHP-3-0954"></a> 
<a name="IDX-CHP-3-0955"></a> 
<a name="IDX-CHP-3-0956"></a> 
<a name="IDX-CHP-3-0957"></a> 
<a name="IDX-CHP-3-0958"></a> 
<a name="IDX-CHP-3-0959"></a> 
<a name="IDX-CHP-3-0960"></a> 
<a name="IDX-CHP-3-0961"></a> 
<a name="IDX-CHP-3-0962"></a> 
<a name="IDX-CHP-3-0963"></a> 
<a name="IDX-CHP-3-0964"></a> 
<a name="IDX-CHP-3-0965"></a> 
<a name="IDX-CHP-3-0966"></a> 
<a name="IDX-CHP-3-0967"></a> 
<a name="IDX-CHP-3-0968"></a> 
<a name="IDX-CHP-3-0969"></a> 
<a name="IDX-CHP-3-0970"></a> 
<a name="IDX-CHP-3-0971"></a> 
<a name="IDX-CHP-3-0972"></a> 
<a name="IDX-CHP-3-0973"></a> 
<a name="IDX-CHP-3-0974"></a> 
<a name="IDX-CHP-3-0975"></a> 
<a name="IDX-CHP-3-0976"></a> 
<a name="IDX-CHP-3-0977"></a> 
<a name="IDX-CHP-3-0978"></a> 
<a name="IDX-CHP-3-0979"></a> 
<a name="IDX-CHP-3-0980"></a> 
<a name="IDX-CHP-3-0981"></a> 
<a name="IDX-CHP-3-0982"></a> 
<a name="IDX-CHP-3-0983"></a> 
<a name="IDX-CHP-3-0984"></a> 
<a name="IDX-CHP-3-0985"></a> 
<a name="IDX-CHP-3-0986"></a> 
<a name="IDX-CHP-3-0987"></a> 
<a name="IDX-CHP-3-0988"></a> 
<a name="IDX-CHP-3-0989"></a> 
<a name="IDX-CHP-3-0990"></a> 
<a name="IDX-CHP-3-0991"></a> 
<a name="IDX-CHP-3-0992"></a> 
<a name="IDX-CHP-3-0993"></a> 
<a name="IDX-CHP-3-0994"></a> 
<a name="IDX-CHP-3-0995"></a> 
<a name="IDX-CHP-3-0996"></a> 
<a name="IDX-CHP-3-0997"></a> 
<a name="IDX-CHP-3-0998"></a> 
<a name="IDX-CHP-3-0999"></a> 
<a name="IDX-CHP-3-1000"></a> 
<a name="IDX-CHP-3-1001"></a> 
<a name="IDX-CHP-3-1002"></a> 
<a name="IDX-CHP-3-1003"></a> 
<a name="IDX-CHP-3-1004"></a> 
<a name="IDX-CHP-3-1005"></a> 
<a name="IDX-CHP-3-1006"></a> 
<a name="IDX-CHP-3-1007"></a> 
<a name="IDX-CHP-3-1008"></a> 
<a name="IDX-CHP-3-1009"></a> 
<a name="IDX-CHP-3-1010"></a> 
<a name="IDX-CHP-3-1011"></a> 
<a name="IDX-CHP-3-1012"></a> 
<a name="IDX-CHP-3-1013"></a> 
<a name="IDX-CHP-3-1014"></a> 
<a name="IDX-CHP-3-1015"></a> 
<a name="IDX-CHP-3-1016"></a> 
<a name="IDX-CHP-3-1017"></a> 
<a name="IDX-CHP-3-1018"></a> 
<a name="IDX-CHP-3-1019"></a> 
<a name="IDX-CHP-3-1020"></a> 
<a name="IDX-CHP-3-1021"></a> 
<a name="IDX-CHP-3-1022"></a> 
<a name="IDX-CHP-3-1023"></a> 
<a name="IDX-CHP-3-1024"></a> 
<a name="IDX-CHP-3-1025"></a> 
<a name="IDX-CHP-3-1026"></a> 
<a name="IDX-CHP-3-1027"></a> 
<a name="IDX-CHP-3-1028"></a> 
<a name="IDX-CHP-3-1029"></a> 
<a name="IDX-CHP-3-1030"></a> 
<a name="IDX-CHP-3-1031"></a> 
<a name="IDX-CHP-3-1032"></a> 
<a name="IDX-CHP-3-1033"></a> 
<a name="IDX-CHP-3-1034"></a> 
<a name="IDX-CHP-3-1035"></a> 
<a name="IDX-CHP-3-1036"></a> 
<a name="IDX-CHP-3-1037"></a> 
<a name="IDX-CHP-3-1038"></a> 
<a name="IDX-CHP-3-1039"></a> 
<a name="IDX-CHP-3-1040"></a> 
<a name="IDX-CHP-3-1041"></a> 
<a name="IDX-CHP-3-1042"></a> 
<a name="IDX-CHP-3-1043"></a> 
<a name="IDX-CHP-3-1044"></a> 
<a name="IDX-CHP-3-1045"></a> 
<a name="IDX-CHP-3-1046"></a> 
<a name="IDX-CHP-3-1047"></a> 
<a name="IDX-CHP-3-1048"></a> 
<a name="IDX-CHP-3-1049"></a> 
<a name="IDX-CHP-3-1050"></a> 
<a name="IDX-CHP-3-1051"></a> 
<a name="IDX-CHP-3-1052"></a> 
<a name="IDX-CHP-3-1053"></a> 
<a name="IDX-CHP-3-1054"></a> 
<a name="IDX-CHP-3-1055"></a> 
<a name="IDX-CHP-3-1056"></a> 
<a name="IDX-CHP-3-1057"></a> 
<a name="IDX-CHP-3-1058"></a> 
<a name="IDX-CHP-3-1059"></a> 
<a name="IDX-CHP-3-1060"></a> 
<a name="IDX-CHP-3-1061"></a> 
<a name="IDX-CHP-3-1062"></a> 
<a name="IDX-CHP-3-1063"></a> 
<a name="IDX-CHP-3-1064"></a> 
<a name="IDX-CHP-3-1065"></a> 
<a name="IDX-CHP-3-1066"></a> 
<a name="IDX-CHP-3-1067"></a> 
<a name="IDX-CHP-3-1068"></a> 
<a name="IDX-CHP-3-1069"></a> 
<a name="IDX-CHP-3-1070"></a> 
<a name="IDX-CHP-3-1071"></a> 
<a name="IDX-CHP-3-1072"></a> 
<a name="IDX-CHP-3-1073"></a> 
<a name="IDX-CHP-3-1074"></a> 
<a name="IDX-CHP-3-1075"></a> 
<a name="IDX-CHP-3-1076"></a> 
<a name="IDX-CHP-3-1077"></a> 
<a name="IDX-CHP-3-1078"></a> 
<a name="IDX-CHP-3-1079"></a> 
<a name="IDX-CHP-3-1080"></a> 
<a name="IDX-CHP-3-1081"></a> 
<a name="IDX-CHP-3-1082"></a> 
<a name="IDX-CHP-3-1083"></a> 
<a name="IDX-CHP-3-1084"></a> 
<a name="IDX-CHP-3-1085"></a> 
<a name="IDX-CHP-3-1086"></a> 
<a name="IDX-CHP-3-1087"></a> 
<a name="IDX-CHP-3-1088"></a> 
<a name="IDX-CHP-3-1089"></a> 
<a name="IDX-CHP-3-1090"></a> 
<a name="IDX-CHP-3-1091"></a> 
<a name="IDX-CHP-3-1092"></a> 
<a name="IDX-CHP-3-1093"></a> 
<a name="IDX-CHP-3-1094"></a> 
<a name="IDX-CHP-3-1095"></a> 
<a name="IDX-CHP-3-1096"></a> 
<a name="IDX-CHP-3-1097"></a> 
<a name="IDX-CHP-3-1098"></a> 
<a name="IDX-CHP-3-1099"></a> 
<a name="IDX-CHP-3-1100"></a> 
<a name="IDX-CHP-3-1101"></a> 
<a name="IDX-CHP-3-1102"></a> 
<a name="IDX-CHP-3-1103"></a> 
<a name="IDX-CHP-3-1104"></a> 
<a name="IDX-CHP-3-1105"></a> 
<a name="IDX-CHP-3-1106"></a> 
<a name="IDX-CHP-3-1107"></a> 
<a name="IDX-CHP-3-1108"></a> 
<a name="IDX-CHP-3-1109"></a> 
<a name="IDX-CHP-3-1110"></a> 
<a name="IDX-CHP-3-1111"></a> 
<a name="IDX-CHP-3-1112"></a> 
<a name="IDX-CHP-3-1113"></a> 
<a name="IDX-CHP-3-1114"></a> 
<a name="IDX-CHP-3-1115"></a> 
<a name="IDX-CHP-3-1116"></a> 
<a name="IDX-CHP-3-1117"></a> 
<a name="IDX-CHP-3-1118"></a> 
<a name="IDX-CHP-3-1119"></a> 
<a name="IDX-CHP-3-1120"></a> 
<a name="IDX-CHP-3-1121"></a> 
<a name="IDX-CHP-3-1122"></a> 
<a name="IDX-CHP-3-1123"></a> 
<a name="IDX-CHP-3-1124"></a> 
<a name="IDX-CHP-3-1125"></a> 
<a name="IDX-CHP-3-1126"></a> 
<a name="IDX-CHP-3-1127"></a> 
<a name="IDX-CHP-3-1128"></a> 
<a name="IDX-CHP-3-1129"></a> 
<a name="IDX-CHP-3-1130"></a> 
<a name="IDX-CHP-3-1131"></a> 
<a name="IDX-CHP-3-1132"></a> 
<a name="IDX-CHP-3-1133"></a> 
<a name="IDX-CHP-3-1134"></a> 
<a name="IDX-CHP-3-1135"></a> 
<a name="IDX-CHP-3-1136"></a> 
<a name="IDX-CHP-3-1137"></a> 
<a name="IDX-CHP-3-1138"></a> 
<a name="IDX-CHP-3-1139"></a> 
<a name="IDX-CHP-3-1140"></a> 
<a name="IDX-CHP-3-1141"></a> 
<a name="IDX-CHP-3-1142"></a> 
<a name="IDX-CHP-3-1143"></a> 

<p class="docText">On its surface, Unicode is a mapping (&#9758;106), but the Unicode Standard offers much more. It also defines qualities about each character, such as "this character is a lowercase letter," "this character is meant to be written right-to-left," "this character is a mark that's meant to be combined with another character," etc.</P>
<p class="docText">Regular-expression support for these qualities varies, but many Unicode-enabled programs support matching via at least some of them with <img src=images/U2308.jpg border=0><tt>\p{<span class="docEmphasis">quality</span>}</tt><img src=images/U230B.jpg border=0> (matches characters that have the quality) and <img src=images/U2308.jpg border=0><tt>\P{<span class="docEmphasis">quality</span>}</tt><img src=images/U230B.jpg border=0> (matches characters without it). A basic example is <img src=images/U2308.jpg border=0><tt>\p{L}</tt><img src=images/U230B.jpg border=0>, where '<tt>L</tt>' is the quality meaning "letter" (as opposed to number, punctuation, accents, etc.). '<tt>L</tt>' is an example of a <span class="docEmphasis">general property</span> (also called a category). We'll soon see other "qualities" that can be tested by <img src=images/U2308.jpg border=0><tt>\p{&#8943;}</tt><img src=images/U230B.jpg border=0><a name="IDX-CHP-3-1144"></a> 
 and <img src=images/U2308.jpg border=0><tt>\P{&#8943;}</tt><img src=images/U230B.jpg border=0>, but the most commonly supported are the general properties.</P>
<p class="docText">The general properties are shown in <a class="docLink" href="#regex3-CHP-3-TABLE-8">Table 3-8</a>. Each character (each code point actually, which includes those that have no characters defined) can be matched by just one general property. The general property names are one character ('<tt>L</tt>' for Letter, '<tt>S</tt>' for symbol, etc.), but some systems support a more descriptive synonym ('<tt>Letter</tt>', '<tt>Symbol</tt>', etc.) as well. Perl, for example, supports these.</P>
<p class="docText">With some systems, single-letter property names may be referenced without the curly braces (e.g., using <tt>\pL</tt> instead of <tt>\p{L}</tt>). Some systems may require (or simply allow) '<tt>In</tt>' or '<tt>Is</tt>' to prefix the letter (e.g., <tt>\p{IsL}</tt>). As we look at additional qualities, we'll see examples of where an <tt>Is/In</tt> prefix is required.<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-FN-12">[<img src=images/U2020.jpg border=0>]</a></sup></p><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-FN-12">[<img src=images/U2020.jpg border=0>]</a></sup> As we'll see (and is illustrated in the table on page 125), the whole Is/In prefix business is somewhat of a mess. Previous versions of Unicode recommend one thing, while early implementations often did another. During Perl 5.8's development, I worked with the development group to simplifythings for Perl. The rule in Perl now is simply "You don't need to use '<tt>Is</tt>' or '<tt>In</tt>' unless you specifically want a Unicode Block (&#9758;124), in which case you must prepend '<tt>In</tt>'."</P></blockquote>
<p class="docText">As shown in <a class="docLink" href="#regex3-CHP-3-TABLE-9">Table 3-9</a>, each one-letter general Unicode property can be further subdivided into a set of two-letter sub-properties, such as "letter" being divided into "lowercase letter," "uppercase letter," "titlecase letter," "modifier letter," "other letter." Each code point is assigned exactly one of the subdivided properties.</p>
<a name="regex3-CHP-3-TABLE-8"></a><p><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><H5 class="docTableTitle">Table 3-8. Basic Unicode Properties</H5></caption><colgroup span="2"><col><col></colgroup><thead><tr><th class="thead" scope="col" align="left"><p class="docText">Class</p></th><th class="thead" scope="col" align="left"><p class="docText">Synonym and description</P></th></TR></thead><TR><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{L}</span></tt></P></TD><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Letter}</span></tt>  Things considered letters.</p></td></tr><TR><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{M}</span></tt></p></TD><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Mark}</span></tt>  Various characters that are not meant to appear by themselves, but with other base characters (accent marks, enclosing boxes, ...).</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Z}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Separator}</span></tt>  Characters that separate things, but have no visual representation (various kinds of spaces ...).</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{S}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Symbol}</span></tt>  Various types of Dingbats and symbols.</P></td></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{N}</span></tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Number}</span></tt>  Any kind of numeric character.</P></td></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{P}</span></tt></P></TD><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Punctuation}</span></tt>  Punctuation characters.</p></TD></TR><TR><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{C}</span></tt></P></TD><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Other}</span></tt>  Catch-all for everything else (rarely used for normal characters).</p></td></tr></table></P><br>
<p class="docText">Additionally, some implementations support a special composite sub-property, <tt>\p{L&amp;}</tt>, which is a shorthand for all "cased" letters, and is the same as <img src=images/U2308.jpg border=0><tt>[\p{Lu}\p{Ll}\p{Lt}]</tt><img src=images/U230B.jpg border=0>.</p>
<p class="docText">Also shown in <a class="docLink" href="#regex3-CHP-3-TABLE-9">Table 3-9</a> are the full-length synonyms (e.g., "<tt>Lowercase_Letter</tt>" instead of "<tt>Ll</tt>") supported by some implementations. The standard suggests that a variety of forms be accepted (such as '<tt>LowercaseLetter</tt>', '<tt>LOWERCASE_LETTER</tt>', '<tt>Lowercase&#8226;Letter</tt>', '<tt>lowercase-letter</tt>', etc.), but I recommend, for consistency, always using the form shown in <a class="docLink" href="#regex3-CHP-3-TABLE-9">Table 3-9</a>.</P>
<p class="docText"><span class="docEmphasis"><span class="docEmphStrong">Scripts</span></span>. Some systems have support for matching via a <span class="docEmphasis">script</span><a name="IDX-CHP-3-1145"></a> 
 (writing system) name with <img src=images/U2308.jpg border=0><tt>\p{&#8943;}</tt><img src=images/U230B.jpg border=0>. For example, if supported, <tt>\p{Hebrew}</tt><a name="IDX-CHP-3-1146"></a> 
 matches characters that are specifically part of the Hebrew writing system. (A script does not include common characters that might be used by other writing systems as well, such as spaces and punctuation.)</p>
<p class="docText">Some scripts<a name="IDX-CHP-3-1147"></a> 
 are language-based (such as <tt>Gujarati, Thai, Cherokee</tt>, &#8943;). Some span multiple languages (e.g., <tt>Latin, Cyrillic</tt>), while some languages are composed of multiple scripts, such as Japanese, which uses characters from the <tt>Hiragana, Katakana, Han</tt> ("Chinese Characters"), and <tt>Latin</tt> scripts. See your system's documentation for the full list.<a name="IDX-CHP-3-1148"></a> 
</p>
<p class="docText">A script does not include all characters used by the particular writing system, but rather, all characters used only (or predominantly) by that writing system. Common characters such as spacing and punctuation are not included within any script, but rather are included as part of the catch-all pseudo-script <tt>IsCommon</tt>, matched by <img src=images/U2308.jpg border=0><tt>\p{IsCommon}</tt><img src=images/U230B.jpg border=0>.<a name="IDX-CHP-3-1149"></a> 
<a name="IDX-CHP-3-1150"></a> 
<a name="IDX-CHP-3-1151"></a> 
 A second pseudo-script, <tt>Inherited</tt>, is composed of certain combining<a name="IDX-CHP-3-1152"></a> 
 characters that inherit the script from the base character that they follow.</p>
<a name="regex3-CHP-3-TABLE-9"></a><p><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><h5 class="docTableTitle">Table 3-9. Basic Unicode Sub-Properties</h5></caption><colgroup span="2"><col><col></colgroup><thead><tr><th class="thead" scope="col" align="left"><p class="docText">Property</p></th><th class="thead" scope="col" align="left"><p class="docText">Synonym and description</p></th></tr></thead><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Ll}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Lowercase_Letter}</span></tt>  Lowercase letters.</p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Lu}</span></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Uppercase_Letter}</span></tt>  Uppercase letters.</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p{Lt}</tt><a name="IDX-CHP-3-1153"></a> 
<a name="IDX-CHP-3-1154"></a> 
<a name="IDX-CHP-3-1155"></a> 
</p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Titlecase_Letter}</span></tt>  Letters that appear at the start of a word (e.g., the character D<img src=images/U017E.jpg border=0> is the title case of the lowercase d<img src=images/U017E.jpg border=0> and of the uppercase D<img src=images/U017D.jpg border=0>).</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{L&amp;}</span></tt></P></td><TD class="docTableCell" align="left"><p class="docText">A composite shorthand matching all <tt>\p<span class="docEmphStrong">{Ll}</span>, \p<span class="docEmphStrong">{Lu}</span></tt>, and <tt>\p<span class="docEmphStrong">{Lt}</span></tt> characters.</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Lm}</span></tt></P></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Modifier_Letter}</span></tt>  A small set of letter-like special-use characters.</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Lo}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Other_Letter}</span></tt>  Letters that have no case, and aren't modifiers, including letters from Hebrew, Arabic, Bengali, Tibetan, Japanese, ...</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Mn}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Non_Spacing_Mark}</span></tt>  "Characters" that modify other characters, such as accents, umlauts, certain "vowel signs," and tone marks.</p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Mc}</span></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Spacing_Combining_Mark}</span></tt>  Modification characters that take up space of their own (mostly "vowel signs" in languages that have them, including Bengali, Gujarati, Tamil, Telugu, Kannada, Malayalam, Sinhala, Myanmar, and Khmer).</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Me}</span></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Enclosing_Mark}</span></tt>  A small set of marks that can enclose other characters, such as circles, squares, diamonds, and "keycaps."</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Zs}</span></tt></P></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Space_Separator}</span></tt>  Various kinds of spacing characters, such as a normal space, non-break space, and various spaces of specific widths.</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Zl}</span></tt></P></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Line_Separator}</span></tt>  The LINE SEPARATOR character (<tt>U+2028</tt>).</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Zp}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Paragraph_Separator}</span></tt>  The PARAGRAPH SEPARATOR<a name="IDX-CHP-3-1156"></a> 
 character (<tt>U+2029</tt>).</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Sm}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Math_Symbol}</span></tt>  +, &#247;, a fraction slash, <img border="0" alt="" width="10" height="9" SRC="images/regex3_u0310.jpg">, ...</p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Sc}</span></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Currency_Symbol}</span></tt>  $, &#162;, &#165;, &euro;, ...</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Sk}</span></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Modifier_Symbol}</span></tt>  Mostly versions of the combining characters, but as full-fledged characters in their own right.</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{So}</span></tt></P></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Other_Symbol}</span></tt>  Various Dingbats, box-drawing symbols, Braille patterns, non-letter Chinese characters, ...</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Nd}</span></tt></P></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Decimal_Digit_Number}</span></tt>  Zero through nine, in various scripts (not including Chinese, Japanese, and Korean).</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Nl}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Letter_Number}</span></tt>  Mostly Roman numerals.</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{No}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Other_Number}</span></tt>  Numbers as superscripts or symbols; characters representing numbers that aren't digits (Chinese, Japanese, and Korean not included).</p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Pd}</span></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Dash_Punctuation}</span></tt>  Hyphens and dashes of all sorts.</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Ps}</span></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Open_Punctuation}</span></tt>  Characters like (, &#65085;, and &#12298;, ...</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Pe}</span></tt></P></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Close_Punctuation}</span></tt>  Characters like), &#12299;, &#12299;, ...</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Pi}</span></tt></P></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Initial_Punctuation}</span></tt>  Characters like <img src=images/U226A.jpg border=0>, ', &lt;, ...</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Pf}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Final_Punctuation}</span></tt>  Characters like <img src=images/U226B.jpg border=0>, ', &gt;, ...</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Pc}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Connector_Punctuation}</span></tt>  A few punctuation characters with special linguistic meaning, such as an underscore.</p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Po}</span></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Other_Punctuation}</span></tt>  Catch-all for other punctuation: !, &amp;, ., :, :, ...</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Cc}</span></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Control}</span></tt>  The ASCII<a name="IDX-CHP-3-1157"></a> 
 and Latin-1<a name="IDX-CHP-3-1158"></a> 
 control characters (<tt>TAB, LF, CR</tt>, ...)</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Cf}</span></tt></P></td><TD class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Format}</span></tt>  Non-visible characters intended to indicate some basic formatting(<span class="docEmphasis">zero width joiner, activate Arabic form shaping</span>, ...)</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Co}</span></tt></P></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Private_Use}</span></tt>  Code points allocated for private use (company logos, etc.).</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Cn}</span></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\p<span class="docEmphStrong">{Unassigned}</span></tt>  Code points that have no characters assigned.</p></td></tr></table></p><br>
<p class="docText"><span class="docEmphasis"><span class="docEmphStrong">Blocks</span></span>. Similar (but inferior) to scripts, <span class="docEmphasis">blocks</span><a name="IDX-CHP-3-1159"></a> 
 refer to ranges of code points on the Unicode character map. For example, the <tt>Tibetan</tt> block<a name="IDX-CHP-3-1160"></a> 
 refers to the <tt>256</tt> code points from <tt>U+0F00</tt> through <tt>U+0FFF</tt>. Characters in this block are matched with <tt>\p{InTibetan}</tt><a name="IDX-CHP-3-1161"></a> 
<a name="IDX-CHP-3-1162"></a> 
<a name="IDX-CHP-3-1163"></a> 
 in Perl and <tt>java.util.regex</tt>, and with <tt>\p{IsTibetan}</tt><a name="IDX-CHP-3-1164"></a> 
<a name="IDX-CHP-3-1165"></a> 
<a name="IDX-CHP-3-1166"></a> 
 in .NET. (More on this in a bit.)</p>
<p class="docText">There are many blocks, including blocks for most systems of writing (<tt>Hebrew, Tamil, Basic_Latin, Hangul_Jamo, Cyrillic, Katakana</tt>, ...), and for special character types (<tt>Currency, Arrows, Box_Drawing, Dingbats</tt>, ...).</p>
<p class="docText"><tt>Tibetan</tt> is one of the better examples of a block, since all characters in the block that are defined relate to the Tibetan language, and there are no Tibetan-specific characters outside the block. Block qualities, however, are inferior to script qualities for a number of reasons:</p>
<ul><LI><p class="docList">Blocks can contain unassigned code points. For example, about 25 percent of the code points in the <tt>Tibetan</tt> block have no characters assigned to them.</p></LI><li><p class="docList">Not all characters that would seem related to a block are actually part of that block. For example, the <tt>Currency</tt> block does not contain the universal currency symbol '&#164;', nor such notable currency symbols as $, &#162;,<a name="IDX-CHP-3-1167"></a> 
 &#163;,<a name="IDX-CHP-3-1168"></a> 
<a name="IDX-CHP-3-1169"></a> 
 &euro;, and &#165;.<a name="IDX-CHP-3-1170"></a> 
 (Luckily, in this case, you can use the currency property, <tt>\p{Sc}</tt>, in its place.)</p></LI><LI><p class="docList">Blocks often have unrelated characters in them. For example, &#165; (Yen symbol) is found in the <tt>Latin_1_Supplement</tt> block.</P></LI><li><p class="docList">What might be considered one <span class="docEmphasis">script</span> may be included within multiple <span class="docEmphasis">blocks</span>. For example, characters used in Greek can be found in both the <tt>Greek</tt> and <tt>Greek_Extended blocks</tt>.</P></li></ul>
<p class="docText">Support for block qualities is more common than for script qualities. There is ample room for getting the two confused because there is a lot of overlap in the naming (for example, Unicode provides for both a Tibetan script and a Tibetan block).</P>
<p class="docText">Furthermore, as <a class="docLink" href="#regex3-CHP-3-TABLE-10">Table 3-10</a> on the facing page shows, the nomenclature has not yet been standardized. With <tt>Perl</tt> and <tt>java.util.regex</tt>, the Tibetan block is <img src=images/U2308.jpg border=0><tt>\p{<span class="docEmphStrong">In</span>Tibetan}</tt><img src=images/U230B.jpg border=0>, but in the .NET Framework, it's <tt>\p{<span class="docEmphStrong">Is</span>Tibetan}</tt> (which, to add to the confusion, Perl allows as an alternate representation for the Tibetan <span class="docEmphasis">script</span>).</P>
<p class="docText"><span class="docEmphasis"><span class="docEmphStrong">Other properties/qualities</span></span>. Not everything talked about so far is universally supported. <a class="docLink" href="#regex3-CHP-3-TABLE-10">Table 3-10</a> gives a few details about what's been covered so far.</p>
<p class="docText">Additionally, Unicode defines many other qualities that might be accessible via the <img src=images/U2308.jpg border=0><tt>\p{&#8943;}</tt><img src=images/U230B.jpg border=0> construct, including ones related to how a character is written (left-to-right, right-to-left, etc.), vowel sounds associated with characters, and more. Some implementations even allow you to create your own properties on the fly. See your program's documentation for details on what's supported.</p>
<a name="regex3-CHP-3-TABLE-10"></a><P><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><H5 class="docTableTitle">Table 3-10. Property/Script/Block Features</H5></caption><colgroup span="5"><col><col><col><col><col></colgroup><thead><tr><th class="thead" scope="col" align="left"><p class="docText">Feature</P></th><th class="thead" scope="col" align="center"><p class="docText">Perl<a name="IDX-CHP-3-1171"></a> 
</P></th><th class="thead" scope="col" align="center"><p class="docText">Java<a name="IDX-CHP-3-1172"></a> 
</p></th><th class="thead" scope="col" align="center"><p class="docText">.NET<a name="IDX-CHP-3-1173"></a> 
</p></th><th class="thead" scope="col" align="center"><p class="docText">PHP/PCRE3<a name="IDX-CHP-3-1174"></a> 
</p></th></tr></thead><TR><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> Basic Properties like <tt>\p{L}</tt></p></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> Basic Properties shorthand like <tt>\pL</tt></p></td><TD class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText">Basic Properties longhand like <tt>\p{IsL}</tt></p></td><TD class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td></tr><TR><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> Basic Properties full like <tt>\p{Letter}</tt></p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td></tr><tr><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> Composite <tt>\p{L&amp;}</tt></p></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></TD></tr><tr><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> Script like <tt>\p{Greek}</tt></P></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></td></tr><tr><td class="docTableCell" align="left"><p class="docText">Script longhand like <tt>\p{<span class="docEmphStrong">Is</span>Greek}</tt></p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></TD></tr><TR><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> Block like <tt>\p{Cyrillic}</tt></p></TD><TD class="docTableCell" align="center"><p class="docText">if no script</P></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></TD></TR><TR><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> Block longhand like <tt>\p{<span class="docEmphStrong">In</span>Cyrillic}</tt></P></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">Block longhand like <tt>\p{<span class="docEmphStrong">Is</span>Cyrillic}</tt></p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> Negated <tt>\P{&#8943;}</tt></P></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><TD class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></td></TR><TR><td class="docTableCell" align="left"><p class="docText">Negated <tt>\p{^&#8943;}</tt></p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> <tt>\p{Any}</tt><a name="IDX-CHP-3-1175"></a> 
<a name="IDX-CHP-3-1176"></a> 
<a name="IDX-CHP-3-1177"></a> 
<a name="IDX-CHP-3-1178"></a> 
</p></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="center"><p class="docText">as <tt>\p{all}</tt></p></TD><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></TD></TR><TR><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0><tt>\p{Assigned}</tt><a name="IDX-CHP-3-1179"></a> 
</P></td><td class="docTableCell" align="center"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="center"><p class="docText">as <tt>\P{Cn}</tt></p></TD><TD class="docTableCell" align="center"><p class="docText">as <tt>\P{Cn}</tt></P></td><TD class="docTableCell" align="center"><p class="docText">as <tt>\P{Cn}</tt></P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0> <tt>\p{Unassigned}</tt><a name="IDX-CHP-3-1180"></a> 
<a name="IDX-CHP-3-1181"></a> 
<a name="IDX-CHP-3-1182"></a> 
<a name="IDX-CHP-3-1183"></a> 
</P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="center"><p class="docText">as <tt>\p{Cn}</tt><a name="IDX-CHP-3-1184"></a> 
<a name="IDX-CHP-3-1185"></a> 
<a name="IDX-CHP-3-1186"></a> 
</p></td><td class="docTableCell" align="center"><p class="docText">as <tt>\p{Cn}</tt></p></td><td class="docTableCell" align="center"><p class="docText">as <tt>\p{Cn}</tt></p></td></tr><tr><td class="docTableCell" align="left" colspan="5"><p class="docText">Lines checkmarked at left are recommended for new implementations. (See page 91 for version information)</p></td></tr></table></p><BR>

<a name="regex3-CHP-3-SECT-5.2.7"></a>
<h5 id="title-IDAVNQIS" class="docSection3Title">3.5.2.7. Simple class subtraction: <tt>[[a-z]-[aeiou]]</tt></H5>
<a name="IDX-CHP-3-1187"></a> 
<a name="IDX-CHP-3-1188"></a> 
<a name="IDX-CHP-3-1189"></a> 
<a name="IDX-CHP-3-1190"></a> 
<a name="IDX-CHP-3-1191"></a> 
<a name="IDX-CHP-3-1192"></a> 
<a name="IDX-CHP-3-1193"></a> 
<a name="IDX-CHP-3-1194"></a> 
<a name="IDX-CHP-3-1195"></a> 
<a name="IDX-CHP-3-1196"></a> 
<a name="IDX-CHP-3-1197"></a> 
<a name="IDX-CHP-3-1198"></a> 
<a name="IDX-CHP-3-1199"></a> 
<a name="IDX-CHP-3-1200"></a> 
<a name="IDX-CHP-3-1201"></a> 
<a name="IDX-CHP-3-1202"></a> 
<a name="IDX-CHP-3-1203"></a> 
<a name="IDX-CHP-3-1204"></a> 
<a name="IDX-CHP-3-1205"></a> 
<a name="IDX-CHP-3-1206"></a> 
<a name="IDX-CHP-3-1207"></a> 

<p class="docText">.NET offers a simple class "subtraction" nomenclature, which allows you to remove from what a class can match those characters matchable by another class. For example, the characters matched by <img src=images/U2308.jpg border=0><tt>[[a-z]-[aeiou]]</tt><img src=images/U230B.jpg border=0> are those matched by <img src=images/U2308.jpg border=0><tt>[a-z]</tt><img src=images/U230B.jpg border=0> minus those matched by <img src=images/U2308.jpg border=0><tt>[aeiou]</tt><img src=images/U230B.jpg border=0>, i.e. that are non-vowel lower-case ASCII.</p>
<p class="docText">As another example, <img src=images/U2308.jpg border=0><tt>[\p{P}-[\p{Ps}\p{Pe}]]</tt><img src=images/U230B.jpg border=0> is a class that matches characters in <tt>\p{P}</tt> except those matchable by <img src=images/U2308.jpg border=0><tt>[\p{Ps}\p{Pe}]</tt><img src=images/U230B.jpg border=0>, which is to say that it matches all punctuation except opening and closing punctuation such as &#12299;and (.</p>

<a name="regex3-CHP-3-SECT-5.2.8"></a>
<H5 id="title-IDAD0VTR" class="docSection3Title">3.5.2.8. Full class set operations: <tt>[[a-z] &amp;&amp; [^aeiou]]</tt></H5>
<a name="IDX-CHP-3-1208"></a> 

<a name="IDX-CHP-3-1209"></a> 
<a name="IDX-CHP-3-1210"></a> 
<a name="IDX-CHP-3-1211"></a> 
<a name="IDX-CHP-3-1212"></a> 

<p class="docText">Sun's Java regex package supports a full range of set operations (union, subtraction, intersection) within character classes. The syntax is different from the simple class subtraction mentioned in the previous section (and, in particular, Java's set subtraction looks particularly oddthe non-vowel example shown in the previous section would be rendered in Java as <span class="docEmphStrong">[</span><tt>[a-z]<span class="docEmphStrong">&amp;&amp;</span>[^aeiou]<span class="docEmphStrong">]</span></tt>). Before looking at subtraction in detail, let's look at the two basic class set operations, OR and AND.</P>
<p class="docText">OR allows you to add characters to the class by including what looks like an embedded class within the class: <tt>[abcxyz]</tt> can also be written as <tt><span class="docEmphStrong">[</span>[abc][xyz]<span class="docEmphStrong">]</span></tt>, <tt><span class="docEmphStrong">[</span>abc[xyz]<span class="docEmphStrong">]</span></tt>, or <tt><span class="docEmphStrong">[</span>[abc]xyz<span class="docEmphStrong">]</span></tt>, among others. OR combines sets, creating a new set that is the sum of the argument sets. Conceptually, it's similar to the "bitwise or" operator that many languages have via a '<tt>|</tt>' or '<tt>or</tt>' operator. In character classes, OR is mostly a notational convenience, although the ability to include <span class="docEmphasis">negated classes</span> can be useful in some situations.</P>
<p class="docText">AND does a conceptual "bitwise AND" of two sets, keeping only those characters found in both sets. It is achieved by inserting the special class metasequence &amp;&amp; between two sets of characters. For example, <tt>[\p{InThai}&amp;&amp;\P{Cn}]</tt> matches all <span class="docEmphasis">assigned</span> code points in the <tt>Thai</tt> block. It does this by taking the intersection between (i.e., keeping only characters in both) <tt>\p{InThai}</tt> and <tt>\P{Cn}</tt>. Remember, <tt>\P{</tt>&#8943;<tt>}</tt> with a capital 'P', matches everything <span class="docEmphasis">not</span> part of the quality, so <tt>\P{Cn}</tt> matches everything <span class="docEmphasis">not unassigned</span>, which in other words, means is <span class="docEmphasis">assigned</span>. (Had Sun supported the <tt>Assigned</tt> quality, I could have used <tt>\p{Assigned}</tt> instead of <tt>\P{Cn}</tt> in this example.)</p>
<p class="docText">Be careful not to confuse OR and AND. How intuitive these names feel depends on your point of view. For example, <tt><span class="docEmphStrong">[</span>[this][that]<span class="docEmphStrong">]</span></tt> in normally read "accept characters that match <tt>[this]</tt> <span class="docEmphasis">or</span> <tt>[that]</tt>," yet it is equally true if read "the list of characters to allow is <tt>[this]</tt> <span class="docEmphasis">and</span> <tt>[that]</tt>." Two points of view for the same thing.</P>
<p class="docText">AND is less confusing in that <tt>[\p{InThai}&amp;&amp;\P{Cn}]</tt> is normally read as "match only characters matchable by <tt>\p{InThai}</tt> <span class="docEmphasis">and</span> <tt>\P{Cn}</tt>," although it is sometimes read as "the list of allowed characters is the <span class="docEmphasis">intersection</span> of <tt>\p{InThai}</tt> and <tt>\P{Cn}</tt>."</p>
<p class="docText">These differing points of view can make talking about this confusing: what I call OR and AND, some might choose to call AND and INTERSECTION.</p>
<p class="docText"><span class="docEmphStrong"><span class="docEmphasis">Class subtraction with set operators</span></span>. It's useful to realize that <tt>\P{Cn}</tt> is the same as <tt>[^\p{Cn}]</tt>, which allows the "assigned characters in the <tt>Thai</tt> block" example, <tt>[\p{InThai}&amp;&amp;\P{Cn}]</tt>, to be rewritten as <tt>[\p{InThai}&amp;&amp;[^\p{Cn}]]</tt>. Such a change is not particularly helpful except that it helps to illustrate a general pattern: realizing that "assigned characters in the <tt>Thai</tt> block" can be rephrased as the somewhat unruly "characters in the <tt>Thai</tt> block, <span class="docEmphasis">minus un</span>assigned characters," we then see that <tt><span class="docEmphStrong">[</span><img border="0" alt="" width="80" height="13" SRC="images/regex3_u0311.jpg"><span class="docEmphStrong">&amp;&amp;[</span>^<img border="0" alt="" width="53" height="14" SRC="images/regex3_u0312.jpg"><span class="docEmphStrong">]]</span></tt> means "<tt><img border="0" alt="" width="80" height="13" SRC="images/regex3_u0313.jpg"> <span class="docEmphasis">minus</span> <img border="0" alt="" width="53" height="14" SRC="images/regex3_u0314.jpg"></tt>."</P>
<p class="docText">This brings us back to the <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">[</span>[a-z]<span class="docEmphStrong">&amp;&amp;</span>[^aeiou]<span class="docEmphStrong">]</span></tt><img src=images/U230B.jpg border=0> example from the start of the section, and shows how to do <span class="docEmphasis">class subtraction</span>. The pattern is that <img src=images/U2308.jpg border=0><tt>[this &amp;&amp;[^that]]</tt><img src=images/U230B.jpg border=0> means "<tt>[<span class="docEmphasis">this</span>]</tt> <span class="docEmphasis">minus</span> <tt>[<span class="docEmphasis">that</span>]</tt>." I find that the double negatives of <span class="docEmphStrong">&amp;&amp;</span> and <tt>[^&#8943;]</tt> tend to make my head swim, so I just remember the <img src=images/U2308.jpg border=0><tt>[&#8943; &amp;&amp;<span class="docEmphStrong">[</span>^&#8943;<span class="docEmphStrong">]</span>]</tt><img src=images/U230B.jpg border=0> pattern.</P>
<p class="docText"><span class="docEmphasis"><span class="docEmphStrong">Mimicking class set operations<a name="IDX-CHP-3-1213"></a> 
 with lookaround</span></span>. If your program doesn't support class set operations, but does support lookaround (&#9758;133), you can mimic the set operations. With lookahead, <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">[</span><img border="0" alt="" width="80" height="13" SRC="images/regex3_u0315.jpg">&amp;&amp;[^<img border="0" alt="" width="53" height="14" SRC="images/regex3_u0316.jpg">]<span class="docEmphStrong">]</span></tt><img src=images/U230B.jpg border=0> can be rewritten as <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">(?</span>!<img border="0" alt="" width="53" height="14" SRC="images/regex3_u0317.jpg">)<img border="0" alt="" width="80" height="13" SRC="images/regex3_u0318.jpg"></tt><img src=images/U230B.jpg border=0>.<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-FN-13">[<img src=images/U2020.jpg border=0>]</a></sup>Although not as efficient as well-implemented class set operations, using lookaround can be quite flexible. This example can be written four different ways (substituting <tt>IsThai</tt> for <tt>InThai</tt> in .NET &#9758;125):</p><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-FN-13">[<img src=images/U2020.jpg border=0>]</a></sup> Actually, in Perl, this particular example could probably be written simply as <img src=images/U2308.jpg border=0><tt>\p{Thai}</tt><img src=images/U230B.jpg border=0>, since in Perl<tt>\p{Thai}</tt> is a <span class="docEmphasis">script</span>, which never contains unassigned code points. Other differences between the Thai script and block are subtle. It's beneficial to have the documentation as to what is actually covered by any particular script or block. In this case, the script is actually missing a few special characters that are in the block. See the data files at <a class="docLink" target="_blank" href="http://unicode.org">http://unicode.org</a> for all the details.</p></blockquote>
<pre>
       (?!\p{Cn})\p{InThai}
        (?=\P{Cn})\p{InThai}
        \p{InThai}(?&lt;!\p{Cn})
        \p{InThai}(?&lt;=\P{Cn})
</pre><BR>


<a name="regex3-CHP-3-SECT-5.2.9"></a>
<H5 id="title-IDASECYH" class="docSection3Title">3.5.2.9. POSIX bracket-expression "character class" : <tt>[[:alpha:]]</tt></H5>
<a name="IDX-CHP-3-1214"></a> 

<a name="IDX-CHP-3-1215"></a> 
<a name="IDX-CHP-3-1216"></a> 
<a name="IDX-CHP-3-1217"></a> 
<a name="IDX-CHP-3-1218"></a> 
<a name="IDX-CHP-3-1219"></a> 
<a name="IDX-CHP-3-1220"></a> 
<a name="IDX-CHP-3-1221"></a> 

<p class="docText">What we normally call a <span class="docEmphasis">character class</span>, the POSIX standard calls a <span class="docEmphasis">bracket expression</span>. POSIX uses the term "character class" for a special feature used <span class="docEmphasis">within</span> a bracket expression<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-FN-14">[<img src=images/U2021.jpg border=0>]</a></sup> that we might consider to be the precursor to Unicode's character properties.</p><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-FN-14">[<img src=images/U2021.jpg border=0>]</a></sup> In general, this book uses "character class" and "POSIX bracket expression" as synonyms to refer to the entire construct, while "POSIX character class" refers to the special range-like class feature described here.</P></blockquote>
<p class="docText">A POSIX character class is one of several special metasequences for use within a POSIX bracket expression. An example is <tt>[:lower:]</tt>, which represents any lowercase letter within the current locale<a name="IDX-CHP-3-1222"></a> 
<a name="IDX-CHP-3-1223"></a> 
 (&#9758;87). For English text, <tt>[:lower:]</tt> is comparable to <tt>a-z</tt>. Since this entire sequence is valid only <span class="docEmphasis">within</span> a bracket expression, the full class comparable to <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">[</span>a-z<span class="docEmphStrong">]</span></tt><img src=images/U230B.jpg border=0> is <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">[</span>[:lower:]<span class="docEmphStrong">]</span></tt><img src=images/U230B.jpg border=0>. Yes, it's that ugly. But, it has the advantage over <img src=images/U2308.jpg border=0><tt>[a-z]</tt><img src=images/U230B.jpg border=0> of including other characters, such as &ouml;, &ntilde;, and the like if the locale actually indicates that they are "lowercase letters."</P>
<p class="docText">The exact list of POSIX character classes is locale dependent, but the following are usually supported:</p>
<p><table cellspacing="0" border="1" RULES="all" cellpadding="4" width="100%"><colgroup span="2"><col><col></colgroup><thead></thead><tr><td class="docTableCell" align="left"><p class="docText"><tt>[:alnum:]</tt></P></td><td class="docTableCell" align="left"><p class="docText">alphabetic characters and numeric character</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>[:alpha:]</tt></p></td><td class="docTableCell" align="left"><p class="docText">alphabetic characters</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>[:blank:]</tt></p></td><td class="docTableCell" align="left"><p class="docText">space and tab</p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>[:cntrl:]</tt></p></td><TD class="docTableCell" align="left"><p class="docText">control characters</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>[:digit:]</tt></p></td><TD class="docTableCell" align="left"><p class="docText">digits</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><tt>[:graph:]</tt></P></td><TD class="docTableCell" align="left"><p class="docText">non-blank characters (not spaces, control characters, or the like)</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>[:lower:]</tt></P></td><td class="docTableCell" align="left"><p class="docText">lowercase alphabetics</P></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>[:print:]</tt></p></td><td class="docTableCell" align="left"><p class="docText">like <tt>[:graph:]</tt>, but includes the space character</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText"><tt>[:punct:]</tt></p></td><td class="docTableCell" align="left"><p class="docText">punctuation characters</p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>[:space:]</tt></p></td><TD class="docTableCell" align="left"><p class="docText">all whitespace characters (<tt>[:blank:]</tt>, newline, carriage return, and the like)</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>[:upper:]</tt></p></td><TD class="docTableCell" align="left"><p class="docText">uppercase alphabetics</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText"><tt>[:xdigit:]</tt></P></td><TD class="docTableCell" align="left"><p class="docText">digits allowed in a hexadecimal number (i.e., <tt>0-9a-fA-F</tt>).</P></td></tr></table></p><br>
<p class="docText">Systems that support Unicode properties (&#9758;121) may or may not extend that Unicode support to these POSIX constructs. The Unicode property constructs are more powerful, so those should generally be used if available.</P>

<a name="regex3-CHP-3-SECT-5.2.10"></a>
<h5 id="title-IDAJVEYH" class="docSection3Title">3.5.2.10. POSIX bracket-expression "collating sequences" : <tt>[[.span-ll.]]</tt></h5>
<a name="IDX-CHP-3-1224"></a> 

<a name="IDX-CHP-3-1225"></a> 

<a name="IDX-CHP-3-1226"></a> 
<a name="IDX-CHP-3-1227"></a> 
<a name="IDX-CHP-3-1228"></a> 
<a name="IDX-CHP-3-1229"></a> 
<a name="IDX-CHP-3-1230"></a> 
<a name="IDX-CHP-3-1231"></a> 

<p class="docText">A locale can have <span class="docEmphasis">collating sequences</span> to describe how certain characters or sets of characters should be ordered. For example, in Spanish, the two characters <tt>ll</tt> (as in <span class="docEmphasis">tortilla</span>)<a name="IDX-CHP-3-1232"></a> 
 traditionally sort as if they were one logical character between <tt>l</tt> and <tt>m</tt>, and the German &szlig;<a name="IDX-CHP-3-1233"></a> 
<a name="IDX-CHP-3-1234"></a> 
 is a character that falls between <tt>s</tt> and <tt>t</tt>, but sorts as if it were the two characters <tt>ss</tt>. These rules might be manifested in collating sequences named, for example, <tt>span-ll</tt> and <tt>eszet</tt>.</P>
<p class="docText">A collating sequence that maps multiple physical characters to a single logical character, such as the <tt>span-ll</tt> example, is considered "one character" to a fully compliant POSIX regex engine. This means that <img src=images/U2308.jpg border=0><tt>[^abc]</tt><img src=images/U230B.jpg border=0> matches a '<tt>ll</tt>' sequence.</p>
<p class="docText">A collating sequence element is included within a bracket expression using a[.&#8943;.] notation: <img src=images/U2308.jpg border=0> <tt>torti<span class="docEmphStrong">[</span>[.span-ll.]<span class="docEmphStrong">]</span>a</tt><img src=images/U230B.jpg border=0> matches <tt>tortilla</tt>. A collating sequence allows you to match against those characters that are made up of combinations of other characters. It also creates a situation where a bracket expression can match more than one physical character.</p>

<a name="regex3-CHP-3-SECT-5.2.11"></a>
<h5 id="title-IDAUYEYH" class="docSection3Title">3.5.2.11. POSIX bracket-expression "character equivalents" : <tt>[[=n=]]</tt></h5>
<p class="docText">Some locales define <span class="docEmphasis">character equivalents</span> to indicate that certain characters should be considered identical for sorting and such. For example, a locale might define an equivalence class '<tt>n</tt>' as containing <tt>n</tt> and <tt>&ntilde;</tt>, or perhaps one named '<tt>a</tt>' as containing <tt>a</tt>, <tt>&agrave;</tt>, and <tt>&#180;</tt>. Using a notation similar to <tt>[:</tt>&#8943;<tt>:]</tt>, but with '=' instead of a colon, you can reference these equivalence classes within a bracket expression: <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">[</span>[=n=][=a=]<span class="docEmphStrong">]</span></tt><img src=images/U230B.jpg border=0> matches any of the characters just mentioned.</p>
<p class="docText">If a character equivalence with a single-letter name is used but not defined in the locale, it defaults to the collating sequence of the same name. Locales normally include normal characters as collating sequences  <tt>[.a.], [.b.], [.c.]</tt>, and so onso in the absence of special equivalents, <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">[</span>[=n=][=a=]<span class="docEmphStrong">]</span></tt><img src=images/U230B.jpg border=0> defaults to <img src=images/U2308.jpg border=0><tt>[na]</tt><img src=images/U230B.jpg border=0>.</p>

<a name="regex3-CHP-3-SECT-5.2.12"></a>
<h5 id="title-IDAN0EYH" class="docSection3Title">3.5.2.12. Emacs syntax classes</h5>
<a name="IDX-CHP-3-1235"></a> 

<a name="IDX-CHP-3-1236"></a> 

<p class="docText">GNU Emacs doesn't support the traditional <img src=images/U2308.jpg border=0><tt>\w</tt><img src=images/U230B.jpg border=0>, <img src=images/U2308.jpg border=0><tt>\s</tt><img src=images/U230B.jpg border=0>, etc.; rather, it uses special sequences to reference "syntax classes" :</p>
<p><table cellspacing="0" border="1" RULES="all" cellpadding="4" width="100%"><colgroup span="2"><col><col></colgroup><thead></thead><tr><td class="docTableCell" align="left"><p class="docText"><tt>\s</tt><span class="docEmphasis">char</span></p></td><td class="docTableCell" align="left"><p class="docText">matches characters in the Emacs syntax class<a name="IDX-CHP-3-1237"></a> 
 as described by <span class="docEmphasis">char</span></p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText"><tt>\S</tt><span class="docEmphasis">char</span></p></td><TD class="docTableCell" align="left"><p class="docText">matches characters not in the Emacs syntax class</P></TD></TR></table></p><BR>
<p class="docText"><img src=images/U2308.jpg border=0><tt>\sw</tt><img src=images/U230B.jpg border=0> matches a "word constituent" character, and <img src=images/U2308.jpg border=0><tt>\s-</tt><img src=images/U230B.jpg border=0> matches a "whitespace character." These would be written as <img src=images/U2308.jpg border=0><tt>\w</tt><img src=images/U230B.jpg border=0> and <img src=images/U2308.jpg border=0><tt>\s</tt><img src=images/U230B.jpg border=0> in many other systems.</p>
<p class="docText">Emacs<a name="IDX-CHP-3-1238"></a> 
<a name="IDX-CHP-3-1239"></a> 
 is special because the choice of which characters fall into these classes can be modified on the fly, so, for example, the concept of which characters are word constituents can be changed depending upon the kind of text being edited.</p>


<a name="regex3-CHP-3-SECT-5.3"></a>
<H4 id="title-IDAR3EYH" class="docSection2Title">3.5.3. Anchors and Other "Zero-Width Assertions"</H4>
<a name="IDX-CHP-3-1240"></a> 
<a name="IDX-CHP-3-1241"></a> 
<a name="IDX-CHP-3-1242"></a> 
<a name="IDX-CHP-3-1243"></a> 

<p class="docText">Anchors and other "zero-width assertions" don't match actual text, but rather <span class="docEmphasis">positions</span> in the text.</p>
<a name="regex3-CHP-3-SECT-5.3.1"></a>
<h5 id="title-IDAP4EYH" class="docSection3Title">3.5.3.1. Start of line/string: <tt>^, \A</tt></H5>
<a name="IDX-CHP-3-1244"></a> 

<a name="IDX-CHP-3-1245"></a> 

<p class="docText">Caret <img src=images/U2308.jpg border=0><tt>^</tt><img src=images/U230B.jpg border=0> matches at the beginning of the text being searched, and, if in an enhanced line-anchor match mode (&#9758;112), after any newline. In some systems, an enhanced-mode <img src=images/U2308.jpg border=0><tt>^</tt><img src=images/U230B.jpg border=0> can match after Unicode line terminators,<a name="IDX-CHP-3-1246"></a> 
 as well (&#9758;109).</P>
<p class="docText">When supported, <img src=images/U2308.jpg border=0><tt>\A</tt><img src=images/U230B.jpg border=0> always matches only at the start of the text being searched, regardless of any match mode.</P>

<a name="regex3-CHP-3-SECT-5.3.2"></a>
<h5 id="title-IDAQ5EYH" class="docSection3Title">3.5.3.2. End of line/string: <tt>$, \Z, \z</tt></H5>
<a name="IDX-CHP-3-1247"></a> 

<a name="IDX-CHP-3-1248"></a> 

<a name="IDX-CHP-3-1249"></a> 

<a name="IDX-CHP-3-1250"></a> 

<p class="docText">As <a class="docLink" href="#regex3-CHP-3-TABLE-11">Table 3-11</a> on the next page shows, the concept of "end of line" can be a bit more complex than its start-of-line counterpart. <img src=images/U2308.jpg border=0><tt>$</tt><img src=images/U230B.jpg border=0> has a variety of meanings among different tools, but the most common meaning is that it matches at the end of the target string, and before a <span class="docEmphasis">string-ending</span> newline, as well. The latter is common, to allow an expression like <img src=images/U2308.jpg border=0><tt>s$</tt><img src=images/U230B.jpg border=0> (ostensibly, to match "a line ending with s") to match '...<tt>s</tt><img border="0" alt="" width="12" height="16" SRC="images/regex3_u0220.jpg">', a line ending with <tt>s</tt> that's capped with an ending newline.</P>
<p class="docText">Two other common meanings for <img src=images/U2308.jpg border=0><tt>$</tt><img src=images/U230B.jpg border=0> are to match only at the end of the target text, and to match before any newline. In some Unicode systems, the special meaning of newline in these rules are replaced by Unicode line terminators (&#9758;109). (Java, for example, offers particularly complex semantics for <img src=images/U2308.jpg border=0><tt>$</tt><img src=images/U230B.jpg border=0> with respect to Unicode line terminators &#9758;370.)</p>
<p class="docText">A match mode (&#9758;112) can change the meaning of <img src=images/U2308.jpg border=0><tt>$</tt><img src=images/U230B.jpg border=0> to match before any embedded newline (or Unicode line terminator as well).</p>
<p class="docText">When supported, <img src=images/U2308.jpg border=0><tt>\Z</tt><img src=images/U230B.jpg border=0> usually matches what the "unmoded" <img src=images/U2308.jpg border=0><tt>$</tt><img src=images/U230B.jpg border=0> matches, which often means to match at the end of the string, or before a string-ending newline. To complement these, <img src=images/U2308.jpg border=0><tt>\Z</tt><img src=images/U230B.jpg border=0> matches only at the end of the string, period, without regard to any newline. See <a class="docLink" href="#regex3-CHP-3-TABLE-11">Table 3-11</a> for a few exceptions.</p>
<a name="regex3-CHP-3-TABLE-11"></a><p><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><H5 class="docTableTitle">Table 3-11. Line Anchors for Some Scripting Languages</h5></caption><colgroup span="8"><col><col><col><col><col><col><col><col></colgroup><thead><tr><th class="thead" scope="col" align="left"><p class="docText">Concern</P></th><th class="thead" scope="col" align="left"><p class="docText">Java<a name="IDX-CHP-3-1251"></a> 
</p></th><th class="thead" scope="col" align="left"><p class="docText">Perl<a name="IDX-CHP-3-1252"></a> 
</p></th><th class="thead" scope="col" align="left"><p class="docText">PHP<a name="IDX-CHP-3-1253"></a> 
</p></th><th class="thead" scope="col" align="left"><p class="docText">Python</p></th><th class="thead" scope="col" align="left"><p class="docText">Ruby</p></th><th class="thead" scope="col" align="left"><p class="docText">Tcl</p></th><th class="thead" scope="col" align="left"><p class="docText">.NET<a name="IDX-CHP-3-1254"></a> 
</p></th></tr></thead><tr><td class="docTableCell" align="left"><p class="docText">Normally...</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></TD><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText">^ matches at start of string</P></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">^matches after any newline</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD><TD class="docTableCell" align="center"><p class="docText">&nbsp;</p></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-2">[]</a></sup></p></TD><TD class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD></tr><TR><TD class="docTableCell" align="left"><p class="docText">$ matches at end of string</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td></tr><tr><TD class="docTableCell" align="left"><p class="docText">$ matches before string-ending newline</p></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-1">[]</a></sup></p></TD><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td></tr><tr><td class="docTableCell" align="left"><p class="docText">$ matches before <span class="docEmphasis">any</span> newline</P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-2">[]</a></sup></p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</P></td></TR><tr><td class="docTableCell" align="left"><p class="docText">Has enhanced line-anchor mode (&#9758;112)</P></TD><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><TD class="docTableCell" align="center"><p class="docText">&nbsp;</p></TD><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD></tr><tr><TD class="docTableCell" align="left"><p class="docText">In enhanced line-anchor mode ...</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</p></TD><td class="docTableCell" align="center"><p class="docText">&nbsp;</p></TD></TR><TR><TD class="docTableCell" align="left"><p class="docText">^ matches at start of string</p></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="left"><p class="docText">N/A</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td></tr><tr><td class="docTableCell" align="left"><p class="docText">^ matches after any newline</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-1">[]</a></sup></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="left"><p class="docText">N/A</P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td></TR><tr><td class="docTableCell" align="left"><p class="docText">$ matches at end of string</P></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><TD class="docTableCell" align="left"><p class="docText">N/A</p></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">$ matches before <span class="docEmphasis">any</span> newline</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-1">[]</a></sup></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><TD class="docTableCell" align="left"><p class="docText">N/A</P></TD><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD></TR><tr><td class="docTableCell" align="left"><p class="docText">\A always matches like normal ^</P></TD><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="left"><p class="docText">&#8226;<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-4">[]</a></sup></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">\Z always matches like normal $</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-1">[]</a></sup></p></td><TD class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD><TD class="docTableCell" align="left"><p class="docText">&#8226;<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-3">[]</a></sup></P></TD><td class="docTableCell" align="left"><p class="docText">&#8226;<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-5">[]</a></sup></P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></TD></TR><TR><td class="docTableCell" align="left"><p class="docText">\z always matches only at end of string</P></TD><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></P></td><td class="docTableCell" align="left"><p class="docText">N/A</p></td><td class="docTableCell" align="left"><p class="docText">N/A</p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td><td class="docTableCell" align="left"><p class="docText"><img src=images/U2713.jpg border=0></p></td></tr><tr><td class="docTableFooter" align="left" colspan="8"><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-1">[]</a></sup></td></TR><tr><TD class="docTableFooter" align="left" colspan="8"><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-2">[]</a></sup></td></tr><TR><TD class="docTableFooter" align="left" colspan="8"><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-3">[]</a></sup></TD></TR><tr><TD class="docTableFooter" align="left" colspan="8"><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-4">[]</a></sup></td></tr><TR><TD class="docTableFooter" align="left" colspan="8"><sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-TFN-5">[]</a></sup></td></tr><TR><TD class="docTableFooter" align="right" colspan="8"><p class="docText">(See page 91 for version information.)</P></td></TR></table></P><br><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-TFN-1">[]</a></sup> Notes: 1. Sun's Java regex package supports Unicode's <span class="docEmphasis">line terminator</span>(&#9758;109) in these cases.</p></blockquote><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-TFN-2">[]</a></sup> 2. Ruby's $<a name="IDX-CHP-3-1255"></a> 
 and ^<a name="IDX-CHP-3-1256"></a> 
 match at embedded newlines, but its \A and \Z do not.</p></blockquote><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-TFN-3">[]</a></sup> 3. Python's \Z matches only at the end of the string.</p></blockquote><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-TFN-4">[]</a></sup> 4. Ruby's \A, unlike its ^, matches only at the start of the string.</P></blockquote><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-TFN-5">[]</a></sup> 5. Ruby's \Z, unlike its $, matches at the end of the string, or before a string-ending newline.</p></blockquote>

<a name="regex3-CHP-3-SECT-5.3.3"></a>
<h5 id="title-IDAMCCTH" class="docSection3Title">3.5.3.3. Start of match (or end of previous match): <tt>\G</tt></H5>
<a name="IDX-CHP-3-1257"></a> 

<a name="IDX-CHP-3-1258"></a> 

<a name="IDX-CHP-3-1259"></a> 
<a name="IDX-CHP-3-1260"></a> 
<a name="IDX-CHP-3-1261"></a> 
<a name="IDX-CHP-3-1262"></a> 
<a name="IDX-CHP-3-1263"></a> 
<a name="IDX-CHP-3-1264"></a> 
<a name="IDX-CHP-3-1265"></a> 
<a name="IDX-CHP-3-1266"></a> 
<a name="IDX-CHP-3-1267"></a> 
<a name="IDX-CHP-3-1268"></a> 

<p class="docText"><img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> was first introduced by Perl to be useful when doing iterative matching with <tt>/g</tt> (&#9758;51), and ostensibly matches the location where the previous match left off. On the first iteration, <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> matches only at the beginning of the string, just like <img src=images/U2308.jpg border=0><tt>\A</tt><img src=images/U230B.jpg border=0>.</p>
<p class="docText">If a match is not successful, the location at which <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> matches is reset back to the beginning of the string. Thus, when a regex is applied repeatedly, as with Perl's <img src=images/U2308.jpg border=0><tt>s/&#8943;/&#8943;<span class="docEmphStrong">/g</span></tt><img src=images/U230B.jpg border=0> or other language's "match all" function, the failure that causes the "match all" to fail also resets the location for <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> for the next time a match of some sort is applied.</p>
<p class="docText">Perl's <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> has three unique aspects that I find quite interesting and useful:</p>
<ul><li><p class="docList">The location associated with <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> is an attribute of <span class="docEmphasis">each target string</span>, not of the regexes that are setting that location. This means that multiple regexes can match against a string, in turn, each using <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> to ensure that they pick up exactly where one of the others left off.</p></li><li><p class="docList">Perl's regex operators have an option (Perl's <tt>/c</tt><a name="IDX-CHP-3-1269"></a> 
<a name="IDX-CHP-3-1270"></a> 
 modifier &#9758;315) that indicates a failing match should <span class="docEmphasis">not</span>reset the <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> location, but rather to leave it where it was. This works well with the first point to allow tests with a variety of expressions to be performed at one point in the target string, advancing only when there's a match.</p></li><li><p class="docList">That location associated with <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> can be inspected and modified by non-regex constructs (Perl's pos function &#9758;313). One might want to explicitly set the location to "prime" a match to start at a particular location, and match only at that location. Also, if the language supports this point, the functionality of the previous point can be mimicked with this feature, if it's not already supported directly.</p></li></ul>
<p class="docText">See the sidebar on the next page for an example of these features in action. Despite these convenient features, Perl's <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> does have a problem in that it works reliably only when it's the first thing in the regex. Luckily, that's where it's most-naturally used.</p>
<a name="regex3-CHP-3-SECT-5.3.3.1"></a>
<h5 id="title-IDAVGCTH" class="docSection4Title">3.5.3.3.1. End of previous match, or start of the current match?</h5>
<a name="IDX-CHP-3-1271"></a> 
<a name="IDX-CHP-3-1272"></a> 
<a name="IDX-CHP-3-1273"></a> 
<a name="IDX-CHP-3-1274"></a> 
<a name="IDX-CHP-3-1275"></a> 
<a name="IDX-CHP-3-1276"></a> 
<a name="IDX-CHP-3-1277"></a> 
<a name="IDX-CHP-3-1278"></a> 
<a name="IDX-CHP-3-1279"></a> 
<a name="IDX-CHP-3-1280"></a> 
<a name="IDX-CHP-3-1281"></a> 
<a name="IDX-CHP-3-1282"></a> 

<p class="docText">One detail that differs among implementations is whether <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> actually matches the "start of the current match" or "end of the previous match." In the vast majority of cases, the two meanings are the same, so it's a non-issue most of the time. Uncommonly, they can differ. There is a realistic example of how this might arise on page 215, but the issue is easiest to understand with a contrived example: consider applying <img src=images/U2308.jpg border=0><tt>x?</tt><img src=images/U230B.jpg border=0> to '<tt>abcde</tt>'. The regex can match successfully at '<tt><sub><img src=images/U22CF.jpg border=0></sub>abcde</tt>', but doesn't actually match any text. In a global search-and-replace situation, where the regex is applied repeatedly, picking up each time from where it left off, unless the transmission does something special, the "where it left off" will always be the same as where it started. To avoid an infinite loop, the transmission forcefully bumps along to the next character (&#9758;148) when it recognizes this situation. You can see this by applying <tt>s/x?/!/g</tt> to '<tt>abcde</tt>', yielding '<tt>!a!b!c!d!e!</tt>'.</P>
<p class="docText">One side effect of the transmission having to step in this way is that the "end of the previous match" then differs from "the start of the current match." When this happens, the question becomes: which of the two locations does <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> match? In Perl, actually applying <tt>s/\Gx?/!/g</tt> to '<tt>abcde</tt>' yields just '<tt>!abcde</tt>', so in Perl, <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> really does match only the end of the previous match. If the transmission does the artificial bump-along, Perl's <tt>\G</tt> is guaranteed to fail.</p>
<p class="docText">On the other hand, applying the same search and replace with some other tools yields the original '<tt>!a!b!c!d!e!</tt>', showing that their <tt>\G</tt> matches successfully at the start of each current match, as decided <span class="docEmphasis">after</span> the artificial bump-along.</P>
<p class="docText">You can't always rely on the documentation that comes with a tool to tell you which is which, as both Microsoft's .NET and Sun's Java documentation were incorrect until I contacted them about it (they've since been fixed). The status now is that PHP and Ruby have <img src=images/U2308.jpg border=0><tt>\G</tt><img src=images/U230B.jpg border=0> match at the start of the current match, while Perl,<tt>java.util.regex</tt>, and the .NET languages have it match at the end of the previous match.</p>
<a name="regex3-CHP-3-SIDEBAR-1"></a><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><TR><TD>
<H2 class="docSidebarTitle">Advanced Use of <tt>\G</tt> with Perl</H2>
<p class="docText">Here's the outline of a snippet that performs simple validation on the HTML in the variable <tt>$html</tt>, ensuring that it contains constructs from among only a very limited subset of HTML (simple <tt>&lt;IMG&gt;</tt> and <tt>&lt;A&gt;</tt> tags are allowed, as well as simple entities like <tt>&amp;gt;</tt>). I used this method at Yahoo!,<a name="IDX-CHP-3-1283"></a> 
 for example, to validate that a user's HTML submission met certain guidelines.</p>
<p class="docText">This code relies heavily on the behavior of Perl's <tt>m/&#8943;/gc</tt> match operator, which applies the regular expression to the target string once, picking up from where the last successful match left off, but <tt>not</tt> resetting that position if it fails (&#9758;315).</P>
<p class="docText">Using this feature, the various expressions used below all "tag team" to work their way through the string. It's similar in theory to having one big alternation with all the expressions, but this approach allows program code to be executed with each match, and to include or exclude expressions on the fly.</p>
<pre>
    my $need_close_anchor = 0; <span class="docEmphStrong"># True if we've seen &lt;A&gt;, but not its closing &lt;/A&gt;</span>.

   while (not $html =~ m/\G\z/gc) # <span class="docEmphasis">While we haven't worked our way to the end</span> ...
   {
     if ($html =~ m/<span class="docEmphStrong">\G(\w+)</span>/gc) {
       ... <span class="docEmphasis">have a word or number in $1 -- can now check for profanity,
for example</span> ...
     } elsif ($html =~ m/<span class="docEmphStrong">\G[^&lt;&gt;&amp;\w]</span>+/gc) {
       # <span class="docEmphasis">Other non-HTML stuff -- simply allow it</span>.
     } elsif ($html =~ m/<span class="docEmphStrong">\G&lt;img\s+([^&gt;]+)&gt;</span>/gci) {
       ... <span class="docEmphasis">have an image tag -- can check that it's appropriate</span> ...
                      <img src=images/U22EE.jpg border=0>
     } elsif (not $need_close_anchor and $html =~ m/<span class="docEmphStrong">\G&lt;A\s+([^&gt;]+)&gt;</span>/gci) {
       ... <span class="docEmphasis">have a link anchor  can validate it</span> ...
                      <img src=images/U22EE.jpg border=0>
       $need_close_anchor = 1; # <span class="docEmphasis">Note that we now need &lt;/A&gt;</span>
     } elsif ($need_close_anchor and $html =~ m{<span class="docEmphStrong">\G&lt;/A&gt;</span>}gci){
       $need_close_anchor = 0; # <span class="docEmphasis">Got what we needed; don't allow again</span>
     } elsif ($html =~ m/<span class="docEmphStrong">\G&amp;(#\d+&lt;\w+);</span>/gc){
       # <span class="docEmphasis">Allow entities like &amp;gt; and &amp;#123;</span>
     } else {# <span class="docEmphasis">Nothing matched at this point, so it must be an error.
Note the location, and grab a dozen or so</span>
       # <span class="docEmphasis">characters from the HTML so that we can issue an informative error message</span>.
       my $location = pos($html); # <span class="docEmphasis">Note where the unexpected HTML starts</span>.
       my ($badstuff) = $html =~ m/<span class="docEmphStrong">\G(.{1,12})</span>/s;
       die "Unexpected HTML at position $location: $badstuff\n";
     }
   }

   # <span class="docEmphasis">Make sure there's no dangling &lt;A&gt;</span>
  if ($need_close_anchor) {
     die "Missing final &lt;/A&gt;"
  }
</pre><br>

</TD></TR></table></p><br>


<a name="regex3-CHP-3-SECT-5.3.4"></a>
<H5 id="title-IDAENCTH" class="docSection3Title">3.5.3.4. Word boundaries: <tt>\b, \B, \&lt;, \&gt;, ...</tt></H5>
<a name="IDX-CHP-3-1284"></a> 
<a name="IDX-CHP-3-1285"></a> 
<a name="IDX-CHP-3-1286"></a> 

<p class="docText">Like line anchors, word-boundary anchors match a location in the string. There are two distinct approaches. One provides separate metasequences for <span class="docEmphasis">start</span>- and <span class="docEmphasis">end of-word</span> boundaries (often \&lt; and \&gt;), while the other provides ones catch-all <span class="docEmphasis">word boundary</span> metasequence (often <tt>\b</tt>). Either generally provides a <span class="docEmphasis">not-word boundary</span> metasequence as well (often <tt>\B</tt>). <a class="docLink" href="#regex3-CHP-3-TABLE-12">Table 3-12</a> shows a few examples. Tools that don't provide separate start- and end-of-word anchors, but do support lookaround, can mimic word-boundary anchors with the lookaround. In the table, I've filled in the otherwise empty spots that way, wherever practical.</P>
<p class="docText">A word boundary is generally defined as a location where there is a "word character" on one side, and not on the other. Each tool has its own idea of what constitutes a "word character," as far as word boundaries<a name="IDX-CHP-3-1287"></a> 
 go. It would make sense if the word boundaries agree with <tt>\w</tt>, but that's not always the case. With PHP and <tt>java.util.regex</tt>, for example, <tt>\w</tt> applies only to ASCII characters and not the full breadth of Unicode, so in the table I've used lookaround with the Unicode letter property <tt>\pL</tt> (which is a shorthand for <img src=images/U2308.jpg border=0><tt>\p{L}</tt><img src=images/U230B.jpg border=0><a name="IDX-CHP-3-1288"></a> 
<a name="IDX-CHP-3-1289"></a> 
<a name="IDX-CHP-3-1290"></a> 
 &#9758;121).</p>
<p class="docText">Whatever the word boundaries consider to be "word characters," word boundary tests are always a simple test of adjoining characters. No regex engine actually does linguistic analysis to decide about words: all consider "NE14AD8" to be a word, but not "M.I.T."</P>

<a name="regex3-CHP-3-SECT-5.3.5"></a>
<H5 id="title-IDATPCTH" class="docSection3Title">3.5.3.5. Lookahead <tt>(?=&#8943;), (?!&#8943;)</tt>; Lookbehind, <tt>(?&lt;=&#8943;), (?&lt;!&#8943;)</tt></h5>
<a name="IDX-CHP-3-1291"></a> 
<a name="IDX-CHP-3-1292"></a> 
<a name="IDX-CHP-3-1293"></a> 
<a name="IDX-CHP-3-1294"></a> 
<a name="IDX-CHP-3-1295"></a> 
<a name="IDX-CHP-3-1296"></a> 
<a name="IDX-CHP-3-1297"></a> 
<a name="IDX-CHP-3-1298"></a> 
<a name="IDX-CHP-3-1299"></a> 
<a name="IDX-CHP-3-1300"></a> 
<a name="IDX-CHP-3-1301"></a> 
<a name="IDX-CHP-3-1302"></a> 
<a name="IDX-CHP-3-1303"></a> 
<a name="IDX-CHP-3-1304"></a> 
<a name="IDX-CHP-3-1305"></a> 
<a name="IDX-CHP-3-1306"></a> 
<a name="IDX-CHP-3-1307"></a> 
<a name="IDX-CHP-3-1308"></a> 
<a name="IDX-CHP-3-1309"></a> 
<a name="IDX-CHP-3-1310"></a> 
<a name="IDX-CHP-3-1311"></a> 

<p class="docText">Lookahead and lookbehind<a name="IDX-CHP-3-1312"></a> 
 constructs (collectively, <span class="docEmphasis">lookaround</span>) are discussed with an extended example in the previous chapter's "<a class="docLink" href="regex3-CHP-2-SECT-3.html#regex3-CHP-2-SECT-3.5">Adding Commas to a Number with Lookaround</a>" (&#9758;59). One important issue not discussed there relates to what kind of expression can appear within either of the lookbehind constructs. Most implementations have restrictions about the length of text matchable within lookbehind (but not within lookahead,<a name="IDX-CHP-3-1313"></a> 
 which is unrestricted).</p>
<p class="docText">The most restrictive rule exists in Perl and Python, where the lookbehind can match only fixed-length strings. For example, <tt>(?&lt;!;<span class="docEmphStrong">\w</span>)</tt> and <tt>(?&lt;!<span class="docEmphStrong">this|that</span>)</tt> are allowed, but <tt>(?&lt;!<span class="docEmphStrong">books?</span>)</tt> and <tt>(?&lt;^<span class="docEmphStrong">\w+:</span>)</tt> are not, as they can match a variable amount of text. In some cases, such as with <tt>(?&lt;!<span class="docEmphStrong">books?</span>)</tt>, you can accomplish the same thing by rewriting the expression, as with <img src=images/U2308.jpg border=0><tt>(?&lt;!book)(?&lt;!books)</tt><img src=images/U230B.jpg border=0>, although that's certainly not easy to read at first glance.</p>
<a name="regex3-CHP-3-TABLE-12"></a><p><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><H5 class="docTableTitle">Table 3-12. A Few Utilities and Their Word Boundary Metacharacters</h5></caption><colgroup span="4"><col><col><col><col></colgroup><thead><tr><th class="thead" scope="col" align="left"><p class="docText">Program</P></th><th class="thead" scope="col" align="left"><p class="docText">Start-of-word ... End-of-word</p></th><th class="thead" scope="col" align="left"><p class="docText">Word boundary</p></th><th class="thead" scope="col" align="left"><p class="docText">Not word-boundary</p></th></tr></thead><tr><td class="docTableCell" align="left"><p class="docText">GNU awk</p></td><td class="docTableCell" align="left"><p class="docText"><tt>\&lt; ...\&gt;</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\y</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\B</tt><a name="IDX-CHP-3-1314"></a> 
<a name="IDX-CHP-3-1315"></a> 
</p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText">GNU <span class="docEmphasis">egrep</span></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\&lt; ...\&gt;</tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\b</tt><a name="IDX-CHP-3-1316"></a> 
<a name="IDX-CHP-3-1317"></a> 
</p></TD><td class="docTableCell" align="left"><p class="docText"><tt>\B</tt></p></TD></TR><tr><td class="docTableCell" align="left"><p class="docText">GNU Emacs</P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\&lt; ...\&gt;</tt></p></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\b</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\B</tt></p></TD></tr><tr><TD class="docTableCell" align="left"><p class="docText">Java<a name="IDX-CHP-3-1318"></a> 
</p></td><td class="docTableCell" align="left"><p class="docText"><tt>(?&lt;!\pL)(?=\pL)</tt> ... <tt>(?&lt;=\pL)(?!\pL)</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\b <img src=images/U22A0.jpg border=0></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\B <img src=images/U22A0.jpg border=0></tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">MySQL</p></td><td class="docTableCell" align="left"><p class="docText"><tt>[[:&lt;:]] ... [[:&gt;:]]</tt></P></td><TD class="docTableCell" align="left"><p class="docText">[[:&lt;:]]|[[:&gt;:]]</p></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></TD></TR><tr><TD class="docTableCell" align="left"><p class="docText">.NET<a name="IDX-CHP-3-1319"></a> 
</p></td><TD class="docTableCell" align="left"><p class="docText"><tt>(?&lt;!\w)(?=\w) ... (?&lt;=\w)(?!\w)</tt></P></td><td class="docTableCell" align="left"><p class="docText"><tt>\b</tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\B</tt></p></TD></TR><tr><td class="docTableCell" align="left"><p class="docText">Perl</p></td><TD class="docTableCell" align="left"><p class="docText"><tt>(?&lt;!\w)(?=\w) ... (?&lt;=\w)(?!\w)</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\b</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\B</tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">PHP<a name="IDX-CHP-3-1320"></a> 
<a name="IDX-CHP-3-1321"></a> 
</p></td><td class="docTableCell" align="left"><p class="docText"><tt>(?&lt;!\pL)(?=\pL) ... (?&lt;=\pL)(?!\pL)</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\b <img src=images/U22A0.jpg border=0></tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\B <img src=images/U22A0.jpg border=0></tt></P></td></TR><tr><td class="docTableCell" align="left"><p class="docText">Python</P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>(?&lt;!\w)(?=\w) ... (?&lt;=\w)(?!\w)</tt></P></td><TD class="docTableCell" align="left"><p class="docText"><tt>\b</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\B</tt></P></td></tr><TR><TD class="docTableCell" align="left"><p class="docText">Ruby</P></td><TD class="docTableCell" align="center"><p class="docText">&nbsp;</P></td><td class="docTableCell" align="left"><p class="docText"><tt>\b <img src=images/U22A0.jpg border=0></tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>\B <img src=images/U22A0.jpg border=0></tt></p></td></TR><tr><td class="docTableCell" align="left"><p class="docText">GNU sed</p></td><td class="docTableCell" align="left"><p class="docText">\&lt; ...\&gt;</p></td><td class="docTableCell" align="left"><p class="docText"><tt>\b</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>\B</tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">Tcl</p></TD><td class="docTableCell" align="left"><p class="docText"><tt>\m ... \M</tt></P></td><td class="docTableCell" align="left"><p class="docText"><tt>\y</tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\Y</tt></P></td></TR><tr><td class="docTableCell" align="left" colspan="4"><p class="docText">Items marked with <img src=images/U22A0.jpg border=0> work only with characters in ASCII (or the locale-based 8-bit encoding), even though the flavor otherwise supports Unicode.</P></TD></tr><tr><TD class="docTableCell" align="right" colspan="4"><p class="docText">(See page 91 for version infomation.)</P></TD></tr></table></P><BR>
<p class="docText">The next level of support allows alternatives of different lengths within the look behind, so <tt>(?&lt;<span class="docEmphStrong">!books?</span>)</tt> can be written as <tt>(?&lt;<span class="docEmphStrong">!book|books</span>)</tt>. PCRE (and as such the preg suite in PHP) allows this.</p>
<p class="docText">The next level allows for regular expressions that match a variable amount of text, but only if it's of a finite length. This allows <tt>(?&lt;<span class="docEmphStrong">!books?</span>)</tt> directly, but still disallows<tt>(?&lt;!^<span class="docEmphStrong">\w+:</span>)</tt> since the <tt>\w+</tt> is open-ended. Sun's Java regex package supports this level.</p>
<p class="docText">When it comes down to it, these first three levels of support are really equivalent, since they can all be expressed, although perhaps somewhat clumsily, with the most restrictive fixed-length matching level of support. The intermediate levels are just "syntactic sugar" to allow you to express the same thing in a more pleasing way. The fourth level, however, allows the subexpression within lookbehind<a name="IDX-CHP-3-1322"></a> 
<a name="IDX-CHP-3-1323"></a> 
 to match any amount of text, including the <tt>(?&lt;!^<span class="docEmphStrong">\w+:</span>)</tt> example. This level, supported by Microsoft's .NET languages, is truly superior to the others, but does carry a potentially huge efficiency penalty if used unwisely. (When faced with lookbehind that can match any amount of text, the engine is forced to check the lookbehind subexpression from the start of the string, which may mean a <span class="docEmphasis">lot</span> of wasted effort when requested from near the end of a long string.)</p>


<a name="regex3-CHP-3-SECT-5.4"></a>
<h4 id="title-IDA3CETH" class="docSection2Title">3.5.4. Comments and Mode Modifiers</H4>
<a name="IDX-CHP-3-1324"></a> 
<a name="IDX-CHP-3-1325"></a> 
<a name="IDX-CHP-3-1326"></a> 
<a name="IDX-CHP-3-1327"></a> 
<a name="IDX-CHP-3-1328"></a> 
<a name="IDX-CHP-3-1329"></a> 
<a name="IDX-CHP-3-1330"></a> 
<a name="IDX-CHP-3-1331"></a> 
<a name="IDX-CHP-3-1332"></a> 
<a name="IDX-CHP-3-1333"></a> 
<a name="IDX-CHP-3-1334"></a> 
<a name="IDX-CHP-3-1335"></a> 

<p class="docText">With many flavors, the regex modes and match modes described earlier (&#9758;110) can be modified within the regex (on the fly, so to speak) by the following constructs.</p>
<a name="regex3-CHP-3-SECT-5.4.1"></a>
<h5 id="title-IDAYEETH" class="docSection3Title">3.5.4.1. Mode modifier: <tt>(?modifier)</tt>, such as <tt>(?i)</tt> or <tt>(?-i)</tt></H5>
<p class="docText">Many flavors now allow some of the regex and match modes (&#9758;110) to be set within the regular expression itself. A common example is the special notation <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">(?i)</span></tt><img src=images/U230B.jpg border=0>, which turns on case-insensitive matching, and <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">(?-i)</span></tt><img src=images/U230B.jpg border=0>, which turns it off. For example, <img src=images/U2308.jpg border=0><tt>&lt;B&gt;(?i)very(?-i)&lt;/B&gt;</tt><img src=images/U230B.jpg border=0> has the <img src=images/U2308.jpg border=0><tt>very</tt><img src=images/U230B.jpg border=0> part match with case insensitivity, while still keeping the tag names case-sensitive. This matches '<tt>&lt;B&gt;VERY&lt;/B&gt;</tt>' and '<tt>&lt;B&gt;Very&lt;/B&gt;</tt>', for example, but not '<tt>&lt;b&gt;Very&lt;/b&gt;</tt>'.</p>
<p class="docText">This example works with most systems that support <img src=images/U2308.jpg border=0><tt>(?i)</tt><img src=images/U230B.jpg border=0>, including Perl, PHP, <tt>java.util.regex</tt>, Ruby,<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-FN-15">[<img src=images/U2020.jpg border=0>]</a></sup> and the .NET languages. It doesn't work with Python or Tcl, neither of which support <img src=images/U2308.jpg border=0><tt>(?-i)</tt><img src=images/U230B.jpg border=0>.</p><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-FN-15">[<img src=images/U2020.jpg border=0>]</a></sup> The example works with Ruby, but note that Ruby's <tt><span class="docEmphStrong">(?i)</span></tt> has a bug whereby it sometimes doesn't work with <img src=images/U2308.jpg border=0><tt>|</tt><img src=images/U230B.jpg border=0>-separated alternatives that are lowercase (but does if they're uppercase).</p></blockquote>
<p class="docText">With most implementations except Python, the effects of <img src=images/U2308.jpg border=0><tt>(?i)</tt><img src=images/U230B.jpg border=0> within any type of parentheses are limited by the parentheses (that is, turn off at the closing parentheses). So, the <img src=images/U2308.jpg border=0><tt>(?-i)</tt><img src=images/U230B.jpg border=0> can be eliminated by wrapping the case-insensitive part in parentheses and putting <img src=images/U2308.jpg border=0><tt>(?i)</tt><img src=images/U230B.jpg border=0> as the first thing inside: <img src=images/U2308.jpg border=0><tt>&lt;B&gt;<span class="docEmphStrong">(?:</span>(?i)very<span class="docEmphStrong">)</span>&lt;/B&gt;</tt><img src=images/U230B.jpg border=0>.</p>
<p class="docText">The mode-modifier constructs support more than just '<tt>i</tt>'. With most systems, you can use at least those shown in <a class="docLink" href="#regex3-CHP-3-TABLE-13">Table 3-13</a>. Some systems have additional letters for additional functions. PHP, in particular, offers quite a few extra (&#9758;446), as does Tcl (see its documentation).</p>
<a name="regex3-CHP-3-TABLE-13"></a><p><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><h5 class="docTableTitle">Table 3-13. Common Mode Modifiers</h5></caption><colgroup span="2"><col><col></colgroup><thead><tr><th class="thead" scope="col" align="left"><p class="docText">Letter</p></th><th class="thead" scope="col" align="left"><p class="docText">Mode</p></th></tr></thead><tr><td class="docTableCell" align="left"><p class="docText"><tt>i</tt></p></td><td class="docTableCell" align="left"><p class="docText">case-insensitivity match mode (&#9758;110)</P></td></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>x</tt></P></TD><TD class="docTableCell" align="left"><p class="docText">free-spacing and comments regex mode (&#9758;111)</P></td></TR><tr><td class="docTableCell" align="left"><p class="docText"><tt>s</tt></P></TD><td class="docTableCell" align="left"><p class="docText">dot-matches-all match mode (&#9758;111)</p></TD></TR><TR><td class="docTableCell" align="left"><p class="docText"><tt>m</tt></P></TD><td class="docTableCell" align="left"><p class="docText">enhanced line-anchor match mode (&#9758;112)</p></td></tr></table></P><br>

<a name="regex3-CHP-3-SECT-5.4.2"></a>
<h5 id="title-IDAKKETH" class="docSection3Title">3.5.4.2. Mode-modified span: <tt>(?modifier :&#8943;)</tt>, such as <tt>(?i:&#8943;)</tt></H5>
<p class="docText">The example from the previous section can be made even simpler for systems that support a mode-modified span.<a name="IDX-CHP-3-1336"></a> 
 Using a syntax like <img src=images/U2308.jpg border=0><tt>(?i:&#8943;)</tt><img src=images/U230B.jpg border=0>, a mode-modified span turns on the mode only for what's matched within the parentheses. Using this, the <img src=images/U2308.jpg border=0><tt>&lt;B&gt;<span class="docEmphStrong">(?:(?i)</span>very<span class="docEmphStrong">)</span>&lt;/B&gt;</tt><img src=images/U230B.jpg border=0> example is simplified to <img src=images/U2308.jpg border=0><tt>&lt;B&gt;<span class="docEmphStrong">(?i:</span>very<span class="docEmphStrong">)</span>&lt;/B&gt;</tt><img src=images/U230B.jpg border=0>. When supported, this form generally works for all mode-modifier letters the system supports. Tcl and Python are two examples that support the <img src=images/U2308.jpg border=0><tt>(?i)</tt><img src=images/U230B.jpg border=0> form, but not the mode-modified span <img src=images/U2308.jpg border=0><tt>(?i:&#8943;)</tt><img src=images/U230B.jpg border=0> form.</p>

<a name="regex3-CHP-3-SECT-5.4.3"></a>
<h5 id="title-IDAYLETH" class="docSection3Title">3.5.4.3. Comments: <tt>(?#&#8943;)</tt>and <tt>#&#8943;</tt></h5>
<a name="IDX-CHP-3-1337"></a> 

<a name="IDX-CHP-3-1338"></a> 
<a name="IDX-CHP-3-1339"></a> 
<a name="IDX-CHP-3-1340"></a> 
<a name="IDX-CHP-3-1341"></a> 
<a name="IDX-CHP-3-1342"></a> 
<a name="IDX-CHP-3-1343"></a> 

<p class="docText">Some flavors support comments<a name="IDX-CHP-3-1344"></a> 
 via <img src=images/U2308.jpg border=0><tt>(?#&#8943;)</tt><img src=images/U230B.jpg border=0>. In practice, this is rarely used, in favor of the free-spacing and comments regex mode (&#9758;111). However, this type of comment is particularly useful in languages for which it's difficult to get a newline into a string literal, such as VB.NET (&#9758;99, 420).</p>

<a name="regex3-CHP-3-SECT-5.4.4"></a>
<h5 id="title-IDAMNETH" class="docSection3Title">3.5.4.4. Literal-text span: <tt>\Q&#8943;\E</tt></h5>
<p class="docText">First introduced with Perl, the special sequence <tt>\Q&#8943;\E</tt> turns off all regex metacharacters between them, except for <tt>\E</tt> itself. (If the <tt>\E</tt> is omitted, they are turned off until the end of the regex.) It allows what would otherwise be taken as normal metacharacters to be treated as literal text. This is especially useful when including the contents of a variable while building a regular expression.</p>
<p class="docText">For example, to respond to a web search, you might accept what the user types as <tt>$query</tt>, and search for it with <tt>m/$query/i</tt>. As it is, this would certainly have unexpected results if <tt>$query</tt> were to contain, say, '<tt>C:\WINDOWS\</tt>', which results in a run-time error because the search term contains something that isn't a valid regular expression (the trailing lone backslash).</p>
<p class="docText"><img src=images/U2308.jpg border=0><tt>\Q&#8943;\E</tt><img src=images/U230B.jpg border=0> avoids the problem. With the Perl code <tt>m/\Q$query\E/i</tt>, a <tt>$query</tt> of '<tt>C:\WINDOWS\</tt>' becomes <img src=images/U2308.jpg border=0><tt>C\:\\WINDOWS\\</tt><img src=images/U230B.jpg border=0>, resulting in a search that finds the original '<tt>C:\WINDOWS\</tt>' as the user expects.</p>
<p class="docText">This feature is less useful in systems with procedural and object-oriented handling (&#9758;95), as they accept normal strings. While building the string to be used as a regular expression, it's fairly easy to call a function to make the value from the variable "safe" for use in a regular expression. In VB, for example, one would use the <tt>Regex.Escape</tt><a name="IDX-CHP-3-1345"></a> 
 method (&#9758;432); PHP has the <tt>preg_quote</tt><a name="IDX-CHP-3-1346"></a> 
 function (&#9758;470); Java has a <tt>quote</tt> method (&#9758;395).</p>
<p class="docText">The only regex engines that I know of that support <img src=images/U2308.jpg border=0><tt>\Q&#8943;\E</tt><img src=images/U230B.jpg border=0> are <tt>java.util.regex</tt> and PCRE (and hence also PHP's preg suite). Considering that I just mentioned that this was introduced with Perl (and I gave an example in Perl), you might wonder why I don't include Perl in the list. Perl supports <tt>\Q&#8943;\E</tt> within regex <span class="docEmphasis">literals</span> (regular expressions appearing directly in the program), but not within the contents of variables that might be interpolated into them. See <a class="docLink" href="regex3-CHP-7.html#regex3-CHP-7">Chapter 7</a> (&#9758;290) for details.</p>
<p class="docText">The <tt>java.util.regex</tt> support for <img src=images/U2308.jpg border=0><tt>\Q&#8943;\E</tt><img src=images/U230B.jpg border=0> within a character class, prior to Java 1.6.0, is buggy and shouldn't be relied upon.</p>


<a name="regex3-CHP-3-SECT-5.5"></a>
<h4 id="title-IDADQETH" class="docSection2Title">3.5.5. Grouping, Capturing, Conditionals, and Control</h4>
<a name="IDX-CHP-3-1347"></a> 
<a name="IDX-CHP-3-1348"></a> 

<a name="regex3-CHP-3-SECT-5.5.1"></a>
<h5 id="title-IDARQETH" class="docSection3Title">3.5.5.1. Capturing/Grouping Parentheses: <tt>(&#8943;)</tt> and <tt>\1, \2, ...</tt></h5>
<p class="docText">Common, unadorned parentheses generally perform two functions, grouping and capturing.<a name="IDX-CHP-3-1349"></a> 
 Common parentheses are almost always of the form <img src=images/U2308.jpg border=0><tt>(&#8943;)</tt><img src=images/U230B.jpg border=0>, but a few flavors use <img src=images/U2308.jpg border=0><tt>\(&#8943;\)</tt><img src=images/U230B.jpg border=0>.<a name="IDX-CHP-3-1350"></a> 
 These include GNU Emacs, <span class="docEmphasis">sed</span>, <span class="docEmphasis">vi</span>, and <span class="docEmphasis">grep</span>.</p>
<p class="docText">Capturing parentheses are numbered by counting their opening parentheses from the left, as shown in figures on pages 41, 43, and 57. If <span class="docEmphasis">backreferences</span><a name="IDX-CHP-3-1351"></a> 
 are available, the text matched via an enclosed subexpression can itself be matched later in the same regular expression with <img src=images/U2308.jpg border=0><tt>\1</tt><img src=images/U230B.jpg border=0>, <img src=images/U2308.jpg border=0><tt>\2</tt><img src=images/U230B.jpg border=0>, etc.</P>
<p class="docText">One of the most common uses of parentheses is to pluck data from a string. The text matched by a parenthesized subexpression (also called "the text matched by the parentheses") is made available after the match in different ways by different programs, such as Perl's <tt>$1</tt>,<a name="IDX-CHP-3-1352"></a> 
<a name="IDX-CHP-3-1353"></a> 
 <tt>$2</tt>, etc. (A common mistake is to try to use the <img src=images/U2308.jpg border=0><tt>\1</tt><img src=images/U230B.jpg border=0> syntax <span class="docEmphasis">outside</span> the regular expression; something allowed only with <span class="docEmphasis">sed</span> and <span class="docEmphasis">vi</span>.) <a class="docLink" href="#regex3-CHP-3-TABLE-14">Table 3-14</a> on the next page shows how a number of programs make the captured text available after a match. It shows how to access the text matched by the whole expression, and the text matched within a set of capturing parentheses.</p>

<a name="regex3-CHP-3-SECT-5.5.2"></a>
<H5 id="title-IDA0SETH" class="docSection3Title">3.5.5.2. Grouping-only parentheses: <tt>(?:&#8943;)</tt></h5>
<p class="docText">Grouping-only parentheses <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">(?:</span>&#8943;<span class="docEmphStrong">)</span></tt><img src=images/U230B.jpg border=0> don't capture, but, as the name implies, group regex components for alternation and the application of quantifiers. They are not counted as part of <tt>$1</tt>, <tt>$2</tt>, etc. After a match of <img src=images/U2308.jpg border=0><tt>(1|one)<span class="docEmphStrong">(?:</span>and|or)(2|two<span class="docEmphStrong">)</span></tt><img src=images/U230B.jpg border=0>, for example, <tt>$1</tt> contains '<tt>1</tt>' or '<tt>one</tt>', while <tt>$2</tt> contains '<tt>2</tt>' or '<tt>two</tt>'. Grouping-only parentheses are also called <span class="docEmphasis">non-capturing</span><a name="IDX-CHP-3-1354"></a> 
 parentheses.</p>
<p class="docText">Non-capturing parentheses are useful for a number of reasons. They can help make the use of a complex regex clearer in that the reader doesn't need to wonder if what's matched by what they group is accessed elsewhere by <tt>$1</tt> or the like. Also, they can be more efficient. If the regex engine doesn't need to keep track of the text matched for capturing purposes, it can work faster and use less memory. (Efficiency is covered in detail in <a class="docLink" href="regex3-CHP-6.html#regex3-CHP-6">Chapter 6</a>.)</P>
<p class="docText">Non-capturing parentheses are useful when building up a regex from parts. Recall the example from page 76 in which the variable <tt>$HostnameRegex</tt><a name="IDX-CHP-3-1355"></a> 
<a name="IDX-CHP-3-1356"></a> 
 holds a regex to match a hostname.<a name="IDX-CHP-3-1357"></a> 
 Imagine using that to pluck out the whitespace around a hostname, as in the Perl snippet <tt><span class="docEmphStrong">m/</span>(\s*)$HostnameRegex(\s*)<span class="docEmphStrong">/</span></tt>. After this, you might expect <tt>$1</tt> and <tt>$2</tt> to hold the leading and trailing whitespace, but the trailing whitespace is actually in <tt>$4</tt> because <tt>$HostnameRegex</tt> contains two sets of <span class="docEmphasis">capturing</span> parentheses:</P>
<pre>
    $HostnameRegex = qr/[-a-z0-9]+(\.[-a-z0-9]+)*\.(com|edu|info)/i;
</pre><BR>

<a name="regex3-CHP-3-TABLE-14"></a><P><table cellspacing="0" FRAME="hsides" RULES="all" cellpadding="4" width="100%"><caption><h5 class="docTableTitle">Table 3-14. A Few Utilities and Their Access to Captured Text</H5></caption><colgroup span="3"><col><col><col></colgroup><thead><tr><th class="thead" scope="col" align="left"><p class="docText">Program</p></th><th class="thead" scope="col" align="left"><p class="docText">Entire match</P></th><th class="thead" scope="col" align="left"><p class="docText">First set of parentheses</P></th></tr></thead><tr><TD class="docTableCell" align="left"><p class="docText">GNU <span class="docEmphasis">egrep</span></P></TD><td class="docTableCell" align="left"><p class="docText">N/A</P></TD><td class="docTableCell" align="left"><p class="docText">N/A</p></td></tr><TR><td class="docTableCell" align="left"><p class="docText">GNU Emacs</p></TD><td class="docTableCell" align="left"><p class="docText"><tt>(match-string 0)</tt> (\&amp; within replacement string)</p></td><td class="docTableCell" align="left"><p class="docText"><tt>(match-string 1)</tt> (\1<a name="IDX-CHP-3-1358"></a> 
<a name="IDX-CHP-3-1359"></a> 
 within replacement string)</p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">GNU awk</p></td><td class="docTableCell" align="left"><p class="docText"><tt>substr($text, RSTART, RLENGTH)</tt> (\&amp; within replacement string)</p></td><td class="docTableCell" align="left"><p class="docText">\1 (within gensub replacement)</p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText">MySQL</p></td><TD class="docTableCell" align="left"><p class="docText">N/A</P></TD><TD class="docTableCell" align="left"><p class="docText">N/A</p></TD></tr><tr><TD class="docTableCell" align="left"><p class="docText">Perl &#9758;41</P></td><td class="docTableCell" align="left"><p class="docText"><tt>$&amp;</tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>$1</tt></p></TD></TR><tr><td class="docTableCell" align="left"><p class="docText">PHP<a name="IDX-CHP-3-1360"></a> 
 &#9758;450</p></td><TD class="docTableCell" align="left"><p class="docText"><tt>$<span class="docEmphasis">matches</span>[0]</tt></p></td><TD class="docTableCell" align="left"><p class="docText"><tt>$<span class="docEmphasis">matches</span>[1]</tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">Python &#9758;97</p></td><td class="docTableCell" align="left"><p class="docText"><tt><span class="docEmphasis">MatchObj</span>.group(0)</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt><span class="docEmphasis">MatchObj</span>.group(1)</tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">Ruby</p></TD><td class="docTableCell" align="left"><p class="docText"><tt>$&amp;</tt></P></td><td class="docTableCell" align="left"><p class="docText">$1</P></TD></TR><TR><td class="docTableCell" align="left"><p class="docText">GNU sed</P></td><td class="docTableCell" align="left"><p class="docText">&amp; (<tt>in replacement string only</tt>)</P></TD><td class="docTableCell" align="left"><p class="docText"><tt>\1</tt> (in replacement and regex only)</p></TD></TR><TR><td class="docTableCell" align="left"><p class="docText">Java<a name="IDX-CHP-3-1361"></a> 
 &#9758;95</P></TD><td class="docTableCell" align="left"><p class="docText"><tt><span class="docEmphasis">MatcherObj</span>.group()</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt>MatcherObj.group(1)</tt></P></td></tr><TR><td class="docTableCell" align="left"><p class="docText">Tcl</p></td><td class="docTableCell" align="left" colspan="2"><p class="docText"><tt>set to user-selected variables via regexp command</tt></p></td></tr><tr><td class="docTableCell" align="left"><p class="docText">VB.NET &#9758;96</p></td><td class="docTableCell" align="left"><p class="docText"><tt><span class="docEmphasis">MatchObj</span>.Groups(0)</tt></p></td><td class="docTableCell" align="left"><p class="docText"><tt><span class="docEmphasis">MatchObj</span>.Groups(1)</tt></p></td></TR><tr><TD class="docTableCell" align="left"><p class="docText">C#</p></td><TD class="docTableCell" align="left"><p class="docText"><tt><span class="docEmphasis">MatchObj</span>.Groups[0]</tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt><span class="docEmphasis">MatchObj</span>.Groups[1]</tt></p></TD></tr><tr><TD class="docTableCell" align="left"><p class="docText">vi</P></td><td class="docTableCell" align="left"><p class="docText"><tt>&amp;</tt></P></TD><TD class="docTableCell" align="left"><p class="docText"><tt>\1</tt></p></TD></TR><tr><td class="docTableFooter" align="right" valign="top" colspan="3"><p class="docText">(See page 91 for version information.)</p></td></TR></table></p><br>
<p class="docText">Were those sets of parentheses non-capturing instead, <tt>$HostnameRegex</tt> could be used without generating this surprise. Another way to avoid the surprise, although not available in Perl, is to use named capture,<a name="IDX-CHP-3-1362"></a> 
<a name="IDX-CHP-3-1363"></a> 
 discussed next.</P>

<a name="regex3-CHP-3-SECT-5.5.3"></a>
<h5 id="title-IDAJBFTH" class="docSection3Title">3.5.5.3. Named capture: <tt>(?&lt;Name&gt;&#8943;)</tt></h5>
<a name="IDX-CHP-3-1364"></a> 
<a name="IDX-CHP-3-1365"></a> 
<a name="IDX-CHP-3-1366"></a> 
<a name="IDX-CHP-3-1367"></a> 
<a name="IDX-CHP-3-1368"></a> 
<a name="IDX-CHP-3-1369"></a> 
<a name="IDX-CHP-3-1370"></a> 
<a name="IDX-CHP-3-1371"></a> 
<a name="IDX-CHP-3-1372"></a> 
<a name="IDX-CHP-3-1373"></a> 
<a name="IDX-CHP-3-1374"></a> 
<a name="IDX-CHP-3-1375"></a> 
<a name="IDX-CHP-3-1376"></a> 
<a name="IDX-CHP-3-1377"></a> 
<a name="IDX-CHP-3-1378"></a> 
<a name="IDX-CHP-3-1379"></a> 
<a name="IDX-CHP-3-1380"></a> 
<a name="IDX-CHP-3-1381"></a> 

<p class="docText">Python, PHP's preg engine, and .NET<a name="IDX-CHP-3-1382"></a> 
 languages support captures to named locations. Python and PHP use the syntax <img src=images/U2308.jpg border=0><tt>(?P&lt;name&gt;&#8943;)</tt><img src=images/U230B.jpg border=0>, while the .NET languages use <img src=images/U2308.jpg border=0><tt>(?&lt;name&gt;&#8943;)</tt><img src=images/U230B.jpg border=0>, a syntax that I prefer. Here's an example for .NET:</p>
<pre>
    <img src=images/U2308.jpg border=0> \b<span class="docEmphStrong">(?&lt;Area&gt;</span>\d\d\d\)-<span class="docEmphStrong">(?&lt;Exch&gt;</span>\d\d\d<span class="docEmphStrong">)</span>-<span class="docEmphStrong">(?&lt;Num&gt;</span>\d\d\d\d<span class="docEmphStrong">)</span>\b<img src=images/U230B.jpg border=0>
</pre><br>

<p class="docText">and for Python/PHP:</p>
<pre>
    <img src=images/U2308.jpg border=0>\b<span class="docEmphStrong">(?P&lt;Area&gt;</span>\d\d\d\)-<span class="docEmphStrong">(?P&lt;Exch&gt;</span>\d\d\d)-<span class="docEmphStrong">(?P&lt;Num&gt;</span>\d\d\d\d)\b<img src=images/U230B.jpg border=0>
</pre><br>

<p class="docText">This "fills the names" <span class="docEmphasis">Area</span>, <span class="docEmphasis">Exch</span>, and <span class="docEmphasis">Num</span> with the components of a US phone number. The program can then refer to each matched substring through its name, for example, <tt><span class="docEmphasis">RegexObj.Groups</span>("Area")</tt> in VB.NET and most other .NET languages, <tt><span class="docEmphasis">RegexObj.Groups</span>["Area"]</tt> in C#, <span class="docEmphasis">RegexObj</span>.<tt>group("Area")</tt> in Python, and <span class="docEmphasis">$matches</span><tt>["Area"]</tt> in PHP. The result is clearer code.</p>
<p class="docText">Within the regular expression itself, the captured text is available via <img src=images/U2308.jpg border=0><tt>\k&lt;Area&gt;</tt><img src=images/U230B.jpg border=0> with .NET, and <img src=images/U2308.jpg border=0><tt>(?P=Area)</tt><img src=images/U230B.jpg border=0> in Python and PHP.</p>
<p class="docText">With Python and .NET (but not with PHP), you can use the same name more than once within the same expression. For example, to match the area code part of a US phone number, which look like '<tt>(###)</tt>' or '<tt>###-</tt>', you might use (shown in .NET syntax): <img src=images/U2308.jpg border=0><tt>&#8943;<span class="docEmphStrong">(?:</span>\((?&lt;Area&gt;\d\d\d)\)|(?&lt;Area&gt;\d\d\d)-<span class="docEmphStrong">)</span>&#8943;</tt><img src=images/U230B.jpg border=0>. When either set matches, the three-digit code is saved to the name <span class="docEmphasis">Area</span>.</p>

<a name="regex3-CHP-3-SECT-5.5.4"></a>
<h5 id="title-IDASHFTH" class="docSection3Title">3.5.5.4. Atomic grouping: <tt>(?&gt;&#8943;)</tt></h5>
<a name="IDX-CHP-3-1383"></a> 
<a name="IDX-CHP-3-1384"></a> 
<a name="IDX-CHP-3-1385"></a> 
<a name="IDX-CHP-3-1386"></a> 

<p class="docText">Atomic grouping, <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">(?&gt;</span>&#8943;<span class="docEmphStrong">)</span></tt><img src=images/U230B.jpg border=0>, will be very easy to explain once the important details of how the regex engine carries out its work is understood (&#9758;169). Here, I'll just say that once the parenthesized subexpression matches, what it matches is fixed (becomes atomic, unchangeable) for the rest of the match, unless it turns out that the whole set of atomic parentheses needs to be abandoned and subsequently revisited. A simple example helps to illustrate this indivisible, "atomic" nature of text matched by these parentheses.</p>
<p class="docText">The string '<tt>&#161;Hola!</tt>' is matched by <img src=images/U2308.jpg border=0><tt>&#161;.*!</tt><img src=images/U230B.jpg border=0>, but is not matched if <img src=images/U2308.jpg border=0> <tt>.*</tt><img src=images/U230B.jpg border=0> is wrapped with atomic grouping, <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">&#161;(?&gt;.*)!</span></tt><img src=images/U230B.jpg border=0>. In either case, <img src=images/U2308.jpg border=0> <tt>.*</tt><img src=images/U230B.jpg border=0> first internally matches as much as it can ('&#161;<img border="0" alt="" width="40" height="13" SRC="images/regex3_u0319.jpg">'), but the inability of the subsequent <img src=images/U2308.jpg border=0><tt>!</tt><img src=images/U230B.jpg border=0> to match wants to force the <img src=images/U2308.jpg border=0> <tt>.*</tt><img src=images/U230B.jpg border=0> to give up some of what it had matched (the final '!'). That can't happen in the second case because <img src=images/U2308.jpg border=0> <tt>.*</tt><img src=images/U230B.jpg border=0> is inside atomic grouping, which never "gives up" anything once the matching leaves them.</p>
<p class="docText">Although this example doesn't hint at it, atomic grouping has important uses. In particular, it can help make matching more efficient (&#9758;171), and can be used to finely control what can and can't be matched (&#9758;269).</p>

<a name="regex3-CHP-3-SECT-5.5.5"></a>
<h5 id="title-IDAZJFTH" class="docSection3Title">3.5.5.5. Alternation: <tt>&#8943;| &#8943; | &#8943;</tt></h5>
<p class="docText">Alternation allows several subexpressions to be tested at a given point. Each subexpression is called an <span class="docEmphasis">alternative</span>. The <img src=images/U2308.jpg border=0><tt>|</tt><img src=images/U230B.jpg border=0> symbol is called various things, but <span class="docEmphasis">or</span> and <span class="docEmphasis">bar</span> seem popular. Some flavors use <img src=images/U2308.jpg border=0><tt>\|</tt><img src=images/U230B.jpg border=0> instead.</p>
<p class="docText">Alternation has very low precedence, so <img src=images/U2308.jpg border=0><tt>this and|or that</tt><img src=images/U230B.jpg border=0> matches the same as <img src=images/U2308.jpg border=0><tt>(this and)|(or that)</tt><img src=images/U230B.jpg border=0>, and not <img src=images/U2308.jpg border=0><tt>this (and|or) that</tt><img src=images/U230B.jpg border=0>, even though visually, the <tt>and|or</tt> looks like a unit.</P>
<p class="docText">Most flavors allow an empty alternative, as in <img src=images/U2308.jpg border=0><tt>(this|that|<sub><img src=images/U22CF.jpg border=0></sub>)</tt><img src=images/U230B.jpg border=0>. The empty subexpression can always match, so this example is comparable to <img src=images/U2308.jpg border=0><tt>(this|that)?</tt><img src=images/U230B.jpg border=0>.<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-FN-16">[]</a></sup></p><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-FN-16">[]</a></sup> To be pedantic, <img src=images/U2308.jpg border=0><tt>(this|that|)</tt><img src=images/U230B.jpg border=0> is logically comparable to <img src=images/U2308.jpg border=0><tt>((?:this|that)?)</tt><img src=images/U230B.jpg border=0>. The minor difference from <img src=images/U2308.jpg border=0><tt>(this|that)?</tt><img src=images/U230B.jpg border=0> is that a "nothingness match" is not <span class="docEmphasis">within</span> the parentheses, a subtle difference important to tools that differentiate between a match of nothing and non-participation in the match.</P></blockquote>
<p class="docText">The POSIX standard disallows an empty alternative, as does <span class="docEmphasis">lex</span> and most versions of awk. I think it's useful for its notational convenience or clarity. As Larry Wall told me once, "It's like having a zero in your numbering system."</p>

<a name="regex3-CHP-3-SECT-5.5.6"></a>
<h5 id="title-IDAVLFTH" class="docSection3Title">3.5.5.6. Conditional: <tt>(?if then |else)</tt></H5>
<a name="IDX-CHP-3-1387"></a> 
<a name="IDX-CHP-3-1388"></a> 
<a name="IDX-CHP-3-1389"></a> 
<a name="IDX-CHP-3-1390"></a> 
<a name="IDX-CHP-3-1391"></a> 
<a name="IDX-CHP-3-1392"></a> 

<p class="docText">This construct allows you to express an if/then/else within a regex. The <span class="docEmphasis">if</span> part is a special kind of conditional<a name="IDX-CHP-3-1393"></a> 
<a name="IDX-CHP-3-1394"></a> 
 expression discussed in a moment. Both the <span class="docEmphasis">then</span> and <span class="docEmphasis">else</span> parts are normal regex subexpressions. If the <span class="docEmphasis">if</span> part tests true, the <span class="docEmphasis">then</span> expression is attempted. Otherwise, the <span class="docEmphasis">else</span> part is attempted. (The <span class="docEmphasis">else</span> part may be omitted, and if so, the '<tt>|</tt>' before it may be omitted as well.)</P>
<p class="docText">The kinds of <span class="docEmphasis">if</span> tests available are flavor-dependent, but most implementations allow at least special references to capturing subexpressions and lookaround.</P>
<p class="docText"><span class="docEmphStrong">Using a special reference to capturing parentheses as the test</span>. If the <span class="docEmphasis">if</span> part is a number in parentheses, it evaluates to "true" if that numbered set of capturing parentheses has participated in the match to this point. Here's an example that matches an <tt>&lt;IMG&gt;</tt> HTML tag, either alone, or surrounded by <tt>&lt;A&gt;&#8943;&lt;/A&gt;</tt> link tags. It's shown in a free-spacing mode with comments, and the conditional construct (which in this example has no <span class="docEmphasis">else</span> part) is bold:</P>
<pre>
    ( &lt;A\s+[^&gt;]+&gt; \s* )? # <span class="docEmphasis">Match leading &lt;A&gt; tag, if there</span>.
    &lt;IMG\s+[^&gt;]+&gt;        # <span class="docEmphasis">Match &lt;IMG&gt; tag</span>.
    (?(1)\s*&lt;/A&gt;)           # <span class="docEmphasis">Match a closing &lt;/A&gt;, if we'd matched an &lt;A&gt; before</span>.
</pre><br>

<p class="docText">The (1) in <img src=images/U2308.jpg border=0><tt>(?<span class="docEmphStrong">(1)</span>&#8943;)</tt><img src=images/U230B.jpg border=0> tests whether the first set of capturing parentheses participated in the match. "Participating in the match" is very different from "actually matched some text," as a simple example illustrates...</P>
<p class="docText">Consider these two approaches to matching a word optionally wrapped in "&lt;&#8943;&gt;": <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">(</span>&lt;<span class="docEmphStrong">)?</span>\w+<span class="docEmphStrong">(?(1)</span>&gt;<span class="docEmphStrong">)</span></tt><img src=images/U230B.jpg border=0> works, but <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">(</span>&lt;?<span class="docEmphStrong">)</span>\w+<span class="docEmphStrong">(?(1)</span>&gt;<span class="docEmphStrong">)</span></tt><img src=images/U230B.jpg border=0> does not. The only difference between them is the location of the first question mark. In the first (correct) approach, the question mark governs the capturing parentheses, so the parentheses (and all they contain) are optional.<a name="IDX-CHP-3-1395"></a> 
<a name="IDX-CHP-3-1396"></a> 
 In the flawed second approach, the capturing parentheses are not optional  only the <img src=images/U2308.jpg border=0><tt>&lt;</tt><img src=images/U230B.jpg border=0> matched <span class="docEmphasis">within</span> them is, so they "participate in the match" regardless of a '&lt;' being matched or not. This means that the <span class="docEmphasis">if</span> part of <img src=images/U2308.jpg border=0><tt>(?(1)&#8943;)</tt><img src=images/U230B.jpg border=0> always tests "true."</p>
<p class="docText">If named capture (&#9758;138) is supported, you can generally use the name in parentheses instead of the number.</p>
<p class="docText"><span class="docEmphStrong">Using lookaround as the test</span>. A full lookaround construct, such as <img src=images/U2308.jpg border=0><tt>(?=&#8943;)</tt><img src=images/U230B.jpg border=0> and <img src=images/U2308.jpg border=0><tt>(?&lt;=&#8943;)</tt><img src=images/U230B.jpg border=0>, can be used as the <span class="docEmphasis">if</span> test. If the lookaround matches, it evaluates to "true," and so the <span class="docEmphasis">then</span> part is attempted. Otherwise, the <span class="docEmphasis">else</span> part is attempted. A somewhat contrived example that illustrates this is <img src=images/U2308.jpg border=0><tt><span class="docEmphStrong">(?</span><img border="0" alt="" width="75" height="13" SRC="images/regex3_u0320.jpg">\d+|\w+)</tt><img src=images/U230B.jpg border=0>, which attempts <img src=images/U2308.jpg border=0><tt>\d+</tt><img src=images/U230B.jpg border=0> at positions just after <img src=images/U2308.jpg border=0><tt>NUM:</tt><img src=images/U230B.jpg border=0>, but attempts <img src=images/U2308.jpg border=0><tt>\w+</tt><img src=images/U230B.jpg border=0> at other positions. The lookbehind conditional is underlined.</P>
<p class="docText"><span class="docEmphStrong"><span class="docEmphasis">Other tests for the conditional</span></span>. Perl adds an interesting twist to this conditional construct by allowing arbitrary Perl code to be executed as the test. The return value of the code is the test's value, indicating whether the <span class="docEmphasis">then</span> or <span class="docEmphasis">else</span> part should be attempted. This is covered in <a class="docLink" href="regex3-CHP-7.html#regex3-CHP-7">Chapter 7</a>, on page 327.</P>

<a name="regex3-CHP-3-SECT-5.5.7"></a>
<h5 id="title-IDAJSFTH" class="docSection3Title">3.5.5.7. Greedy quantifiers: <tt>*, +, ?, {num,num}</tt></h5>
<a name="IDX-CHP-3-1397"></a> 
<a name="IDX-CHP-3-1398"></a> 
<a name="IDX-CHP-3-1399"></a> 
<a name="IDX-CHP-3-1400"></a> 
<a name="IDX-CHP-3-1401"></a> 
<a name="IDX-CHP-3-1402"></a> 

<p class="docText">The quantifiers (star, plus, question mark, and intervalsmetacharacters that affect the <span class="docEmphasis">quantity</span> of what they govern) have already been discussed extensively. However, note that in some tools, <img src=images/U2308.jpg border=0><tt>\+</tt><img src=images/U230B.jpg border=0><a name="IDX-CHP-3-1403"></a> 
 and <img src=images/U2308.jpg border=0><tt>\?</tt><img src=images/U230B.jpg border=0><a name="IDX-CHP-3-1404"></a> 
 are used instead of <img src=images/U2308.jpg border=0><tt>+</tt><img src=images/U230B.jpg border=0> and <img src=images/U2308.jpg border=0><tt>?</tt><img src=images/U230B.jpg border=0>. Also, with some older tools, quantifiers can't be applied to a backreference or to a set of parentheses.</P>
<a name="regex3-CHP-3-SECT-5.5.7.1"></a>
<H5 id="title-IDADUFTH" class="docSection4Title">3.5.5.7.1. Intervals <tt>{min,max}or \{min,max \}</tt></H5>
<p class="docText">Intervals can be considered a "counting quantifier"<a name="IDX-CHP-3-1405"></a> 
<a name="IDX-CHP-3-1406"></a> 
 because you specify exactly the minimum number of matches you wish to <span class="docEmphasis">require</span>, and the maximum number of matches you wish to <span class="docEmphasis">allow</span>. If only a single number is given (such as in <img src=images/U2308.jpg border=0><tt>[a-z]{3}</tt><img src=images/U230B.jpg border=0> or <img src=images/U2308.jpg border=0><tt>[a-z]\{3\}</tt><img src=images/U230B.jpg border=0>, depending upon the flavor), it matches exactly that many of the item. This example is the same as <img src=images/U2308.jpg border=0><tt>[a-z][a-z][a-z]</tt><img src=images/U230B.jpg border=0> (although one may be more or less efficient than the other &#9758;251).</p>
<p class="docText">One caution: don't think you can use something like <img src=images/U2308.jpg border=0><tt>X{0,0}</tt><img src=images/U230B.jpg border=0> to mean "there must not be an <tt>X</tt> here." <img src=images/U2308.jpg border=0><tt>X{0,0}</tt><img src=images/U230B.jpg border=0> is a meaningless expression because it means " no <span class="docEmphasis">requirement</span> to match <img src=images/U2308.jpg border=0><tt>X</tt><img src=images/U230B.jpg border=0>, and, in fact, don't even bother trying to match any. Period. " It's the same as if the whole <img src=images/U2308.jpg border=0><tt>X{0,0}</tt><img src=images/U230B.jpg border=0> wasn't there at allif there is an <tt>X</tt> present, it could still be matched by something later in the expression, so your intended purpose is defeated.<sup class="docFootnote"><a class="docLink" href="#regex3-CHP-3-FN-17">[<img src=images/U2020.jpg border=0>]</a></sup> Use negative lookahead for a true "must not be here" construct.</P><blockquote><p class="docFootnote"><sup><a name="regex3-CHP-3-FN-17">[<img src=images/U2020.jpg border=0>]</a></sup> In theory, what I say about {0,0} is correct. In practice, what actually happens is even worse  it's almost random! In many programs (including GNU awk, GNU <span class="docEmphasis">grep</span>, and older versions of Perl) it seems that {0,0} means the same as *, while in many others (including most versions of <span class="docEmphasis">sed</span> that I've seen, and some versions of <span class="docEmphasis">grep</span>) it means the same as ?. Crazy!</P></blockquote>


<a name="regex3-CHP-3-SECT-5.5.8"></a>
<h5 id="title-IDABWFTH" class="docSection3Title">3.5.5.8. Lazy quantifiers: <tt>*?, +?, ??, {num,num}?</tt></h5>
<p class="docText">Some tools offer the rather ungainly looking <tt>*?, +?, ??,</tt> and {<tt>min,max</tt>}?. These are the <span class="docEmphasis">lazy</span><a name="IDX-CHP-3-1407"></a> 
<a name="IDX-CHP-3-1408"></a> 
<a name="IDX-CHP-3-1409"></a> 
<a name="IDX-CHP-3-1410"></a> 
 versions of the quantifiers. (They are also called <span class="docEmphasis">minimal matching</span>, <span class="docEmphasis">nongreedy</span>, and <span class="docEmphasis">ungreedy</span>.) Quantifiers are normally "greedy,"<a name="IDX-CHP-3-1411"></a> 
<a name="IDX-CHP-3-1412"></a> 
<a name="IDX-CHP-3-1413"></a> 
<a name="IDX-CHP-3-1414"></a> 
 and try to match as much as possible. Conversely, these non-greedy versions match as little as possible, just the bare minimum needed to satisfy the match. The difference has far-reaching implications, covered in detail in the next chapter (&#9758;159).</p>

<a name="regex3-CHP-3-SECT-5.5.9"></a>
<h5 id="title-IDAFA2OK" class="docSection3Title">3.5.5.9. Possessive quantifiers: <tt>*+, ++, ?+, {num,num}+</tt></H5>
<p class="docText">Currently supported only by <tt>java.util.regex</tt> and PCRE (and hence PHP), but likely to gain popularity, <span class="docEmphasis">possessive<a name="IDX-CHP-3-1415"></a> 
<a name="IDX-CHP-3-1416"></a> 
<a name="IDX-CHP-3-1417"></a> 
<a name="IDX-CHP-3-1418"></a> 
 quantifiers</span> are like normally greedy quantifiers, but once they match something, they never "give it up." Like the atomic grouping to which they're related, understanding possessive quantifiers<a name="IDX-CHP-3-1419"></a> 
<a name="IDX-CHP-3-1420"></a> 
 is much easier once the underlying match process is understood (which is the subject of the next chapter).</p>
<p class="docText">In one sense, possessive quantifiers are just syntactic sugar, as they can be mimicked with atomic grouping. Something like <img src=images/U2308.jpg border=0> <tt>.++</tt><img src=images/U230B.jpg border=0> has exactly the same result as <img src=images/U2308.jpg border=0><tt>(?&gt;<span class="docEmphStrong">.+</span>)</tt><img src=images/U230B.jpg border=0>, although a smart implementation can optimize possessive quantifiers more than atomic grouping (&#9758;250).</p>



<a href="7041536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a></TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=regex3-CHP-3-SECT-4.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=regex3-CHP-3-SECT-6.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>