<html><head>
<META http-equiv="Content-Type" content="text/html">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="15.2 Zope: A Web Publishing Framework"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
	<a href="0596000855_python2-CHP-15-SECT-1.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0596000855_python2-CHP-15-SECT-3.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><A NAME="python2-CHP-15-SECT-2"></A>
<H3 class="docSection1Title">15.2 Zope: A Web Publishing Framework</H3>

<P class="docText"><A NAME="python2-IDXTERM-1587"></A>
<A NAME="python2-IDXTERM-1588"></A> <A NAME="python2-IDXTERM-1589"></A>Zope is an open source web-application server
and toolkit, written in and customizable with Python. It is a
server-side technology that allows web designers to implement sites
and applications by publishing Python object hierarchies on the Web.
With Zope, programmers can focus on writing objects, and let Zope
handle most of the underlying HTTP and CGI details. If you are
interested in implementing more complex web sites than the form-based
interactions we've seen in the last three chapters, you should
investigate Zope: it can obviate many of the tasks that web scripters
wrestle with on a daily basis.
</P>

<P class="docText">Sometimes compared to commercial web toolkits such as ColdFusion,
Zope is made freely available over the Internet by a company called
Digital Creations and enjoys a large and very active development
community. Indeed, many attendees at a recent Python conference were
attracted by Zope, which had its own conference track. The use of
Zope has spread so quickly that many Pythonistas now look to it as
Python's "killer application" -- a system so
good that it naturally pushes Python into the development spotlight.
At the least, Zope offers a new, higher-level way of developing sites
for the Web, above and beyond raw CGI scripting.<sup class="docFootnote"><A class="docLink" HREF="#">[1]</A></sup><A NAME="IXT-15-337746"></A>
</P>
<blockquote><p class="docFootnote"><sup><A NAME="">[1]</A></sup> Over
the years, observers have also pointed to other systems as possible
Python "killer applications," including Grail,
Python's COM support on Windows, and JPython. I hope
they're all right, and fully expect new killers to arise after
this edition is published. But at the time that I write this, Zope is
attracting an astonishing level of interest among both developers and
investors. </p></blockquote>

<A NAME="python2-CHP-15-SECT-2.1"></A>
<H4 class="docSection2Title">15.2.1 Zope Components</H4>

<P class="docText"><A NAME="IXT-15-337747"></A>Zope
began life as a set of tools (part of which was named
"Bobo") placed in the public domain by Digital Creations.
Since then, it has grown into a large system with many components, a
growing body of add-ons (called "products" in Zope
parlance), and a fairly steep learning curve. We can't do it
any sort of justice in this book, but since Zope is one of the most
popular Python-based applications at this writing, I'd be
remiss if I didn't provide a few details here.
</P>

<P class="docText">In terms of its core components, Zope includes the following parts:</P>

<A NAME="IXT-15-337748"></A><A NAME="IXT-15-337749"></A><A NAME="IXT-15-337750"></A><A NAME="IXT-15-337751"></A><A NAME="IXT-15-337752"></A><A NAME="IXT-15-337753"></A><A NAME="IXT-15-337754"></A><A NAME="IXT-15-337755"></A><A NAME="IXT-15-337756"></A><A NAME="IXT-15-337757"></A><A NAME="IXT-15-337758"></A><A NAME="IXT-15-337759"></A><DL class="docList">
<DT><I><span class="docPubcolor">Zope Object Request Broker (ORB)</span></I></DT>
<DD>
<P class="docList"><A NAME="IXT-15-337748"></A>
<A NAME="IXT-15-337749"></A>
<A NAME="IXT-15-337750"></A>
<A NAME="IXT-15-337751"></A> <A NAME="IXT-15-337752"></A>At the heart of Zope, the
ORB dispatches incoming HTTP requests to Python objects and returns
results to the requestor, working as a perpetually running middleman
between the HTTP CGI world and your Python objects. The Zope ORB is
described further in the next section.
</P>
</DD><DT><I><span class="docPubcolor">HTML document templates</span></I></DT>
<DD>
<P class="docList"><A NAME="IXT-15-337753"></A>
<A NAME="IXT-15-337754"></A> <A NAME="IXT-15-337755"></A>Zope provides a simple way to define web
pages as templates, with values automatically inserted from Python
objects. Templates allow an object's HTML representation to be
defined independently of the object's implementation. For
instance, values of attributes in a class instance object may be
automatically plugged into a template's text by name. Template
coders need not be Python coders, and vice versa.
</P>
</DD><DT><I><span class="docPubcolor">Object database</span></I></DT>
<DD>
<P class="docList"><A NAME="IXT-15-337756"></A>
<A NAME="IXT-15-337757"></A>To record data persistently, Zope comes
with a full object-oriented database system for storing Python
objects. The Zope object database is based on the Python
<TT>pickle</TT> serialization module we'll meet in
the next part of this book, but adds support for transactions, lazy
object fetches (sometimes called delayed evaluation), concurrent
access, and more. Objects are stored and retrieved by key, much as
they are with Python's standard <TT>shelve</TT>
module, but classes must subclass an imported
<TT>Persistent</TT> superclass, and object stores are
instances of an imported <TT>PickleDictionary</TT> object.
Zope starts and commits transactions at the start and end of HTTP
requests.<A NAME="IXT-15-337758"></A>
<A NAME="IXT-15-337759"></A>
</P>
</DD>
</DL>

<P class="docText"><A NAME="IXT-15-337760"></A>
<A NAME="IXT-15-337761"></A>Zope also includes a management framework for
administrating sites, as well as a product API used to package
components. Zope ships with these and other components integrated
into a whole system, but each part can be used on its own as well.
For instance, the Zope object database can be used in arbitrary
Python applications by itself.
</P>


<A NAME="python2-CHP-15-SECT-2.2"></A>
<H4 class="docSection2Title">15.2.2 What's Object Publishing?</H4>

<P class="docText"><A NAME="python2-IDXTERM-1606"></A>
<A NAME="python2-IDXTERM-1607"></A>If you're like me,
the concept of publishing objects on the Web may be a bit vague at
first glance, but it's fairly simple in Zope: the Zope ORB
automatically maps URLs requested by HTTP into calls on Python
objects. Consider the Python module and function in <A class="docLink" HREF="#python2-CHP-15-EX-1">Example 15-1</A><A NAME="IXT-15-337762"></A>
<A NAME="IXT-15-337763"></A>
<A NAME="IXT-15-337764"></A>.
</P>


<H5 class="docExampleTitle"><A NAME="python2-CHP-15-EX-1"></A>Example 15-1. PP2E\Internet\Other\messages.py </H5>
<PRE>"A Python module published on the Web by Zope"

def greeting(size='brief', topic='zope'):
    "a published Python function"
    return 'A %s %s introduction' % (size, topic)</PRE>


<P class="docText">This is normal Python code, of course, and says nothing about Zope,
CGI, or the Internet at large. We may call the function it defines
from the interactive prompt as usual:
</P>

<PRE>C:\...\PP2E\Internet\Other&gt;<B>python</B>
&gt;&gt;&gt; <B>import messages</B>
&gt;&gt;&gt; <B>messages.greeting(  )</B>
'A brief zope introduction'

&gt;&gt;&gt; <B>messages.greeting(size='short')</B>
'A short zope introduction'

&gt;&gt;&gt; <B>messages.greeting(size='tiny', topic='ORB')</B>
'A tiny ORB introduction'</PRE>

<P class="docText">But if we place this module file, along with Zope support files, in
the appropriate directory on a server machine running Zope, it
automatically becomes visible on the Web. That is, the function
becomes a <span class="docEmphasis">published object  --</span> it can be
invoked through a URL, and its return value becomes a response page.
For instance, if placed in a <TT>cgi-bin</TT> directory on
a server called <TT>myserver.net</TT>, the following URLs
are equivalent to the three calls above:<A NAME="IXT-15-337765"></A>
<A NAME="IXT-15-337766"></A>
</P>

<PRE>http://www.myserver.net/cgi-bin/messages/greeting
http://www.myserver.net/cgi-bin/messages/greeting?size=short
http://www.myserver.net/cgi-bin/messages/greeting?size=tiny&amp;topic=ORB</PRE>

<P class="docText">When our function is accessed as a URL over the Web this way, the
Zope ORB performs two feats of magic:<A NAME="IXT-15-337767"></A>
<A NAME="IXT-15-337768"></A>
</P>

<UL>
<LI><P class="docList">The URL is automatically translated into a call to the Python
function. The first part of the URL after the directory path
(<TT>messages</TT>) names the Python module, the second
(<TT>greeting</TT>) names a function or other callable
object within that module, and any parameters after the
<TT>?</TT> become keyword arguments passed to the named
function.
</P></LI>
<LI><P class="docList">After the function runs, its return value automatically appears in a
new page in your web browser. Zope does all the work of formatting
the result as a valid HTTP response.
</P></LI>
</UL>
<P class="docText">In other words, URLs in Zope become <span class="docEmphasis">remote function
calls</span>, not just script invocations. The functions (and
methods) called by accessing URLs are coded in Python, and may live
at arbitrary places on the Net. It's as if the Internet itself
becomes a Python namespace, with one module directory per server.
</P>

<P class="docText">Zope is a server-side technology based on
<span class="docEmphasis">objects</span>, not text streams; the main advantage of
this scheme is that the details of CGI input and output are handled
by Zope, while programmers focus on writing domain objects, not on
text generation. When our function is accessed with a URL, Zope
automatically finds the referenced object, translates incoming
parameters to function call arguments, runs the function, and uses
its return value to generate an HTTP response. In general, a URL
like:
</P>

<PRE>http:<TT><I>//servername/dirpath/module/object1/object2/method?arg1=val1&amp;arg2=val2</I></TT></PRE>

<P class="docText">is mapped by the Zope ORB running on <TT>servername</TT>
into a call to a Python object in a Python module file installed in
<TT>dirpath</TT>, taking the form:
</P>

<PRE><TT><I>module.object1.object2.method(arg1=val1, arg2=val2)</I></TT></PRE>

<P class="docText">The return value is formatted into an HTML response page sent back to
the client requestor (typically a browser). By using longer paths,
programs can publish complete hierarchies of objects; Zope simply
uses Python's generic object-access protocols to fetch objects
along the path.
</P>

<P class="docText"><A NAME="IXT-15-337769"></A>
<A NAME="IXT-15-337770"></A>As usual, a URL like those listed here can
appear as the text of a hyperlink, typed manually into a web browser,
or used in an HTTP request generated by a program (e.g., using
Python's <TT>urllib</TT> module in a client-side
script). Parameters are listed at the end of these URLs directly, but
if you post information to this URL with a form instead, it works the
same way:
</P>

<PRE>&lt;form action="http://www.myserver.net/cgi-bin/messages/greeting" method=POST&gt;
    Size:  &lt;input type=text name=size&gt;
    Topic: &lt;input type=text name=topic value=zope&gt;
    &lt;input type=submit&gt;
&lt;/form&gt;</PRE>

<P class="docText"><A NAME="IXT-15-337771"></A>
<A NAME="IXT-15-337772"></A>Here, the <TT>action</TT> tag
references our function's URL again; when the user fills out
this form and presses its submit button, inputs from the form sent by
the browser magically show up as arguments to the function again.
These inputs are typed by the user, not hardcoded at the end of a
URL, but our published function doesn't need to care. In fact,
Zope recognizes a variety of parameter sources and translates them
all into Python function or method arguments: form inputs, parameters
at the end of URLs, HTTP headers and cookies, CGI environment
variables, and more.
</P>

<P class="docText">This just scratches the surface of what published objects can do,
though. For instance, published functions and methods can use the
Zope object database to save state permanently, and Zope provides
many more advanced tools such as debugging support, precoded HTTP
servers for use with the ORB, and finer-grained control over
responses to URL requestors.
</P>

<P class="docText">For all things Zope, visit <A class="docLink" target="_blank" HREF="http://www.zope.org/default.htm">http://www.zope.org</A>. There, you'll find
up-to-date releases, as well as documentation ranging from tutorials
to references to full-blown Zope example sites. Also see this
book's CD (view CD-ROM content online at <A class="docLink" target="_blank" HREF="http://examples.oreilly.com/python2">http://examples.oreilly.com/python2</A>) for a copy of the Zope distribution, current as of
the time we went to press.<A NAME="IXTR3-419"></A><A NAME="IXTR3-420"></A> <A NAME="IXTR3-421"></A>
</P>

<P><table border="0" bgcolor="black" cellspacing="0" cellpadding="1" width="90%" align="center"><tr><td>
<table bgcolor="white" width="100%" border="0" cellspacing="0" cellpadding="6"><tr>
<td width="60" valign="top"><img src="FILES/tip_yellow.gif" width="50" height="54"></td>
<td valign="top">
<P class="docText">Python creator Guido van Rossum and his Pythonlabs team of core
Python developers have moved from BeOpen to Digital Creations, home
of the Zope framework introduced here. Although Python itself remains
an open source system, Guido's presence at Digital Creations is
seen as a strategic move that will foster future growth of both Zope
and Python.<A NAME="IXT-15-337773"></A>
</P>
</td>
</tr></table></td></tr></table></P>



<ul></ul>
</td>
</tr>
</table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
          <a href="0596000855_python2-CHP-15-SECT-1.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0596000855_python2-CHP-15-SECT-3.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
