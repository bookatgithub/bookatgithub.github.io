<html><head>
<META http-equiv="Content-Type" content="text/html">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="7.9 Images"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
	<a href="0596000855_python2-CHP-7-SECT-8.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0596000855_python2-CHP-8.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><A NAME="python2-CHP-7-SECT-9"></A>
<H3 class="docSection1Title">7.9 Images</H3>

<P class="docText">In Tkinter, graphical images are displayed by creating independent
<TT>PhotoImage</TT> or <TT>BitmapImage</TT>
objects, and then attaching those image objects to other widgets via
<TT>image</TT> attribute settings. Buttons, labels,
canvases, text, and menus can all display images by associating
prebuilt image objects this way. To illustrate, <A class="docLink" HREF="#python2-CHP-7-EX-36">Example 7-36</A> throws a picture up on a button.
</P>


<H5 class="docExampleTitle"><A NAME="python2-CHP-7-EX-36"></A>Example 7-36. PP2E\Gui\Tour\imgButton.py </H5>
<PRE>gifdir = "../gifs/"
from Tkinter import *
win = Tk()
igm = PhotoImage(file=gifdir+"ora-pp.gif")
Button(win, image=igm).pack()
win.mainloop()</PRE>


<P class="docText">I could try to come up with a simpler example, but it would be
tough -- all this script does is make a Tkinter
<TT>PhotoImage</TT> object for a GIF file stored in another
directory, and associate it with a <TT>Button</TT>
widget's <TT>image</TT> option. The result is
captured in <A class="docLink" HREF="#python2-CHP-7-FIG-36">Figure 7-36</A>.
</P>

<CENTER>
<H5 class="docFigureTitle"><A NAME="python2-CHP-7-FIG-36"></A>Figure 7-36. imgButton in action</H5>
<IMG BORDER="0" WIDTH="160" HEIGHT="221" src="FILES/ppy2_0736.gif" ALT="figs/ppy2_0736.gif"></CENTER>

<P class="docText"><TT>PhotoImage</TT> and its cousin,
<TT>BitmapImage</TT>, essentially load graphics files, and
allow those graphics to be attached to other kinds of widgets. To
open a picture file, pass its name to the <TT>file</TT>
attribute of these image objects. <TT>Canvas</TT>
widgets -- general drawing surfaces discussed in more detail later
on this tour -- can display pictures too; <A class="docLink" HREF="#python2-CHP-7-EX-37">Example 7-37</A> renders <A class="docLink" HREF="#python2-CHP-7-FIG-37">Figure 7-37</A>.
</P>


<H5 class="docExampleTitle"><A NAME="python2-CHP-7-EX-37"></A>Example 7-37. PP2E\Gui\Tour\imgCanvas.py </H5>
<PRE>gifdir = "../gifs/"
from Tkinter import *
win = Tk()
img = PhotoImage(file=gifdir+"ora-lp.gif")
can = Canvas(win)
can.pack(fill=BOTH)
can.create_image(2, 2, image=img, anchor=NW)           # x, y coordinates
win.mainloop()</PRE>


<CENTER>
<H5 class="docFigureTitle"><A NAME="python2-CHP-7-FIG-37"></A>Figure 7-37. An image on canvas</H5>
<IMG BORDER="0" WIDTH="213" HEIGHT="188" src="FILES/ppy2_0737.gif" ALT="figs/ppy2_0737.gif"></CENTER>

<P class="docText">Buttons are automatically sized to fit an associated photo, but
canvases are not (because you can add objects to a canvas, as
we'll see in <A class="docLink" HREF="0596000855_python2-CHP-8.html#python2-CHP-8">Chapter 8</A>). To make a canvas
fit the picture, size it according to the <TT>width</TT>
and <TT>height</TT> methods of image objects as in <A class="docLink" HREF="#python2-CHP-7-EX-38">Example 7-38</A>. This version will make the canvas smaller or
larger than its default size as needed, lets you pass in a photo
file's name on the command line, and can be used as a simple
image viewer utility. The visual effect of this script is captured in
<A class="docLink" HREF="#python2-CHP-7-FIG-38">Figure 7-38</A>.
</P>


<H5 class="docExampleTitle"><A NAME="python2-CHP-7-EX-38"></A>Example 7-38. PP2E\Gui\Tour\imgCanvas2.py </H5>
<PRE>gifdir = "../gifs/"
from sys import argv
from Tkinter import *
filename = (len(argv) &gt; 1 and argv[1]) or 'ora-lp.gif'    # name on cmdline?
win = Tk()
img = PhotoImage(file=gifdir+filename)
can = Canvas(win)
can.pack(fill=BOTH)
can.config(width=img.width(), height=img.height())        # size to img size
can.create_image(2, 2, image=img, anchor=NW)
win.mainloop()</PRE>


<CENTER>
<H5 class="docFigureTitle"><A NAME="python2-CHP-7-FIG-38"></A>Figure 7-38. Sizing the canvas to match the photo</H5>
<IMG BORDER="0" WIDTH="127" HEIGHT="178" src="FILES/ppy2_0738.gif" ALT="figs/ppy2_0738.gif"></CENTER>

<P class="docText">And that's all there is to it. In <A class="docLink" HREF="0596000855_python2-CHP-8.html#python2-CHP-8">Chapter 8</A>,
well see images show up in a <TT>Menu</TT>, other
<TT>Canvas</TT> examples, and the image-friendly
<TT>Text</TT> widget. In later chapters, we'll find
them in an image slideshow (PyView), in a paint program (PyDraw), on
clocks (PyClock), and so on. It's easy to add graphics to GUIs
in Python/Tkinter.
</P>

<P class="docText">Once you start using photos in earnest, though, you're likely
to run into two tricky bits which I want to warn you about here:
</P>

<DL class="docList">
<DT><I><span class="docPubcolor">Supported file types</span></I></DT>
<DD>
<P class="docList">At present, the <TT>PhotoImage</TT> widget only supports
GIF, PPM, and PGM graphic file formats, and
<TT>BitmapImage</TT> supports X Windows-style
<span class="docEmphasis">.xbm</span> bitmap files. This may be expanded in
future releases, and you can convert photos in other formats to these
supported formats, of course; but I'll wait to address this
issue in more detail in <A class="docLink" HREF="#python2-CHP-7-SIDEBAR-1">Other Image File Formats: PIL</A> later in this section.
</P>
</DD><DT><I><span class="docPubcolor">Hold on to your photos</span></I></DT>
<DD>
<P class="docList">Unlike all other Tkinter widgets, an image is utterly lost if the
corresponding Python image object is garbage-collected. That means
that you must retain an explicit reference to image objects for as
long as your program needs them (e.g., assign them to a long-lived
variable name or data structure component). Python does not
automatically keep a reference to the image, even if it is linked to
other GUI components for display; moreover, image destructor methods
erase the image from memory. We saw earlier that Tkinter variables
can behave oddly when reclaimed too, but the effect is much worse and
more likely to happen with images. This may change in future Python
releases (though there are good reasons for not retaining big image
files in memory indefinitely); for now, though, images are a
"use it or lose it" widget.
</P>
</DD>
</DL>

<A NAME="python2-CHP-7-SECT-9.1"></A>
<H4 class="docSection2Title">7.9.1 Fun with Buttons and Pictures</H4>

<P class="docText">I tried to come up with an image demo for this section that was both
fun and useful. I settled for the fun part. <A class="docLink" HREF="#python2-CHP-7-EX-39">Example 7-39</A> displays a button that changes its image at
random each time it is pressed.
</P>


<H5 class="docExampleTitle"><A NAME="python2-CHP-7-EX-39"></A>Example 7-39. PP2E\Gui\Tour\buttonpics-func.py </H5>
<PRE>from Tkinter import *                # get base widget set
from glob import glob                # file name expansion list
import demoCheck                     # attach checkbutton demo to me
import random                        # pick a picture at random
gifdir = '../gifs/'                  # where to look for gif files

def draw():
    name, photo = random.choice(images)
    lbl.config(text=name)
    pix.config(image=photo)

root=Tk()
lbl = Label(root,  text="none", bg='blue', fg='red')
pix = Button(root, text="Press me", command=draw, bg='white')
lbl.pack(fill=BOTH)
pix.pack(pady=10)
demoCheck.Demo(root, relief=SUNKEN, bd=2).pack(fill=BOTH)

files = glob(gifdir + "*.gif")                              # gifs for now
images = map(lambda x: (x, PhotoImage(file=x)), files)      # load and hold
print files
root.mainloop()</PRE>


<P class="docText">This code uses a handful of built-in tools from the Python library:</P>

<UL>
<LI><P class="docList">The Python <TT>glob</TT> module we met earlier in the book
gives a list of all files ending in <span class="docEmphasis">.gif</span> in a
directory; in other words, all GIF files stored there.
</P></LI>
<LI><P class="docList">The Python <TT>random</TT> module is used to select a
random GIF from files in the directory:
<TT>random.choice</TT> picks and returns an item from a
list at random.
</P></LI>
<LI><P class="docList">To change the image displayed (and the GIF file's name in a
label at the top of the window), the script simply calls the widget
<TT>config</TT> method with new option settings; changing
on the fly like this changes the widget's display.
</P></LI>
</UL>
<P class="docText">Just for fun, this script also attaches an instance of the
<TT>demoCheck</TT> checkbox demo bar, which in turn
attaches an instance of the <TT>Quitter</TT> button we
wrote earlier. This is an artificial example, of course, but again
demonstrates the power of component class attachment at work.
</P>

<P class="docText">Notice how this script builds and holds onto all images in its
<TT>images</TT> list. The <TT>map</TT> here
applies a <TT>PhotoImage</TT> constructor call to every
.<span class="docEmphasis">gif</span> file in the photo directory, producing a
list of <TT>(file,image)</TT> tuples that is saved in a
global variable. Remember, this guarantees that image objects
won't be garbage-collected as long as the program is running.
<A class="docLink" HREF="#python2-CHP-7-FIG-39">Figure 7-39</A> shows this script in action on Windows.
</P>

<CENTER>
<H5 class="docFigureTitle"><A NAME="python2-CHP-7-FIG-39"></A>Figure 7-39. buttonpics in action</H5>
<IMG BORDER="0" WIDTH="275" HEIGHT="143" src="FILES/ppy2_0739.gif" ALT="figs/ppy2_0739.gif"></CENTER>

<P class="docText">Although it may not be obvious in this grayscale book, the name of
the GIF file being displayed is shown in red text in the blue label
at the top of this window. This program's window grows and
shrinks automatically when larger and smaller GIF files are
displayed; <A class="docLink" HREF="#python2-CHP-7-FIG-40">Figure 7-40</A> shows it randomly picking a
taller photo globbed from the image directory.
</P>

<CENTER>
<H5 class="docFigureTitle"><A NAME="python2-CHP-7-FIG-40"></A>Figure 7-40. buttonpics showing a taller photo</H5>
<IMG BORDER="0" WIDTH="171" HEIGHT="253" src="FILES/ppy2_0740.gif" ALT="figs/ppy2_0740.gif"></CENTER>

<P class="docText">And finally, <A class="docLink" HREF="#python2-CHP-7-FIG-41">Figure 7-41</A> captures this
script's GUI displaying one of the wider GIFs, selected
completely at random from the photo file directory.<sup class="docFootnote"><A class="docLink" HREF="#">[3]</A></sup>
</P>
<blockquote><p class="docFootnote"><sup><A NAME="">[3]</A></sup> This particular image appeared as a banner ad on
developer-related web sites like <A class="docLink" target="_blank" HREF="slashdot.com">slashdot.com</A> when the book <span class="docEmphasis">Learning
Python</span> was first published. It generated enough of a
backlash from Perl zealots that O'Reilly eventually pulled the
ad altogether. Which is why, of course, it appears in this
book.</p></blockquote>

<CENTER>
<H5 class="docFigureTitle"><A NAME="python2-CHP-7-FIG-41"></A>Figure 7-41. buttonpics gets political</H5>
<IMG BORDER="0" WIDTH="389" HEIGHT="156" src="FILES/ppy2_0741.gif" ALT="figs/ppy2_0741.gif"></CENTER>

<P class="docText">While we're playing, let's recode this script as a class
in case we ever want to attach or customize it later (it could
happen). It's mostly a matter of indenting and adding self
before global variable names, as shown in <A class="docLink" HREF="#python2-CHP-7-EX-40">Example 7-40</A>.
</P>


<H5 class="docExampleTitle"><A NAME="python2-CHP-7-EX-40"></A>Example 7-40. PP2E\Gui\Tour\buttonpics.py </H5>
<PRE>from Tkinter import *                # get base widget set
from glob import glob                # file name expansion list
import demoCheck                     # attach checkbox example to me
import random                        # pick a picture at random
gifdir = '../gifs/'                  # default dir to load gif files

class ButtonPicsDemo(Frame):
    def __init__(self, gifdir=gifdir, parent=None):
        Frame.__init__(self, parent)
        self.pack()
        self.lbl = Label(self,  text="none", bg='blue', fg='red')
        self.pix = Button(self, text="Press me", command=self.draw, bg='white')
        self.lbl.pack(fill=BOTH)
        self.pix.pack(pady=10)
        demoCheck.Demo(self, relief=SUNKEN, bd=2).pack(fill=BOTH)
        files = glob(gifdir + "*.gif")
        self.images = map(lambda x: (x, PhotoImage(file=x)), files)
        print files
        
    def draw(self):
        name, photo = random.choice(self.images)
        self.lbl.config(text=name)
        self.pix.config(image=photo)

if __name__ == '__main__': ButtonPicsDemo().mainloop()</PRE>


<P class="docText">This version works the same as the original, but can now be attached
to any other GUI where you would like to include such an unreasonably
silly button.
</P>

<P><A NAME="python2-CHP-7-SIDEBAR-1"></A><TABLE CELLSPACING="0" WIDTH="90%" BORDER="1"><TR><TD>
<H2 class="docSidebarTitle">Other Image File Formats: PIL</H2>

<P class="docText">As mentioned, Python Tkinter scripts show images by associating
independently created image objects with real widget objects. At this
writing, Tkinter GUIs can display photo image files in GIF, PPM, and
PGM formats by creating a <TT>PhotoImage</TT> object, as
well as X11-style bitmap files (usually suffixed with a
.<span class="docEmphasis">xbm</span> extension) by creating a
<TT>BitmapImage</TT> object.
</P>

<P class="docText">This set of supported file formats is limited by the underlying Tk
library, not Tkinter itself, and may expand in the future. But if you
want to display files in other formats today (e.g., JPEG and BMP),
you can either convert your files to one of the supported formats
with an image-processing program, or install the PIL Python extension
package mentioned at the start of <A class="docLink" HREF="0596000855_python2-CHP-6.html#python2-CHP-6">Chapter 6</A>.
</P>

<P class="docText">PIL currently supports nearly 30 graphic file formats (including JPEG
and BMP). To make use of its tools, you must first fetch and install
the PIL package (see <A class="docLink" target="_blank" HREF="http://www.pythonware.com/default.htm">http://www.pythonware.com</A>).
Then, simply use special <TT>PhotoImage</TT> and
<TT>BitmapImage</TT> objects imported from the PIL
<TT>ImageTk</TT> module to open files in other graphic
formats. These are compatible replacements for the standard Tkinter
classes of the same name, and may be used anywhere Tkinter expects a
<TT>PhotoImage</TT> or <TT>BitmapImage</TT>
object (i.e., in label, button, canvas, text, and menu object
configurations). That is, replace standard Tkinter code like this:
</P>

<PRE>from Tkinter import *
imgobj = PhotoImage(file=imgdir+"spam.gif")
Button(image=imgobj).pack()</PRE>

<P class="docText">With code of this form:</P>

<PRE>from Tkinter import *
import ImageTk
imgobj = ImageTk.PhotoImage(file=imgdir+"spam.jpg")
Button(image=imgobj).pack()</PRE>

<P class="docText">Or the more verbose equivalent:</P>

<PRE>from Tkinter import *
import Image, ImageTk
imagefile = Image.open(imgdir+"spam.jpeg")
imageobj  = ImageTk.PhotoImage(imagefile)
Label(image=imageobj).pack()</PRE>

<P class="docText">PIL installation details vary per platform; on my Windows laptop, it
was just a matter of downloading, unzipping, and adding PIL
directories to the front of PYTHONPATH. There is much more to PIL
than we have time to cover here; for instance, it also provides image
conversion, resizing, and transformation tools, some of which can be
run as command-line programs that have nothing to do with GUIs
directly. See <A class="docLink" target="_blank" HREF="http://www.pythonware.com/default.htm">http://www.pythonware.com</A> for more
information, as well as online PIL and Tkinter documentation sets.
</P>
</TD></TR></TABLE></P>



<ul></ul>
</td>
</tr>
</table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
          <a href="0596000855_python2-CHP-7-SECT-8.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0596000855_python2-CHP-8.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
