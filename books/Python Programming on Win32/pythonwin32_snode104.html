<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="13.2 Python's Database API"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode103.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode105.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>13.2
Python's Database API</h3>


<p>
<a NAME="idx1295"></a>
<a naME="idx1296"></A>Python has its own database API.
This is intended so that people writing wrappers around ODBC and
vendor-specific database drivers should expose the same database API
to Python. The <A name="idx1297"></A>Database Special Interest Group (DB-SIG)
maintains the database API, and has a mailing list and archives
relating to it at
<A NAme="idx1298"></a><a target="_blank" href="http://www.python.org/sigs/db-sig/default.htm">http://www.python.org/sigs/db-sig/</a>.</p>



<p>Version 2.0 of this standard has just been released; we include a
full copy in <a href="pythonwin32_cnode207.html">Appendix C</A>. The various ODBC modules
we demonstrate in this chapter conform closely to the standard, so we
will confine ourselves here to a brief discussion of what it
encompasses:</P>


<A NAmE="idx1299"></A>
<a NAmE="idx1300"></A><DL>
<DT>
<i><fonT COLor="#990000">
Connection objects</foNT></I></Dt>
<dd>
<p>Connection objects manage a connection to the database. They can be
opened and closed, and can commit and roll back transactions. They
may offer methods or properties to set global aspects of the
connection, such as transaction behavior. Everything else is done
through cursor objects.</P>
</DD>
<Dt>
<i><font color="#990000">Cursor objects</font></i></dt>
<dd>
<p>
<A NAME="idx1300"></A>These manage
the context of a single statement. Users ask the connection objects
to create cursors, and assign an SQL statement to the cursor. The
cursor handles control of execution and of iteration through the
result set. It also defines a standard format for descriptive
information about the fields in the result set. Cursors provide
support for parameterized queries and prepared statements.</p>
</DD>
<dT>
<I><fONT COLor="#990000">Standard information provided</foNT></I></Dt>
<dd>
<p>A database connection or module should be able to return information
about its capabilities. These include:</P>
</DD>
</Dl>


<ul>
<lI><P>The <A Name="idx1301"></a>API level to
which it conforms: level 2 offers many more features than level 1.
See <a href="pythonwin32_cnode207.html">Appendix C</a> for details.</p>
</li>
</ul>
<ul>
<li><p>The <a NAME="idx1302"></A>parameter style to use for arguments to
prepared statements; a question mark is the most common.</P>
</lI>
</Ul>
<UL>
<lI><P>Information about how safe the module is to use with threads.</P>
</LI>
</Ul>
<dl>
<dT>
<I><FOnt coLOR="#990000">Standard errors</Font></i></DT>
<DD>
<p>A standard set of exceptions is defined for database work, helping
users to distinguish between SQL syntax errors, integrity warnings in
the database, invalid SQL, and so on.</p>
</dd>
<dt>
<i><font color="#990000">Standard data types</font></i></DT>
<DD>
<P>Databases have special types to represent null, dates and times,
binary objects, and row IDs. Each DB-API-compliant module may create
its own objects to handle these, but the constructor for them is
defined. Thus, calling <Tt CLaSS="monofont">mymodule.Date(1999,12,31)</tT>
should return a valid <TT CLAss="monofont">Date</tt> object suitable for
insertion in the database, even if the implementation of the
<TT CLass="monofont">Date</tT> object varies from one database module to
another.</P>
</DD>
</dl>


<p>The <a NAME="idx1303"></a>Python DB-API is simple and straightforward, yet
offers the features needed for high-performance database development.</p>



<p>Because it's just been released, adherence to the new Version
2.0 database API isn't perfect, so we'll briefly note the
differences from the 1.0 specification. Version 1.0 offered the same
connection and cursor objects, but defined a shared helper module
named DBI (presumably short for Database Independence) that offered
standard <tt class="monofont">Date</tt> and <tt class="monofont">RAW</tt> types. It
also did not define the standard exceptions and driver information
features.</P>



<P>As we noted earlier, there are many Python interface modules
available; generally, one for each database vendor. We will
concentrate exclusively on the ODBC modules, because ODBC drivers are
available for virtually all database servers.</P>

</FONt>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode103.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode105.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>