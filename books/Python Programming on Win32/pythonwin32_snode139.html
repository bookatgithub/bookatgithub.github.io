<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="18.1 Services in Brief"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode137.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode140.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>18.1
Services in Brief</h3>


<p>A Windows NT Service is a normal program with additional
responsibilities and complications.</p>




<H4>18.1.1
Service Control Manager</H4>


<P>An integral part of Windows NT is the <A name="idx1741"></A>
<A NAme="idx1742"></a>Service Control Manager
(SCM). All Windows NT services must be registered with the SCM, which
is responsible for starting and stopping the service process. When a
process registers with the SCM, it provides attributes about the
service, including:</p>



<UL>
<LI><p>The username that runs the process. This may not be the same as the
user currently logged in to the system; indeed, there may not be
anyone logged on to the system when the service starts.</p>
</li>
<li><p>Any other services that this service depends on. For example, if you
were writing a Microsoft Exchange extension, you may specify your
service is dependent on the Microsoft Exchange Information Store
service. The SCM ensures that all dependent services are running
before your service can start. It also ensures that when a service is
stopped, all services that depend on it are also stopped.</p>
</li>
<li><p>How the service is to start: automatically when the system boots (and
all dependants have also started), or manually (i.e., when initiated
by the user).</p>
</li>
</ul>
<p>The SCM provides a user interface that allows the user to manually
control services. This user interface is available from the Services
applet in the control panel.</p>



<p>The SCM also provides an API to allow programmatic control of
services. Thus it is possible for a program to control services.</P>







<H4>18.1.2
Starting and Stopping</H4>


<P>
<A NaME="idx1743"></a>Typically, Windows NT
itself is responsible for starting and stopping services via the
Service Control Manager. The SCM provides a user interface to allow
the user to start and stop services manually, via the Services applet
in the control panel.</P>



<P>When a service starts, it must report its status to the SCM. Further,
it must listen for control requests from the SCM. When a service is
to stop, the SCM issues a control request to the service. The service
itself must act on this request and report back to the SCM as it
shuts down and just before it terminates.</p>







<H4>18.1.3
User Interface</H4>


<P>
<A NAme="idx1744"></a>Services typically have no user
interface associated with them. It's important to remember that
services may be running while no user is logged into the system, so
often there is no user with which to interact.</p>



<P>In some cases, it's possible for the service to display simple
dialog boxes, such as a MessageBox. However, this is fraught with
danger and best avoided. Communication with the user is typically
done via the <A NAme="idx1745"></a>Windows NT Event Log.</p>







<H4>18.1.4
Error Reporting and Handling</H4>


<P>
<A name="idx1746"></A>
<A NAme="idx1747"></a>Error reporting for Windows NT
Services can be viewed as very simple: use the Windows NT Event Log.
Unfortunately, using the Windows NT Event Log is not as simple as it
sounds! We will discuss the key concepts of the Windows NT Event Log
and provide sample code that logs key events.</p>







<h4>18.1.5
Performance Monitor</h4>


<p>
<a name="idx1748"></a> <a name="idx1749"></a>
<a nAME="idx1750"></A>It's
often appropriate for a Windows NT service to provide some
performance statistics. These statistics can be anything that makes
sense to the service: number of current connections, number of
clients connected, some throughput information relevant to the
service, etc.</P>



<P>The Windows NT Performance Monitor can provide this information.
There are a number of benefits to using this instead of creating your
own scheme, including:</p>



<DL>
<dT>
<I><fONT COLor="#990000">Single common repository of performance information</foNT></I></Dt>
<dd>
<p>Windows NT administrators don't need to learn a new tool of
interface simply for your service.</P>
</DD>
<Dt>
<i><foNT COlor="#990000">Nice user interface already provided and very general API</font></i></dt>
<dd>
<p>The Performance Monitor has a decent user interface for performance
information installed on every copy of Windows NT. As Microsoft makes
enhancements to this interface, your application automatically
benefits. The API used by the Performance Monitor is general and
should be capable of accommodating most performance-logging
requirements.</p>
</dd>
<dt>
<i><foNT COLOr="#990000">Third party tools already available</FOnT></I></dT>
<DD>
<P>By providing your data via the Performance Monitor, NT administrators
can take advantage of third-party tools for monitoring this
information. For example, tools are available that periodically check
the performance information, and can take corrective action should
they find any problems.</P>
</Dd>
</dl>

</fONT>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode137.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode140.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>