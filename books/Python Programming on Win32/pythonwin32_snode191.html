<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="B.2 pythoncom Module"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode190.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode192.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>B.2
pythoncom Module</h3>


<p>
<a NAME="idx2208"></a>The <tt cLASS="monofont">pythoncom</tt> module
provides the low-level interface between COM and Python.</p>



<tABLE width="515" border="0" cellpaddinG="5">
<TR>
<TD AlIGn="left">
<FOnT sIZE="+1"><B><i>CoCreateInstance( )</i></b></fONT>
</Td>
<td aLIGN="right">
</td>
</tr>
</TABLe>
<hr width="515" size="3" noshade="true" alIGN="left" COLoR="black">
<TaBLe WiDTH="515" BordeR="0" CELlpadDING="5">
<tr>
<td ALIGn="left">
</td>
<td align="right">
</td>
</tr>
</table>
<p>Creates the specified COM object and returns the requested interface.</p>
<PRE CLAsS="monofont">interface = CoCreateInstance(clsid, unkOuter , clsctx , iid)</PrE>
<H4>Parameters</h4>


<Dl>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">clsid</span></font>
</font></dt>
<dd>
<p>A string or <tt cLASS="monofont">PyIID</TT> object containing the class ID
for the new object.</p>
</DD>
<dT>
<FoNt COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">unkOuter</sPAN></Font>
</font></dt>
<dd>
<p>Typically <tt class="monofont">None</tt>, or may be a Python interface
object if the object is used as part of an aggregate.</P>
</DD>
<DT>
<FoNT cOLoR="#990000"><fONT Color="#990000"><SPAN clasS="monofont">clsctx</SPAn></fonT>
</FONt></dt>
<dd>
<p>Defines the context in which the code that manages the newly created
object runs. May be a combination of the following constants:</p>


<dl>
<dt>
<font color="#990000"><fONT COLoR="#990000"><SpAN cLaSS="monofont">pythoncom.CLSCTX_INPROC_SERVER</SPan></foNT>
</FOnt></dt>
<DD>
<P>The code that creates and manages objects of this class runs in the
same process as the caller of the function specifying the class
context.</P>
</dd>
<dt>
<FONT color="#990000"><font color="#990000"><span claSS="monofont">pythoncom.CLSCTX_INPROC_HANDLER</SPAN></fONt>
 </FOnT></dT>
<DD>
<P>The code that manages objects of this class is an in-process handler.
This is a DLL that runs in the client process and implements
client-side structures of this class when instances of the class are
accessed remotely.</p>
</dd>
<dT>
<FONt colOR="#990000"><FOnt coLOR="#990000"><Span class="monofont">pythoncom.CLSCTX_LOCAL_SERVER</span></font>
 </font></dT>
<DD>
<P>The EXE code that creates and manages objects of this class is loaded
in a separate process space (runs on same machine but in a different
process).</P>
</Dd>
<DT>
<fONt CoLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">pythoncom.CLSCTX_REMOTE_SERVER</spaN></FONt>
 </font></dt>
<dd>
<p>A remote machine context. The LocalServer32 or LocalService code that
creates and manages objects of this class is run on a different
machine.</p>
</dd>
<dt>
<font coLOR="#990000"><FONt COlOR="#990000"><sPaN CLAss="monofont">pythoncom.CLSCTX_ALL</spAN></FOnt>
</foNT></DT>
<dd>
<p>Indicates all class contexts.</p>
</DD>
<DT>
<font color="#990000"><font color="#990000"><spaN CLASS="monofont">pythoncom.CLSCTX_INPROC</sPAn></FOnT>
</fONT></Dt>
<dd>
<p>Indicates all in-process contexts.</P>
</DD>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><span class="monofont">pythoncom.CLSCTX_SERVER</span></font>
</fONT></DT>
<Dd>
<P>Indicates server code, whether in-process, local, or remote.</P>
</dD>
</Dl>


<Dl>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">iid</span></font>
</font></dt>
<dd>
<p>A string or <tt cLASS="monofont">PyIID</TT> object that defines the
interface ID requested from the new object.</p>
</DD>
</dL>
</Dd>
</Dl>



<H4>Result</H4>


<P>The result is a Python interface object, the exact type of which is
determined by the <Tt claSS="monofont">iid</TT> parameter.</p>




<h4>Comments</h4>


<p>This function is for advanced use only; in most cases, you create COM
objects using the <TT CLass="monofont">win32com.client.Dispatch()</tT>
function.</P>





<TAble width="515" border="0" cellpadDING="5">
<TR>
<tD AlIGn="left">
<FoNT SIze="+1"><b><i>CoInitialize( )</I></B></FOnt>
</td>
<TD ALign="right">
</tD>
</TR>
</Table>
<hr width="515" size="3" noshadE="true" ALIGN="left" cOLoR="black">
<TaBlE WIDth="515" boRDER="0" cellPADDing="5">
<tR>
<TD Align="left">
</td>
<td align="right">
</td>
</tr>
</tablE>
<P>Initializes COM for apartment model threading.</P>
<PRE cLAsS="monofont">CoInitialize()</PrE>
<h4>Parameters</H4>


<P>No parameters.</P>




<H4>Comments</h4>


<p>Equivalent to
<tt CLASs="monofont">CoInitializeEx(pythoncom.COINIT_APARTMENTTHREADED)</tt>.
See <tT CLAss="monofont">CoInitializeEx()</tt> for more details.</P>





<TABle width="515" border="0" cellpaddING="5">
<TR>
<Td ALiGN="left">
<fOnT SIZe="+1"><b><i>CoInitializeEx( )</i></B></FONt>
</td>
<tD ALIgn="right">
</td>
</TR>
</TAble>
<hr width="515" size="3" noshade="true" ALIGN="left" CoLOr="black">
<TAbLe WIDTh="515" borDER="0" CellpADDIng="5">
<tr>
<TD ALign="left">
</td>
<td align="right">
</td>
</tr>
</table>
<P>Initializes COM for the calling thread.</P>
<PRE ClASs="monofont">CoIntializeEx(flags)</PRe>
<H4>Parameters</h4>


<DL>
<DT>
<font COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">flags</span></font>
</font></dt>
<dd>
<p>An integer defining the initialization options. May include:</p>



<DL>
<DT>
<FOnT CoLOr="#990000"><FoNT COlor="#990000"><sPAN Class="monofont">pythoncom.COINIT_APARTMENTTHREADED</SPAN></font>
</FONT></dt>
<dd>
<p>Initializes the thread for apartment-threaded object concurrency.</p>
</dd>
<dt>
<font color="#990000"><foNT COLOr="#990000"><SPaN ClAsS="monofont">pythoncom.COINIT_MULTITHREADED</SPAn></fonT>
</FONt></dt>
<dD>
<P>Initializes the thread for multithreaded object concurrency.</P>
</Dd>
<dt>
<fONT Color="#990000"><font color="#990000"><span clasS="monofont">pythoncom.COINIT_DISABLE_OLE1DDE</SPAN></FoNT>
 </fONt></Dt>
<DD>
<P>Disables DDE for OLE1 support.</P>
</dd>
<dt>
<FONT coloR="#990000"><FONt colOR="#990000"><SPan class="monofont">pythoncom.COINIT_SPEED_OVER_MEMORY</span></font>
</font></dt>
<DD>
<P>Trades memory for speed.</P>
</DD>
</dL>
</Dd>
</DL>



<h4>Comments</H4>


<p>There's no need to call this function for the Python thread
that first imports the <TT CLass="monofont">pythoncom</tT> module. Please
see <A href="pythonwin32_cnode217.html">Appendix D</a>, for a detailed description of COM
threading models.</p>





<TABLe widTH="515" BOrder="0" cellpadding="5">
<tr>
<td alIGN="left">
<FONt SIzE="+1"><B><i>CoUninitialize( )</I></b></FONT>
</td>
<td ALIGn="right">
</td>
</tR>
</TABle>
<hr WIDTh="515" size="3" noshade="true" align="left" coloR="black">
<TABLE wIDtH="515" BoRdER="0" CEllpaDDINg="5">
<tr>
<tD ALIgn="left">
</td>
<TD ALign="right">
</td>
</tr>
</table>
<p>Closes the COM library on the current thread, unloads all COM DLLs
loaded by the thread, and forces all COM RPC connections on the
thread to close.</p>
<pre clasS="monofont">CoUninitialize()</PRE>
<H4>Comments</H4>


<p>As described in <A href="pythonwin32_cnode217.html">Appendix D</a>, this function is
currently never called by the COM framework.</P>





<tABLE widtH="515" BORder="0" cELLPaddiNG="5">
<TR>
<td align="left">
<font size="+1"><b><i>CoMarshalInterThreadInterfaceInStream( )</i></b></foNT>
</TD>
<TD aLIgN="right">
</Td>
</Tr>
</TABLe>
<hr wIDTH="515" size="3" NOSHade="true" aLIGN="left" color="black">
<table width="515" border="0" CELLPAdDInG="5">
<Tr>
<Td ALIGn="left">
</td>
<tD ALIgn="right">
</td>
</TR>
</TAble>
<p>Marshals a Python COM interface object from one thread to another
thread in the same process.</P>
<PRE class="monofont">stream = CoMarshalInterThreadInterfaceInStream(iid, interface)</pre>
<h4>Parameters</h4>


<dl>
<dt>
<font colOR="#990000"><FONT cOLoR="#990000"><SpAn CLASs="monofont">iid</spaN></FONt>
</fonT></DT>
<Dd>
<p>A string or <tt CLASs="monofont">PyIID</tt> object that identifies the
interface to be marshaled into the new stream.</p>
</dd>
<dt>
<font color="#990000"><font COLOR="#990000"><SpAN cLAsS="monofont">interface</sPAN></Font>
</fONT></Dt>
<dd>
<p>A Python COM interface object or
<TT CLass="monofont">win32com.client.Dispatch()</tT> instance to be
marshaled.</P>
</DD>
</dl>



<h4>Result</h4>


<p>The result is a <tt class="monofont">PyIStream</tt> object; that is, a
Python wrapper around a COM <tt class="monofont">IStream</TT> interface.
This stream is typically passed to
<TT CLaSS="monofont">CoGetInterface-AndReleaseStream()</tT> to obtain the
marshaled object in the new thread.</P>




<h4>Comments</H4>


<p>When paired with <TT CLass="monofont">CoGetInterfaceAndReleaseStream()</tT>,
programs can easily and reliably marshal a COM interface object to
another thread in the same process. See <A href="pythonwin32_cnode217.html">Appendix D</a>
for further details.</p>





<A NAMe="idx2209"></a><taBLE Width="515" border="0" cellpadding="5">
<TR>
<TD ALiGN="left">
<fONt SiZE="+1"><B><I>CoGetInterfaceAndReleaseStream( )</i></b></foNT>
</TD>
<td alIGN="right">
</Td>
</tr>
</tABLE>
<hr width="515" size="3" noshade="true" aliGN="left" COLOr="black">
<TAbLE wIdTH="515" BOrder="0" CELLpaddING="5">
<Tr>
<td aLIGN="left">
</td>
<td align="right">
</td>
</tr>
</table>
<p>Unmarshals a Python interface object from a stream and releases the
stream.</p>
<pRE CLASs="monofont">interface = CoGetInterfaceAndReleaseStream(stream, iid)</PRe>
<H4>Parameters</H4>


<dL>
<dT>
<FONt colOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">stream</span></font>
</font></dt>
<dd>
<p>A <tt clASS="monofont">PyIStream</TT> object to which the object was
previously marshaled.</P>
</dD>
<Dt>
<FOnT cOLOR="#990000"><font COLOr="#990000"><spaN CLAss="monofont">iid</spAN></FOnt>
</font></dt>
<dd>
<p>A string or <tt class="monofont">PyIID</tt> object that defines the
interface to be unmarshaled from the stream.</p>
</DD>
</DL>



<H4>Result</H4>


<p>The result is a Python COM interface object, the exact type of which
is determined by the <TT cLAsS="monofont">iid</tT> parameter.</P>




<H4>Comments</H4>


<p>When paired with
<tt cLASS="monofont">CoMarshalInterThreadInterfaceInStream()</tt>, programs
can easily and reliably marshal a COM interface object to another
thread in the same process. See <a href="pythonwin32_cnode217.html">Appendix D</A> for
further details.<a namE="idx2209"></A></P>



</Font>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode190.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode192.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>