<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="B.3 win32api Module"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode191.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode193.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>B.3
win32api Module</h3>


<p>
<a NAME="idx2210"></a>The <tt cLASS="monofont">win32api</tt> module
contains a mixed bag of useful Win32 API functions. This module
contains general-purpose routines often required by programs with
fairly light Windows-specific requirements. Other Python modules
provide more complete coverage of specific Win32 API sets.</p>




<tABLE width="515" border="0" cellpaddinG="5">
<TR>
<TD AlIGn="left">
<FOnT sIZE="+1"><B><i>ShellExecute( )</i></b></fONT>
</Td>
<td aLIGN="right">
</td>
</tr>
</TABLe>
<hr width="515" size="3" noshade="true" alIGN="left" COLoR="black">
<TaBLe WiDTH="515" BordeR="0" CELlpadDING="5">
<tr>
<td ALIGn="left">
</td>
<td align="right">
</td>
</tr>
</table>
<p>Performs an operation on the specified file.</p>
<PRE CLAsS="monofont">ShellExecute(Hwnd, Operation, File, Parameters, InitialDirectory, bShow)</PrE>
<H4>Parameters</h4>


<Dl>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">Hwnd</span></font>
</font></dt>
<dd>
<p>A handle to the window that is to be the parent window for the new
process. This is primarily used for message boxes the new application
may display. It's expressed as a Python integer, and
(zero) may be passed if no parent is required.</p>
</dd>
<DT>
<FONT cOLoR="#990000"><FoNt COLOr="#990000"><spaN CLAss="monofont">Operation</spAN></FOnt>
</foNT></DT>
<dd>
<p>A string representing the operation to perform on the file. Typically
this is <tt class="monofont">open</tt>. The value it takes depends on the
process being executed. For example, if you execute a Python file,
supported operations are <tt class="monofont">open</tt> and
<TT CLASs="monofont">edit</TT>. If you execute a Microsoft Word document,
supported operations include <tT ClAsS="monofont">open</TT> and
<Tt claSS="monofont">print</TT>.</p>
</dd>
<dT>
<FONt colOR="#990000"><FOnt color="#990000"><span class="monofont">File</span></fONT>
</FONt></DT>
<dD>
<P>The name of the file to execute. Most commonly, this is a document,
but a program can also be specified.</p>
</Dd>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">Parameters</span></font>
</font></dt>
<dd>
<p>If the <tt cLASS="monofont">File</TT> parameter contains the name of a
document file, this should be <tT ClASs="monofont">None</Tt>. If a program
is specified, it should be a string containing the name of the
document file.</P>
</DD>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><sPAN Class="monofont">InitialDirectory</span></font>
</font></dt>
<dd>
<p>The directory in which to open the document. This directory becomes
the current directory for the application.</P>
</DD>
<DT>
<FoNT cOLoR="#990000"><fONT Color="#990000"><SPAN clasS="monofont">bShow</SPAn></fonT>
</FONt></dt>
<dd>
<p>An integer specifying if the main window for the application is to be
shown. This is typically 1.</p>
</dd>
</dl>




<table width="515" BORDER="0" cELlPAdDiNG="5">
<TR>
<td alIGN="left">
<Font sIZE="+1"><B><i>WinExec( )</i></b></fONT>
</Td>
<td align="right">
</td>
</tr>
</table>
<hr wiDTH="515" SIZe="3" NOsHAdE="true" aLIGN="left" coloR="black">
<TABle wiDTH="515" BordeR="0" CELlpadding="5">
<tr>
<td align="left">
</td>
<td ALIGN="right">
</Td>
</TR>
</tABlE>
<p>Runs the specified application.</P>
<PRE clasS="monofont">WinExec(CommandLine, WindowShowState)</PRE>
<h4>Parameters</h4>


<dl>
<DT>
<FOnt coLOR="#990000"><Font color="#990000"><span class="monofont">CommandLine</span></FONT>
</FOnT></Dt>
<DD>
<p>The command to execute. This string can contain simply the program
name in which case the Windows <Tt CLASs="monofont">path</tt> is searched,
or it may contain the full path to the program. Parameters to the
program can also be specified here, and these parameters should
contain embedded quotation marks if necessary.</p>
</DD>
<DT>
<font COLOr="#990000"><fonT COLor="#990000"><span class="monofont">WindowShowState</span></font>
</foNT></DT>
<DD>
<p>An optional integer that defines how the main window for the program
is created. If this parameter isn't specified,
<TT cLAsS="monofont">win32con.SW_SHOWNORMAL</tT> is used. Common values for
this flag are listed here, but for a full list, please see the
Microsoft documentation for the <TT Class="monofont">WinExec</TT> function.</P>


<Dl>
<dt>
<fONT Color="#990000"><FONT color="#990000"><span class="monofont">win32con.SW_SHOWNORMAL</span></fonT>
 </FONT></Dt>
<DD>
<p>The window is created using its default. Typically, this means the
window is created in a restored or overlapped state.</P>
</Dd>
<Dt>
<FONT coloR="#990000"><FONt colOR="#990000"><SPan clASS="monofont">win32con.SW_SHOWMAXIMIZED</Span></font>
</font></dt>
<dd>
<p>The window is created maximized.</p>
</dd>
<dt>
<FONT COlOR="#990000"><fONt CoLOR="#990000"><Span cLASS="monofont">win32con.SW_SHOWMINIMIZED</span></FONT>
</font></DT>
<DD>
<p>The window is created minimized.</p>
</dd>
<dt>
<font color="#990000"><font coLOR="#990000"><SPAn CLaSS="monofont">win32con.SW_HIDE</sPaN></FONt>
</fonT></DT>
<Dd>
<p>The window is created hidden.</p>
</dD>
</DL>
</Dd>
</dl>





<tABLE width="515" border="0" cellpaddinG="5">
<TR>
<TD AlIGn="left">
<FOnT sIZE="+1"><B><i>OpenProcess( )</i></b></fONT>
</Td>
<td aLIGN="right">
</td>
</tr>
</TABLe>
<hr width="515" size="3" noshade="true" alIGN="left" COLoR="black">
<TaBLe WiDTH="515" BordeR="0" CELlpadDING="5">
<tr>
<td ALIGn="left">
</td>
<td align="right">
</td>
</tr>
</table>
<p>Retrieves a handle to an existing process.</p>
<PRE CLAsS="monofont">handle = OpenProcess(reqdAccess, bInherit, processId)</PrE>
<H4>Parameters</h4>


<Dl>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">reqdAccess</span></font>
 </font></dt>
<dd>
<p>An integer defining the access level requested on the handle. Common
values are listed here, but for a full description please see the
Win32 documentation for the <tt cLASS="monofont">OpenProcess()</TT>
function.</p>


<DL>
<dT>
<FoNt COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">win32con.PROCESS_ALL_ACCESS</sPAN></Font>
</font></dt>
<dd>
<p>Specifies all possible access flags for the process object.</p>
</dd>
<dt>
<font COLOR="#990000"><FoNT cOLoR="#990000"><sPAN Class="monofont">win32con.PROCESS_QUERY_INFORMATION</SPAN></font>
</FONT></dt>
<dd>
<P>Enables using the process handle in the
<TT Class="monofont">GetExitCodeProcess()</tt> and
<tt class="monofont">GetPriorityClass()</tt> functions to read information
from the process object.</p>
</dd>
<dt>
<fONT COLoR="#990000"><FoNT cOlOR="#990000"><SPan clASS="monofont">win32con.PROCESS_TERMINATE</Span></fONT>
</Font></dT>
<DD>
<P>Enables using the process handle in the
<tt class="monofont">TerminateProcess()</tt> function to terminate the
process.</p>
</dd>
</dl>
</dd>
</dl>



<dl>
<dT>
<FONT CoLOr="#990000"><FOnT cOLOR="#990000"><span CLASs="monofont">bInherit</spaN></FONt>
</fonT></DT>
<Dd>
<p>Specifies whether the returned handle can be inherited by a new
process created by the current process. If <tt class="monofont">true</tt>,
the handle is inheritable.</p>
</dd>
<dt>
<font cOLOR="#990000"><FOnT CoLOr="#990000"><SpAN CLass="monofont">processId</sPAN></Font>
</fONT></Dt>
<dd>
<p>An integer specifying the process identifier of the process to open.</P>
</DD>
</Dl>



<h4>Result</h4>


<p>The result is a <tt class="monofont">PyHANDLE</tt> object containing the
handle to the process.</p>





<table wiDTH="515" BORdER="0" cELlPaDDINg="5">
<tr>
<tD ALIgn="left">
<foNT SIze="+1"><b><i>GetSystemMetrics( )</I></B></FOnt>
</td>
<td align="right">
</td>
</tr>
</table>
<hR WIDTH="515" sIZe="3" NOsHaDE="true" ALign="left" cOLOR="black">
<tablE WIDth="515" boRDER="0" cellpadding="5">
<tr>
<td align="left">
</tD>
<TD ALIgN="right">
</Td>
</TR>
</tAbLE>
<P>Retrieves information, in pixels, about various display elements and
system configuration settings.</P>
<pre cLASS="monofont">result = GetSystemMetrics(metricType)</pre>
<h4>Parameter</H4>


<DL>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">metricType</sPAN></FONt>
</FOnT></Dt>
<Dd>
<P>Specifies the information to retrieve. There are over 80 valid values
for this function, which can be identified by constants in the
<TT Class="monofont">win32con</TT> module that begin with
<TT clasS="monofont">SM_</TT>, such as <Tt claSS="monofont">SM_CXSCREEN</TT>.
Please see the Win32 documentation for further details.</p>
</dd>
</dl>



<h4>Result</h4>


<p>An integer with the requested system metric.</p>





<table width="515" boRDER="0" CElLPaDDiNg="5">
<TR>
<TD aligN="left">
<FONt sizE="+1"><B><I>GetDomainName( )</I></b></fonT>
</TD>
<Td align="right">
</td>
</tr>
</table>
<hr widtH="515" SIZE="3" NoSHaDE="true" aLiGN="left" COlor="black">
<tABLE widtH="515" BORder="0" cELLPadding="5">
<tr>
<td align="left">
</td>
<td alIGN="right">
</TD>
</Tr>
</TAbLE>
<p>Retrieves the name of the domain to which the current computer
belongs.</P>
<pRE CLass="monofont">name = GetDomainName()</pRE>
<H4>Parameters</H4>


<p>No parameters.</p>




<h4>Result</h4>


<P>The result is a string with the current domain name.</P>





<TAble wIDTH="515" border="0" cellpadding="5">
<tr>
<td ALIGN="left">
<FoNT sIZe="+1"><B><i>GetUserName( )</I></B></FOnt>
</td>
<TD ALign="right">
</tD>
</TR>
</Table>
<HR WIdth="515" size="3" noshade="true" align="left" coLOR="black">
<TABlE WiDTh="515" BoRDER="0" cellPADDing="5">
<tR>
<TD Align="left">
</TD>
<TD align="right">
</td>
</tr>
</table>
<p>Retrieves the username for the current thread.</p>
<pre clASS="monofont">name = GetUserName()</PRE>
<h4>Parameters</H4>


<P>No parameters.</p>




<H4>Result</H4>


<p>The result is a string with the current username. No domain
information is returned, just the username.</P>





<tABLE widtH="515" BORder="0" cELLPaddiNG="5">
<TR>
<td align="left">
<font size="+1"><b><i>GetComputerName( )</i></b></foNT>
</TD>
<TD aLIgN="right">
</Td>
</Tr>
</TABLe>
<hr wIDTH="515" size="3" NOSHade="true" aLIGN="left" color="black">
<table width="515" border="0" CELLPAdDInG="5">
<Tr>
<Td ALIGn="left">
</td>
<tD ALIgn="right">
</td>
</TR>
</TAble>
<p>Retrieves the NetBIOS name of the local computer, as defined in the
control panel and read at system bootup.</P>
<PRE class="monofont">name = GetComputerName()</pre>
<h4>Parameters</h4>


<p>No parameters.</p>




<h4>Result</h4>


<p>The result is a string with the computer name.</p>





<table WIDTH="515" BoRDeR="0" CeLlPADDing="5">
<tR>
<TD Align="left">
<FONT size="+1"><B><I>InitiateSystemShutdown( )</I></B></font>
</td>
<td align="right">
</td>
</tr>
</tablE>
<HR WIDtH="515" SiZE="3" nOsHADE="true" aligN="left" COLor="black">
<taBLE Width="515" BORDer="0" cellpadding="5">
<tr>
<td aligN="left">
</TD>
<TD AlIGn="right">
</TD>
</tR>
</tABLE>
<p>Initiates a shutdown and optional restart of the specified computer.</p>
<prE CLAss="monofont">InitiateSystemShutdown(machineName, message, timeout, bForceAppsClosed, bReboot)</prE>
<H4>Parameters</H4>


<Dl>
<dt>
<fONT Color="#990000"><font color="#990000"><span clasS="monofont">machineName</SPAN></FoNT>
</fONt></Dt>
<DD>
<P>The network name of the machine to shut down or
<Tt claSS="monofont">None</TT> for the current machine.</p>
</dd>
<dT>
<FONt colOR="#990000"><FOnt color="#990000"><span class="monofont">message</span></fONT>
</FONt></DT>
<dD>
<P>A string that specifies a message to be displayed in the shut-down
dialog box or <tT cLASS="monofont">None</tt> for no message.</p>
</dD>
<DT>
<Font cOLOR="#990000"><font COLOr="#990000"><span class="monofont">timeout</span></font>
</fonT></DT>
<DD>
<P>An integer that specifies the time in milliseconds to display the
dialog. During this period, the shutdown can be aborted by calling
<tT ClASs="monofont">AbortSystem-Shutdown()</Tt>. If this value is zero, no
dialog is shown, and the shutdown begins immediately.</P>
</DD>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><sPAN Class="monofont">bForceAppsClosed</span></font>
</font></dt>
<dd>
<p>An integer that specifies if applications should be forced closed. If
<TT CLASs="monofont">true</TT>, users aren't given an opportunity to
save their work.</p>
</DD>
<dT>
<fONT Color="#990000"><FONT coloR="#990000"><SPAn claSS="monofont">bReboot</SPan></font>
</font></dt>
<dd>
<p>An integer that specifies if the machine should be restarted after
shutdown or left in a state safe to power off the computer.</p>
</dd>
</dl>



<h4>Comments</H4>


<P>To shut down the local computer, the calling process must have the
<TT CLaSS="monofont">SE_SHUTDOWN_NAME</tT> privilege. To shut down a remote
computer, the calling process must have the
<Tt ClASS="monofont">SE_REMOTE_SHUTDOWN_NAME</Tt> privilege on the remote
computer.</p>





<taBLE Width="515" BORDer="0" ceLLPAdding="5">
<tr>
<td align="left">
<font sizE="+1"><B><I>AbortSystemShutdown( )</I></B></FoNT>
</tD>
<Td AlIGN="right">
</Td>
</tr>
</tABLE>
<hr wiDTH="515" Size="3" nOSHAde="true" align="left" color="black">
<table widtH="515" BORDEr="0" CElLPaDdING="5">
<Tr>
<td aLIGN="left">
</td>
<td ALIGn="right">
</td>
</tR>
</TABle>
<p>Stops the system shutdown of a specified computer.</p>
<pre class="monofont">AbortSystemShutdown(machineName)</pre>
<h4>Parameters</h4>


<dl>
<dt>
<FONT COlOR="#990000"><fONt CoLOR="#990000"><Span cLASS="monofont">machineName</span></FONT>
</font></DT>
<DD>
<p>A string that specifies the name of the computer on which to abort
the shutdown or <tt class="monofont">None</tt> for the local computer.</p>
</dd>
</dl>



<h4>Comments</h4>


<p>This function can programmatically abort a system shutdown initiated
by <tt cLASS="monofont">InitiateSystemShutdown()</TT> during the specified
timeout interval.</p>



<P>To stop the local computer from shutting down, the calling process
must have the <Tt CLaSs="monofont">SE_SHUTDOWN_NAME</TT> privilege. To stop
a remote computer from shutting down, the calling process must have
the <TT clasS="monofont">SE_REMOTE_SHUTDOWN_NAME</TT> privilege on the
remote computer.</P>





<tablE WIDth="515" boRDER="0" cellpadding="5">
<tr>
<td align="left">
<fONT SIZe="+1"><B><I>GetCurrentThreadId( )</i></B></FoNt>
</TD>
<TD aligN="right">
</TD>
</Tr>
</tabLE>
<HR widtH="515" SIZe="3" noshade="true" align="left" color="black">
<tabLE WIDTh="515" BOrDEr="0" CeLLPAddinG="5">
<TR>
<Td aliGN="left">
</TD>
<td alIGN="right">
</Td>
</tr>
</table>
<p>Returns the thread identifier for the current thread.</p>
<pre class="monofont">threadId = GetCurrentThreadId()</pre>
<H4>Result</H4>


<P>The result is an integer containing the Win32 thread ID. Until the
thread terminates, this ID uniquely identifies the thread to the
system.</P>





<A NaME="idx2211"></a><TAbLe WIDTh="515" borDER="0" CellpADDIng="5">
<tr>
<TD ALign="left">
<font size="+1"><b><i>GetCurrentProcessId( )</i></b></font>
</td>
<TD ALIGn="right">
</TD>
</tR>
</TaBlE>
<HR Width="515" SIZE="3" noshADE="true" Align="left" COLOr="black">
<table width="515" border="0" cellPADDINg="5">
<TR>
<tD AlIgN="left">
</TD>
<Td aliGN="right">
</TD>
</tr>
</taBLE>
<P>Returns the process identifier for the current process.</p>
<pre CLASs="monofont">processId = GetCurrentProcessId()</pre>
<h4>Result</h4>


<p>The result is an integer containing the Win32 process ID. Until the
process terminates, this ID uniquely identifies the process to the
system.<a name="idx2211"></a></p>



</font>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode191.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode193.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>