<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="B.5 win32evtlog Module"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode193.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode195.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>B.5
win32evtlog Module</h3>


<p>
<a NAME="idx2214"></a>The <tt cLASS="monofont">win32evtlog</tt> module
interfaces to the Win32 SDK functions that deal with the Windows NT
Event Log. This module also contains generic message resources
suitable for reference in Event Log records.</p>



<tABLE width="515" border="0" cellpaddinG="5">
<TR>
<TD AlIGn="left">
<FOnT sIZE="+1"><B><i>CloseEventLog( )</i></b></fONT>
</Td>
<td aLIGN="right">
</td>
</tr>
</TABLe>
<hr width="515" size="3" noshade="true" alIGN="left" COLoR="black">
<TaBLe WiDTH="515" BordeR="0" CELlpadDING="5">
<tr>
<td ALIGn="left">
</td>
<td align="right">
</td>
</tr>
</table>
<p>Closes a handle to the Event Log.</p>
<PRE CLAsS="monofont">CloseEventLog(handle)</PrE>
<H4>Parameters</h4>


<Dl>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">handle</span></font>
</font></dt>
<dd>
<p>The <tt cLASS="monofont">handle</TT> to close, as obtained from
<tT ClASs="monofont">win32evtlog.OpenEventLog()</Tt>.</P>
</DD>
</Dl>




<tabLE WIdth="515" bORDEr="0" celLPADding="5">
<tr>
<td align="left">
<font size="+1"><B><I>OpenEventLog( )</I></B></FOnT>
</Td>
<TD aLiGN="right">
</TD>
</tr>
</taBLE>
<Hr widTH="515" SIze="3" noSHADe="true" align="left" color="black">
<table width="515" BORDER="0" cELlPAdDiNG="5">
<TR>
<td alIGN="left">
</Td>
<td aLIGN="right">
</td>
</tr>
</TABLe>
<p>Opens a handle to one of the Event Logs on the specified machine.</p>
<pre class="monofont">handle = OpenEventLog(machineName, logName)</pre>
<h4>Parameters</h4>


<dl>
<dt>
<fONT COLoR="#990000"><FoNT cOlOR="#990000"><SPan clASS="monofont">machineName</Span></fONT>
</Font></dT>
<DD>
<P>The name of the machine to connect to or <tt class="monofont">None</tt> for
the current machine.</p>
</dd>
<dt>
<font colOR="#990000"><FONT cOLoR="#990000"><SpAn CLASs="monofont">logName</spaN></FONt>
</fonT></DT>
<Dd>
<p>The name of the Event Log to open, such as Application, System, or
Security.</p>
</dD>
</DL>



<H4>Result</h4>


<p>The return value is an integer handle to the Event Log.</p>





<table width="515" border="0" ceLLPADDiNG="5">
<tR>
<Td AlIGN="left">
<Font sIZE="+1"><B><i>ReadEventLog( )</i></b></fONT>
</Td>
<td aLIGN="right">
</td>
</tr>
</table>
<hr width="515" size="3" nOSHADE="true" aLIgN="left" CoLoR="black">
<TABle wiDTH="515" BordeR="0" CELlpadDING="5">
<tr>
<td align="left">
</td>
<td align="right">
</td>
</tR>
</TABLE>
<p>Reads a number of records from an open Event Log.</P>
<PrE ClAsS="monofont">records = ReadEventLog(handle, readFlags, recordOffset)</PRE>
<h4>Parameters</h4>


<dl>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span class="monofont">handle</span></font>
</font></DT>
<DD>
<P>An open handle to the Event Log, obtained from
<Tt CLaSS="monofont">win32evtlog.OpenEventLog()</tT>.</p>
</DD>
<DT>
<font COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">readFlags</span></font>
</font></dt>
<dd>
<p>Specify how the <tT CLASS="monofont">read</tT> operation is to proceed and
may be a combination of the following flags:</P>


<dL>
<Dt>
<FoNT COlor="#990000"><fONT Color="#990000"><SPAN clasS="monofont">win32evtlog.EVENTLOG_FORWARDS_READ</SPAn></font>
</font></dt>
<dd>
<p>The Log is read in forward chronological order.</p>
</dd>
<dt>
<foNT COLOr="#990000"><FOnT CoLoR="#990000"><SPAn claSS="monofont">win32evtlog.EVENTLOG_BACKWARDS_READ</SPan></foNT>
</FOnt></dt>
<DD>
<P>The Log is read in reverse chronological order.</P>
</dd>
<dt>
<font color="#990000"><font coloR="#990000"><SPAN ClASs="monofont">win32evtlog.EVENTLOG_SEEK_READ</SPaN></fONT>
</Font></dT>
<DD>
<P>The <tt clASS="monofont">read</Tt> operation proceeds from the record
specified by the <tt cLASS="monofont">recordOffset</tt> parameter. If this
flag is used, <tt class="monofont">readFlags</tt> must also specify
<tt class="monofont">EVENTLOG_FORWARDS_READ</tt> or
<tT CLASS="monofont">EVENTLOG_BACKWARDS_READ</tT>, which indicates the
direction for successive <Tt CLaSs="monofont">read</TT> operations.</P>
</Dd>
<dt>
<fONT Color="#990000"><FONT coloR="#990000"><SPAn class="monofont">win32evtlog.EVENTLOG_SEQUENTIAL_READ</span></font>
</font></dt>
<dD>
<P>The <TT CLaSS="monofont">read</tT> operation proceeds sequentially from the
last call to the <Tt ClASS="monofont">win32evtlog.ReadEventLog()</Tt>
function using this handle.</p>
</dd>
</DL>
</DD>
<dt>
<foNT COlor="#990000"><fONT Color="#990000"><span class="monofont">recordOffset</span></font>
</FONT></DT>
<dD>
<P>Specifies the log-entry record number at which the
<tT ClAsS="monofont">read</TT> operation should start. This parameter is
ignored unless the <Tt claSS="monofont">readFlags</TT> parameter includes
the <tt clASS="monofont">EVENTLOG_SEEK_READ</Tt> flag.</p>
</dd>
</DL>

<H4>Result</H4>


<p>The result is a list of <tt class="monofont">PyEVENTLOGRECORD</tt> objects.
The number of records returned by a single call can be determined
only after the call has returned.</p>





<table width="515" BORDER="0" cELlPAdDiNG="5">
<TR>
<td alIGN="left">
<Font sIZE="+1"><B><i>PyEVENTLOGRECORD object</i></b></fONT>
</Td>
<td align="right">
</td>
</tr>
</table>
<hr wiDTH="515" SIZe="3" NOsHAdE="true" aLIGN="left" coloR="black">
<TABle wiDTH="515" BordeR="0" CELlpadding="5">
<tr>
<td align="left">
</td>
<td ALIGN="right">
</Td>
</TR>
</tABlE>
<p>A <TT CLass="monofont">PyEVENTLOGRECORD</tT> object reads records from the
Event Log or writes new records to the Log.</P>

<H4>Methods</H4>


<p>This object has no methods.</p>




<h4>Properties</h4>


<DL>
<DT>
<font COLOr="#990000"><font color="#990000"><span class="monofont">RecordNumber</spAN></FONT>
</fONt></DT>
<dD>
<p>The number of the Event Log record. This number can be used to find
the specific record.</P>
</DD>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><sPAN Class="monofont">TimeGenerated</span></font>
</font></dt>
<dd>
<p>A <TT CLASs="monofont">Time</TT> object indicating the time the record was
generated.</p>
</DD>
<dT>
<fONT Color="#990000"><FONT coloR="#990000"><SPAn claSS="monofont">TimeWritten</SPan></font>
</font></dt>
<dd>
<p>A <tt clasS="monofont">Time</TT> object indicating the time the record was
actually written to the Log.</P>
</DD>
<dT>
<FoNT cOlOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">EventID</span></FONT>
</font></dt>
<dd>
<p>An integer event ID, as defined by the application writing the record.</p>
</dd>
<dt>
<font colOR="#990000"><FONT cOLoR="#990000"><SpAn CLASs="monofont">EventType</spaN></FONt>
</fonT></DT>
<Dd>
<p>An integer defining the event type, which can be one of the following:</p>



<dL>
<DT>EVENTLOG_ERROR_TYPE</Dt>
<dt>EVENTLOG_WARNING_TYPE</dt>
<dt>EVENTLOG_INFORMATION_TYPE</dt>
<dt>EVENTLOG_AUDIT_SUCCESS</dt>
<dt>EVENTLOG_AUDIT_FAILURE</dt>
</dl>

</dd>
<DT>
<FONT cOLoR="#990000"><FoNt COLOr="#990000"><spaN CLAss="monofont">EventCategory</spAN></FOnt>
</foNT></DT>
<dd>
<p>An integer event category, as defined by the application writing the
record.</p>
</dd>
<dt>
<font color="#990000"><font COLOR="#990000"><SpAN cLAsS="monofont">SourceName</sPAN></Font>
</fONT></Dt>
<dd>
<p>The name of the application that generated the Event Log record.</P>
</DD>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">ComputerName</sPAN></FONt>
</FOnT></Dt>
<Dd>
<P>The name of the computer that generated this message.</P>
</DD>
<dt>
<foNT COlor="#990000"><fONT Color="#990000"><SPAN class="monofont">StringInserts</span></font>
</font></dt>
<dd>
<P>A list of string inserts for this message.</P>
</DD>
<DT>
<fONt COlOr="#990000"><FONT coloR="#990000"><SPAn claSS="monofont">Sid</SPan></foNT>
</FOnt></dt>
<dd>
<p>The security identifier of a user to be associated with this record.</p>
</dd>
<dt>
<font color="#990000"><FONT COlOR="#990000"><sPAn ClASS="monofont">Data</Span></fONT>
</Font></dT>
<DD>
<P>The raw binary data for the Event Log record.</p>
</dd>
</dL>




<A NAme="idx2215"></a><table width="515" border="0" ceLLPADDiNG="5">
<tR>
<Td AlIGN="left">
<Font sIZE="+1"><B><i>Messages</i></b></fONT>
</Td>
<td aLIGN="right">
</td>
</tr>
</table>
<hr width="515" size="3" nOSHADE="true" aLIgN="left" CoLoR="black">
<TABle wiDTH="515" BordeR="0" CELlpadDING="5">
<tr>
<td align="left">
</td>
<td align="right">
</td>
</tR>
</TABLE>
<p>The <I>win32evtlog.pyd</I> file contains embedded
messages suitable for using to write to the Event Log. Only generic
messages are provided.</p>
<P><TaBlE BORder="1" cELLSpaciNG="0" CEllpaDDINg="1" width="100%">
<colgroup span="3">
<tr>
<tH>
<FONT SiZE="2">
<p><B>Message ID</B></p>
</FoNT></TH>
<th>
<foNT SIze="2">
<p>Event Type</p>
</FONT></th>
<th>
<FONT size="2">
<p>Message Text</p>
</font></th>
</tr>
<tr>
<td>
<fonT SIZE="2">
<P>1 to 9</p>
</FOnT></Td>
<Td>
<FONT size="2">
<P>Error</P>
</FOnt></td>
<TD>
<FOnt siZE="2">
<P>%1</P>
</font></td>
</tr>
<tr>
<td>
<font size="2">
<p>1 to 9</P>
</FONT></Td>
<TD>
<fONt SiZE="2">
<P>Information</P>
</font></TD>
<TD>
<font SIZE="2">
<p>%1</p>
</foNT></TD>
</tr>
<tr>
<td>
<font size="2">
<p>1 to 9</p>
</font></tD>
<TD>
<FONt SIzE="2">
<P>Success</p>
</FoNT></TD>
<td>
<foNT SIze="2">
<p>%1</p>
</FONT></td>
</tr>
<TR>
<TD>
<font size="2">
<p>1 to 9</p>
</font></td>
<td>
<fonT SIZE="2">
<P>Warning</p>
</FOnT></Td>
<Td>
<FONT size="2">
<P>%1<A NAme="idx2215"></a></p>
</FONT></td>
</tr>
</COLGroup>
</table></p>

</font>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode193.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode195.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>