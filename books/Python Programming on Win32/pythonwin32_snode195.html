<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="B.6 win32file Module"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode194.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode196.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>B.6
win32file Module</h3>


<p>
<a NAME="idx2216"></a>The <tt cLASS="monofont">win32file</tt> module
contains functions that interface to the <tt CLASs="monofont">File</tt> and
other I/O-related Win32 API functions.</p>



<table width="515" border="0" cELLPADdINg="5">
<TR>
<tD aLIGN="left">
<font SIZE="+1"><b><i>CreateFile( )</i></b></FONT>
</td>
<td ALIGn="right">
</td>
</tr>
</table>
<hr width="515" size="3" NOSHADe="true" ALiGN="left" cOlOR="black">
<TAble wIDTH="515" bordER="0" CEllpaDDINg="5">
<tr>
<td align="left">
</td>
<td align="right">
</td>
</TR>
</TABLe>
<P>Opens or creates a file or a number of other objects and returns a
handle that can access the object.</P>
<pRE cLaSS="monofont">handle = CreateFile(FileName, DesiredAccess, ShareMode, SecurityAttributes, 
CreationDisposition, FlagsAndAttributes, TemplateFile)</PRe>
<h4>Parameters</h4>


<dL>
<DT>
<Font cOLOR="#990000"><font COLOr="#990000"><span class="monofont">FileName</span></font>
</fonT></DT>
<DD>
<P>The name of the file, pipe, or other resource to open.</p>
</DD>
<dT>
<FoNt COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">DesiredAccess</sPAN></Font>
</font></dt>
<dd>
<p>An integer determining the access this file is opened with. This
allows the file to be opened with read access, write access,
read-write access, or device access. The following flags are defined:</p>


<dl>
<dt>
<font COLOR="#990000"><FoNT cOLoR="#990000"><sPAN Class="monofont">0</SPAN></font>
</FONT></dt>
<dd>
<P>Specifies the file to be opened with device query access. This allows
the application to query the device attributes without accessing the
device.</P>
</DD>
<dt>
<font color="#990000"><font color="#990000"><sPAN CLAsS="monofont">win32file.GENERIC_READ</SpAN></fOnT>
</FONt></dt>
<dD>
<P>Specifies read access to the file. Combine with
<TT clasS="monofont">win32file.GENERIC_WRITE</TT> for read-write access.</P>
</dd>
<dt>
<FONT color="#990000"><font color="#990000"><span claSS="monofont">win32file.GENERIC_WRITE</SPAN></fONt>
</FOnT></dT>
<DD>
<P>Specified write access to the file. Combine with
<tt clASS="monofont">win32file.GENERIC_WRITE</Tt> for read-write access.</p>
</dd>
</DL>
</DD>
</dl>


<dl>
<DT>
<FOnt color="#990000"><font color="#990000"><span cLASS="monofont">ShareMode</SPaN></FoNT>
</fOnT></DT>
<Dd>
<p>A set of bit flags that determines how the file is to be shared. If
<tt CLASs="monofont">ShareMode</tt> is 0, the file can't be shared,
and all subsequent attempts to open the file fail until the handle is
closed. This parameter can be a combination of the following values:</p>


<DL>
<DT>
<font COLOr="#990000"><font color="#990000"><span class="monofont">win32file.FILE_SHARE_DELETE</spAN></FONT>
</fONt></DT>
<dD>
<p>Windows NT only. Only requests to open the file for delete mode
succeed.</P>
</DD>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><sPAN Class="monofont">win32file.FILE_SHARE_READ</span></font>
</font></dt>
<dd>
<p>Only requests to open the file for read mode succeed.</P>
</DD>
<DT>
<FoNT cOLoR="#990000"><fONT Color="#990000"><SPAN clasS="monofont">win32file.FILE_SHARE_WRITE</SPAn></fonT>
</FONt></dt>
<dd>
<p>Only requests to open the file for write mode succeed.</p>
</dd>
</dl>
</dd>
</dl>



<dl>
<dt>
<foNT COLOr="#990000"><FOnT CoLoR="#990000"><SPAn claSS="monofont">SecurityAttributes</SPan></foNT>
</FOnt></dt>
<DD>
<P>Determines whether the file is inherited by child processes. On
Windows NT, this specifies the security descriptor for the file if
the underlying filesystem supports security.</P>
</dd>
<dt>
<font color="#990000"><font coloR="#990000"><SPAN ClASs="monofont">CreationDisposition</SPaN></fONT>
</Font></dT>
<DD>
<P>Specifies what action to take on files that already exist and what
action to take on files that don't already exist. This can be
one of the following values:</p>


<dl>
<dT>
<FONt colOR="#990000"><FOnt color="#990000"><span class="monofont">win32file.CREATE_NEW</span></fONT>
</FONt></DT>
<dD>
<P>A new file is to be created. An exception is thrown if the file
already exists.</p>
</Dd>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">win32file.CREATE_ALWAYS</span></font>
</font></dt>
<dd>
<p>A new file is to be created. If an existing file exists, it's
overwritten.</p>
</dd>
<DT>
<FONT cOLoR="#990000"><FoNt COLOr="#990000"><spaN CLAss="monofont">win32file.OPEN_EXISTING</spAN></FOnt>
</foNT></DT>
<dd>
<p>Opens an existing file. If the file doesn't already exist, an
exception is thrown.</p>
</dd>
<dt>
<font color="#990000"><font COLOR="#990000"><SpAN cLAsS="monofont">win32file.OPEN_ALWAYS</sPAN></Font>
</fONT></Dt>
<dd>
<p>Opens an existing file if it exists, or creates a new file if not.</P>
</DD>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">win32file.TRUNCATE_EXISTING</sPAN></FONt>
</FOnT></Dt>
<Dd>
<P>Opens the file and truncates its length to zero. The file must have
been opened with write access. If the file doesn't exist, an
exception is thrown.</P>
</DD>
</dl>
</dd>
</DL>



<DL>
<dt>
<foNT COlor="#990000"><fONT Color="#990000"><span class="monofont">FlagsAndAttributes</span></font>
</FONT></DT>
<dD>
<P>Specifies the attributes and other flags for the file. This can be a
combination of the following flags:</p>



<DL>
<dT>
<fONT Color="#990000"><FONT coloR="#990000"><SPAn claSS="monofont">win32file.FILE_ATTRIBUTE_ARCHIVE</SPan></font>
</font></dt>
<dd>
<p>The file should be archived; that is, it has the archive attribute
set.</p>
</dd>
<dt>
<fONT COLoR="#990000"><FoNT cOlOR="#990000"><SPan clASS="monofont">win32file.FILE_ATTRIBUTE_ENCRYPTED</Span></fONT>
</Font></dT>
<DD>
<P>The file or directory is to be encrypted. This flag has no affect if
the filesystem doesn't support encryption.</p>
</dd>
<dt>
<font color="#990000"><font colOR="#990000"><SPAN cLAsS="monofont">win32file.FILE_ATTRIBUTE_HIDDEN</SpAn></FONT>
</font></DT>
<DD>
<p>The file is hidden and not included in a normal directory listing.</p>
</dd>
<DT>
<FOnt coLOR="#990000"><Font color="#990000"><span class="monofont">win32file.FILE_ATTRIBUTE_NORMAL</span></FONT>
</FOnT></Dt>
<DD>
<p>There are no special attributes on the file. This value is valid only
when used alone.</P>
</dD>
<DT>
<Font cOLOR="#990000"><font COLOr="#990000"><spaN CLAss="monofont">win32file.FILE_ATTRIBUTE_OFFLINE</span></font>
</font></dt>
<dd>
<p>The data of the file isn't available immediately because it has
been moved to temporary offline storage.</p>
</dD>
<DT>
<FONt COlOR="#990000"><fOnT COLor="#990000"><spAN CLass="monofont">win32file.FILE_ATTRIBUTE_READONLY</sPAN></Font>
</fONT></Dt>
<dd>
<p>The file is marked as read-only. Applications can open the file for
read access but not write access.</p>
</dd>
<dt>
<font color="#990000"><fonT COLOR="#990000"><sPAn CLaSs="monofont">win32file.FILE_ATTRIBUTE_SYSTEM</SPAN></font>
</FONT></dt>
<dd>
<P>The file is a system file and used exclusively by the operating
system.</P>
</DD>
<dt>
<foNT COlor="#990000"><font color="#990000"><span class="monofont">win32file.FILE_ATTRIBUTE_TEMPORARY</SPAN></FOnT>
</FoNT></dT>
<dD>
<P>The file is used for temporary storage, and the operating system
attempts to keep the entire file in memory when possible to speed
access. Applications should remove these files as soon as possible.</P>
</Dd>
<dt>
<fONT Color="#990000"><FONT coloR="#990000"><SPAn class="monofont">win32file.FILE_FLAG_WRITETHROUGH</span></font>
</font></dt>
<dD>
<P>The system writes all data immediately to the disk, bypassing the
lazy-write capabilities of the cache.</P>
</DD>
<Dt>
<FOnT CoLoR="#990000"><FONt colOR="#990000"><SPan clASS="monofont">win32file.FILE_FLAG_OVERLAPPED</Span></fONT>
</Font></dt>
<dd>
<p>All I/O on this file occurs asynchronously. When a file is opened in
this mode, read and write operations may return
<tt class="monofont">ERROR_IO_PENDING</tt>, and the event in the
<tt clASS="monofont">OVERLAPPED</TT> object is set when the I/O operation
completes. Files opened with this flag must provide an
<Tt CLaSS="monofont">OVERLAPPED</tT> object.</p>
</DD>
<DT>
<font COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">win32file.FILE_FLAG_NO_BUFFERING</span></font>
</font></dt>
<dd>
<p>The system opens the file with no buffering or caching.</p>
</DD>
<DT>
<FOnT CoLOr="#990000"><FoNT COlor="#990000"><sPAN Class="monofont">win32file.FILE_FLAG_RANDOM_ACCESS</SPAN></font>
</FONT></dt>
<dd>
<p>Indicates the file is accessed randomly. The system uses this as a
hint to optimize caching of the file.</p>
</dd>
<dt>
<font color="#990000"><foNT COLOr="#990000"><SPaN ClAsS="monofont">win32file.FILE_FLAG_SEQUENTIAL_SCAN</SPAn></fonT>
</FONt></dt>
<dD>
<P>Indicates the file is accessed sequentially. The system uses this as
a hint to optimize caching of the file.</P>
</Dd>
<dt>
<fONT Color="#990000"><font color="#990000"><span clasS="monofont">win32file.FILE_FLAG_DELETE_ON_CLOSE</SPAN></FoNT>
</fONt></Dt>
<DD>
<P>The operating system deletes the file automatically when the last
handle to it is closed. Subsequent attempts to open the file (except
for delete) fail.</P>
</dd>
<dt>
<FONT coloR="#990000"><FONt colOR="#990000"><SPan class="monofont">win32file.FILE_FLAG_BACKUP_SEMANTICS</span></font>
</font></dt>
<DD>
<P>Indicates the file is being opened for a backup operation. Special NT
security requirements apply.</P>
</DD>
<dT>
<FoNT cOlOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">win32file.FILE_FLAG_POSIX_SEMANTICS</span></FONT>
</font></dt>
<dd>
<p>Changes the semantics of the file to resemble POSIX files. Used only
by the POSIX subsystem; shouldn't be used by Windows
applications.</p>
</dd>
<dt>
<font colOR="#990000"><FONT cOLoR="#990000"><SpAn CLASs="monofont">win32file.FILE_FLAG_OPEN_REPARSE_POINT</spaN></FONt>
</fonT></DT>
<Dd>
<p>Inhibits the reparse functionality of the NTFS filesystem and is
beyond the scope of this book.</p>
</dD>
<DT>
<Font color="#990000"><font color="#990000"><span CLASS="monofont">win32file.FILE_FLAG_OPEN_NO_RECALL</SpAN></fONt>
</FoNT></DT>
<dd>
<p>Used by remote storage systems and is beyond the scope of this book.</p>
</DD>
</DL>
</dd>
</dl>


<DL>
<DT>
<font COLOr="#990000"><font color="#990000"><span class="monofont">TemplateFile</spAN></FONT>
</fONt></DT>
<dD>
<p>A handle to another file used as a template for file attributes or
<TT CLass="monofont">None</tT>. Under Windows 95, this parameter must be
<TT Class="monofont">None</TT>.</P>
</Dd>
</dl>



<h4>Result</H4>


<P>A <TT class="monofont">PyHANDLE</tt> object to the file.</p>





<table width="515" borDER="0" CELlPAdDInG="5">
<tR>
<TD Align="left">
<FONT size="+1"><B><I>ReadFile( )</I></B></font>
</TD>
<TD align="right">
</td>
</tr>
</table>
<hr width="515" SIZE="3" NOsHAdE="true" AlIgN="left" COLor="black">
<taBLE Width="515" BORDer="0" ceLLPAdding="5">
<tr>
<td align="left">
</td>
<td aliGN="right">
</TD>
</TR>
</tABlE>
<P>Reads data from an open file.</p>
<PrE CLAss="monofont">errCode, data = ReadFile(FileHandle, Size, Overlapped)</prE>
<H4>Parameters</H4>


<Dl>
<dt>
<fONT Color="#990000"><FONT color="#990000"><span class="monofont">FileHandle</span></fonT>
</FONT></Dt>
<DD>
<p>The file handle identifying the file to read from. This handle
typically is obtained from <TT cLaSS="monofont">win32file.CreateFile()</TT>.</p>
</dd>
<dT>
<FONt colOR="#990000"><FOnt coLOR="#990000"><Span class="monofont">Size or ReadBuffer</span></font>
</font></dT>
<DD>
<P>If <TT cLAsS="monofont">Size</Tt> is specified as a Python integer,
it's the number of bytes to read from the file. When using
overlapped I/O, a <Tt CLASs="monofont">ReadBuffer</tt> should be used,
indicating where the <tT CLAss="monofont">ReadFile</tt> operation should
place the data.</P>
</DD>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">Overlapped</sPAN></FONt>
</FOnT></Dt>
<Dd>
<P>An <TT Class="monofont">OVERLAPPED</TT> object or <TT clasS="monofont">None</TT> if
overlapped I/O isn't being performed. This parameter can be
omitted, in which case <Tt claSS="monofont">None</TT> is used.</p>
</dd>
</dl>



<h4>Result</h4>


<dl>
<dt>
<font color="#990000"><fONT COLoR="#990000"><SpAN cLaSS="monofont">errCode</SPan></foNT>
</FOnt></dt>
<DD>
<P>Either 0, or <Tt claSS="monofont">ERROR_IO_PENDING</TT>.</p>
</dd>
<dt>
<font color="#990000"><font colOR="#990000"><SPAN cLAsS="monofont">Data</SpAn></FONT>
</font></DT>
<DD>
<p>The data read from the file.</p>
</dd>
</DL>




<A Name="idx2217"></a><TABLe width="515" border="0" cellpaddiNG="5">
<TR>
<TD aLIgN="left">
<FoNt SIZE="+1"><b><i>WriteFile( )</i></b></FONT>
</td>
<td ALIGn="right">
</td>
</tR>
</TABle>
<hr width="515" size="3" noshade="true" aLIGN="left" COlOR="black">
<tABlE wIDTH="515" bordER="0" CEllpaDDINg="5">
<tr>
<tD ALIgn="left">
</td>
<td align="right">
</td>
</tr>
</table>
<p>Writes data to an open file.</P>
<PRE CLaSS="monofont">errCode = WriteFile(FileHandle, Data, Overlapped)</pRE>
<h4>Parameters</H4>


<dL>
<DT>
<Font cOLOR="#990000"><font COLOr="#990000"><spaN CLAss="monofont">FileHandle</span></font>
</font></dt>
<dd>
<p>The file handle identifying the file to read from. This handle
typically is obtained from <tt CLASS="monofont">win32file.CreateFile()</Tt>.</P>
</Dd>
<DT>
<fOnT COLor="#990000"><foNT COlor="#990000"><sPAN Class="monofont">Data</SPAN></font>
</font></dt>
<dd>
<p>The data to write to the file, as a Python string.</p>
</dd>
<dt>
<fonT COLOR="#990000"><fONt COlOr="#990000"><SPAN clasS="monofont">Overlapped</SPAn></fonT>
</FONt></dt>
<dD>
<P>An <TT class="monofont">OVERLAPPED</tt> object or <tt class="monofont">None</tt> if
overlapped I/O isn't being performed. This parameter can be
omitted, in which case <tt claSS="monofont">None</TT> is used.</P>
</Dd>
</DL>



<h4>Result</H4>


<A nAmE="idx2217"></A><DL>
<dt>
<foNT COlor="#990000"><fONT Color="#990000"><SPAN class="monofont">errCode</span></font>
</font></dt>
<dd>
<P>Either
or <TT CLAsS="monofont">ERROR_IO_PENDING</Tt>.<A NaMe="idx2217"></A></P>
</DD>
</dl>


</foNT>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode194.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode196.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>