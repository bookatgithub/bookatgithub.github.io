<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="B.8 win32process Module"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode196.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode198.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>B.8
win32process Module</h3>


<p>
<a NAME="idx2219"></a>The <tt cLASS="monofont">win32process</tt>
module interfaces to the process and thread-related Win32 API
functions.</p>



<tABLE width="515" border="0" cellpaddinG="5">
<TR>
<TD AlIGn="left">
<FOnT sIZE="+1"><B><i>CreateProcess( )</i></b></fONT>
</Td>
<td aLIGN="right">
</td>
</tr>
</TABLe>
<hr width="515" size="3" noshade="true" alIGN="left" COLoR="black">
<TaBLe WiDTH="515" BordeR="0" CELlpadDING="5">
<tr>
<td ALIGn="left">
</td>
<td align="right">
</td>
</tr>
</table>
<p>Creates a new process and its primary thread.</p>
<PRE CLAsS="monofont">procHandle, threadHandle, procId, threadId = CreateHandle(ApplicationName,\
                                                       CommandLine,\
                                                       ProcessSecurityAttributes,\
                                                       ThreadSecurityAttributes,\
                                                       bInheritHandles,\
                                                       CreationFlags,\
                                                       Environment,\
                                                       CurrentDirectory,\
                                                       StartupInfo)</PrE>
<H4>Parameters</h4>


<Dl>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">ApplicationName</span></font>
</font></dt>
<dd>
<p>The name of the executable that creates the process. This can either
be a full path to the executable or just the filename portion. If no
path is specified, Windows searches the system path for the process.
This parameter may be <tt cLASS="monofont">None</TT>, in which case the
executable must be specified in the <tT ClASs="monofont">CommandLine</Tt>
parameter.</P>
</DD>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><sPAN Class="monofont">CommandLine</span></font>
</font></dt>
<dd>
<p>The command line that executes the program. If the
<TT CLASs="monofont">ApplicationName</TT> parameter is
<tT ClAsS="monofont">None</TT>, this must also include the name of the
executable. If <Tt claSS="monofont">ApplicationName</TT> is specified, this
contains additional arguments for the executable.</p>
</dd>
<dT>
<FONt colOR="#990000"><FOnt color="#990000"><span class="monofont">ProcessSecurityAttributes</span></fONT>
</FONt></DT>
<dD>
<P>The security attributes for the new process or
<tT cLASS="monofont">None</tt> if the current attributes are to be
inherited. Security attributes can be created using the
<tt CLASs="monofont">win32security</tt> module.</p>
</DD>
<DT>
<font COLOr="#990000"><font color="#990000"><span class="monofont">ThreadSecurityAttributes</spAN></FONT>
</fONt></DT>
<dD>
<p>The security attributes for the main thread in the new process or
<TT CLass="monofont">None</tT> if the current attributes are to be
inherited.</P>
</DD>
<dt>
<foNT COlor="#990000"><fONT Color="#990000"><span class="monofont">bInheritHandles</span></font>
</FONT></DT>
<dD>
<P>A boolean flag indicating if the new process should inherit Windows
handles from the creating process. If <tT ClAsS="monofont">true</TT> (that
is, 1), each open handle in the creating process is valid for the new
process.</P>
</dd>
<dt>
<FONT coloR="#990000"><FONt colOR="#990000"><SPan class="monofont">CreationFlags</span></font>
</font></dt>
<DD>
<P>A set of flags that allow special options to be set for the created
process. The following flags are currently defined:</P>



<DL>
<dT>
<FoNT cOlOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">win32process.CREATE_DEFAULT_ERROR_MODE</span></FONT>
</font></dt>
<dd>
<p>Creates the new process using a default error mode. If this flag
isn't set, the error mode for the creating process is used. The
error mode for a process determines how the application handles
certain error conditions and can be set via
<tt class="monofont">win32api.SetErrorMode()</tt>.</p>
</dd>
<DT>
<FONT cOLoR="#990000"><FoNt COLOr="#990000"><spaN CLAss="monofont">win32process.CREATE_NEW_CONSOLE</spAN></FOnt>
</foNT></DT>
<dd>
<p>The new process is created using a new console, rather than
inheriting the current console. If the creating process is a GUI
process, and the process to be created is a console process, this
flag has no effect.</p>
</dd>
<dt>
<font color="#990000"><font COLOR="#990000"><SpAN cLAsS="monofont">win32process.CREATE_NEW_PROCESS_GROUP</sPAN></Font>
</fONT></Dt>
<dd>
<p>A new process group is created for this process and all subprocesses.
A process group determines Ctrl-C or Ctrl-Break handling for console
application.</P>
</DD>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">win32process.CREATE_SEPARATE_WOW_VDM</sPAN></FONt>

<FOnT CoLoR="#990000"><SPAn claSS="monofont">win32process.CREATE_SHARED_WOW_VDM</SPan></foNT>
</FOnt></dt>
<DD>
<P>Under Windows NT when executing a 16-bit program, these flags allow
you to specify the Virtual DOS machine the process executes in. The
Windows SDK documentation contains more information on these flags.</P>
</dd>
<dt>
<font color="#990000"><font coloR="#990000"><SPAN ClASs="monofont">win32process.CREATE_SUSPENDED</SPaN></fONT>
</Font></dT>
<DD>
<P>The main thread of the new process is created in a suspended state.
The function <tt clASS="monofont">win32process.ResumeThread()</Tt> starts
the actual execution.</p>
</dd>
<DT>
<FOnt color="#990000"><font color="#990000"><span cLASS="monofont">win32process.DEBUG_PROCESS</SPaN></FoNT>
, 
<fOnT COLor="#990000"><spAN CLass="monofont">win32process.DEBUG_ONLY_THIS_PROCESS</sPAN></Font>
</fONT></Dt>
<dd>
<p>These flags are typically used by Windows debuggers. The creating
process is assumed to be a debugger, and the system notifies the
creator of certain debug-related events.</p>
</dd>
<dt>
<font color="#990000"><fonT COLOR="#990000"><sPAn CLaSs="monofont">win32process.DETACHED_PROCESS</SPAN></font>
</FONT></dt>
<dd>
<P>If the new process is a console application, the process is created
without a console. This is often used to execute console programs in
the background.</P>
</DD>
</dl>

<p>In addition, these flags can determine the new process's system
priority. These flags include:</p>




<DL>
<DT>
<font color="#990000"><font color="#990000"><spaN CLASS="monofont">win32process.HIGH_PRIORITY_CLASS</sPAn></FOnT>
</fONT></Dt>
<dd>
<p>Used for processes that perform time-critical operations. This should
be used sparingly, as a single process at this priority could cause
severe disruption to the operating system itself.</P>
</DD>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><span class="monofont">win32process.IDLE_PRIORITY_CLASS</span></font>
</fONT></DT>
<Dd>
<P>Indicates the process need execute only while the machine is
otherwise unused. Suitable for background operations that can execute
slowly, but should not disrupt the normal operations of the machine.</P>
</dD>
<Dt>
<FoNT COlor="#990000"><fONT Color="#990000"><SPAN clasS="monofont">win32process.NORMAL_PRIORITY_CLASS</SPAn></font>
</font></dt>
<dd>
<p>Indicates a normal process with no special scheduling requirements.</p>
</dd>
<dt>
<foNT COLOr="#990000"><FOnT CoLoR="#990000"><SPAn claSS="monofont">win32process.REALTIME_PRIORITY_CLASS</SPan></foNT>
</FOnt></dt>
<DD>
<P>The new process has the highest possible priority. Threads at this
priority preempt the threads of all other processes, including
critical operating-system threads, such as the mouse driver or
filesystem cache.</P>
</dd>
</dl>
</dd>
</dl>


<dl>
<dt>
<font color="#990000"><FONT COlOR="#990000"><sPAn ClASS="monofont">Environment</Span></fONT>
</Font></dT>
<DD>
<P>The environment for the new process or <tt clASS="monofont">None</Tt> to
inherit the environment of the calling process. If specified, this
parameter must be a dictionary of string key/value pairs or Unicode
string/value pairs.</p>
</dd>
<dt>
<font color="#990000"><font coLOR="#990000"><SPAn CLaSS="monofont">CurrentDirectory</sPaN></FONt>
</fonT></DT>
<Dd>
<p>A string that specifies the current drive and directory for the
process or <tt CLASs="monofont">None</tt> to use the current drive and
directory of the calling process.</p>
</DD>
<DT>
<font color="#990000"><font color="#990000"><spaN CLASS="monofont">StartupInfo</sPAn></FOnT>
</fONT></Dt>
<dd>
<p>A Python <TT CLass="monofont">STARTUPINFO</tT> object that specifies
information about the window for the new process. A default
<TT Class="monofont">STARTUPINFO</TT> structure can be created by calling
<TT class="monofont">win32process.STARTUPINFO()</tt>, and if necessary,
properties of this object can be set.</p>
</dd>
</dl>



<h4>Result</h4>


<dl>
<dt>
<fonT COLOR="#990000"><fONt COlOr="#990000"><SPAN clasS="monofont">procHandle</SPAn></fonT>
</FONt></dt>
<dD>
<P>A handle to the new process.</P>
</Dd>
<dt>
<font color="#990000"><font color="#990000"><SPAN CLaSS="monofont">threadHandle</sPAn></FoNT>
</FOnt></dt>
<DD>
<P>A handle to the main thread in the new process.</P>
</dd>
<dt>
<FONT coloR="#990000"><FONt color="#990000"><span class="monofont">procId</span></foNT>
</FONT></dT>
<Dd>
<P>The ID of the new process.</P>
</dD>
<dT>
<FONt colOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">threadId</span></font>
</font></dt>
<dd>
<p>The ID of the main thread in the new process.</p>
</dd>
</dL>




<TABLE wIDtH="515" BoRdER="0" CEllpaDDINg="5">
<tr>
<tD ALIgn="left">
<foNT SIze="+1"><b><i>TerminateProcess( )</i></b></font>
</td>
<td align="right">
</td>
</TR>
</TABLe>
<HR wIDtH="515" sIZE="3" NoshaDE="true" ALign="left" cOLOR="black">
<tablE WIDth="515" border="0" cellpadding="5">
<tr>
<TD ALIGn="left">
</TD>
<tD AlIgN="right">
</TD>
</Tr>
</tabLE>
<P>Terminates the specified process and all its threads.</P>
<pre cLASS="monofont">TerminateProcess(processHandle, exitCode)</pre>
<h4>Parameters</H4>


<DL>
<Dt>
<font color="#990000"><font color="#990000"><spAN CLASs="monofont">processHandle</SPaN></FoNt>
</FONT></dt>
<dd>
<P>A handle to the process to be terminated. This handle must have
sufficient permissions to terminate the process; otherwise an
"access denied" Win32 exception will be thrown.</P>
</DD>
<dt>
<foNT COlor="#990000"><fONT Color="#990000"><span class="monofont">exitCode</span></font>
</FONT></DT>
<dD>
<P>The integer exit code for the process. This exit code is returned to
any program that requests it (e.g., as the return code from the
<tT ClAsS="monofont">os.system()</TT> function or via the
<Tt claSS="monofont">win32process.GetExitCodeProcess()</TT> function.</p>
</dd>
</dL>




<TABle wiDTH="515" Border="0" cellpadding="5">
<tr>
<td aLIGN="left">
<FOnT SiZE="+1"><b><I>GetProcessAffinityMask( )</i></B></FONt>
</td>
<tD ALIgn="right">
</td>
</TR>
</TAble>
<hR WIDth="515" size="3" noshade="true" align="left" colOR="black">
<TABLe WIdTH="515" bOrDER="0" CellpADDIng="5">
<tr>
<TD ALign="left">
</tD>
<TD Align="right">
</td>
</tr>
</table>
<p>Retrieves the process affinity mask for a process and the system
affinity mask for the system.</p>
<pre claSS="monofont">processMask, systemMask = GetProcessAffinityMask(handle)</PRE>
<H4>Parameters</h4>


<DL>
<dT>
<FoNt COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">handle</sPAN></Font>
</font></dt>
<dd>
<p>A <tt class="monofont">PyHANDLE</tt> or integer that represents the handle
to the process for which the affinity mask is to be retrieved.</P>
</DD>
</DL>



<H4>Result</h4>


<DL>
<dT>
<FoNt COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">processMask</sPAN></Font>
</font></dt>
<dd>
<p>An integer representing the affinity mask for the specified process.</p>
</dd>
<dt>
<font COLOR="#990000"><FoNT cOLoR="#990000"><sPAN Class="monofont">systemMask</SPAN></font>
</FONT></dt>
<dd>
<P>An integer representing the affinity mask for the system.</P>
</DD>
</dl>



<h4>Comments</h4>


<p>A <i>process</i> <i>affinity</i>
<i>mask</i> is a bit mask in which each bit represents
the processors on which a process is allowed to run. A
<i>system</i> <i>affinity</i>
<i>mask</i> is a bit mask in which each bit represents
the processors that are configured in a system.</p>



<p>A process affinity mask is a subset of a system affinity mask. A
process is allowed to run only on the processors configured into a
system.</p>



<p>Under the Windows 95/98 family, both result masks are always set to 1.</P>





<TABLE wIDtH="515" BoRdER="0" CEllpaDDINg="5">
<tr>
<tD ALIgn="left">
<foNT SIze="+1"><b><i>SetProcessAffinityMask( )</i></b></font>
</td>
<td align="right">
</td>
</TR>
</TABLe>
<HR wIDtH="515" sIZE="3" NoshaDE="true" ALign="left" cOLOR="black">
<tablE WIDth="515" border="0" cellpadding="5">
<tr>
<TD ALIGn="left">
</TD>
<tD AlIgN="right">
</TD>
</Tr>
</tabLE>
<P>Sets a processor affinity mask for the threads of a specified process.</P>
<pre cLASS="monofont">SetProcessAffinityMask(handle, affinityMask)</pre>
<h4>Parameters</H4>


<DL>
<Dt>
<font color="#990000"><font color="#990000"><spAN CLASs="monofont">handle</SPaN></FoNt>
</FONT></dt>
<dd>
<P>A <TT Class="monofont">PyHANDLE</TT> or integer that represents the handle
to the process for which the affinity mask is to be set.</P>
</Dd>
<dt>
<fONT Color="#990000"><font color="#990000"><span clasS="monofont">affinityMask</SPAN></FoNT>
</fONt></Dt>
<DD>
<P>An integer defining the new affinity mask for the process.</P>
</dd>
</dl>



<H4>Comments</H4>


<P>A process affinity mask is a bit mask in which each bit represents
the processor on which the threads of the process are allowed to run.
The value of the process affinity mask must be a proper subset of the
system affinity mask values obtained by the
<Tt claSS="monofont">GetProcessAffinityMask()</TT> function.</p>



<p>This function is supported only in the Windows 2000/NT families.</p>





<tABLE width="515" border="0" cellpaddinG="5">
<TR>
<TD AlIGn="left">
<FOnT sIZE="+1"><B><i>SetThreadAffinityMask( )</i></b></fONT>
</Td>
<td aLIGN="right">
</td>
</tr>
</TABLe>
<hr width="515" size="3" noshade="true" alIGN="left" COLoR="black">
<TaBLe WiDTH="515" BordeR="0" CELlpadDING="5">
<tr>
<td ALIGn="left">
</td>
<td align="right">
</td>
</tr>
</table>
<p>Sets the processor affinity mask for a thread.</p>
<PRE CLAsS="monofont">oldMask = SetThreadAffinityMask(handle, affinityMask)</PrE>
<H4>Parameters</h4>


<Dl>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">handle</span></font>
</font></dt>
<dd>
<p>A <tt cLASS="monofont">PyHANDLE</TT> or integer that represents the handle
to the thread for which the affinity mask is to be set.</p>
</DD>
<dT>
<FoNt COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">affinityMask</sPAN></Font>
</font></dt>
<dd>
<p>For Windows NT/2000, an integer defining the new affinity mask for
the thread. For Windows 95/98, this must be 1.</p>
</dd>
</dl>



<h4>Result</h4>


<p>On Windows NT/2000, the result is the previous affinity mask for the
process. On Windows 95/98, the result is always 1.</p>





<A NAME="idx2220"></A><tABlE WiDtH="515" BORder="0" cELLPaddiNG="5">
<TR>
<td alIGN="left">
<Font size="+1"><b><i>SetPriorityClass( )</i></b></font>
</td>
<td alIGN="right">
</TD>
</Tr>
</TAbLE>
<hR wIDTH="515" size="3" NOSHade="true" aLIGN="left" coloR="black">
<TABle width="515" border="0" cellpaddING="5">
<TR>
<Td ALiGN="left">
</tD>
<tD ALIgn="right">
</td>
</TR>
</TAble>
<p>Sets the priority class for the specified process.</P>
<PRE clasS="monofont">SetPriorityClass(handle, priorityClass)</PRE>
<h4>Parameters</h4>


<a name="idx2220"></a><dl>
<dt>
<font color="#990000"><FONT COlOR="#990000"><sPAn ClASS="monofont">handle</Span></fONT>
</Font></dT>
<DD>
<P>A <tt clASS="monofont">PyHANDLE</Tt> or integer that represents the handle
to the thread for which the affinity mask is to be set.</p>
</dd>
<dt>
<font color="#990000"><font coLOR="#990000"><SPAn CLaSS="monofont">priorityClass</sPaN></FONt>
</fonT></DT>
<Dd>
<p>Specifies the priority class for the process. Specify one of the
following values:</p>



<a NAME="idx2220"></a><dl>
<dT>
<FONt color="#990000"><font color="#990000"><span clASS="monofont">win32process.ABOVE_NORMAL_PRIORITY_CLASS</SPAn></FOnT>
</FoNt></DT>
<DD>
<p>Windows 2000 only: indicates a process that has priority above
<tt cLASS="monofont">NORMAL_PRIORITY_CLASS</tt> but below
<tt CLASs="monofont">HIGH_PRIORITY_CLASS</tt>.</p>
</DD>
<DT>
<font color="#990000"><font color="#990000"><spaN CLASS="monofont">win32process.BELOW_NORMAL_PRIORITY_CLASS</sPAn></FOnT>
</fONT></Dt>
<dd>
<p>Windows 2000 only: indicates a process that has priority above
<TT CLass="monofont">IDLE_PRIORITY_CLASS</tT> but below
<TT Class="monofont">NORMAL_PRIORITY_CLASS</TT>.</P>
</Dd>
<dt>
<font color="#990000"><font color="#990000"><SPAN CLaSS="monofont">win32process.HIGH_PRIORITY_CLASS</sPAn></FoNT>
</FOnt></dt>
<DD>
<P>A process that performs time-critical tasks that must be executed
immediately. The threads of the process preempt the threads of normal
or idle priority class processes. An example is the Task List, which
must respond quickly when called by the user, regardless of the load
on the operating system. Use extreme care when using the
high-priority class, because a high-priority class application can
use nearly all available CPU time.</P>
</dd>
<dt>
<FONT coloR="#990000"><FONt color="#990000"><span class="monofont">win32process.IDLE_PRIORITY_CLASS</span></foNT>
</FONT></dT>
<Dd>
<P>Threads run only when the system is idle. The threads of the process
are preempted by the threads of any process running in a higher
priority class. An example is a screen saver. The idle-priority class
is inherited by child processes.</P>
</dD>
<dT>
<FONt colOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">win32process.NORMAL_PRIORITY_CLASS</span></font>
</font></dt>
<dd>
<p>No special scheduling needs.</p>
</dd>
<dT>
<FONT CoLOr="#990000"><FOnT cOLOR="#990000"><span CLASs="monofont">win32process.REALTIME_PRIORITY_CLASS</spaN></FONt>
</fonT></DT>
<Dd>
<p>The highest possible priority. The threads of the process preempt the
threads of all other processes, including operating-system processes
performing important tasks. For example, a real-time process that
executes for more than a brief interval can cause disk caches not to
flush or cause the mouse to be unresponsive.<a name="idx2220"></a></p>
</dd>
</dl>
</dd>
</dl>


</font>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode196.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode198.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>