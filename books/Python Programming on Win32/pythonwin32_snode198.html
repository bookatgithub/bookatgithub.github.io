<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="B.9 Service-Related Modules"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode197.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode199.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>B.9
Service-Related Modules</h3>


<p>
<a NAME="idx2221"></a>There are a
number of Python modules related to Windows NT Services.</p>




<h4>B.9.1
win32serviceutil Module</h4>


<P>
<A NAme="idx2222"></a>The <tT CLAss="monofont">win32serviceutil</tt>
module is a higher-level interface to the Win32 Service functions. It
builds on the <tt class="monofont">win32service</tt> module to provide a
more convenient interface to service-related functions.</p>




<table wiDTH="515" BORdER="0" cELlPaDDINg="5">
<tr>
<tD ALIgn="left">
<foNT SIze="+1"><b><i>ControlService( )</I></B></FOnt>
</td>
<td align="right">
</td>
</tr>
</table>
<hR WIDTH="515" sIZe="3" NOsHaDE="true" ALign="left" cOLOR="black">
<tablE WIDth="515" boRDER="0" cellpadding="5">
<tr>
<td align="left">
</tD>
<TD ALIgN="right">
</Td>
</TR>
</tAbLE>
<P>Connects to the Service Control Manager on the specified machine,
then attempts to control the service.</P>
<pre cLASS="monofont">status = ControlService(serviceName, code, machine = None)</pre>
<h4>Parameters</H4>


<DL>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">serviceName</sPAN></FONt>
</FOnT></Dt>
<Dd>
<P>The name of the service from which to obtain the status information.</P>
</DD>
<dt>
<foNT COlor="#990000"><fONT Color="#990000"><SPAN class="monofont">code</span></font>
</font></dt>
<dd>
<P>The control code to send to the service. See the
<TT CLAsS="monofont">win32service.ControlService()</Tt> function for further
information.</P>
</Dd>
<Dt>
<FONT coloR="#990000"><FONt colOR="#990000"><SPan clASS="monofont">machineName = None</Span></font>
</font></dt>
<dd>
<p>The name of the machine to connect to. If not specified, the current
machine is used.</p>
</dd>
</dl>



<H4>Result</H4>


<P>The result is the same as for the
<TT ClASs="monofont">win32service.ControlService()</TT> function.</p>





<TaBLE Width="515" BORDer="0" ceLLPAddinG="5">
<TR>
<Td align="left">
<font size="+1"><b><i>QueryServiceStatus( )</i></b></fonT>
</TD>
<TD AlIGn="right">
</TD>
</tR>
</tABLE>
<hr wiDTH="515" Size="3" nOSHAde="true" alIGN="left" Color="black">
<table width="515" border="0" cELLPADdINg="5">
<TR>
<tD aLIGN="left">
</td>
<td ALIGn="right">
</td>
</tR>
</TABle>
<p>Connects to the Service Control Manager on the specified machine,
then queries the service status.</p>
<PRE Class="monofont">status = QueryServiceStatus(serviceName, machineName = None)</pre>
<h4>Parameters</h4>


<dl>
<dt>
<font coloR="#990000"><FONT CoLOr="#990000"><SPaN cLASS="monofont">serviceName</span></FONT>
</font></DT>
<DD>
<p>The name of the service from which to obtain the status information.</p>
</dd>
<DT>
<FOnt color="#990000"><font color="#990000"><span cLASS="monofont">machineName = None</SPaN></FoNT>
</fOnT></DT>
<Dd>
<p>The name of the machine to connect to. If not specified, the current
machine is used.</p>
</dD>
</DL>



<H4>Result</h4>


<p>The result is the same as the
<tt CLASs="monofont">win32service.QueryServiceStatus()</tt>
function's.</p>





<TABLe width="515" border="0" cellpaddiNG="5">
<TR>
<TD aLIgN="left">
<FoNt SIZE="+1"><b><i>StartService( )</i></b></FONT>
</td>
<td ALIGn="right">
</td>
</tR>
</TABle>
<hr width="515" size="3" noshade="true" aLIGN="left" COlOR="black">
<tABlE wIDTH="515" bordER="0" CEllpaDDINg="5">
<tr>
<tD ALIgn="left">
</td>
<td align="right">
</td>
</tr>
</table>
<p>Connects to the Service Control Manager on the specified machine,
then starts the service using the specified arguments.</P>
<PRE CLaSS="monofont">StartService(serviceName, args = None, machineName = None)</pRE>
<h4>Parameters</H4>


<dL>
<DT>
<Font cOLOR="#990000"><font COLOr="#990000"><spaN CLAss="monofont">serviceName</span></font>
</font></dt>
<dd>
<p>The name of the service to start.</p>
</dD>
<DT>
<FONt COlOR="#990000"><fOnT COLor="#990000"><spAN CLass="monofont">args</sPAN></Font>
</fONT></Dt>
<dd>
<p>A sequence of strings defining the arguments for the service. May be
<tt class="monofont">None</tt> for no arguments.</p>
</dd>
<dt>
<fonT COLOR="#990000"><fONt COlOr="#990000"><SPAN clasS="monofont">machineName</SPAn></fonT>
</FONt></dt>
<dD>
<P>The name of the machine on which to start the service.</P>
</Dd>
</dl>




<a name="idx2223"></a><table width="515" boRDER="0" CElLPaDDiNg="5">
<TR>
<TD aligN="left">
<FONt sizE="+1"><B><I>StopService( )</I></b></fonT>
</TD>
<Td align="right">
</td>
</tr>
</table>
<hr widtH="515" SIZE="3" NoSHaDE="true" aLiGN="left" COlor="black">
<tABLE widtH="515" BORder="0" cELLPadding="5">
<tr>
<td align="left">
</td>
<td alIGN="right">
</TD>
</Tr>
</TAbLE>
<p>Connects to the Service Control Manager on the specified machine,
then sends a <Tt CLASs="monofont">SERVICE_CONTROL_STOP</tt> message to the
specified service.</p>
<PRE Class="monofont">StopService(serviceName, machineName = None)</PRE>
<H4>Parameters</h4>


<a naME="idx2223"></A><Dl>
<dt>
<font color="#990000"><font color="#990000"><SPAN CLaSS="monofont">serviceName</sPAn></FoNT>
</FOnt></dt>
<DD>
<P>The name of the service to stop.</P>
</dd>
<dt>
<FONT coloR="#990000"><FONt color="#990000"><span class="monofont">machineName</span></foNT>
</FONT></dT>
<Dd>
<P>The name of the machine on which to stop the service.<A nAmE="idx2223"></A></P>
</Dd>
</dl>








<h4>B.9.2
win32service Module</H4>


<P>
<A Name="idx2224"></a>The <TT CLass="monofont">win32service</tT>
module provides an interface to the low-level Windows NT
Service-related functions.</P>



<TAble width="515" border="0" cellpadDING="5">
<TR>
<tD AlIGn="left">
<FoNT SIze="+1"><b><i>OpenSCManager( )</I></B></FOnt>
</td>
<TD ALign="right">
</tD>
</TR>
</Table>
<hr width="515" size="3" noshadE="true" ALIGN="left" cOLoR="black">
<TaBlE WIDth="515" boRDER="0" cellPADDing="5">
<tR>
<TD Align="left">
</td>
<td align="right">
</td>
</tr>
</tablE>
<P>Establishes a connection to the Service Control Manager on the
specified computer and opens the specified SCM database.</P>
<PRE cLAsS="monofont">handle = OpenSCManager(machineName, databaseName, desiredAccess)</PrE>
<h4>Parameters</H4>


<DL>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><sPAN Class="monofont">machineName</span></font>
</font></dt>
<dd>
<p>Names the target computer. If <TT CLASs="monofont">None</TT> or an empty
string, the function connects to the local computer.</p>
</DD>
<dT>
<fONT Color="#990000"><FONT coloR="#990000"><SPAn claSS="monofont">databaseName</SPan></font>
</font></dt>
<dd>
<p>Names the SCM database to open. If <tt clasS="monofont">None</TT>, the
database <TT ClASs="monofont">SERVICES_ACTIVE_DATABASE</TT> is used.</p>
</Dd>
<DT>
<FOnt coLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">desiredAccess</span></font>
</font></dt>
<dd>
<p>Specifies the access to the SCM. Any or all of the following flags
can be used. The value
<tt cLASS="monofont">win32service.SC_MANAGER_CONNECT</TT> is implied.</p>


<DL>
<dT>
<FoNt COLOr="#990000"><fonT COLor="#990000"><spAN CLass="monofont">win32service.SC_MANAGER_ALL_ACCESS</sPAN></Font>
</font></dt>
<dd>
<p>Includes <tt class="monofont">STANDARD_RIGHTS_REQUIRED</tt>, plus the access
types in this list.</P>
</DD>
<DT>
<FoNT cOLoR="#990000"><fONT Color="#990000"><SPAN clasS="monofont">win32service.SC_MANAGER_CONNECT</SPAn></fonT>
</FONt></dt>
<dd>
<p>Enables connecting to the SCM.</p>
</dd>
<dt>
<font color="#990000"><fONT COLoR="#990000"><SpAN cLaSS="monofont">win32service.SC_MANAGER_CREATE_SERVICE</SPan></foNT>
 </FOnt></dt>
<DD>
<P>Enables calling the <Tt claSS="monofont">win32service.CreateService()</TT>
function to create a service and add it to the database.</p>
</dd>
<dt>
<font color="#990000"><font colOR="#990000"><SPAN cLAsS="monofont">win32service.SC_MANAGER_ENUMERATE_SERVICE</SpAn></FONT>
 </font></DT>
<DD>
<p>Enables calling the
<tt cLASS="monofont">win32service.EnumServicesStatus()</tt> function to list
the services in the database.</p>
</dD>
<DT>
<Font color="#990000"><font color="#990000"><span CLASS="monofont">win32service.SC_MANAGER_LOCK</SpAN></fONt>
</FoNT></DT>
<dd>
<p>Enables calling the
<tT CLAss="monofont">win32service.LockServiceDatabase()</tt> function to
acquire a lock on the database.</P>
</DD>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">win32service.SC_MANAGER_QUERY_LOCK_STATUS</sPAN></FONt>
</FOnT></Dt>
<Dd>
<P>Enables calling the
<TT Class="monofont">win32service.QueryServiceLockStatus()</TT> function to
retrieve the lock status information for the database.</P>

</Dd>
</dl>

<p>The following access types can also be used.</P>


<DL>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">win32con.GENERIC_READ</sPAN></FONt>
</FOnT></Dt>
<Dd>
<P>Combines the following access types:
<TT Class="monofont">STANDARD_RIGHTS_READ</TT>,
<TT clasS="monofont">SC_MANAGER_ENUMERATE_SERVICE</TT>, and
<Tt claSS="monofont">SC_MANAGER_QUERY_LOCK_STATUS</TT>.</p>
</dd>
<dt>
<font color="#990000"><font colOR="#990000"><SPAN cLAsS="monofont">win32con.GENERIC_WRITE</SpAn></FONT>
</font></DT>
<DD>
<p>Combines the following access types:
<tt cLASS="monofont">STANDARD_RIGHTS_WRITE</tt> and
<tt CLASs="monofont">SC_MANAGER_CREATE_SERVICE</tt>.</p>
</dd>
<dt>
<font color="#990000"><font COLOR="#990000"><SpAN cLAsS="monofont">win32con.GENERIC_EXECUTE</sPAN></Font>
</fONT></Dt>
<dd>
<p>Combines the following access types:
<TT CLass="monofont">STANDARD_RIGHTS_EXECUTE</tT>,
<TT Class="monofont">SC_MANAGER_CONNECT</tt>, and
<tt class="monofont">SC_MANAGER_LOCK</tt>.</p>
</dd>
</dl>
</dD>
</DL>




<H4>Result</H4>


<Dl>
<DT>
<fONt CoLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">handle</spaN></FONt>
</font></dt>
<dd>
<p>A handle to the SCM. When no longer needed, it should be closed with
<tt class="monofont">win32service.CloseServiceHandle()</tt>.</p>
</dD>
</DL>




<TABlE WiDTh="515" BoRDER="0" cellPADDing="5">
<tR>
<TD Align="left">
<FONT size="+1"><b><i>OpenService( )</i></b></font>
</td>
<td align="right">
</TD>
</TR>
</TAbLE>
<hR WiDtH="515" SIZe="3" nosHADE="true" aligN="left" COLor="black">
<taBLE Width="515" border="0" cellpadding="5">
<TR>
<TD ALiGN="left">
</tD>
<Td AlIGN="right">
</Td>
</tr>
</tABLE>
<p>Opens a handle to an existing service.</p>
<prE CLAss="monofont">handle = OpenService(scHandle, serviceName, desiredAccess)</prE><DL>
<Dt>
<font color="#990000"><font color="#990000"><spAN CLASs="monofont">scHandle</SPaN></FoNt>
</FONT></dt>
<dd>
<P>A handle to the Service Control Manager, as obtained from
<TT Class="monofont">win32service.OpenSCManager()</TT>.</P>
</Dd>
<dt>
<fONT Color="#990000"><font color="#990000"><span clasS="monofont">serviceName</SPAN></FoNT>
</fONt></Dt>
<DD>
<P>The name of the service to open. Service-name comparisons are
case-insensitive.</P>
</dd>
<dt>
<FONT coloR="#990000"><FONt colOR="#990000"><SPan class="monofont">desiredAccess</span></font>
</font></dt>
<DD>
<P>Specifies the access to the service. Before granting the requested
access, the system checks the access token of the calling process
against the service object.</P>



<DL>
<dT>
<FoNT cOlOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">win32service.SERVICE_ALL_ACCESS</span></FONT>
</font></dt>
<dd>
<p>Includes <tt class="monofont">win32con.STANDARD_RIGHTS_REQUIRED</tt> in
addition to all the access types listed here.</p>
</dd>
<DT>
<FONT cOLoR="#990000"><FoNt COLOr="#990000"><spaN CLAss="monofont">win32service.SERVICE_CHANGE_CONFIG</spAN></FOnt>
</foNT></DT>
<dd>
<p>Enables calling the
<tt class="monofont">win32service.ChangeServiceConfig()</tt> function to
change the service configuration.</p>
</dd>
<dt>
<font COLOR="#990000"><FoNT cOLoR="#990000"><sPAN Class="monofont">win32service.SERVICE_ENUMERATE_DEPENDENTS</SPAN></font>
</FONT></dt>
<dd>
<P>Enables calling the
<TT Class="monofont">win32service.EnumDependentServices()</tt> function to
enumerate all the services dependent on the service.</p>
</dd>
<dt>
<font color="#990000"><fONT COLoR="#990000"><SpAN cLaSS="monofont">win32service.SERVICE_INTERROGATE</SPan></foNT>
</FOnt></dt>
<DD>
<P>Enables calling the <Tt claSS="monofont">win32service.ControlService()</TT>
function to ask the service to report its status immediately.</p>
</dd>
<dt>
<font color="#990000"><font colOR="#990000"><SPAN cLAsS="monofont">win32service.SERVICE_PAUSE_CONTINUE</SpAn></FONT>
</font></DT>
<DD>
<p>Enables calling the <tt cLASS="monofont">win32service.ControlService()</tt>
function to pause or continue the service.</p>
</dD>
<DT>
<Font color="#990000"><font color="#990000"><span CLASS="monofont">win32service.SERVICE_QUERY_CONFIG</SpAN></fONt>
</FoNT></DT>
<dd>
<p>Enables calling the
<tT CLAss="monofont">win32service.QueryServiceConfig()</tt> function to
query the service configuration.</P>
</DD>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">win32service.SERVICE_QUERY_STATUS</sPAN></FONt>
</FOnT></Dt>
<Dd>
<P>Enables calling the
<TT Class="monofont">win32service.QueryServiceStatus()</TT> function to ask
the SCM about the status of the service.</P>
</Dd>
<dt>
<fONT Color="#990000"><FONT color="#990000"><span class="monofont">win32service.SERVICE_START</span></fonT>
</FONT></Dt>
<DD>
<p>Enables calling the <TT cLaSS="monofont">win32service.StartService()</TT>
function to start the service.</p>
</dd>
<dT>
<FONt colOR="#990000"><FOnt coLOR="#990000"><Span class="monofont">win32service.SERVICE_STOP</span></font>
</font></dT>
<DD>
<P>Enables calling the <TT cLAsS="monofont">win32service.ControlService()</Tt>
function to stop the service.</P>
</dD>
<DT>
<Font cOLOR="#990000"><font COLOr="#990000"><spaN CLAss="monofont">win32service.SERVICE_USER_DEFINED_CONTROL</span></font>
</font></dt>
<dd>
<p>Enables calling the <tt CLASS="monofont">win32service.ControlService()</Tt>
function to specify a user-defined control code.</P>
</Dd>
</DL>



<p>You may also specify any of the following standard access types:</P>



<dL>
<DT>
<Font cOLOR="#990000"><font COLOr="#990000"><spaN CLAss="monofont">win32con.GENERIC_READ</span></font>
</font></dt>
<dd>
<p>Combines the following access types:
<tt CLASS="monofont">STANDARD_RIGHTS_READ</Tt>,
<TT cLAsS="monofont">SERVICE_QUERY_CONFIG</tT>,
<TT Class="monofont">SERVICE_QUERY_STATUS</TT>, and
<TT clasS="monofont">SERVICE_ENUMERATE_DEPENDENTS</TT>.</P>
</dd>
<dt>
<FONT color="#990000"><font color="#990000"><span claSS="monofont">win32con.GENERIC_WRITE</SPAN></fONt>
</FOnT></dT>
<DD>
<P>Combines the following access types:
<tt clASS="monofont">STANDARD_RIGHTS_WRITE</Tt> and
<tt cLASS="monofont">SERVICE_CHANGE_CONFIG</tt>.</p>
</dD>
<DT>
<Font color="#990000"><font color="#990000"><span CLASS="monofont">win32con.GENERIC_EXECUTE</SpAN></fONt>
</FoNT></DT>
<dd>
<p>Combines the following access types:
<tT CLAss="monofont">STANDARD_RIGHTS_EXECUTE</tt>,
<TT CLass="monofont">SERVICE_START</tT>, <TT Class="monofont">SERVICE_STOP</tt>,
<tt class="monofont">SERVICE_PAUSE_CONTINUE</tt>,
<tt clasS="monofont">SERVICE_INTERROGATE</TT>, and
<TT ClASs="monofont">SERVICE_USER_DEFINED_CONTROL</TT>.</p>
</Dd>
</DL>
</DD>
</dl>
<h4>Result</h4>


<DL>
<DT>
<font COLOr="#990000"><fonT COLor="#990000"><span class="monofont">handle</span></font>
</foNT></DT>
<DD>
<p>A handle to the service. This should be closed using
<TT cLAsS="monofont">win32service.CloseServiceHandle()</tT>.</P>
</DD>
</dl>




<taBLE Width="515" BORDer="0" ceLLPAdding="5">
<tr>
<td align="left">
<font sizE="+1"><B><I>CloseServiceHandle( )</I></B></FoNT>
</tD>
<Td AlIGN="right">
</Td>
</tr>
</tABLE>
<hr wiDTH="515" Size="3" nOSHAde="true" align="left" color="black">
<table widtH="515" BORDEr="0" CElLPaDdING="5">
<Tr>
<td aLIGN="left">
</td>
<td ALIGn="right">
</td>
</tR>
</TABle>
<p>Closes a handle to a service or the Service Control Manager.</p>
<pre class="monofont">CloseServiceHandle(handle)</pre>
<h4>Parameters</h4>


<dl>
<dt>
<FONT COlOR="#990000"><fONt CoLOR="#990000"><Span cLASS="monofont">handle</span></FONT>
</font></DT>
<DD>
<p>A handle obtained from
<tt class="monofont">win32service.OpenSCManager()</tt>,
<tt class="monofont">win32service.OpenService()</tt>, or
<tt CLASS="monofont">win32service.CreateService()</Tt>.</P>
</Dd>
</DL>




<tAbLE WIdth="515" bORDEr="0" celLPADding="5">
<TR>
<TD align="left">
<font size="+1"><b><i>ControlService( )</i></b></font>
</TD>
<TD ALiGN="right">
</tD>
</Tr>
</TaBLE>
<Hr widTH="515" SIze="3" noSHADe="true" aliGN="left" COlor="black">
<table width="515" border="0" ceLLPADDiNG="5">
<tR>
<Td AlIGN="left">
</Td>
<td aLIGN="right">
</td>
</tr>
</TABLe>
<p>Sends control requests to a service.</p>
<pRE CLass="monofont">status = ControlService(handle, code)</pre>
<h4>Parameters</h4>


<dl>
<dt>
<font color="#990000"><FONT COlOR="#990000"><sPAn ClASS="monofont">handle</Span></fONT>
</Font></dT>
<DD>
<P>Handle to the service, as obtained from
<tt clASS="monofont">win32service.OpenService()</Tt>.</p>
</dd>
<dt>
<font color="#990000"><font coLOR="#990000"><SPAn CLaSS="monofont">code</sPaN></FONt>
</fonT></DT>
<Dd>
<p>Specifies the requested control code. May be one of the following
values:</p>


<dL>
<DT>
<Font cOLOR="#990000"><font color="#990000"><span class="monofont">win32service.SERVICE_CONTROL_STOP</spaN></FONT>
</FoNT></dT>
<Dd>
<P>Requests the service to stop. The handle must have
<tT CLAss="monofont">SERVICE_STOP</tt> access.</P>
</DD>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><span class="monofont">win32service.SERVICE_CONTROL_PAUSE</span></font>
</fONT></DT>
<Dd>
<P>Requests the service to pause. The handle must have
<Tt CLaSs="monofont">SERVICE_PAUSE_CONTINUE</TT> access.</P>
</Dd>
<dt>
<fONT Color="#990000"><FONT coloR="#990000"><SPAn class="monofont">win32service.SERVICE_CONTROL_CONTINUE</span></font>
</font></dt>
<dD>
<P>Requests the paused service to resume. The handle must have
<TT CLaSS="monofont">SERVICE_PAUSE_CONTINUE</tT> access.</P>
</dD>
<dT>
<FONt colOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">win32service.SERVICE_CONTROL_INTERROGATE</span></font>
</font></dt>
<dd>
<p>Requests the service to update immediately its current status
information to the SCM. The handle must have
<tt clASS="monofont">SERVICE_INTERROGATE</TT> access.</P>
</dD>
</Dl>
</DD>
</dL>




<h4>Result</H4>


<P>The result is a tuple in the same format as returned by the
<TT clasS="monofont">win32service.QueryServiceStatus()</TT> function.</P>





<tablE WIDth="515" boRDER="0" cellpadding="5">
<tr>
<td align="left">
<fONT SIZe="+1"><B><I>QueryServiceStatus( )</i></B></FoNt>
</TD>
<TD aligN="right">
</TD>
</Tr>
</tabLE>
<HR widtH="515" SIZe="3" noshade="true" align="left" color="black">
<tabLE WIDTh="515" BOrDEr="0" CeLLPAddinG="5">
<TR>
<Td aliGN="left">
</TD>
<td alIGN="right">
</Td>
</tr>
</table>
<p>Queries a service for status.</p>
<pre class="monofont">status = QueryServiceStatus(handle)</pre>
<H4>Parameters</H4>


<DL>
<DT>
<fONt COlOr="#990000"><FONT coloR="#990000"><SPAn claSS="monofont">handle</SPan></foNT>
</FOnt></dt>
<dd>
<p>Handle to the service, as obtained from
<tt class="monofont">win32service.OpenService()</tt>.</p>
</dd>
</dl>



<H4>Result</H4>


<P>The result is a tuple with the following fields:</P>



<DL>
<dT>
<FoNT cOlOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">serviceType</span></FONT>
</font></dt>
<dd>
<p>A combination of the following flags:</p>



<dl>
<dt>
<font colOR="#990000"><FONT cOLoR="#990000"><SpAn CLASs="monofont">win32service.SERVICE_WIN32_OWN_PROCESS</spaN></FONt>
</fonT></DT>
<Dd>
<p>Indicates a service that runs in its own process.</p>
</dD>
<DT>
<Font color="#990000"><font color="#990000"><span CLASS="monofont">win32service.SERVICE_WIN32_SHARE_PROCESS</SpAN></fONt>
</FoNT></DT>
<dd>
<p>Indicates a service that shares a process with other services.</p>
</DD>
<DT>
<font COLOr="#990000"><fonT COLor="#990000"><span class="monofont">win32service.SERVICE_KERNEL_DRIVER</span></font>
</foNT></DT>
<DD>
<p>Indicates a device driver.</P>
</Dd>
<DT>
<fOnT COLor="#990000"><foNT COlor="#990000"><sPAN Class="monofont">win32service.SERVICE_FILE_SYSTEM_DRIVER</SPAN></font>
</font></dt>
<dd>
<p>Indicates a filesystem driver.</p>
</dd>
<dt>
<fonT COLOR="#990000"><fONt COlOr="#990000"><SPAN clasS="monofont">win32service.SERVICE_INTERACTIVE_PROCESS</SPAn></fonT>
</FONt></dt>
<dD>
<P>A service process that can interact with the desktop.</P>
</Dd>
</dl>
</dd>
</dl>

<dl>
<dt>
<font color="#990000"><fONT COLoR="#990000"><SpAN cLaSS="monofont">currentState</SPan></foNT>
</FOnt></dt>
<DD>
<P>A combination of the following flags:</P>



<dl>
<dt>
<FONT color="#990000"><font color="#990000"><span claSS="monofont">win32service.SERVICE_STOPPED</SPAN></fONt>
</FOnT></dT>
<DD>
<P>The service isn't running.</p>
</dd>
<dT>
<FONt colOR="#990000"><FOnt coLOR="#990000"><Span class="monofont">win32service.SERVICE_START_PENDING</span></font>
</font></dT>
<DD>
<P>The service is starting.</P>
</Dd>
<DT>
<fONt CoLOR="#990000"><Font cOLOR="#990000"><span CLASs="monofont">win32service.SERVICE_STOP_PENDING</spaN></FONt>
</font></dt>
<dd>
<p>The service is stopping.</p>
</dd>
<dt>
<font coLOR="#990000"><FONt COlOR="#990000"><sPaN CLAss="monofont">win32service.SERVICE_RUNNING</spAN></FOnt>
</foNT></DT>
<dd>
<p>The service is running.</p>
</DD>
<DT>
<font color="#990000"><font color="#990000"><spaN CLASS="monofont">win32service.SERVICE_CONTINUE_PENDING</sPAn></FOnT>
</fONT></Dt>
<dd>
<p>The service continue is pending.</P>
</DD>
<Dt>
<fonT COLor="#990000"><foNT COlor="#990000"><span class="monofont">win32service.SERVICE_PAUSE_PENDING</span></font>
</fONT></DT>
<Dd>
<P>The service pause is pending.</P>
</dD>
<Dt>
<FoNT COlor="#990000"><fONT Color="#990000"><SPAN clasS="monofont">win32service.SERVICE_PAUSED</SPAn></font>
</font></dt>
<dd>
<p>The service is paused.</p>
</dd>
</dl>
</dd>
</DL>

<DL>
<DT>
<fONt COlOr="#990000"><FONT coloR="#990000"><SPAn claSS="monofont">controlsAccepted</SPan></foNT>
</FOnt></dt>
<dd>
<p>A set of flags indicating the controls the service accepts:</p>



<dl>
<dt>
<font color="#990000"><FONT COlOR="#990000"><sPAn ClASS="monofont">win32service.SERVICE_ACCEPT_STOP</Span></fONT>
</Font></dT>
<DD>
<P>The service can be stopped. This enables the
<tt clASS="monofont">SERVICE_CONTROL_STOP</Tt> value.</p>
</dd>
<dt>
<font color="#990000"><font coLOR="#990000"><SPAn CLaSS="monofont">win32service.SERVICE_ACCEPT_PAUSE_CONTINUE</sPaN></FONt>
</fonT></DT>
<Dd>
<p>The service can be paused and continued. This enables the
<tt CLASs="monofont">SERVICE_CONTROL_PAUSE</tt> and
<tT CLAss="monofont">SERVICE_CONTROL_CONTINUE</tt> values.</p>
</dd>
<dt>
<font color="#990000"><fonT COLOR="#990000"><sPAn CLaSs="monofont">win32service.SERVICE_ACCEPT_SHUTDOWN</SPAN></font>
</FONT></dt>
<dd>
<P>The service is notified when system shutdown occurs. This enables the
system to send a <TT Class="monofont">SERVICE_CONTROL_SHUTDOWN</TT> value to
the service. The <TT class="monofont">win32service.ControlService()</tt>
function can't send this control code.</p>

</dd>
</dl>


<p>Windows 2000 supports additional flags. See the Windows NT
documentation for further information.</p>



<dl>
<dt>
<fonT COLOR="#990000"><fONt COlOr="#990000"><SPAN clasS="monofont">win32ExitCode</SPAn></fonT>
</FONt></dt>
<dD>
<P>A Win32 error code the service may set while it's starting or
stopping. If this value is
<TT class="monofont">win32service.ERROR_SERVICE_SPECIFIC_ERROR</tt>, the
next tuple item contains the service-specific error code.</p>
</dd>
<dt>
<font color="#990000"><FONT COlOR="#990000"><sPAn ClASS="monofont">serviceSpecificExitCode</Span></fONT>
</Font></dT>
<DD>
<P>An error code set by the service. This should be ignored unless the
previous item is
<tt clASS="monofont">win32service.ERROR_SERVICE_SPECIFIC_ERROR</Tt>.</p>
</dd>
<dt>
<font color="#990000"><font coLOR="#990000"><SPAn CLaSS="monofont">checkPoint</sPaN></FONt>
</fonT></DT>
<Dd>
<p>A value the service periodically increments to report its progress
during lengthy start, stop, pause, or continue operations. It's
used primarily to indicate to the SCM that meaningful initialization
or termination is still happening.</p>
</dD>
<DT>
<Font cOLOR="#990000"><font color="#990000"><span class="monofont">waitHint</spaN></FONT>
</FoNT></dT>
<Dd>
<P>Specifies an estimate of the amount of time, in milliseconds, that
the service expects a pending start, stop, pause, or continue
operation to take before the service makes its next call to the
<tT CLAss="monofont">win32service.SetServiceStatus()</tt> function with
either an incremented <TT CLass="monofont">checkPoint</tT> value or a change
in <TT Class="monofont">currentState</TT>.</P>
</Dd>
</dl>
</dd>
</dl>




<a name="idx2225"></a><table widTH="515" BORDeR="0" CeLLpAdDING="5">
<tr>
<td ALIGn="left">
<fonT SIZe="+1"><b><i>StartService( )</i></B></FONt>
</td>
<td align="right">
</td>
</tr>
</table>
<hr WIDTH="515" SiZE="3" nOShAdE="true" ALIgn="left" coLOR="black">
<Table WIDTh="515" borDER="0" Cellpadding="5">
<tr>
<td align="left">
</td>
<TD ALIGn="right">
</TD>
</tR>
</TaBlE>
<P>Starts the service identified by the handle.</P>
<Pre clASS="monofont">StartService(handle, args)</Pre>
<h4>Parameters</h4>


<A NAMe="idx2225"></a><dl>
<DT>
<FOnt color="#990000"><font color="#990000"><span cLASS="monofont">handle</SPaN></FoNT>
</fOnT></DT>
<Dd>
<p>A handle to a service, as obtained from
<tt CLASs="monofont">win32service.OpenService()</tt>.</p>
</DD>
<DT>
<font COLOr="#990000"><font color="#990000"><span class="monofont">args</spAN></FONT>
</fONt></DT>
<dD>
<p>A sequence of strings (or Unicode objects) to use as arguments to the
service. <TT CLass="monofont">None</tT> may be specified if no arguments are
required.<A NAme="idx2225"></a></p>
</DD>
</DL>








<h4>B.9.3
servicemanager Module</h4>


<p>
<a NAME="idx2226"></a>The <tt class="monofont">servicemanager</tt>
module is implemented by the Python service framework; thus, there is
no <tt class="monofont">servicemanager</tt> file on disk, and the module is
available only when code is running under the Service Control
Manager. See <a href="pythonwin32_cnode137.html">Chapter 18</A>, for more information.</P>




<TaBLe WIdTh="515" BORDer="0" ceLLPAddinG="5">
<TR>
<Td aliGN="left">
<FOnt size="+1"><b><i>LogMsg( )</i></b></font>
</td>
<td aliGN="right">
</TD>
</TR>
</tABlE>
<Hr WiDTH="515" Size="3" nOSHAde="true" alIGN="left" Color="black">
<TABLe width="515" border="0" cellpaddiNG="5">
<TR>
<TD aLIgN="left">
</Td>
<Td ALIGn="right">
</td>
</tR>
</TABle>
<p>Logs a specific message to the Event Log.</p>
<PRE Class="monofont">LogMsg(errorType, eventId, inserts = ())</PRE>
<H4>Parameters</h4>


<dl>
<dt>
<font color="#990000"><font colOR="#990000"><SPAN cLAsS="monofont">errorType</SpAn></FONT>
</font></DT>
<DD>
<p>An integer that identifies the class of error. May be either the
<tt cLASS="monofont">EVENTLOG_ERROR_TYPE</tt>,
<tt CLASs="monofont">EVENTLOG_WARNING_TYPE</tt>,
<tt class="monofont">EVENTLOG_INFORMATION_TYPE</tt>,
<tt class="monofont">EVENTLOG_AUDIT_SUCCESS</tt>, or
<TT CLASs="monofont">EVENTLOG_AUDIT_FAILURE</TT> constants from the
<tT ClAsS="monofont">servicemanager</TT> module.</P>
</dd>
<dt>
<FONT coloR="#990000"><FONt colOR="#990000"><SPan class="monofont">eventId</span></font>
</font></dt>
<DD>
<P>The event ID, which can be any of the valid IDs listed in the
messages section for this module.</P>
</DD>
<dT>
<FoNT cOlOR="#990000"><FOnt coLOR="#990000"><Span cLASS="monofont">inserts = ()</span></FONT>
</font></dt>
<dd>
<p>A sequence with the inserts for the message. Each sequence item must
be a string and is replaced with the specified marker in the message
text.</p>
</dd>
</dl>




<table wiDTH="515" BORdER="0" cELlPaDDINg="5">
<tr>
<tD ALIgn="left">
<foNT SIze="+1"><b><i>LogInfoMsg( ), LogWarningMsg, ( )LogErrorMsg( )</I></B></FOnt>
</td>
<td align="right">
</td>
</tr>
</table>
<hR WIDTH="515" sIZe="3" NOsHaDE="true" ALign="left" cOLOR="black">
<tablE WIDth="515" boRDER="0" cellpadding="5">
<tr>
<td align="left">
</tD>
<TD ALIgN="right">
</Td>
</TR>
</tAbLE>
<P>Logs a generic informational, warning or error message to the Event
Log.</P>
<pre cLASS="monofont">LogInfoMsg(message)
LogWarningMsg(message)
LogErrorMsg(message)</pre>
<h4>Parameters</H4>


<DL>
<Dt>
<fonT COLor="#990000"><font color="#990000"><span class="monofont">message</sPAN></FONt>
</FOnT></Dt>
<Dd>
<P>A string containing the message to be written.</P>
</DD>
</dl>




<a nAME="idx2227"></A><a namE="idx2228"></A><TAble wIDTH="515" border="0" cellpadding="5">
<tr>
<td ALIGN="left">
<FoNT sIZe="+1"><B><i>Messages</I></B></FOnt>
</td>
<TD ALign="right">
</tD>
</TR>
</Table>
<HR WIdth="515" size="3" noshade="true" align="left" coLOR="black">
<TABlE WiDTh="515" BoRDER="0" cellPADDing="5">
<tR>
<TD Align="left">
</TD>
<TD align="right">
</td>
</tr>
</table>
<p>The <tt clasS="monofont">servicemanager</TT> module contains embedded
messages suitable to write to the Event Log using the methods
described previously.</P>
<P><TaBLe BOrDeR="1" CELlspaCING="0" cellPADDing="1" wIDTH="100%">
<colgroup span="3">
<tr>
<th>
<font sIZE="2">
<P>Message ID</P>
</FoNT></tH>
<Th>
<FoNT SIze="2">
<p>Event Type</p>
</FONT></th>
<th>
<FONT size="2">
<P>Message Text</P>
</FOnt></th>
</tr>
<tr>
<td>
<font size="2">
<p>0xFF</p>
</fONT></TD>
<Td>
<FOnT SiZe="2">
<P>Error</P>
</FOnt></td>
<TD>
<FOnt siZE="2">
<P>%1</P>
</font></TD>
</TR>
<tr>
<td>
<font size="2">
<p>0x1000-<tt class="monofont">PYS_SERVICE_STARTING</tT></P>
</FONT></tD>
<Td>
<FOnT sIZE="2">
<P>Information</p>
</fonT></TD>
<Td>
<fonT SIZe="2">
<p>The %1 service is starting %2.</p>
</fONT></Td>
</tr>
<tr>
<td>
<font size="2">
<p>0x1002-<tt claSS="monofont">PYS_SERVICE_STARTED</TT></P>
</FoNT></tD>
<Td>
<FoNT SIze="2">
<p>Information</p>
</FONT></td>
<td>
<FONT size="2">
<P>The %1 service has started %2.</P>
</FOnt></td>
</tr>
<tr>
<td>
<font size="2">
<p>0x1003-<tt CLASS="monofont">PYS_SERVICE_STOPPING</Tt></P>
</FoNT></tD>
<tD>
<FONt sizE="2">
<P>Information</P>
</Font></tD>
<TD>
<Font sIZE="2">
<P>The %1 service is stopping %2.</p>
</font></td>
</tr>
<tr>
<td>
<font size="2">
<P>0x1004-<TT CLAsS="monofont">PYS_SERVICE_STOPPED</Tt></P>
</FoNt></TD>
<TD>
<font SIZE="2">
<p>Information</p>
</foNT></TD>
<td>
<foNT SIze="2">
<p>The %1 service has stopped %2.</p>
</font></td>
</tr>
<tr>
<td>
<font sIZE="2">
<P>1 to 9</P>
</FoNT></tD>
<Td>
<FoNT SIze="2">
<p>Error</p>
</FONT></td>
<td>
<FONT size="2">
<P>%1</P>
</FOnt></td>
</tr>
<tr>
<td>
<font size="2">
<p>1 to 9</p>
</fONT></TD>
<Td>
<FOnT SiZe="2">
<P>Information</P>
</FOnt></td>
<TD>
<FOnt siZE="2">
<P>%1</P>
</font></TD>
</TR>
<tr>
<td>
<font size="2">
<p>1 to 9</p>
</font></td>
<tD>
<FONT SiZE="2">
<p>Success</P>
</FoNt></TD>
<TD>
<font SIZE="2">
<p>%1</p>
</foNT></TD>
</tr>
<tr>
<TD>
<FOnt size="2">
<p>1 to 9</p>
</font></td>
<td>
<font sIZE="2">
<P>
<A NaME="idx2227"></a>Warning</P>
</FoNt></TD>
<TD>
<font SIZE="2">
<p>%1<a naME="idx2228"></A></P>
</font></TD>
</TR>
</colgroup>
</table></p>


</font>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode197.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode199.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>