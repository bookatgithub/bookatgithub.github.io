<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="3.1 The Python Core on Windows"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode24.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode27.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>3.1
The Python Core on Windows</h3>


<p>
<a NAME="idx201"></a>Python
is an <a naME="idx202"></A>Open
Source tool, and on many platforms, the standard way to install
Python is to download the Python sources and run an automated
procedure for compiling Python on the machine, resulting in Python
binaries that are installed and ready to use. The key advantage of
this process is that it can be customized for a particular
installation; if you have a specific requirement, it can normally be
accommodated.</P>



<p>Under Microsoft Windows, however, this strategy doesn't work.
Most people don't have C compilers, and probably would not be
happy with the arrangements even if they did. Therefore, Python
provides an installation package that contains a version of Python
built with useful default options. The installation allows you to
choose which components are installed from the following:</p>



<ul>
<LI><P>The Python core implemented in a Windows DLL named <I>Python1x.dll</i>
<a name="idx203"></a>
(e.g., <i>Python15.dll</i> for the
Python 1.5 family). This DLL is installed into your PC's
Windows system directory.</p>
</li>
<li><p>The standard Python executable,
<i>Python.exe</i>
<a namE="idx204"></A>.
This provides the default interactive prompt and allows you to run
Python programs. Additionally,
<I>Pythonw.exe</I>
<A NaME="idx205"></a>
is also installed, which allows you to write GUI applications using
Python. Only advanced users should employ
<I>Pythonw.exe</I>, because Python errors aren't
printed; this means that <i>Pythonw.exe</I> usually
appears to do nothing, and this is intentional. You should avoid
using <I>Pythonw.exe</I> until you are proficient with
Python itself.</P>
</LI>
<li><p>A few useful Python <a NAME="idx206"></a>extension modules providing an interface
to such things as <i>.zip</i> compatible
compression, the Tkinter GUI library, and so forth. Python extension
modules are implemented as Windows DLLs, but are typically provided
as <i>.pyd</I> files. For example, the
interface to the zlib compression tool is a DLL named <I>zlib.pyd</I>.</P>
</li>
<li><P>The Python <A NAme="idx207"></a>library
as Python source files (<i>.py</i>). The
Python library contains many useful cross-platform modules for
working with Python. These include the basic Python library (such as
the <tt class="monofont">string</tt> and <tt class="monofont">os</TT> modules), as
well as advanced modules, such as web servers or modules for
inspecting and decoding various audio format files.</P>
</LI>
<Li><P>The Python <A nAMe="idx208"></A>test
suite. This is a set of Python source files that test the Python
installation. In general, you don't need to run these tests:
they are designed primarily to test ports of Python to new
architectures, or by the creators of Python to test major changes to
Python itself. If you really feel a need to run this, you can start
the Python interpreter and execute the command:</P>
</LI>
</UL>
<pre cLASS="monofont">&gt;&gt;&gt; import test.autotest</pre>


<p>Python responds with:</P>



<PRE clasS="monofont">test_grammar
test_opcodes
test_operations
test_builtin
test_exceptions
test_types
test_al
test test_al skipped -- an optional feature could not be imported
...</PRE>


<p>A hundred or so lines will print over the next few minutes; it takes
some time to complete. Note the last message printed; you will see
many of these warnings, and they can be safely ignored.</p>



<ul>
<li><p>The Python
<a name="idx209"></a>documentation
in HTML format, accessible from the Windows Start Menu.</p>
</li>
<li><p>Headers (<i>.h</i>
<A NAME="idx210"></A> files) and libraries
(<i>.lib</I>
<A nAMe="idx211"></A> files) for the C components needed to
build your own extension modules. This is covered in <A href="pythonwin32_cnode170.html">Chapter 22</a><i>.</i></p>
</LI>
<LI><p>The portable GUI environment <a naME="idx212"></A>Tkinter and a Python IDE known as
<A name="idx213"></A>IDLE. Tkinter is
discussed in more detail in <A href="pythonwin32_cnode157.html">Chapter 20</a>, while IDLE
is discussed in <a href="pythonwin32_cnode35.html">Chapter 4</a><i>.</i></p>
</li>
<li><p>Various Python scripts and utility programs. Browse the
<i>\tools</i> subdirectory of your Python installation.</p>
</lI>
</UL>
<P>You should browse the supplied Python documentation. You will find a
reference guide for most of the standard library, as well as the
language <A NaME="idx214"></a>tutorial and reference. Additionally,
you should check for later documentation at
<A NaME="idx215"></A>
<A NAme="idx216"></a>
<a NAME="idx217"></a><a taRGET="_blank" href="http://www.python.org/doc/default.htm">http://www.python.org/doc/</A>; it's quite common for new documentation to be
written between major Python releases, and the latest documentation
is always available for online browsing or download in both HTML and
printable (PostScript/PDF) formats.</P>




<H4>3.1.1
The Windows Registry</H4>


<p>
<a name="idx218"></a>
<a name="idx219"></a>When Python is
installed, a number of configuration options are stored in the
Windows registry. The Windows registry provides a central location
where programs can store their preferences and settings and provides
more features than traditional techniques of saving configuration
information. The Windows registry also has some limitations, and many
people would dearly like to see it suffer a slow and painful death!
Whatever your views, good Windows applications, and therefore Python,
store their information in the Windows registry.</p>



<p>In general, it isn't necessary for you to understand or edit
the registry; Python and any extensions you install normally manages
this for you. Indeed, if you are unfamiliar with the Windows
registry, you should avoid it completely: it's all too easy to
do serious damage to your PC's configuration. However, if you
are experienced with the Windows registry or are curious to see how
everything works, read on.</p>



<p>The most important configuration option stored in the registry is the
<a namE="idx220"></A>PythonPath, the
list of directories where Python looks to find modules, which can be
viewed at runtime via
<I>sys.path</I>
<A NaME="idx221"></a>.
Under Unix, the common way of storing this option is by setting a
<A NaME="idx222"></A>PYTHONPATH environment variable. Under
Windows, this information is stored in the registry rather than in
the environment.<FONt sizE="1"><SUP><a hreF="#FOOTNOTE-1">[1]</A></SUp></fonT>
</P>


<BLockquote><font size="1">
<p clasS="footnote">
<SUP><A NaME="FOOTNOTE-1">[1]</a></SUp>
It should be noted that Python on
Windows can also use the PYTHONPATH environment variable, but by
default the value is stored in the registry.</P>
</FONT></BlockQUOTe>





<p>Python also stores other configuration data in the registry,
including the location where Python was installed, a list of Python
<a nAME="idx223"></A>help files, and so forth. For full details
on Python's use of the registry, please see the Python
documentation.</p>



<p>Let's take a quick look at the Python registry information
using the standard Windows
<a nAME="idx224"></A>Registry
Editor. Start the Registry Editor by executing the program
<i>regedit.exe</i>
<a name="idx225"></a> (or possibly
<i>regedt32.exe</i> on Windows 95, depending on the
configuration). You should see a window that looks similar to the
Windows Explorer: a list of folders on the left, and data on the
right.</p>



<p>Locate the folder named <a name="idx226"></a>HKEY_LOCAL_MACHINE, and expand it. Locate
the sub-folder named Software, and expand it, then continue down
through the Python, PythonCore, 1.5, and PythonPath subfolders. Your
screen should look something like <a href="pythonwin32_snode26.html#4">Figure 3.1</A>, which
shows the default PythonPath (i.e., the path used by the Python core)
has been installed in <I>E:\Program Files\Python</I>,
and the three existing path subkeys: PythonWin, win32, and win32com.
These entries have been added by the Python for Windows extensions
and contain the additional PythonPath entries required by the
respective packages.</P>



<p>If you need to add your own PythonPath entry, you can create a subkey
under the PythonPath key and add your new path entries to the key.
The names of the keys are for documentation purposes only; they are
the name of the package that requires the path entry. Only the key
values are actually used by Python itself.</P>



<P><tABlE BORDEr="0" bgcOLOR="black" cellSPACing="0" cELLPadding="1" width="90%" align="center"><tr><td>
<tABLE BGcOLoR="white" WiDTH="100%" BORder="0" cELLSpaciNG="0" CEllpaDDINg="6"><tr>
<td width="60" valign="top"><img src="FILES/warning_yellow.gif" WIDTH="51" hEIgHT="36"></tD>
<TD VALign="top">
<p>
<A NAMe="idx227"></a>The registry is a system-level tool that
allows you freedom to do irreparable damage to your operating system,
requiring complete re-installation. Be careful with any changes you
make to the registry and make no changes unless you are certain of
their impact.</p>


</tD>
</TR></Table></TD></TR></table></p>

<center>
<h5>
<a name="4"></a>Figure 3.1. The Windows Registry Editor</h5>

<iMG BORDeR="0" WiDTh="502" HEIGHT="309" src="FILES/ppw.0301.gif" aLT="figs/ppw.0301.gif"></CEnter>







<H4>3.1.2
Windows Explorer Integration</H4>


<P>
<A name="idx228"></A>
<A NAme="idx229"></a>If you open the
Windows Explorer after installing Python, you might notice that all
<i>.py</i> and <i>.pyc</i> files have
their own cute
<a name="idx230"></a>Python
icon! If you<a name="idx231"></a>
<a nAME="idx232"></A>
right-click on a <I>.py </I>file, notice the default
menu entry is <a NAmE="idx233"></A>Run; you can select this entry from the
menu or double-click on the <i>.py</I> file to run the
<A NAME="idx234"></a>program using
the standard <i>Python.exe</i>. It's possible
that other Python extensions will install new items in this menu; for
example, PythonWin (discussed later in this chapter) adds an
<a NAME="idx235"></a>Edit item,
allowing you to open the Python source file for editing.</p>



<p>In addition, you can drag these <i>.py</I> files to
your favorite text editor (including PythonWin) for editing. This can
be any editor of your choice, or even the standard Windows
<I>notepad</I> tool.<Font sIZE="1"><Sup><a href="#FOOTNOTE-2">[2]</a></sup></font>
</p>


<blockQUOTE><FoNT sIZe="1">
<P CLASS="footnote">
<sup><a NAME="FOOTNOTE-2">[2]</a></sup>
Many standard
Python library files are supplied with Unix-style line terminators.
<I>notepad</I> is still one of the few Windows editors
unable to cope with files of this format. For this and other reasons,
you shouldn't use <I>notepad</I> to edit Python
source.</p>
</fonT></BLOckquote>





<p>Running Python programs from the Windows Explorer has one major
problem: a new window is created for the Python program, and when it
terminates, the window closes immediately. This means that any
<a name="idx236"></a>messages displayed by the program
(either informational or error messages) usually vanish just as you
are trying to read them. For this reason, most Windows users
don't execute their Python programs in this manner; they do so
either from the Windows command prompt or from a Python integrated
development environment (<a name="idx237"></a>IDE), such as
PythonWin or IDLE.</p>







<H4>3.1.3
Using the Windows Command Prompt</H4>


<P>
<A NAmE="idx238"></A> <a NAmE="idx239"></A>Both the Windows 95/98 and NT/2000
families come with a command prompt allowing users to run programs
from a command-line interface. The Windows command prompt has a long
and not-so-glorious history; it has grown from the first versions of
MS-DOS and still uses the same basic syntax.</P>




<H5>3.1.3.1
Running Python programs</H5>


<P>
<a namE="idx240"></A>For these discussions, let's
assume you have a file named
<I>C:\Scripts\hello.py</I>, and this file consists of
the single line:</p>



<pre CLASs="monofont">print "Hello from Python"</pre>


<P>A first attempt to run this program may surprise you:</P>



<PRe class="monofont">C:\Scripts&gt;python.exe hello.py
The name specified is not recognized as an
internal or external command, operable program or batch file.

C:\Scripts&gt;</pre>


<p>Although <i>Python.exe</i> has been installed, it
hasn't modified the system environment variable
<a name="idx241"></a>PATH: Windows doesn't know how to
find <i>Python.exe</i>. Windows NT does, however, know
how to run <i>.py</I> files directly. Thus, if you ask
the command prompt to execute <I>hello.py</I>, it will:</P>



<PRe CLaSS="monofont">C:\Scripts&gt;hello.py
Hello from Python

C:\Scripts&gt;</pRE>


<P>Take this one step further and avoid the use of the
<I>.py</I> extension, making a Python program appear
like a <I>.exe</i>, <i>.com</i>, or
<i>.bat</I> file. Windows NT supports this using the
<A NAme="idx242"></a>PATHEXT environment variable. You can
view the current settings of this variable by entering the command:</p>



<PRE Class="monofont">C:\Scripts&gt;echo %PATHEXT%
.exe;.bat;.cmd

C:\Scripts&gt;</PRE>


<P>This is a list of the default extensions Windows searches for when a
command is executed. You can add Python files to this list (and check
the change was successful) by executing:</p>



<pre class="monofont">C:\Scripts&gt;set PATHEXT=%PATHEXT%;.py

C:\Scripts&gt;echo %PATHEXT%
.exe;.bat;.cmd;.py

C:\Scripts&gt;</pre>


<p>Now execute your Python programs by specifying the base name of the
file:</p>



<pre clasS="monofont">C:\Scripts&gt;hello
Hello from Python

C:\Scripts&gt;</PRE>


<P>For more information, please see the Windows NT documentation.</P>



<p>Unfortunately, none of this applies to Windows 95 or 98, only to
Windows NT and 2000.
<A NaME="idx243"></a>
<A NAME="idx244"></A>Users of Windows 95 or 98 often take one of the
following actions:</p>



<ul>
<lI><P>Add the Python directory to the system environment variable PATH by
modifying their <I>autoexec.bat</I> file.</p>
</li>
<lI><P>Copy <I>Python.exe</I> to the Windows system directory.
The biggest problems with this are that it's one more file in
an already overused directory, and when Python is upgraded, this file
may cause some conflicts.</p>
</li>
</uL>
<P>The facilities we described that are available under Windows NT
usually make these changes unnecessary.</P>



<P>Finally, both operating systems support using the
<tt class="monofont">start</tt>
<a name="idx245"></a> command to start
<a name="idx246"></a>Python in a separate window. For
example, you could use the command <TT CLASs="monofont">start</TT>
<tT ClASS="monofont">python.exe</TT> to start an interactive
<I>Python.exe</i> in a new window or the command
<tt cLASS="monofont">start</tt> <tt CLASs="monofont">hello.py</tt> to run your
script in a new window. However, just as with Windows Explorer, this
window closes as the program exits, meaning you don't get a
chance to read the message printed by your script.</p>






<H5>3.1.3.2
Command-line editing</H5>


<P>All versions of Windows have some capability for
<A name="idx247"></a>
<a name="idx248"></a>command-line editing:
that is, recalling previous commands that have been entered, so they
can be reexecuted without retyping them.</p>



<p>Windows NT supports command-line editing by default, but Windows 95
and 98 require you to execute a program named
<i>doskey</i>
<a name="idx249"></a> before this functionality is available.
Windows 95 and 98 users often configure their environment so that
<I>doskey</I> is automatically executed whenever a
command prompt is started.</P>



<P>To operate the command-line editing tools, use the
<A NaME="idx250"></a>arrow keys on the
keyboard. The up and down arrows scroll between the commands you
executed recently, while the left and right arrow keys allow you to
edit the current command. In addition, <A NaME="idx251"></A>Windows NT also provides
command-line editing for <I>Python.exe </I>; once you
start Python, you can recall previous commands in the same way you
can at the command prompt. Unfortunately, Windows 95 or 98
doesn't offer this feature.</P>



<p>The <i>doskey</i> program can also provide
<a NAME="idx252"></a>command
macros. A <i>command</i> <i>macro</I> is
a <A NAme="idx253"></a>shortcut you
assign to a program, so when the shortcut is executed the command
prompt, the program is executed.</p>



<P>You can use this to your advantage when working with Python. For
example, Windows 95 users who can't take advantage of the
Windows NT command prompt can use the following command to assign the
shortcut <TT Class="monofont">p</tt> to execute Python:</p>



<pre class="monofont">C:\Scripts&gt; doskey p="C:\Program Files\Python\Python.exe" $*</pre>


<p>The <a nAME="idx254"></A>$* at
the end of the command indicates that any command-line parameters
should be passed to the program, in this case, Python. Thus, you
could execute:</P>



<PrE ClASs="monofont">C:\Scripts&gt;p hello.py
Hello from Python

C:\Scripts&gt;</PRE>


<P>Users of Windows NT and Windows 95 may also like to use these
shortcuts to execute their favorite editor. For example, if you
execute the following commands:</P>



<Pre clASS="monofont">C:\Scripts&gt;doskey n=start notepad.exe $*
C:\Scripts&gt;doskey pw=start pythonwin.exe $*</Pre>


<p>you could use:</p>



<PRE Class="monofont">C:\Scripts&gt;n hello.py</PRE>


<P>to edit the file using <i>notepad</i>, or:</p>



<pre class="monofont">C:\Scripts&gt;pw hello.py</pre>


<p>to edit the file using PythonWin.</p>



<p>To take advantage of these
<i>doskey</i>
<a nAME="idx255"></A> macros, you can place them all in a
single <A NaME="idx256"></a>batch file that can be configured to be run
whenever a command prompt is opened. There are many techniques, but a
simple one is to place all the commands in a batch file, then modify
the shortcut you use to execute the command prompt to include the
parameter <TT cLASS="monofont">/k</TT>
<tt clASS="monofont"><I>your_batchfile.bat</i></tt>. This forces the
command prompt to execute your batch file, but remains open, allowing
you to continue entering commands.</p>






<H5>3.1.3.3
Copy and Paste from the command prompt</H5>


<P>Although fairly minor, there are a couple of other features that can
help you work with Python.</P>



<p>
<a naME="idx257"></A> <A name="idx258"></a> <a name="idx259"></a>
<a name="idx260"></a> <a namE="idx261"></A>The first is Copy and Paste. Both
Windows 95 and NT support an option that allows you to copy text from
the command prompt using the mouse. Windows NT also allows you to
paste information into your command prompt with a simple right-click
of the mouse. This can be handy when you need to paste a string or
sample code into your Python prompt. You can enable this by selecting
the Quick Edit option from the command prompt's properties.</P>



<P>
<A NaME="idx262"></a>
<A NaME="idx263"></A>Another nice
feature for all versions is that you can drag a file from Windows
Explorer and drop it into a command prompt, pasting the full filename
to the prompt. This can be a handy way to execute Python programs
from Windows Explorer without losing the output when the program
completes: simply drop the filename onto an existing command prompt
and press Enter.<A NAme="idx264"></a> <a NAME="idx265"></a></p>








<h4>3.1.4
Windows Gotchas</h4>


<P>
<A NAme="idx266"></a>
<a NAME="idx267"></a>As we have stressed a number of
times, Python is cross-platform. Although the sheer market
penetration of Windows makes it one of Python's most popular
platforms, it's still only one of the many operating systems
Python has to work with.</p>



<p>Accordingly, there are some features available on other platforms
that don't exist on Windows. To make matters worse, there are a
number of features that do work on both platforms, but not in exactly
the same way.</p>



<p>Most people who use Python only on Windows never need to worry about
these features; they have probably never heard of these functions
anyway, and they won't find further comment on them in this
book. But for people moving to Windows from the
<a name="idx268"></a>Unix and
<a name="idx269"></a>Linux worlds, seemingly trivial things can
cause much aggravation. Although far from exhaustive, some of the
more common gotchas are detailed here.</p>




<h5>3.1.4.1
Text-mode versus binary-mode files</h5>


<p>
<A NAME="idx270"></A> <a NAmE="idx271"></A>Since the early days of computing
(well before Unix), lines in text files were terminated with
<i>carriage-return</I>
<A NAME="idx272"></a> and
<i>line-feed</i>
<a NAME="idx273"></a> characters. This is directly
attributable to the early teletype devices that required a command to
move the printhead (or carriage) back to the left, and another to
eject a new line. The creators of Unix decided the convention was
pointless and terminated all lines in text files by the line-feed
character, which by then had become known as the
<i>newline</i>
<a NAME="idx274"></a> character. Then the C language came
up with a new technique for opening files, such that regardless of
the local line-ending conventions, your program would always see a
consistent single newline character at the end of each line. A
differentiation was made between binary- and text-mode files, which
was specified when opening the file.</p>



<p>Unfortunately, over time many Unix programmers became somewhat lazy.
As Unix uses a single newline character to terminate lines anyway,
there was no difference on that operating system between text- and
binary-mode files; the program always worked identically on Unix,
regardless of the mode used to open the file. Over time, it became
common practice for programmers to omit the binary- or text-mode
specifiers completely. To add to the confusion, we also have the
Apple Macintosh, which uses a single carriage return.</p>



<P>Windows traces its roots right back to the old teletype days. Every
version of Windows, including the most recent, has had to retain some
level of compatibility with early versions of MS-DOS, and MS-DOS
itself strove to retain some compatibility with
<A NAme="idx275"></a> <a name="idx276"></a>CP/M. As a
direct result of this history, the common default-line terminator on
Windows is a carriage-return character followed by a newline
character. This is the file format editors such as
<i>notepad</i> use. Most modern editors (including most
you are likely to use with Python) support either line convention.</p>



<p>The end result of all this discussion comes down to two points:</p>



<ul>
<li><p>If you open a file and wish to see a single newline character
terminating each line (regardless of what really terminates the
lines), the file should be opened in text mode. You should open in
text mode on all operating systems, including Unix where it will have
no effect; you never know when some poor soul will try to run your
code on a different operating system!</p>
</lI>
<LI><P>If you open a file and need to see the raw, binary data, you should
specify binary mode.</P>
</Li>
</UL>
<p>If you open a file in text mode, but it contains binary data, the
data often appears corrupt due to the newline and carriage-return
mapping. If you open a file in binary mode but you process it as if
it contained text data, each line may have additional (or missing)
carriage returns at the end of each line.</P>



<P>To open a file in binary mode, append a <tT CLASS="monofont">b</tt> to the
mode in the <tt CLASs="monofont">open()</tt> call. The default is text mode,
but on Windows, you can also specify this by appending a
<tT CLAss="monofont">t</tt>. Thus, to open a file for reading in text mode,
use this:</P>



<PRE class="monofont">file = open(filename, "r")</pre>


<p>Or to open a file for writing in binary mode, use this:</p>



<pre class="monofont">file = open(filename, "wb")</pre>





<H5>3.1.4.2
Fork</H5>


<P>Unix provides a function called
<TT ClASs="monofont">fork()</TT>
<a NAME="idx277"></A> to <A name="idx278"></A> <A NAme="idx279"></a>spawn subprocesses.
<tT CLAss="monofont">fork()</tt> is often used in situations where Windows
programmers would consider using
<A NAMe="idx280"></a>threads. Until
recently, some of the more popular Unix systems didn't have
support for threads, and those that did frequently had their own
proprietary API, making it difficult to write portable, threaded code
for Unix. <tt class="monofont">fork()</tt> has a number of subtleties and
features that make it particularly useful in this context, and thus
<tt class="monofont">fork()</tt> is widespread in the Unix world.</p>



<P>Windows doesn't support <TT CLAsS="monofont">fork()</Tt> and,
unfortunately, doesn't support anything that comes close. If
you have a Unix program that uses <TT cLASS="monofont">fork()</TT>, then
porting it to run under Windows is likely to be significant work and
requires fairly intimate understanding of the program.</p>



<p>In many cases, the best solution is to rebuild this part of the
application for Windows. On a typical Unix machine, creating new
processes (as <tt CLASs="monofont">fork()</tt> does) is a relatively cheap
operation. On Windows, however, the overhead of creating a new
process is significant, so solutions using this architecture on
Windows won't often scale or perform as you would hope.
Rewriting this portion of the application to use multiple threads
instead of multiple processes is often the best solution for Windows.</p>



<P>Python exposes the <TT Class="monofont">fork()</TT> function in the
<TT class="monofont">os</tt> module (i.e.,
<tt class="monofont">os.fork()</tt>
<a name="idx281"></A>) on platforms that support it. As
Windows isn't one of these supporting platforms, using
<TT CLAsS="monofont">os.fork()</Tt> yields an
<TT cLASS="monofont">AttributeError</TT> exception.</p>






<h5>3.1.4.3
Select</h5>


<p>Another common Unixism that causes problems on Windows is the use of
the <TT CLass="monofont">select()</tT>
<A NAme="idx282"></a> function. Under Unix, the
<tT CLAss="monofont">select()</tt> function determines when more input is
available from a file. When your program is reading a file on a disk,
you won't have much use for this function. However, it's
common for programs to be reading from files that are not on disk:
for example, reading the output of another process (i.e., a pipe) or
reading data from a network connection. By being notified when a
particular file has more data available to read, using
<tt class="monofont">select()</tt> allows a program to read from multiple
files concurrently.</p>



<p>Windows does provide the <tt clasS="monofont">select()</TT> function, but it
can be used only with sockets (see <A href="pythonwin32_cnode149.html">Chapter 19</A>).
Attempting to use <tT ClASS="monofont">select()</TT> with a regular Python
file object will fail.</P>



<p>The most common technique on Windows for simple asynchronous
input/output is to use threads; and indeed threads are the only
portable technique to perform this style of I/O in Python. A simple
thread-based solution doesn't scale well once the number of
threads becomes large, so Windows provides other native techniques
for performing asynchronous I/O. Although these techniques are beyond
the scope of this book, they are all fully supported by Python on
Windows.</p>






<h5>3.1.4.4
Pipes</h5>


<P>
<A NAme="idx283"></a>This issue is similar
to the one outlined previously for <tT CLAss="monofont">os.fork()</tt>: a
feature for working with subprocesses that doesn't work as you
may hope on Windows.</P>



<P>Quite often, Unix programs use a function called
<TT class="monofont">os.popen()</tt>
<a name="idx284"></a> to create a child process and
establish a pipe between your process and the new child. Depending on
the direction of the pipe, you can read the output from the process
or supply input to the process. The most common use of
<tt class="monofont">os.popen()</tT> is to execute a program and capture its
output. When you read from the pipe, you are actually reading the
output of the child process.</P>



<P>Although provided under Windows, the <TT ClASs="monofont">os.popen()</TT>
function is practically useless. Due to various bugs in Windows,
<tT CLASS="monofont">os.popen()</tt> works only on Windows NT from a console
(i.e., DOS prompt) program. Windows 95, 98, and Windows NT GUI
programs all fail when attempting to use
<tt CLASs="monofont">os.popen()</tt>.</p>



<P>Bill <A NAme="idx285"></a>Tutt has
come to the rescue with his various <tT CLAss="monofont">popen()</tt>
replacement functions for Windows. These functions are exposed in the
<tt class="monofont">win32pipe</tt>
<a name="idx286"></a> module and documented in the standard
Win32 Extensions Help <a nAME="idx287"></A> <A NaME="idx288"></a>file.<A NaME="idx289"></A></P>



</FOnt>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode24.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode27.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>