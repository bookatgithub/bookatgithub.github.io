<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="4.1 The PythonWin IDE"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode35.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode38.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>4.1
The PythonWin IDE</h3>


<p>
<a NAME="idx387"></a>
<a naME="idx388"></A>PythonWin
is many things. As we discuss in <A href="pythonwin32_cnode157.html">Chapter 20</A>, one of
PythonWin's major roles is to be a Python interface to the
<A NAme="idx389"></a>Microsoft Foundation Classes, allowing
an application to take advantage of some of the more esoteric user
interface features available on Windows.</p>



<p>PythonWin is almost a sample application for these MFC extensions.
Over time, it has slowly developed features that make it useful as an
IDE. As time goes on, we can expect these features to improve.</p>




<h4>4.1.1
The PythonWin Environment</h4>


<p>
<a name="idx390"></a>When
PythonWin starts, it automatically opens its Interactive Window,
where you see the Python copyright message and the standard Python
prompt:</p>


<a name="idx391"></A>
<A NAME="idx392"></a>
<PRe CLaSS="monofont">&gt;&gt;&gt;</PRE>


<P>If you are familiar with Python on any other operating system or have
used the standard <i>Python.exe</i>
included with the Python distribution, you can immediately start
entering Python commands to be executed interactively. <a href="pythonwin32_cnode19.html">Chapter 2</A>, and the Python tutorial (optionally installed
with the Python distribution), describes using Python interactively,
and we discuss some additional PythonWin features later in this
chapter.</p>



<p>As much as possible, PythonWin conforms to the standard
user-interface features of Windows. Thus, you will notice a Windows
toolbar with familiar File <imG BORder="0" aLIGN="absmiddle" width="20" height="16" src="FILES/U2192.gif" alt="figs/U2192.gif"> Open and File <img bORDER="0" AlIGn="absmiddle" WIdTH="20" HEIGht="16" src="FILES/U2192.gif" ALT="figs/U2192.gif"> New icons, and
a fairly standard set of menus at the top of the application. Most of
the items on the menus are obvious, so we won't describe the
exact operation of the File <img bORDEr="0" aliGN="absmiddle" WIdth="20" height="16" src="FILES/U2192.gif" alt="figs/U2192.gif"> Open and File <img borDER="0" ALIgN="absmiddle" WiDTh="20" HEIGHT="16" src="FILES/U2192.gif" aLT="figs/U2192.gif"> New
operations. Instead, we will focus on the features specific to
PythonWin.</P>



<P>Now would be a good time to create a new Python
<a namE="idx393"></A>
<A Name="idx394"></a>source file to demonstrate some of the
features of PythonWin. To create a new file, select the blank
document toolbar item, then select File <IMG Border="0" align="absmiddle" width="20" height="16" src="FILES/U2192.gif" ALT="figs/U2192.gif"> New or press Ctrl-N. A
dialog box appears that asks which type of document to create. Select
Python Script.</p>



<P>A blank source file is created. Type the following code:</P>



<pRE cLASS="monofont">def hello(msg):
    print "Hello, " + msg
    
def main():
    import sys
    print "Script name is", sys.argv[0]
    if len(sys.argv)&gt;=2:
        hello(sys.argv[1])
    else:
        hello("Please say something next time")
        
if __name__=='__main__':
    main()</PRe>


<p>As you type, notice the first feature: Python
<a nAME="idx395"></A>
<a namE="idx396"></A>syntax coloring. If you don't
like the particular styles, they can be changed via the View <IMg borDER="0" Align="absmiddle" width="20" height="16" src="FILES/U2192.gif" alt="figs/U2192.gif">
Options menu. Now save the file as <I>pywindemo.py</I> in a convenient directory, and
you're ready to begin.</P>




<H5>4.1.1.1
Running scripts</H5>


<P>
<a NAmE="idx397"></A>PythonWin
allows you to run arbitrary scripts from within its environment.
Changes to the file are saved before the script is run. You can
execute a script by selecting the <a NAME="idx398"></A>"running man" toolbar button,
and then select File <Img boRDER="0" aligN="absmiddle" WIDth="20" heIGHT="16" src="FILES/U2192.gif" alt="figs/U2192.gif"> Run, or press Ctrl-R.</p>



<p>Let's run the script we just created. When you select this
option, the PythonWin environment should look something like <a href="pythonwin32_snode37.html#5">Figure 4.1</a>.</p>



<center>
<H5>
<A NAME="5"></a>Figure 4.1. PythonWin's Run Script dialog</H5>

<ImG BoRDER="0" WIdth="502" hEIGHt="384" src="FILES/ppw.0401.gif" ALT="figs/ppw.0401.gif"></CenteR>


<P>For now, ignore the debugger, so you can leave everything with its
default values and select OK.</P>



<P>You should see the following message output to the interactive window:</p>



<pre class="monofont">Script name is c:\scripts\pywindemo.py
Hello, Please say something next time</pre>


<p>Notice that the script is run the same way you executed
<tt class="monofont">python.exe</tT> <TT CLAsS="monofont">pywindemo.py</Tt>. The
<TT cLASS="monofont">if __name__=='__main__':</TT> block is entered, and
<tt clASS="monofont">sys.argv</Tt> is used to obtain the command-line
parameters. If you perform this procedure again, you can experiment
with adding command-line arguments in the Run dialog.</p>



<p>
<a NAME="idx399"></a>A handy feature to note is that if
you hold down the Shift key while running the module (i.e., while
clicking the toolbar or by pressing Ctrl-Shift-R), the code runs
without displaying the dialog. This is handy for repeatedly running
the same script with the same arguments.</p>






<h5>4.1.1.2
Import modules</h5>


<P>
<A NAme="idx400"></a>
<a name="idx401"></a>Importing modules in the PythonWin
environment is similar to running Python scripts; they both execute
Python code. However, there is an important distinction between
importing modules and running scripts.</p>



<p>Importing the module <i>pywindemo.py</i>
operates almost identically to typing the Python statement:</p>



<pre clasS="monofont">&gt;&gt;&gt; import pywindemo</PRE>


<P>When a module is imported this way, the <Tt CLaSS="monofont">if __name__=='_
_main__':</tT> block isn't entered, but the name of the
script is entered into the Python namespace.</P>



<P>There are two important differences between the PythonWin import
functionality and simply typing <TT Class="monofont">import</TT>
<TT clasS="monofont">pywindemo</TT>. First, the file is saved; and second,
PythonWin automatically performs a <Tt claSS="monofont">reload()</TT> of the
module if necessary. These features combine to ensure the latest
version of the code is made available.</p>



<p>You can import a module in PythonWin by selecting the
<a name="idx402"></a>Import
toolbar icon, and selecting File <img border="0" aligN="absmiddle" WIDTH="20" hEIgHT="16" src="FILES/U2192.gif" ALT="figs/U2192.gif"> Import or pressing Ctrl-I. If
an editor window has the focus, that module is imported; otherwise, a
dialog is opened allowing you to select the Python module to be
imported.</P>



<p>Let's import the test module. Make sure it's the
foreground window and press Ctrl-I. The status bar displays the
message <tt cLASS="monofont">Successfully</tt> <tt CLASs="monofont">imported</tt>
<tT CLAss="monofont">the</tt> <tt class="monofont">module</tt>
<tt class="monofont">'pywindemo'</tT>, and no message is printed to the
interactive window. So although the module is imported, the
<TT CLAsS="monofont">if __name__=='__main__':</Tt> block isn't
executed.</P>



<P>Now that you've imported the module, you can use it as you
would any Python module. Go to the Interactive Window and type:</p>



<PRE CLAss="monofont">&gt;&gt;&gt; pywindemo.hello("how are you")
Hello, how are you
&gt;&gt;&gt;</prE>


<P>Importing modules is primarily useful when developing or debugging a
fairly large application under PythonWin. For example, let's
assume you have the following code structure:</P>



<Pre clASS="monofont"># module spam1
import spamutil
...
    spamutil.MakeEggs()</Pre>


<p>And another similar module:</p>



<PRE Class="monofont"># module spam2
import spamutil
...
    spamutil.MakeEggs()</pre>


<p>If you find a bug in the <tt class="monofont">spamutil</tt> module, you can
edit it in PythonWin, then import the module. The
<tt clASS="monofont">spam1</TT> and <Tt CLaSS="monofont">spam2</tT> modules will
then also be working with the new version of
<TT CLAss="monofont">spamutil</tt>.</P>






<H5>4.1.1.3
Checking modules</H5>


<P>
<a namE="idx403"></A>PythonWin
includes a function that allows you to check a Python source file
without executing it. The syntax of the source code is checked using
Python itself, while the Python
<I>tabnanny</I>
<a namE="idx404"></A> tool checks the source-code whitespace.
Any syntax or whitespace errors are reported in the PythonWin status
bar.</P>



<P>You can check a module by selecting the <a name="idx405"></a>Check Module toolbar item,
then selecting File <img border="0" align="absmiddle" wIDTH="20" HEiGHt="16" src="FILES/U2192.gif" ALT="figs/U2192.gif"> Check or pressing Ctrl-Shift-C.</P>






<H5>4.1.1.4
Locating source files</H5>


<p>
<a naME="idx406"></A>To assist
in locating your Python source files, PythonWin can look down the
Python
<Tt claSS="monofont">sys.path</TT>
<a namE="idx407"></A>
for a file.</P>



<P>To locate a Python file, select File <img border="0" align="absmiddle" width="20" heIGHT="16" src="FILES/U2192.gif" ALt="figs/U2192.gif"> Locate or press Ctrl-L. A
dialog is displayed asking for the name of a module to locate.</P>



<P>If you enter <tT CLASS="monofont">string</tt> into this dialog, PythonWin
searches the path for a module named <i>string.py</i>. PythonWin should locate and open
the standard Python string module.</P>



<P>This feature is aware of Python packages. You could enter a
<A Name="idx408"></a>module
name of <TT CLass="monofont">pywin.framework.app</tT> to locate the
PythonWin application module in the file <I>pywin\framework\app.py</I>.<A name="idx409"></a></p>







<a name="9"></a>
<h4>4.1.2
Command-Line Parameters</h4>


<p>
<a name="idx410"></a>
<A NAME="idx411"></A>PythonWin supports a number of
command-line parameters as shown in this table.</p>



<P><TaBLe BORDER="1" cellSPACing="0" cELLPaddiNG="1" WIdth="100%">
<colgroup span="2">
<tr>
<th>
<foNT SIZE="2">
<p><B>Command Line</B></p>
</FOnT></TH>
<TH>
<Font sIZE="2">
<P>Description</p>
</fonT></TH>
</Tr>
<tr>
<tD>
<FONt size="2">
<p><tt class="monofont">/edit</tt> <tt clasS="monofont"><I>filename</I></TT></P>
</fONt></TD>
<tD>
<FONT Size="2">
<p>Starts PythonWin and opens the named file for editing.</P>
</FONt></td>
</tR>
<TR>
<Td>
<fonT SIZe="2">
<p><tt class="monofont">/run</tt> <tt class="monofont"><i>filename</i></tT></P>
</FONT></tD>
<Td>
<FOnT SIZE="2">
<P>Starts PythonWin and runs the specified script.</p>
</fonT></TD>
</Tr>
<tr>
<tD>
<FONt sizE="2">
<P><TT class="monofont">/nodde</tt></p>
</font></td>
<td>
<font sIZE="2">
<P>Must be the first parameter. Starts PythonWin without DDE support,
allowing for multiple PythonWin instances.</P>
</FoNT></tD>
</Tr>
<TR>
<TD>
<FOnt siZE="2">
<P><Tt claSS="monofont">/app</TT> <tt clASS="monofont"><I>appmodule</i></tt></p>
</font></td>
<td>
<font size="2">
<p>Treats the named file as a PythonWin application. This is for
advanced users only and is discussed in <A href="pythonwin32_cnode157.html">Chapter 20</A>.</p>
</FOnT></Td>
</TR>
</COLGroup>
</TABLe></p>


<p>By default, PythonWin allows only one instance to be open. If you
attempt to start a new instance of PythonWin, the existing instance
is reused, primarily to support better integration with Windows
Explorer, as described later in this chapter. PythonWin uses
<a NAME="idx412"></a>
<a naME="idx413"></A>Dynamic Data Exchange (DDE) to communicate
between instances, so the <Tt class="monofont">/nodde</tt> parameter can
disable this behavior and allow as many
<a name="idx414"></a>PythonWin instances as you
care to start.</p>



<p>To demonstrate these command lines, close the source file <i>pywindemo.py</i> (leave PythonWin running) and
start a command prompt window. Enter the command:</p>



<prE CLASS="monofont">C:\Somewhere&gt; start pythonwin.exe /edit C:\Scripts\pywindemo.py</pRE>


<p>You should see your existing PythonWin application come to the
foreground, and see <I>pywindemo.py</I>
opened for editing. Switch back to the command prompt and enter the
command:</p>



<PRE CLAss="monofont">C:\Somewhere&gt; start pythonwin.exe /run c:\Scripts\pywindemo.py</prE>


<P>You should see the same messages printed as when you ran the script
directly from PythonWin. Finally, from the command prompt enter:</P>



<Pre clASS="monofont">C:\Somewhere&gt; start pythonwin.exe /nodde /edit c:\scripts\pywindemo.py</Pre>


<p>And a new instance of PythonWin starts, with its own copy of
<i>pywindemo.py</I> open for editing.</P>







<H4>4.1.3
The Interactive Window</H4>


<p>At the most obvious level, the PythonWin
<a name="idx415"></a>interactive window simulates the
built-in Python interpreter in interactive mode. Almost anything you
type in the standard Python shell can be used in PythonWin.</p>



<p>To reexecute blocks of code you previously executed, scroll the
cursor to the old block and press Enter. The block is copied to the
end of the interactive window, allowing you to make any changes
before finally reexecuting the code. Alternatively, the Ctrl-Up and
Ctrl-Down keys allow you to scroll through the previously executed
commands.</p>



<p>
<a name="idx416"></a>PythonWin can also help you locate
the source of
<a namE="idx417"></A>
<A NAMe="idx418"></A>
<A nAMe="idx419"></A>errors in standard Python
tracebacks. All Python tracebacks are printed to
the<A NAME="idx420"></a>
interactive window, and you can double-click (or press Enter) on any
line in a traceback to open the offending line in the editor.</p>



<p>As an example, let's force an error in our test script. Open
the same <i>pywindemo.py</I> created
earlier and select File <IMG bordER="0" ALign="absmiddle" wIDTH="20" height="16" src="FILES/U2192.gif" alt="figs/U2192.gif"> Import. Now close the source file. In
the interactive window, type:</p>



<pre class="monofont">&gt;&gt;&gt; pywindemo.hello(0)</PRE>


<P>PythonWin responds with:</P>



<PrE ClASs="monofont">Traceback (innermost last):
  File "&lt;interactive input&gt;", line 0, in ?
  File "c:\scripts\pywindemo.py", line 2, in hello
    print "Hello, " + msg
TypeError: illegal argument type for built-in operation
&gt;&gt;&gt;</PRE>


<P>If you double-click on the third or fourth lines of this traceback,
the test script is opened, and you are at line 2, the line with the
indicated error.</P>







<H4>4.1.4
The Python Editor</h4>


<p>
<a nAME="idx421"></A>
<a namE="idx422"></A>The PythonWin editor has many features
especially designed for Python programs. In many cases these features
are shared between IDLE and PythonWin; both IDEs use exactly the same
(Python!) code to implement the same features.<FOnt siZE="1"><SUp><a href="#FOOTNOTE-1">[1]</a></sup></font>
 The most important features with a brief description are
provided here:</p>


<blockqUOTE><FOnT SiZE="1">
<p CLASS="footnote">
<Sup><a nAME="FOOTNOTE-1">[1]</A></sup>
And
truth be told, PythonWin stole most of these features after IDLE had
already implemented them. No point reinventing the wheel!</p>
</FONT></blocKQUOte>





<a name="idx423"></a><a name="idx424"></a><a name="idx425"></a><a NAME="idx426"></A><A nAMe="idx427"></A><A nAME="idx428"></A><A Name="idx429"></a><A NAMe="idx430"></a><a nAME="idx431"></A><a namE="idx432"></A><A Name="idx433"></a><a name="idx434"></a><a name="idx435"></a><a name="idx436"></A><A NAME="idx437"></a><A NaME="idx438"></a><A NAME="idx439"></A><a namE="idx440"></A><A Name="idx441"></a><A NAMe="idx442"></a><a nAME="idx443"></A><a name="idx444"></a><a name="idx445"></a><a name="idx446"></a><a naME="idx447"></A><A NAmE="idx448"></A><a NAmE="idx449"></A><A NAMe="idx450"></a><a nAME="idx451"></A><dl>
<dt>
<I><FONt colOR="#990000">Unlimited undo and redo capabilities</FOnt></i></dt>
<dd>
<p>
<a name="idx423"></a>
<a name="idx424"></a>Enough said!</p>
</DD>
<DT>
<I><FoNT cOLoR="#990000">Smart indentation</FONT></I></dt>
<dd>
<P>The editor examines existing source files to determine their
<A NAme="idx425"></a>
<a NAME="idx426"></a>indentation. If configured, the
editor can override your tab preferences to match the existing file.
When indenting an incomplete expression (such as a multiline list
definition or function call), the correct indentation is applied to
line up elements in the list or the call parameters. Entire blocks
can be indented or not to allow easy program restructuring.</p>
</dd>
<DT>
<I><Font color="#990000">Block commenting</font></i></dt>
<dd>
<p>
<a naME="idx427"></A>You can
select a block of text and have it all commented or not with a single
command.</P>
</DD>
<dT>
<I><fONt COLOR="#990000">Comment and multiline string formatting</Font></i></DT>
<DD>
<p>
<a naME="idx428"></A>
<A name="idx429"></A>
<A NAme="idx430"></a>
<a name="idx431"></a>Comment blocks and multiline strings can
be reformatted. This command correctly reformats paragraphs to a
70-character width.</p>
</dd>
<dt>
<i><font coLOR="#990000">Attribute expansion</FONt></I></Dt>
<DD>
<p>
<A NAME="idx432"></A>If you
type the name of a module and certain other objects, then press the
period key, a list box is displayed with a selection of attributes.
The arrow keys allow you to change the selection, and the Tab key
selects it. You can see this by typing <tt clASS="monofont">string.</Tt> in
an editor or interactive window. As this book goes to press, this
feature had not yet been ported to IDLE.</p>
</dd>
<DT>
<I><Font cOLOR="#990000">Call tips</font></i></dt>
<dd>
<p>
<a name="idx433"></a>As you type the
name of a Python function and open the parenthesis, a pop-up window
with information about the function may be displayed. The easiest way
to see this in action is to type <tt claSS="monofont">string.split(</TT>,
and the Call Tip window should display.</P>
</Dd>
<DT>
<i><FOnT COLOR="#990000">Auto completion</font></I></DT>
<Dd>
<p>
<a nAME="idx434"></A>This is a
handy feature that means you need never mistype a variable name
again. You can type the start of any word and press the ALT-/ key to
complete the word. The current file is searched for words, and all
words that match are selected. For example, let's assume you
have an editor window with the code:</p>



<pre CLASs="monofont">import string
strval = string.join(["hi", "there"])</pre>


<p>If you type <tt class="monofont">st</tt> and press ALT-/,
<tt class="monofont">string</TT> is substituted. If you press it again,
<TT CLaSS="monofont">strval</tT> is substituted, and so forth.</P>
</dD>
<DT>
<I><FOnt coLOR="#990000">View whitespace</Font></i></DT>
<DD>
<p>
<a naME="idx435"></A> <A name="idx436"></a> <a name="idx437"></a>As whitespace is significant in
Python, there is an option in PythonWin that allows you to view the
whitespace in your file. Space characters are shown as a soft dot;
tab characters are shown as an arrow. IDLE doesn't support this
feature.</p>
</dd>
<dt>
<i><font COLOR="#990000">Fixed and proportional fonts</FoNT></i></DT>
<dD>
<P>
<A NAMe="idx438"></a> <a nAME="idx439"></A> <a namE="idx440"></A>Many people prefer to use
proportional fonts to edit source code, but proportional fonts often
make it hard to see if your source code is correctly aligned.
PythonWin allows you to choose your preferred fixed and proportional
font and quickly toggle between the two.</P>
</Dd>
<dt>
<i><FONT color="#990000">Integrated object browser</font></i></dt>
<dd>
<p>
<a name="idx441"></a>Each editor window in PythonWin has an
integrated browser window. This window is initially closed, but can
be shown by selecting the <A NAME="idx442"></A>splitter bar on the left side of the window.
This browser allows you to see all the
<a NAmE="idx443"></A>classes and
<a NAME="idx444"></A>functions defined in the current
source file and quickly move between them.</P>
</dd>
<dt>
<I><FONt colOR="#990000">Bookmarks</FOnt></i></dT>
<DD>
<P>The Ctrl-F2 key allows you to set a <a name="idx445"></a>bookmark at any line in a source file.
Pressing F2 moves you between bookmarks defined in the current file.
A bookmark is indicated in the margin of the editor window. Bookmarks
are not available in IDLE.</p>
</dd>
<dt>
<i><font color="#990000">Automatic file backup</FONT></I></Dt>
<DD>
<p>
<A NaME="idx446"></A>
<A NAme="idx447"></a>
<a NAME="idx448"></a>
<a naME="idx449"></A>PythonWin can be configured to save
backup copies of your source files. These backups can be saved either
in the same directory as the original but with the file extensions
changed to <I>.bak</i>, or with the same name into a
<i>bak</i> subdirectory in your Windows
<i>temp</I> directory.<A NAme="idx450"></a> <a name="idx451"></a></p>
</dd>
</dl>






<h4>4.1.5
Python Path Browser</h4>


<p>Available from the Tools menu, the Python <a namE="idx452"></A>path browser is really a bit of a
misnomer. When you open the browser, it does indeed display each
<A NAMe="idx453"></A>directory
on your PythonPath and each
<A nAMe="idx454"></A>module
in that directory. However, the browser also allows you to delve into
the modules, examining the functions and classes defined within.</P>







<H4>4.1.6
Object Browser</H4>


<P>PythonWin supports a fairly simple <A name="idx455"></A>object browser. This allows you to peer
deep inside any Python object, allowing you to discover various
details about the
<A NAme="idx456"></a>object.</p>



<P>In contrast with the Python path browser, the object browser
doesn't browse Python source code: only Python objects. This
means that objects you wish to browse must actually exist in the
Python environment. For example, the only way to browse a Python
module in this browser is to import the module.</P>



<P>The object browser can be found by selecting Tools <Img boRDER="0" align="absmiddle" width="20" height="16" src="FILES/U2192.gif" alT="figs/U2192.gif"> Browser or
by pressing Ctrl-B. A dialog is presented asking for the object to
browse; to browse the sample Python module, enter
<TT CLAsS="monofont">pywindemo</Tt> and select OK.</P>



<P>If you expand the <tT CLASS="monofont">hello()</tt> function in the browser,
you should have a window similar to that shown in <a href="pythonwin32_snode37.html#17">Figure 4.2</A>.</p>



<cenTER>
<H5>
<a namE="17"></A>Figure 4.2. The PythonWin browser</H5>

<Img border="0" width="502" height="214" src="FILES/ppw.0402.gif" ALT="figs/ppw.0402.gif"></CEnTEr>


<P>Because the browser digs deeply into Python's internals, some
of the information presented is quite esoteric. However, it can often
provide useful information about your objects.</P>







<h4>4.1.7
Windows Explorer Integration</H4>


<P>
<A NAMe="idx457"></a>PythonWin provides basic
integration with the Windows Explorer. All <i>.py</i> and <I>.pyw</I> files shown in the Windows Explorer have
an Edit option on their context (i.e.,
<A Name="idx458"></a> <A NAMe="idx459"></a>right-click) menu. Selecting this
option starts PythonWin if it isn't already running, and opens
the file for editing.</p>



<p>You can also drag and drop files from the Windows Explorer into
PythonWin. These files are also open for editing.</P>



<P>
<A Name="idx460"></a>PythonWin has also been registered with
Windows in such a way that it can be run without knowing its specific
location and without having it on your system path. If you select
Start <img border="0" align="absmiddle" widTH="20" HEIGhT="16" src="FILES/U2192.gif" AlT="figs/U2192.gif"> Run from the Windows taskbar and enter
<TT CLAss="monofont">pythonwin</tt>, it's correctly located and
started. From a
<A NAMe="idx461"></a>command prompt, you can also execute the
command <tt CLASs="monofont">start</tt> <tT CLAss="monofont">pythonwin</tt> from
any directory, and PythonWin starts. See the previous section, <a href="pythonwin32_snode37.html#9">Section 4.1.2</a>.</p>







<h4>4.1.8
The Debugger</h4>


<p>
<a name="idx462"></a>PythonWin
also has a built-in Python
<a NAME="idx463"></A>debugger
to help you develop your scripts. The PythonWin debugger includes all
the features you expect in debuggers, including:</P>



<uL>
<Li><P>
<A nAME="idx464"></A>Breakpoints
that can be set at any location. Optionally, these breakpoints may
have a condition that must evaluate to <TT clasS="monofont">true</TT> before
the breakpoint stops.</P>
</li>
<li><P>A <A NAme="idx465"></a>watch window
allowing easy tracking of changes to key variables.</p>
</LI>
<LI><p>Commands allowing you to step into, over, or out of functions.</p>
</li>
</ul>
<p>If you are familiar with other Windows IDE debugging environments
(such as Visual C++, Visual Basic, or Delphi) you should find the
debugger easy to work with.</p>



<p>For a language as flexible as Python, there is one huge limitation in
the
<a name="idx466"></a>
<a name="idx467"></a>debugger that is worth noting. It
isn't possible to modify the code while it's being
debugged. If you spot a bug while debugging, code changes you make
aren't applied until you reload the module. Further, any
source-code changes are likely to disrupt the debugging session, as
the debugger will still be stepping though the original line
positions even though they are likely to have changed.</P>



<P>The simplest way to use the debugger is to run scripts using the same
technique described earlier, but this time select one of the
debugging options. The Run Script dialog provides the following
debugging
<A NAMe="idx468"></A>options:</P>



<dL>
<Dt>
<I><FONT Color="#990000">No debugging</FONT></i></dt>
<dD>
<P>This means that the script runs normally without any debugging; it
doesn't stop at breakpoints.</P>
</Dd>
<dt>
<i><FONT color="#990000">Step through in the debugger</font></i></dt>
<dd>
<p>Steps through each line in the debugger. Selecting this option
invokes the debugger at the first line in our script. The default
PythonWin configuration binds the F11 (step in) or F10 (step over)
keys to this function.</p>
</dd>
<dt>
<i><FONT COlOR="#990000">Run in the debugger</fONt></I></DT>
<DD>
<P>Runs the script under the debugger, stopping only at breakpoints. If
you select this option when no breakpoints are set, PythonWin warns
you that the debugger is unlikely to be invoked. Of course, PythonWin
can't determine if your breakpoints are on lines that are
actually executed. If none of your breakpoints are actually hit, this
command appears to run without the debugger at all; the script starts
and completes normally (albeit slightly slower due to the debugger
overhead). The default PythonWin configuration binds the F5 key (Go)
to this function.</p>
</dd>
<dT>
<I><FOnt coLOR="#990000">Postmortem of unhandled exceptions</Font></i></DT>
<DD>
<p>The script isn't run under the debugger, but if an unhandled
exception occurs, the debugger is invoked to perform postmortem
analysis. This can be handy, as it can show you the complete state of
your Python program, including all variable values, at the point
where the exception was raised. If your script runs successfully
(i.e., doesn't generate a traceback while running), this option
has no effect.</p>
</dd>
</dl>


<p>The following discussion demonstrates the debugger using the same
script developed earlier in this chapter. For the example, set a
breakpoint at the first line of the <tt class="monofont">main()</tt>
function. You can set a breakpoint by moving to the line where the
breakpoint should be applied and either display the debugging toolbar
(View <img boRDER="0" ALiGN="absmiddle" wIDtH="20" HEIGHt="16" src="FILES/U2192.gif" ALT="figs/U2192.gif"> Toolbars <Img boRDER="0" aligN="absmiddle" WIDth="20" height="16" src="FILES/U2192.gif" alt="figs/U2192.gif"> Debugging) and selecting the appropriate
button or press the F9 key. PythonWin should respond by placing a
breakpoint indicator in the margin of the editor window. The
breakpoint is simply a black outline as shown in <a href="pythonwin32_snode37.html#22">Figure 4.3</a>, to indicate the breakpoint is currently
disabled (the debugger isn't yet running).</p>



<CENTER>
<h5>
<A NaME="22"></a>Figure 4.3. PythonWin about to debug our sample script</H5>

<IMG BOrder="0" WIDTh="502" heiGHT="402" src="FILES/ppw.0403.gif" alT="figs/ppw.0403.gif"></CENter>


<p>Select the OK button, and if all goes well, the PythonWin debugger
kicks in, and you will be stopped at your breakpoint. Notice a number
of changes to the PythonWin environment, as shown in <a href="pythonwin32_snode37.html#23">Figure 4.4</a>. The most obvious are:</p>



<ul>
<li><p>A new Debugging toolbar appears, giving access to debugger-related
features (this toolbar can always be displayed using View <img boRDER="0" ALiGN="absmiddle" wIDtH="20" HEIGHt="16" src="FILES/U2192.gif" ALT="figs/U2192.gif">
Toolbars <Img boRDER="0" aligN="absmiddle" WIDth="20" height="16" src="FILES/U2192.gif" alt="figs/U2192.gif"> Debugging).</p>
</li>
<li><p>A few new debugging windows appear. These windows can be docked in
the PythonWin frame or left floating. <a href="pythonwin32_snode37.html#23">Figure 4.4</A>
shows the Stack window docked on the left side of PythonWin, and the
Breakpoints and Watch windows floating.</P>
</lI>
<Li><P>The debugger breakpoint turns red, indicating the debugger is active.</P>
</lI>
<LI><P>The Interactive Window shows a <TT clasS="monofont">[Dbg]</TT> indicator
before the standard <Tt claSS="monofont">&gt;&gt;&gt;</TT> and
<tt clASS="monofont">...</Tt> prompts, indicating that expressions you enter
will be evaluated under the debugger's current context rather
than in the global context used by default. This means you can view
or change any local or global variables in the debugger's
current function.</p>
</li>
</ul>
<center>
<h5>
<a name="23"></a>Figure 4.4. PythonWin debugging our sample script</h5>

<iMG BORDeR="0" WiDTh="502" HEIGHT="411" src="FILES/ppw.0404.gif" aLT="figs/ppw.0404.gif"></CEnter>


<P>At this point, you can experiment with some of the debugger windows
and use the debugger toolbar (or the keyboard shortcuts) to step
through the program. <A href="pythonwin32_snode37.html#23">Figure 4.4</a> shows the debugger
after stopping at the breakpoint and selecting the Step command once.</p>




<H5>4.1.8.1
Hard breakpoints</H5>


<P>
<A name="idx469"></a>
<a name="idx470"></a>The term <i>hard breakpoint</i>
refers to the process of changing your source code to explicitly
invoke the debugger. You add a line of code that invokes the debugger
directly, regardless of how you are running the script. These
breakpoints are called hard because they can't be removed by
the debugger: they are embedded in your code, and there is no way to
reset them other than again changing the code!</p>



<p>Hard breakpoints are particularly useful when you are unable or would
find it difficult to run your scripts under PythonWin. You can add a
hard breakpoint to almost any Python program, be it a PythonWin
program or even a Python COM object running under Active Server Pages
or Internet Explorer. In almost all cases, the PythonWin debugger
environment will start up, and you can debug to your heart's
content.</p>



<p>You can set a hard breakpoint by calling the function
<tt clASS="monofont">pywin.debugger.brk()</TT>
<A nAMe="idx471"></A>. It's likely that you will need
to import the
<Tt CLASS="monofont">pywin.debugger</Tt>
<a naME="idx472"></A> module before making the call, so the
code to invoke the debugger typically looks like:</P>



<pre cLASS="monofont">import pywin.debugger
pywin.debugger.brk()</pre>


<p>The PythonWin debugger is installed with thorough documentation,
including a tutorial and sample code that demonstrates these
techniques. You should familiarize yourself with this documentation
to discover other<A NAMe="idx473"></a> debugger<a name="idx474"></a>
features.<a name="idx475"></a></p>



</font>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode35.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode38.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>