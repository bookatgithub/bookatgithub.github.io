<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="6.1 Doubletalk"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode49.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode52.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>6.1
Doubletalk</h3>


<p><i></I>
<A NAme="idx546"></a>The example application is a
slimmed-down version of a set of tools developed by one of the
authors over the last few years. The toolkit is intended to be a
language for <i>double-entry
bookkeeping</I>
<A NAme="idx547"></a>, hence the name
<i>DoubleTalk</I>. The original intention, many years
ago, was to develop a language for dealing with financial objects, in
which users could express and solve a variety of financial problems.
An absolute requirement is for end users to be able to work
interactively and compile and run their own scripts. Python took away
the need to create a whole new language; all that is needed is a
<A NAme="idx548"></a>class
library.</p>



<p>We believe this general approach has great benefits in other fields.
If you can build a class library to capture the essence of some
problem domain and expose those classes to users in an easy-to-use
environment like Python, you give them the ability to create new
applications for themselves.</p>



<p><table border="0" bgcOLOR="black" CElLSpACiNG="0" CELLpaddING="1" Width="90%" ALIGn="center"><tr><tD>
<TABle bgcolor="white" width="100%" border="0" cELLSPAcINg="0" CElLPADDIng="6"><tr>
<TD WIdth="60" vALIGn="top"><img src="FILES/warning_yellow.gif" Width="51" height="36"></td>
<td valign="top">
<p>Since this is an example in a book and not a commercial product,
let's clearly state our "quality objective." We
want a simple class library that lets a careful user write scripts to
manipulate financial data. We aren't creating a
production-quality application that checks everything and saves the
user from all possible mistakes, and there will be a number of
shortcuts and hacks a production application would not take;
we'll point these out as we go.</P>


</TD>
</TR></TaBLe></TD></tR></TABLE></p>

<p>The core of the library is a pair of classes,
<tt CLASs="monofont">Transaction</tt>
<a NAME="idx549"></a> and
<tt cLASS="monofont">BookSet</tt>
<a name="idx550"></a>, which aim to capture the essence of a
set of accounts. They enforce the rules of accounting that must be
obeyed, but allow the user to perform a wide range of high-level
manipulations.</p>



<p>
<a name="idx551"></a>Applications
for the toolkit might include:</p>



<dl>
<dt>
<I><FONT CoLOr="#990000">Doing real accounts </FOnT></I></DT>
<DD>
<p>Although the class library could do this, it probably
shouldn't; the place for a small company's accounts is in
a commercial accounting package, and the place for a large
company's accounts is in a well-managed and secure database.
Nevertheless, the toolkit could be used as a layer on top of a
more-secure form of storage.</p>
</dd>
<DT>
<I><Font cOLOR="#990000">Doing forecast accounts</font></I></DT>
<Dd>
<p>You can write a Python simulation program to generate streams of
future transactions. Such a simulation starts off with some sort of
real accounts to date and adds expected future transactions. This
builds a seamless picture for a business in which past and future
results are evaluated on the same basis.</p>
</dd>
<dt>
<i><font color="#990000">Matching up sets of accounts</font></I></DT>
<DD>
<P>Accountants and financial analysts often need to compare accounts.
The comparison could be for different companies, different periods
with varying accounting standards, or several subsidiaries needing to
consolidate accounts into one coherent set of books. To do this you
need interactive tools to spot gaps, close them with the right
entries, establish the transformations, and write cleanup scripts.</p>
</DD>
<dT>
<I><fONT COLor="#990000">Data laundering</foNT></I></Dt>
<dd>
<p>You can acquire data from various databases and manual sources and
write scripts to convert the data into transactions, integrating them
into one overall picture of a business.</P>
</DD>
<Dt>
<i><foNT COlor="#990000">Market models </font></i></dt>
<dd>
<p>In the securities business people frequently model the behavior of
financial instruments under various conditions. These instruments can
be created as objects that generate transactions in response to
chronology or changing economic variables. A Python simulation
won't be as fast as C++, but you can have it today instead of
next month. The model output includes detailed portfolio breakdowns
(the balance sheet) at each point, as well as a profit-and-loss
picture.</p>
</dd>
<dt>
<i><foNT COLOr="#990000">Reporting</FOnT></I></dT>
<DD>
<P>Financial reports can be complex; they involve a lot of tables with
numbers. But there are also things that must add up and rules the
numbers must obey. These constraints derive from the double-entry
accounting model, and reports are far easier to design if you start
with a coherent data model.</P>
</Dd>
</dl>


<p>Why use Python? Quite simply, because all these tasks vary slightly
from company to company and from situation to situation. Rather than
a monolithic application, what you need is a basic set of tools for
dealing with financial objects that ensure the rules are respected
and a macro language to let you customize their
behavior.<I></I>
<A Name="idx552"></a></P>

</FONt>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode49.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode52.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>