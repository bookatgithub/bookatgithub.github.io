<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="9.4 Server-Side COM Again: Excel as a GUI"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode70.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode72.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>9.4
Server-Side COM Again: Excel as a GUI</h3>


<p>
<a NAME="idx875"></a>
<a naME="idx876"></A> <A name="idx877"></A>Excel makes a wonderful frontend for
financial applications. We've already built a COM server that
can handle all of our data and return certain views. There's a
strong case for turning things on their heads and having Excel use
Python COM objects in many circumstances. We won't go through
an example here, as we have covered all the necessary techniques in
detail, but it's worth thinking about what's possible.</P>



<P>Imagine you regularly generate a set of management accounts,
including results for the year to date and a forecast a year ahead,
and that you extend this with various views of the data. You could
easily build an Excel spreadsheet that starts a COM server when
opened. Where our VB GUI had to do a double loop over the data to get
it into a grid on screen, Excel can insert whole arrays into
worksheets in a split second. You can configure sheets within the
workbook to display arbitrary views of the data and link charts to
these views. Some of these would be user-configurable; for example,
selecting an account or customer from a combo box at the top of a
sheet could fill the sheet with the relevant data, and a chart below
it would be updated automatically.</P>



<p>This is the ideal format in which to deliver numbers to a user; they
can immediately start doing their own calculations and building
charts or comparisons of the data that interest them.</p>



<p>You could as easily build import applications that allow users to
prepare data for import and click a submit button to save it into a
<tt class="monofont">BookSet</tt>. This involves either writing the
table-processing code in VB or extending the COM server with some
import functionality.</p>



<p>When should you use <a name="idx878"></a>Python as the client and when as the
server? There are two factors to consider:</p>



<DL>
<DT>
<I><FoNT cOLoR="#990000">Who's starting things off?</fONT></I></dt>
<dd>
<P>If a user wants to work interactively with a spreadsheet, that
implies Excel on top and a Python COM server. If a spreadsheet
import/export is one step in the execution of a much larger Python
script that runs over 200 files at 2:00 a.m., do it the other way
around.</P>
</DD>
<dt>
<i><fONT Color="#990000">Does it require complex formatting or manipulation in Excel?</FONT></i></dt>
<dd>
<p>If you're getting data out of Excel, you need to know only the
cell references, which we've covered. If you want to build
complex spreadsheets in the middle of the night, where the formatting
depends on the data, consider writing the code in VBA. The
spreadsheet can have an AutoOpen macro that starts up a Python COM
server to deliver the data, and the fetching and formatting can be
handled in Excel. The code will be the same length, but a lot easier
to develop and debug in VBA.</p>
</dd>
</dl>
</font>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_snode70.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode72.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>