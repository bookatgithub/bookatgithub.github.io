<HTML><HEAD><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="11.1 DCOM"-->
<LINK REL="stylesheet" href="FILES/sbolM.css">
</HEAD>
<BODY link="#354278" vlink="#000066" alink="#000080" topmargin="0">
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode85.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode88.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
<FONT>
<h3>11.1
DCOM</h3>


<p>
<a NAME="idx1048"></a>
<a naME="idx1049"></A>Distributed
COM does it all for you. You don't have to change a single line
of your Python code. All you need is to enable a few settings on the
server (which are not specific to this application, but to DCOM in
general) and to change one line in the client code. Here are the
steps:</P>



<ol tyPE="1">
<LI><p>DCOM needs to be enabled on the remote server. Choose Start <img border="0" align="absmiddle" width="20" hEIGHT="16" src="FILES/U2192.gif" AlT="figs/U2192.gif">
Run and type <Tt CLASS="monofont">dcomcnfg.exe</Tt>. A configuration dialog
starts up. Select the Default Properties tab and check the box for
Enable Distributed COM on this computer.</p>
</li>
<LI><P>Python and PythonWin should be installed properly on the server, and
the Doubletalk COM server should be registered.</P>
</li>
<li><P>In our Visual Basic program, go to the line of code where we create
the <TT Class="monofont">BookServer</TT>, and add a parameter for the remote
machine name. We added an extra box in the Options dialog, the
contents of which are stored in the variable
<TT class="monofont"><i>RemoteMachine</i></tt>. Here's the startup
code:</p>

<pre class="monofont">Set BookServer = CreateObject("Doubletalk.BookServer", <tt cLASS="monofont"><I>RemoteMachine</I></tT>)</PrE>


<P>If the string <tT CLASS="monofont"><i>RemoteMachine</i></tt> is empty, the
local server starts up. Otherwise, DCOM talks to the remote machine,
and the <TT CLass="monofont">BookServer</tT> starts up there. All calls to
the COM object and any return values (including large arrays of data)
are automatically packaged and transported across the network.</P>

</LI>
</ol>



<p>To demonstrate this, we created a data file called
<i>remotedata.dtj</I> on a machine called
y<I>osemite</I> and ran the client on a different
machine. In the Options box input the name
<I>yosemite</i> and hit the Reload button. At this
point, the COM server starts on the remote machine. If you
don't get an error message, it's connected. Then, in the
File <img border="0" align="absmiddle" width="20" hEIGHT="16" src="FILES/U2192.gif" AlT="figs/U2192.gif"> Open dialog, type the path of the file on
<I>yosemite (</i>you can't browse for it as it
isn't on the client system), and the remote file loads. Note
the window caption in <A href="pythonwin32_snode87.html#1">Figure 11.1</A>.</p>



<cenTER>
<H5>
<a namE="1"></A>Figure 11.1. Remote server with one line of code</H5>

<Img boRDER="0" width="502" height="239" src="FILES/ppw.1101.gif" alt="figs/ppw.1101.gif"></centER>

</FONT>
 
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right"><a href="pythonwin32_cnode85.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a> <a href="pythonwin32_snode88.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a></td></table>
</BODY></HTML>