<html><head>
<META http-equiv="Content-Type" content="text/html">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="7.13 The poplib Module"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
	<a href="0596000960_pythonsl-CHP-7-SECT-12.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0596000960_pythonsl-CHP-7-SECT-14.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><A NAME="pythonsl-CHP-7-SECT-13"></A>
<H3 class="docSection1Title">7.13 The poplib Module</H3>

<P class="docText">

<A NAME="IXTR3-83"></A>
<A NAME="IXTR3-84"></A>
<A NAME="IXT-7-189739"></A>
<A NAME="IXT-7-189740"></A>

The <TT>poplib</TT> module (shown in <A class="docLink" HREF="#pythonsl-CHP-7-EX-28">Example 7-28</A>) provides a <span class="docEmphasis">Post Office Protocol</span>
(POP3) client implementation.  This protocol is used to
"pop" (copy) messages from a central mail server to your
local computer.</P>


<H5 class="docExampleTitle"><A NAME="pythonsl-CHP-7-EX-28"></A>Example 7-28. Using the poplib Module</H5>

<PRE>
File: poplib-example-1.py

import poplib
import string, random
import StringIO, rfc822

SERVER = "pop.spam.egg"

USER  = "mulder"
PASSWORD = "trustno1"

# connect to server
server = poplib.POP3(SERVER)

# login
server.user(USER)
server.pass_(PASSWORD)

# list items on server
resp, items, octets = server.list()

# download a random message
id, size = string.split(random.choice(items))
resp, text, octets = server.retr(id)

text = string.join(text, "\n")
file = StringIO.StringIO(text)

message = rfc822.Message(file)

for k, v in message.items():
    print k, "=", v

print message.fp.read()

<B>subject = ANN: (the eff-bot guide to) The Standard Python Library
message-id = &lt;199910120808.KAA09206@spam.egg&gt;
received = (from fredrik@spam.egg)
 by spam.egg (8.8.7/8.8.5) id KAA09206
 for mulder; Tue, 12 Oct 1999 10:08:47 +0200
from = Fredrik Lundh &lt;fredrik@spam.egg&gt;
date = Tue, 12 Oct 1999 10:08:47 +0200
to = mulder@spam.egg

...</B></PRE>


<a href="0596000960_"><img src="FILES/pixel.gif" width="1" height="1" border="0"></a><ul></ul>
</td>
</tr>
</table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
          <a href="0596000960_pythonsl-CHP-7-SECT-12.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0596000960_pythonsl-CHP-7-SECT-14.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
