<html><head>
<META http-equiv="Content-Type" content="text/html">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="7.14 The imaplib Module"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
	<a href="0596000960_pythonsl-CHP-7-SECT-13.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0596000960_pythonsl-CHP-7-SECT-15.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><A NAME="pythonsl-CHP-7-SECT-14"></A>
<H3 class="docSection1Title">7.14 The imaplib Module</H3>

<P class="docText">

<A NAME="IXT-7-189741"></A>
<A NAME="IXT-7-189742"></A>
<A NAME="IXT-7-189743"></A>
<A NAME="IXT-7-189744"></A>

The <TT>imaplib</TT> module, shown in <A class="docLink" HREF="#pythonsl-CHP-7-EX-29">Example 7-29</A>, provides an <span class="docEmphasis">Internet Message Access
Protocol</span> (IMAP) client implementation.  This protocol lets
you access mail folders stored on a central mail server as if they
were local.</P>


<H5 class="docExampleTitle"><A NAME="pythonsl-CHP-7-EX-29"></A>Example 7-29. Using the imaplib Module</H5>

<PRE>
File: imaplib-example-1.py

import imaplib
import string, random
import StringIO, rfc822

SERVER = "imap.spam.egg"

USER  = "mulder"
PASSWORD = "trustno1"

# connect to server
server = imaplib.IMAP4(SERVER)

# login
server.login(USER, PASSWORD)
server.select()

# list items on server
resp, items = server.search(None, "ALL")
items = string.split(items[0])

# fetch a random item
id = random.choice(items)
resp, data = server.fetch(id, "(RFC822)")
text = data[0][1]

file = StringIO.StringIO(text)

message = rfc822.Message(file)

for k, v in message.items():
    print k, "=", v

print message.fp.read()

server.logout()

<B>subject = ANN: (the eff-bot guide to) The Standard Python Library
message-id = &lt;199910120816.KAA12177@larch.spam.egg&gt;
to = mulder@spam.egg
date = Tue, 12 Oct 1999 10:16:19 +0200 (MET DST)
from = &lt;effbot@spam.egg&gt;
received = (effbot@spam.egg) by imap.algonet.se (8.8.8+Sun/8.6.12)
id KAA12177 for effbot@spam.egg; Tue, 12 Oct 1999 10:16:19 +0200
(MET DST)

body text for test 5</B></PRE>


<a href="0596000960_"><img src="FILES/pixel.gif" width="1" height="1" border="0"></a><ul></ul>
</td>
</tr>
</table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
          <a href="0596000960_pythonsl-CHP-7-SECT-13.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0596000960_pythonsl-CHP-7-SECT-15.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
