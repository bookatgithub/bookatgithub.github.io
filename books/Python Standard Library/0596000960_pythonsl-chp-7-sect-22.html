<html><head>
<META http-equiv="Content-Type" content="text/html">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="7.22 The cgi Module"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
	<a href="0596000960_pythonsl-CHP-7-SECT-21.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0596000960_pythonsl-CHP-7-SECT-23.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><A NAME="pythonsl-CHP-7-SECT-22"></A>
<H3 class="docSection1Title">7.22 The cgi Module</H3>

<P class="docText">

<A NAME="IXT-7-189769"></A>
<A NAME="IXT-7-189770"></A>

  The <TT>cgi</TT> module provides a number of support functions and classes for CGI scripts.  Among other things, it can
parse CGI form data.</P>

<P class="docText"><A class="docLink" HREF="#pythonsl-CHP-7-EX-40">Example 7-40</A> shows a simple CGI script that returns a list of a files in a given
directory (relative to the root directory specified in the script).</P>


<H5 class="docExampleTitle"><A NAME="pythonsl-CHP-7-EX-40"></A>Example 7-40. Using the cgi Module</H5>

<PRE>
File: cgi-example-1.py

import cgi
import os, urllib

ROOT = "samples"

# header
print "text/html"
print

query = os.environ.get("QUERY_STRING")
if not query:
    query = "."

script = os.environ.get("SCRIPT_NAME", "")
if not script:
    script = "cgi-example-1.py"

print "&lt;html&gt;"
print "&lt;head&gt;"
print "&lt;title&gt;file listing&lt;/title&gt;"
print "&lt;/head&gt;"
print "&lt;/html&gt;"

print "&lt;body&gt;"

try:
    files = os.listdir(os.path.join(ROOT, query))
except os.error:
    files = []

for file in files:
    link = cgi.escape(file)
    if os.path.isdir(os.path.join(ROOT, query, file)):
        href = script + "?" + os.path.join(query, file)
        print "&lt;p&gt;&lt;a href= '%s'&gt;%s&lt;/a&gt;" % (href, cgi.escape(link))
    else:
        print "&lt;p&gt;%s" % link

print "&lt;/body&gt;"
print "&lt;/html&gt;"

<B>text/html

&lt;html&gt;
&lt;head&gt;
&lt;title&gt;file listing&lt;/title&gt;
&lt;/head&gt;
&lt;/html&gt;
&lt;body&gt;
&lt;p&gt;sample.gif
&lt;p&gt;sample.gz
&lt;p&gt;sample.netrc
...
&lt;p&gt;sample.txt
&lt;p&gt;sample.xml
&lt;p&gt;sample~
&lt;p&gt;&lt;a href='cgi-example-1.py?web'&gt;web&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;</B></PRE>


<a href="0596000960_"><img src="FILES/pixel.gif" width="1" height="1" border="0"></a><ul></ul>
</td>
</tr>
</table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#CCCCCC">
<td><font color="black" size=1>I l<font color="#FF0000">@</font>ve RuBoard</td>
<td valign="top" class="v2" align="right">
          <a href="0596000960_pythonsl-CHP-7-SECT-21.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0596000960_pythonsl-CHP-7-SECT-23.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
