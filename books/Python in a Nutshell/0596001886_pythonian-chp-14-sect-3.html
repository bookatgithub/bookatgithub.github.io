<html><head>
<META http-equiv="Content-Type" content="text/html">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="14.3 The Queue Module"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
	<a href="0596001886_pythonian-chp-14-sect-2.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0596001886_pythonian-chp-14-sect-4.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><A NAME="pythonian-CHP-14-SECT-3"></A>
<H3 class="docSection1Title">14.3 The Queue Module</H3>

<P class="docText"><A NAME="pythonian-CHP-14-ITERM-6764"></A>
<A NAME="pythonian-CHP-14-ITERM-6765"></A>
<A NAME="pythonian-CHP-14-ITERM-6766"></A>The <TT>Queue</TT> module
supplies first-in, first-out (FIFO) queues that support multithread
access, with one main class and two exception classes.</P>

<A NAME="ch14-77008"></A><A NAME="pythonian-CHP-14-ITERM-6767"></A><A NAME="pythonian-CHP-14-ITERM-6768"></A><A NAME="pythonian-CHP-14-ITERM-6769"></A><A NAME="pythonian-CHP-14-ITERM-6770"></A><A NAME="pythonian-CHP-14-ITERM-6771"></A><A NAME="pythonian-CHP-14-ITERM-6772"></A><table width="515" border="0" cellpadding="5">
<tr>
<td align="left"><b><i>Queue</i></b></td>
<td align="right"></td>
</tr>
</table>
<hr width="515" size="3" noshade="true" align="left" color="black">
<table width="515" border="0" cellpadding="5">
<tr>
<td align="left">
<pre>class Queue(<TT><I>maxsize</I></TT>=0)</pre>
</td>
<td align="right"></td>
</tr>
</table>
<P class="docText"><TT>Queue</TT> is the main class for module
<TT>Queue</TT> and is covered in the next section. When
<TT><I>maxsize</I></TT> is greater than
<TT>0</TT>, the new <TT>Queue</TT> instance
<TT><I>q</I></TT> is deemed full when
<TT><I>q</I></TT> has <TT><I>maxsize</I></TT>
items. A thread inserting an item with the
<TT><I>block</I></TT> option, when
<TT><I>q</I></TT> is full, suspends until another thread
extracts an item. When <TT><I>maxsize</I></TT> is less
than or equal to <TT>0</TT>, <TT><I>q</I></TT>
is never considered full, and is limited in size only by available
memory, like normal Python containers.</P>

<A NAME="ch14-77009"></A><table width="515" border="0" cellpadding="5">
<tr>
<td align="left"><b><i>Empty</i></b></td>
<td align="right"></td>
</tr>
</table>
<hr width="515" size="3" noshade="true" align="left" color="black">
<table width="515" border="0" cellpadding="5">
<tr>
<td align="left"></td>
<td align="right"></td>
</tr>
</table>
<P class="docText"><TT>Empty</TT> is the class of the exception that
<TT><I>q</I></TT><TT>.get(False)</TT> raises
when <TT><I>q</I></TT> is empty.</P>

<A NAME="ch14-77010"></A><table width="515" border="0" cellpadding="5">
<tr>
<td align="left"><b><i>Full</i></b></td>
<td align="right"></td>
</tr>
</table>
<hr width="515" size="3" noshade="true" align="left" color="black">
<table width="515" border="0" cellpadding="5">
<tr>
<td align="left"></td>
<td align="right"></td>
</tr>
</table>
<P class="docText"><TT>Full</TT> is the class of the exception that
<TT><I>q</I></TT><TT>.put(</TT><TT><I>x</I></TT><TT>,False)</TT>
raises when <TT><I>q</I></TT> is full.</P>

<P class="docText">An instance <TT><I>q</I></TT> of class
<TT>Queue</TT> supplies the following methods.</P>

<A NAME="ch14-77011"></A><A NAME="pythonian-CHP-14-ITERM-6773"></A><A NAME="pythonian-CHP-14-ITERM-6774"></A><table width="515" border="0" cellpadding="5">
<tr>
<td align="left"><b><i>empty</i></b></td>
<td align="right"></td>
</tr>
</table>
<hr width="515" size="3" noshade="true" align="left" color="black">
<table width="515" border="0" cellpadding="5">
<tr>
<td align="left">
<pre><TT><I>q</I></TT>.empty(  )</pre>
</td>
<td align="right"></td>
</tr>
</table>
<P class="docText">Returns <TT>True</TT> if <TT><I>q</I></TT> is
empty, otherwise <TT>False</TT>.</P>

<A NAME="ch14-77012"></A><A NAME="pythonian-CHP-14-ITERM-6775"></A><A NAME="pythonian-CHP-14-ITERM-6776"></A><table width="515" border="0" cellpadding="5">
<tr>
<td align="left"><b><i>full</i></b></td>
<td align="right"></td>
</tr>
</table>
<hr width="515" size="3" noshade="true" align="left" color="black">
<table width="515" border="0" cellpadding="5">
<tr>
<td align="left">
<pre><TT><I>q</I></TT>.full(  )</pre>
</td>
<td align="right"></td>
</tr>
</table>
<P class="docText">Returns <TT>True</TT> if <TT><I>q</I></TT> is
full, otherwise <TT>False</TT>.</P>

<A NAME="ch14-77013"></A><A NAME="pythonian-CHP-14-ITERM-6777"></A><A NAME="pythonian-CHP-14-ITERM-6778"></A><A NAME="pythonian-CHP-14-ITERM-6779"></A><A NAME="pythonian-CHP-14-ITERM-6780"></A><table width="515" border="0" cellpadding="5">
<tr>
<td align="left"><b><i>get, get_nowait</i></b></td>
<td align="right"></td>
</tr>
</table>
<hr width="515" size="3" noshade="true" align="left" color="black">
<table width="515" border="0" cellpadding="5">
<tr>
<td align="left">
<pre><TT><I>q</I></TT>.get(<TT><I>block</I></TT>=True)</pre>
</td>
<td align="right"></td>
</tr>
</table>
<P class="docText">When <TT><I>block</I></TT> is <TT>False</TT>,
<TT>get</TT> removes and returns an item from
<TT><I>q</I></TT> if one is available, otherwise
<TT>get</TT> raises <TT>Empty</TT>. When
<TT><I>block</I></TT> is <TT>True</TT>,
<TT>get</TT> removes and returns an item from
<TT><I>q</I></TT>, suspending the calling thread, if need
be, until an item is available.
<TT><I>q</I></TT><TT>.get_nowait( )</TT> is like
<TT><I>q</I></TT><TT>.get(False)</TT>.
<TT>get</TT> removes and returns items in the same order as
<TT>put</TT> inserted them (first in, first out).</P>

<A NAME="ch14-77014"></A><A NAME="pythonian-CHP-14-ITERM-6781"></A><A NAME="pythonian-CHP-14-ITERM-6782"></A><A NAME="pythonian-CHP-14-ITERM-6783"></A><A NAME="pythonian-CHP-14-ITERM-6784"></A><table width="515" border="0" cellpadding="5">
<tr>
<td align="left"><b><i>put, put_nowait</i></b></td>
<td align="right"></td>
</tr>
</table>
<hr width="515" size="3" noshade="true" align="left" color="black">
<table width="515" border="0" cellpadding="5">
<tr>
<td align="left">
<pre><TT><I>q</I></TT>.put(<TT><I>item</I></TT>,<TT><I>block</I></TT>=True)</pre>
</td>
<td align="right"></td>
</tr>
</table>
<P class="docText"><A NAME="pythonian-CHP-14-ITERM-6781"></A>
<A NAME="pythonian-CHP-14-ITERM-6782"></A> <A NAME="pythonian-CHP-14-ITERM-6783"></A>
<A NAME="pythonian-CHP-14-ITERM-6784"></A>When <TT><I>block</I></TT>
is <TT>False</TT>, <TT>put</TT> adds
<TT><I>item</I></TT> to <TT><I>q</I></TT> if
<TT><I>q</I></TT> is not full, otherwise
<TT>put</TT> raises <TT>Full</TT>. When
<TT><I>block</I></TT> is <TT>True</TT>,
<TT>put</TT> adds <TT><I>item</I></TT> to
<TT><I>q</I></TT>, suspending the calling thread, if need
be, until <TT><I>q</I></TT> is not full.
<TT><I>q</I></TT><TT>.put_nowait(</TT><TT><I>item</I></TT><TT>)</TT>
is like
<TT><I>q</I></TT><TT>.put(</TT><TT><I>item</I></TT><TT>,False)</TT>.</P>

<A NAME="ch14-77015"></A><A NAME="pythonian-CHP-14-ITERM-6785"></A><A NAME="pythonian-CHP-14-ITERM-6786"></A><table width="515" border="0" cellpadding="5">
<tr>
<td align="left"><b><i>qsize</i></b></td>
<td align="right"></td>
</tr>
</table>
<hr width="515" size="3" noshade="true" align="left" color="black">
<table width="515" border="0" cellpadding="5">
<tr>
<td align="left">
<pre><TT><I>q</I></TT>.qsize(  )</pre>
</td>
<td align="right"></td>
</tr>
</table>
<P class="docText">Returns the number of items that are currently in
<TT><I>q</I></TT>.</P>

<P class="docText"><TT>Queue</TT><A NAME="pythonian-CHP-14-ITERM-6787"></A> offers a good example of the idiom
"it's easier to ask forgiveness
than permission" (EAFP), covered in <A class="docLink" HREF="0596001886_pythonian-chp-6.html#pythonian-CHP-6">Chapter 6</A>. Due to multithreading, each non-mutating
method of <TT><I>q</I></TT> can only be advisory. When
some other thread executes and mutates <TT><I>q</I></TT>,
things can change between the instant a thread gets the information
and the very next moment, when the thread acts on the information.
Relying on the "look before you
leap" (LBYL) idiom is futile, and fiddling with
locks to try and fix things is a substantial waste of effort. Just
avoid LBYL code such as:</P>

<PRE>if <TT><I>q</I></TT>.empty(  ): print "no work to perform"
else: <TT><I>x</I></TT>=<TT><I>q</I></TT>.get_nowait(  )</PRE>

<P class="docText">and instead use the simpler and more robust EAFP approach:</P>

<PRE>try: <TT><I>x</I></TT>=<TT><I>q</I></TT>.get_nowait(  )
except Queue.Empty: print "no work to perform"</PRE>


<a href="0596001886_"><img src="FILES/pixel.gif" width="1" height="1" border="0"></a><ul></ul>
</td>
</tr>
</table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
          <a href="0596001886_pythonian-chp-14-sect-2.html"><img src="FILES/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0596001886_pythonian-chp-14-sect-4.html"><img src="FILES/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
