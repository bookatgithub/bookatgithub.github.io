<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Introduction</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-13.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-13-sect-1.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><td valign="top"><a name="ch13-77002"></a><h3 class="docSection1Title">Introduction</h3>

<p class="docText"><span class="docEmphasis">Credit: Guido van Rossum, creator of Python</span></p>

<p class="docText"><a name="pythoncook2-CHP-13-ITERM-2804"></a>Network programming is one of my
favorite Python applications. I wrote or started most of the network
modules in the Python Standard Library, including the
<tt>socket</tt> and <tt>select</tt> extension
modules and most of the protocol client modules (such as
<tt>ftplib</tt>). I also wrote a popular server framework
module, <tt>SocketServer</tt>, and two web browsers in
Python, the first predating Mosaic. Need I say more?</p>

<p class="docText">Python's roots lie in a distributed operating
system, Amoeba, which I helped design and implement in the late
1980s. Python was originally intended to be the scripting language
for Amoeba, since it turned out that the Unix shell, while ported to
Amoeba, wasn't very useful for writing Amoeba system
administration scripts. Of course, I designed Python to be platform
independent from the start. Once Python was ported from Amoeba to
Unix, I taught myself BSD socket programming by wrapping the socket
primitives in a Python extension module and then experimenting with
them using Python; this was one of the first extension modules.</p>

<p class="docText">This approach proved to be a great early testimony of
Python's strengths. Writing socket code in C is
tedious: the code necessary to do error checking on every call
quickly overtakes the logic of the program. Quick: in which order
should a server call <tt>accept</tt>,
<tt>bind</tt>, <tt>connect</tt>, and
<tt>listen</tt>? This is remarkably difficult to find out
if all you have is a set of Unix manpages. In Python, you
don't have to write separate error-handling code for
each call, making the logic of the code stand out much clearer. You
can also learn about sockets by experimenting in an interactive
Python shell, where misconceptions about the proper order of calls
and the argument values that each call requires are cleared up
quickly through Python's immediate error messages.</P>

<p class="docText">Python has come a long way since those first days, and now few
applications use the <tt>socket</tt> module directly; most
use much higher-level modules such as <tt>urllib</tt> or
<tt>smtplib</tt>, and third-party extensions such as the
Twisted framework, whose popularity keeps growing. The examples in
this chapter are a varied bunch: some construct and send complex
email messages, while others dwell on lower-level issues such as
tunneling. My favorite is <a class="docLink" href="pythoncook2-CHP-13-SECT-11.html#pythoncook2-CHP-13-SECT-11">Recipe 13.11</a>, which implements
<tt>PyHeartBeat</tt>: it's useful, it uses
the <tt>socket</tt> module, and it's
simple enough to be an educational example. I do note, with that
mixture of pride and sadness that always accompanies a
parent's observation of children growing up, that,
since the <span class="docEmphasis">Python Cookbook</span>'s
first edition, even <tt>PyHeartBeat</tt> has acquired an
alternative server implementation based on Twisted!</p>

<p class="docText"><a name="pythoncook2-CHP-13-ITERM-2805"></a>Nevertheless,
my own baby, the <tt>socket</tt> module itself, is still
the foundation of all network operations in Python.
It's a plain transliteration of the socket
APIsfirst introduced in BSD Unix and now widespread on all
platformsinto the object-oriented paradigm. You create socket
objects by calling the <tt>socket.socket</tt> factory
function, then you call methods on these objects to perform typical
low-level network operations. You don't have to
worry about allocating and freeing memory for buffers and the
likePython handles that for you automatically. You express IP
addresses as <tt>(host, port)</tt> pairs, in which
<tt>host</tt> is a string in either dotted-quad
('<tt>1.2.3.4</tt>') or domain-name
('<tt>www.python.org</tt>') notation. As you can see, even
low-level modules in Python aren't as low level as
all that.</P>

<p class="docText">Despite the various conveniences, the <tt>socket</tt>
module still exposes the actual underlying functionality of your
operating system's network sockets. If
you're at all familiar with sockets,
you'll quickly get the hang of
Python's <tt>socket</tt> module, using
Python's own <span class="docEmphasis">Library
Reference</span>. You'll then be able to play
with sockets interactively in Python to become a socket expert, if
that is what you want. The classic, highly recommended work on this
subject is W. Richard Stevens, <span class="docEmphasis">UNIX Network Programming,
Volume 1: Networking APIs - Sockets and XTI, 2d ed.</span>
(Prentice-Hall). For many practical uses, however, higher-level
modules will serve you better.</p>

<p class="docText"><a name="pythoncook2-CHP-13-ITERM-2806"></a> <a name="pythoncook2-CHP-13-ITERM-2807"></a>
<a name="pythoncook2-CHP-13-ITERM-2808"></a> <a name="pythoncook2-CHP-13-ITERM-2809"></a>The Internet uses a sometimes
dazzling variety of protocols and formats, and the Python Standard
Library supports many of them. In the Python Standard Library, you
will find dozens of modules dedicated to supporting specific Internet
protocols (such as <tt>smtplib</tt> to support the SMTP
protocol to send mail and <tt>nntplib</tt> to support the
Network News Transfer Protocol (NNTP) to send and receive Network
News). In addition, you'll find about as many
modules that support specific Internet formats (such as
<tt>htmllib</tt> to parse HTML data, the
<tt>email</tt> package to parse and compose various formats
related to emailincluding attachments and
encoding).<a name="pythoncook2-CHP-13-ITERM-2810"></a> <a name="pythoncook2-CHP-13-ITERM-2811"></a></P>

<p class="docText">I cannot even come close to doing justice to the powerful array of
tools mentioned in this introduction, nor will you find all of these
modules and packages used in this chapter, nor in this book, nor in
most programming shops. You may never need to write any program that
deals with Network News, for example; if that is the case, you
don't need to study <tt>nntplib</tt>. But
it is still reassuring to know it's there (part of
the "batteries included" approach
of the Python Standard Library).</p>

<p class="docText"><a name="pythoncook2-CHP-13-ITERM-2812"></a>
<a name="pythoncook2-CHP-13-ITERM-2813"></a>Two
higher-level modules that stand out from the crowd, however, are
<tt>urllib</tt> and <tt>urllib2</tt>. Each of
these two modules can deal with several protocols through the magic
of URLsthose now-familiar strings, such as <a class="docLink" target="_blank" href="http://www.python.org/index.html">http://www.python.org/index.html</a>, that
identify a protocol (such as <a class="docLink" target="_blank" href="http">http</a>), a host and port (such as <a class="docLink" target="_blank" href="www.python.org">www.python.org</a>, port 80 being the default for
the HTTP protocol), and a specific resource at that address (such as
<I>/index.html</I>). <tt>urllib</tt> is very
simple to use, but <tt>urllib2</tt> is more powerful and
extensible. HTTP is the most popular protocol for URLs, but these
modules also support several others, such as FTP. In many cases,
you'll be able to use these modules to write typical
client-side scripts that interact with any of the supported protocols
much quicker and with less effort than it might take with the various
protocol-specific modules.</p>

<p class="docText">To illustrate, I'd like to conclude with a cookbook
example of my own. It's similar to <a class="docLink" href="pythoncook2-CHP-13-SECT-2.html#pythoncook2-CHP-13-SECT-2">Recipe 13.2</a>, but, rather than a program
fragment, it's a little script. I call it
<I>wget.py</I> because it does everything for which
I've ever needed <i>wget</i>. (In fact,
I originally wrote this script on a system where
<i>wget</i> wasn't installed but Python
was; writing <I>wget.py</i> was a more effective use of
my time than downloading and installing the real thing.)</p>

<pre>import sys, urllib
def reporthook(*a): print a
for url in sys.argv[1:]:
    i = url.rfind('/')
    file = url[i+1:]
    print url, "-&gt;", file
    urllib.urlretrieve(url, file, reporthook)</pre><BR>


<p class="docText">Pass this script one or more URLs as command-line arguments; the
script retrieves them into local files whose names match the last
components of the URLs. The script also prints progress information
of the form:</p>

<pre>(block number, block size, total size)</pre><BR>


<p class="docText">Obviously, it's easy to improve on this script; but
it's only seven lines, it's
readable, and it worksand that's
what's so cool about Python.</p>

<p class="docText">Another cool thing about Python is that you can incrementally improve
a program like this, and after it's grown by two or
three orders of magnitude, it's still readable, and
it still works! To see what this particular example might evolve
into, check out <I>Tools/webchecker/websucker.py</I> in
the Python source distribution. Enjoy!</p>


<a href="5991535.html"><img src="images/pixel.gif" alt="" width="1" height="1" border="0"></a><ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-13.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-13-sect-1.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
</body></html>