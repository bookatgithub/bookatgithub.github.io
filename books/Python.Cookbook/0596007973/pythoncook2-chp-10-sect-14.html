<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Recipe&nbsp;10.14.&nbsp;Creating a Share on Windows</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-10-sect-13.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-10-sect-15.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><td valign="top"><a name="pythoncook2-CHP-10-SECT-14"></a>
<h3 class="docSection1Title">Recipe 10.14. Creating a Share on Windows</h3>

<p class="docText"><span class="docEmphasis">Credit: John Nielsen</span></p>

<a name="pythoncook2-CHP-10-SECT-14.1"></a>
<h4 class="docSection2Title">Problem</h4>

<p class="docText"><a name="pythoncook2-CHP-10-ITERM-2652"></a>
<a name="pythoncook2-CHP-10-ITERM-2653"></a>
<a name="pythoncook2-CHP-10-ITERM-2654"></a>
<a name="pythoncook2-CHP-10-ITERM-2655"></a>You
want to share a folder of your Windows PC on a LAN.</P>


<a name="pythoncook2-CHP-10-SECT-14.2"></a>
<h4 class="docSection2Title">Solution</H4>

<p class="docText">PyWin32's <tt>win32net</tt> module makes
this task very easy:</p>

<pre>import win32net
import win32netcon
shinfo={  }
shinfo['netname'] = 'python test'
shinfo['type'] = win32netcon.STYPE_DISKTREE
shinfo['remark'] = 'data files'
shinfo['permissions'] = 0
shinfo['max_uses'] = -1
shinfo['current_uses'] = 0
shinfo['path'] = 'c:\\my_data'
shinfo['passwd'] = ''
server = 'servername'
win32net.NetShareAdd(server, 2, shinfo)</pre><BR>



<a name="pythoncook2-CHP-10-SECT-14.3"></a>
<h4 class="docSection2Title">Discussion</H4>

<p class="docText">While the task of sharing a folder is indeed fairly easy to
accomplish, finding the information on how you do so
isn't. All I could find in the
<tt>win32net</tt> documentation was that you needed to pass
a dictionary holding the share's data
"in the format of SHARE_INFO_*." I
finally managed to integrate this tidbit with the details from the
Windows SDK (<a class="docLink" target="_blank" href="http://msdn.microsoft.com">http://msdn.microsoft.com</a>) and produce the
information in this recipe. One detail that took me some effort to
discover is that the constants you need to use as the value for the
'<tt>type</tt>' enTRy are "hidden
away" in the <tt>win32netcon</tt> module.</p>


<a name="pythoncook2-CHP-10-SECT-14.4"></a>
<H4 class="docSection2Title">See Also</H4>

<p class="docText">PyWin32 docs at <a class="docLink" target="_blank" href="http://sourceforge.net/projects/pywin32/">http://sourceforge.net/projects/pywin32/</a>;
Microsoft's MSDN site, <a class="docLink" target="_blank" href="http://msdn.microsoft.com">http://msdn.microsoft.com</a>.</p>



<ul></ul></td></TR></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-10-sect-13.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-10-sect-15.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
</body></html>