<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Recipe&nbsp;12.11.&nbsp;Using MSHTML to Parse XML or HTML</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-12-sect-10.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-13.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><td valign="top"><a name="pythoncook2-CHP-12-SECT-11"></a>
<h3 class="docSection1Title">Recipe 12.11. Using MSHTML to Parse XML or HTML</h3>

<p class="docText"><span class="docEmphasis">Credit: Bill Bell</span></p>

<a name="pythoncook2-CHP-12-SECT-11.1"></a>
<h4 class="docSection2Title">Problem</h4>

<p class="docText"><a name="pythoncook2-CHP-12-ITERM-2797"></a>
<a name="pythoncook2-CHP-12-ITERM-2798"></a>
<a name="pythoncook2-CHP-12-ITERM-2799"></a>
<a name="pythoncook2-CHP-12-ITERM-2800"></a>
<a name="pythoncook2-CHP-12-ITERM-2801"></a>
<a name="pythoncook2-CHP-12-ITERM-2802"></a>Your Python application, running on Windows,
needs to use the Microsoft MSHTML COM component, which is also the
parser that Microsoft Internet Explorer uses to parse HTML and XML
web pages.</P>


<a name="pythoncook2-CHP-12-SECT-11.2"></a>
<h4 class="docSection2Title">Solution</H4>

<p class="docText">As usual, PyWin32 lets our Python code access COM quite simply:</p>

<pre>from win32com.client import Dispatch
html = Dispatch('htmlfile')    # the disguise for MSHTML as a COM server
html.writeln( "&lt;html&gt;&lt;header&gt;&lt;title&gt;A title&lt;/title&gt;"
     "&lt;meta name='a name' content='page description'&gt;&lt;/header&gt;"
     "&lt;body&gt;This is some of it. &lt;span&gt;And this is the rest.&lt;/span&gt;"
     "&lt;/body&gt;&lt;/html&gt;" )
print "Title: %s" % (html.title,)
print "Bag of words from body of the page: %s" % (html.body.innerText,)
print "URL associated with the page: %s" % (html.url,)
print "Display of name:content pairs from the metatags: "
metas = html.getElementsByTagName("meta")
for m in xrange(metas.length):
    print "\t%s: %s" % (metas[m].name, metas[m].content,)</pre><BR>



<a name="pythoncook2-CHP-12-SECT-11.3"></a>
<h4 class="docSection2Title">Discussion</H4>

<p class="docText">While Python offers many ways to parse HTML or XML, as long as
you're running your programs only on Windows, MSHTML
is very speedy and simple to use. As the recipe shows, you can simply
use the <tt>writeln</tt> method of the COM object to feed
the page into MSHTML and then you can use the methods and properties
of the components to get at all kinds of aspects of the
page's DOM. Of course, you can get the string of
markup and text to feed into MSHTML in any way that suits your
application, such as by using the Python Standard Library module
<tt>urllib</tt> if you're getting a page
from some URL.</P>

<p class="docText">Since the structure of the enriched DOM that MSHTML makes available
is quite rich and complicated, I suggest you experiment with it in
the PythonWin interactive environment that comes with PyWin32. The
strength of PythonWin for such exploratory tasks is that it displays
all of the properties and methods made available by each interface.</p>


<a name="pythoncook2-CHP-12-SECT-11.4"></a>
<H4 class="docSection2Title">See Also</H4>

<p class="docText">A detailed reference to MSHTML, albeit oriented to Visual Basic and
C# users, can be found at <a class="docLink" target="_blank" href="http://www.xaml.net/articles/type.asp?o=MSHTML">http://www.xaml.net/articles/type.asp?o=MSHTML</a>.<a name="pythoncook2-CHP-12-ITERM-2803"></a></p>



<a href="5991535.html"><img src="images/pixel.gif" alt="" width="1" height="1" border="0"></a><ul></ul></td></TR></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-12-sect-10.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-13.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
</body></html>