<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Recipe&nbsp;13.2.&nbsp;Grabbing a Document from the Web</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-13-sect-1.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-13-sect-3.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><td valign="top"><a name="pythoncook2-CHP-13-SECT-2"></a>
<h3 class="docSection1Title">Recipe 13.2. Grabbing a Document from the Web</h3>

<p class="docText"><span class="docEmphasis">Credit: Gisle Aas, Magnus
Bodin</span><a name="pythoncook2-CHP-13-ITERM-2821"></a>
<a name="pythoncook2-CHP-13-ITERM-2822"></a></p>

<a name="pythoncook2-CHP-13-SECT-2.1"></a>
<h4 class="docSection2Title">Problem</h4>

<p class="docText"><a name="pythoncook2-CHP-13-ITERM-2823"></a>
<a name="pythoncook2-CHP-13-ITERM-2824"></a>You need to grab
a document from a URL on the Web.</P>


<a name="pythoncook2-CHP-13-SECT-2.2"></a>
<h4 class="docSection2Title">Solution</H4>

<p class="docText"><tt>urllib.urlopen</tt> returns a file-like object, and you
can call the <tt>read</tt> method on that object to get all
of its contents:</p>

<pre>from urllib import urlopen
doc = urlopen("http://www.python.org").read( )
print doc</pre><BR>



<a name="pythoncook2-CHP-13-SECT-2.3"></a>
<h4 class="docSection2Title">Discussion</H4>

<p class="docText">Once you obtain a file-like object from <tt>urlopen</tt>,
you can read it all at once into one big string by calling its
<tt>read</tt> method, as I do in this recipe.
Alternatively, you can read the object as a list of lines by calling
its <tt>readlines</tt> method, or, for special purposes,
just get one line at a time by looping over the object in a
<tt>for</tt> loop. In addition to these file-like
operations, the object that <tt>urlopen</tt> returns offers
a few other useful features. For example, the following snippet gives
you the headers of the document:</P>

<pre>doc = urlopen("http://www.python.org")
print doc.info( )</pre><br>


<p class="docText">such as the <tt>Content-Type</tt> header
(<tt>text/html</tt> in this case) that defines the MIME
type of the document. <tt>doc.info</tt> returns a
<tt>mimetools.Message</tt> instance, so you can access it
in various ways besides printing it or otherwise transforming it into
a string. For example, <tt>doc.info(
).getheader(`Content-Type')</tt>
returns the '<tt>text/html</tt>' string. The
<tt>maintype</tt> attribute of the
<tt>mimetools.Message</tt> object is the
'<tt>text</tt>' string, <tt>subtype</tt> is the
'<tt>html</tt>' string, and <tt>type</tt> is also
the '<tt>text/html</tt>' string. If you need to perform
sophisticated analysis and processing, all the tools you need are
right there. At the same time, if your needs are simpler, you can
meet them in very simple ways, as this recipe shows.</P>

<p class="docText">If what you need to do with the document you grab from the Web is
specifically to save it to a local file,
<tt>urllib.urlretrieve</tt> is just what you need, as the
"Introduction" to this chapter
describes.</P>

<p class="docText"><tt>urllib</tt> implicitly supports the use of proxies (as
long as the proxies do not require authentication: the current
implementation of <tt>urllib</tt> does not support
authentication-requiring proxies). Just set environment variable
<tt>HTTP_PROXY</tt> to a URL, such as
'<tt>http://proxy.domain.com:8080</tt>', to use the proxy
at that URL. If the environment variable
<tt>HTTP_PROXY</tt> is not set, <tt>urllib</tt>
may also look for the information in other platform-specific
locations, such as the Windows registry if you're
running under Windows.</p>

<p class="docText">If you have more advanced needs, such as using proxies that require
authentication, you may use the more sophisticated
<tt>urllib2</tt> module of the Python Standard Library,
rather than simple module <tt>urllib</tt>. At <a class="docLink" target="_blank" href="http://pydoc.org/2.3/urllib2.html">http://pydoc.org/2.3/urllib2.html</a>, you can
find an example of how to use <tt>urllib2</tt> for the
specific task of accessing the Internet through a proxy that does
require authentication.</p>


<a name="pythoncook2-CHP-13-SECT-2.4"></a>
<h4 class="docSection2Title">See Also</h4>

<p class="docText">Documentation for the standard library modules
<tt>urllib</tt>, <tt>urllib2</tt>, and
<tt>mimetools</tt> in the <span class="docEmphasis">Library
Reference</span> and <span class="docEmphasis">Python in a
Nutshell</span>.</P>



<a href="5991535.html"><img src="images/pixel.gif" alt="" width="1" height="1" border="0"></a><ul></ul></TD></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-13-sect-1.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-13-sect-3.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
</body></html>