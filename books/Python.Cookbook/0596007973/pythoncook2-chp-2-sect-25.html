<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Recipe&nbsp;2.25.&nbsp;Changing File Attributes on Windows</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-2-sect-24.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-2-sect-26.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><td valign="top"><a name="pythoncook2-CHP-2-SECT-25"></a>
<h3 class="docSection1Title">Recipe 2.25. Changing File Attributes on Windows</h3>

<p class="docText"><span class="docEmphasis">Credit: John
Nielsen</span><a name="pythoncook2-CHP-2-ITERM-1709"></a>
<a name="pythoncook2-CHP-2-ITERM-1710"></a></p>

<a name="pythoncook2-CHP-2-SECT-25.1"></a>
<h4 class="docSection2Title">Problem</h4>

<p class="docText">You need to set the attributes of a file on Windows; for example, you
may need to set the file as read-only, archived, and so on.</P>


<a name="pythoncook2-CHP-2-SECT-25.2"></a>
<h4 class="docSection2Title">Solution</H4>

<p class="docText"><a name="pythoncook2-CHP-2-ITERM-1711"></a>PyWin32's
<tt>win32api</tt> module offers a function
<tt>SetFileAttributes</tt> that makes this task quite
simple:</p>

<pre>import win32con, win32api, os
# create a file, just to show how to manipulate it
thefile = 'test'
f = open('test', 'w')
f.close( )
# to make the file hidden...:
win32api.SetFileAttributes(thefile, win32con.FILE_ATTRIBUTE_HIDDEN)
# to make the file readonly:
win32api.SetFileAttributes(thefile, win32con.FILE_ATTRIBUTE_READONLY)
# to be able to delete the file we need to set it back to normal:
win32api.SetFileAttributes(thefile, win32con.FILE_ATTRIBUTE_NORMAL)
# and finally we remove the file we just made
os.remove(thefile)</pre><BR>



<a name="pythoncook2-CHP-2-SECT-25.3"></a>
<h4 class="docSection2Title">Discussion</H4>

<p class="docText">One interesting use of <tt>win32api.SetFileAttributes</tt>
is to enable a file's removal. Removing a file with
<tt>os.remove</tt> can fail on Windows if the
file's attributes are not normal. To get around this
problem, you just need to use the Win32 call to
<tt>SetFileAttributes</tt> to convert it to a normal file,
as shown at the end of this recipe's Solution. Of
course, this should be done with caution, since there may be a good
reason the file is not "normal".
The file should be removed only if you know what
you're doing!</P>


<a name="pythoncook2-CHP-2-SECT-25.4"></a>
<h4 class="docSection2Title">See Also</H4>

<p class="docText">The documentation on the <tt>win32file</tt> module at
<a class="docLink" target="_blank" href="http://ASPN.ActiveState.com/ASPN/Python/Reference/Products/ActivePython/PythonWin32Extensions/win32file.html">http://ASPN.ActiveState.com/ASPN/Python/Reference/Products/ActivePython/PythonWin32Extensions/win32file.html</a>.</P>



<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-2-sect-24.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-2-sect-26.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
</body></html>