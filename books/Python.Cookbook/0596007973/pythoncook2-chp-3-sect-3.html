<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Recipe&nbsp;3.3.&nbsp;Calculating Time Periods in a Date Range</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-3-sect-2.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-3-sect-4.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><td valign="top"><a name="pythoncook2-CHP-3-SECT-3"></a>
<h3 class="docSection1Title" id="409771-975">Recipe 3.3. Calculating Time Periods in a Date Range</h3>

<p class="docText"><span class="docEmphasis">Credit: Andrea Cavalcanti</span></p>

<a name="pythoncook2-CHP-3-SECT-3.1"></a>
<h4 class="docSection2Title">Problem</h4>

<p class="docText"><a name="pythoncook2-CHP-3-ITERM-1744"></a>Given two dates, you want
to calculate the number of weeks between them.</P>


<a name="pythoncook2-CHP-3-SECT-3.2"></a>
<h4 class="docSection2Title">Solution</H4>

<p class="docText"><a name="pythoncook2-CHP-3-ITERM-1745"></a>
<a name="pythoncook2-CHP-3-ITERM-1746"></a>
<a name="pythoncook2-CHP-3-ITERM-1747"></a>Once again,
the standard <tt>datetime</tt> and third-party
<tt>dateutil</tt> modules (particularly
<tt>dateutil</tt>'s
<tt>rrule.count</tt> method) come in quite handy. After
importing the appropriate modules, it's a really
simple job:</p>

<pre>from dateutil import rrule
import datetime
def weeks_between(start_date, end_date):
    weeks = rrule.rrule(rrule.WEEKLY, dtstart=start_date, until=end_date)
    return weeks.count( )</pre><BR>



<a name="pythoncook2-CHP-3-SECT-3.3"></a>
<h4 class="docSection2Title">Discussion</H4>

<p class="docText">Function <I>weeks_between</i> takes the starting and ending
dates as arguments, instantiates a rule to recur weekly between them,
and returns the result of the rule's
<tt>count</tt> methodfaster to code than to
describe. This method will return only an integer (it
won't return
"half" weeks). For example, eight
days is considered two weeks. It's easy to code a
test for this:</P>

<pre>if _ _name_ _=='_ _main_ _':
    starts = [datetime.date(2005, 01, 04), datetime.date(2005, 01, 03)]
    end = datetime.date(2005, 01, 10)
    for s in starts:
        days = rrule.rrule(rrule.DAILY, dtstart=s, until=end).count( )
        print "%d days shows as %d weeks "% (days, weeks_between(s, end))</pre><BR>


<p class="docText">This test emits the following output:</p>

<pre>7 days shows as 1 weeks
8 days shows as 2 weeks</pre><br>


<p class="docText">It's not necessary to give a name to a recurrence
rule, if you don't want tochanging the
function's body, for example, to the single
statement:</p>

<pre>    return rrule.rrule(rrule.WEEKLY, dtstart=start_date, until=end_date).count( )</pre><br>


<p class="docText">works just as well. I prefer to name recurrence rules because
(frankly) I still find them a bit weird, even though
they're so incredibly useful I doubt I could do
without them!</P>


<a name="pythoncook2-CHP-3-SECT-3.4"></a>
<h4 class="docSection2Title">See Also</h4>

<p class="docText">Refer to the <tt>dateutil</tt> module's
documentation available at <a class="docLink" target="_blank" href="https://moin.conectiva.com.br/DateUtil?action=highlight&amp;value=DateUtil">https://moin.conectiva.com.br/DateUtil?action=highlight&amp;value=DateUtil</a>,
<tt>datetime</tt> documentation in the <span class="docEmphasis">Library
Reference</span>.</P>



<ul></UL></td></TR></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;"><a href="toc.html"><img src="images/teamlib.gif" width="62" height="15" border="0" align="absmiddle"  alt="Team LiB"></a></div></td>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=pythoncook2-chp-3-sect-2.html><img src="images/previous.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
<a href=pythoncook2-chp-3-sect-4.html><img src="images/next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</div></td></tr></table>
</body></html>