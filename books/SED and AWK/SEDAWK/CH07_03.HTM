<HTML
><HEAD
>
<TITLE>[Chapter 7] 7.3 Awk's Programming Model</TITLE>
<META
NAME="DC.title"
CONTENT="sed &amp; awk"><META
NAME="DC.creator"
CONTENT="Dale Dougherty &amp; Arnold Robbins"><META
NAME="DC.publisher"
CONTENT="O'Reilly &amp; Associates, Inc."><META
NAME="DC.date"
CONTENT="1998-08-03T20:56:42Z"><META
NAME="DC.type"
CONTENT="Text.Monograph"><META
NAME="DC.format"
CONTENT="text/html"
SCHEME="MIME"><META
NAME="DC.source"
CONTENT="1-56592-225-5"
SCHEME="ISBN"><META
NAME="DC.language"
CONTENT="en-US"><META
NAME="generator"
CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINK
REV="made"
HREF="mailto:online-books@oreilly.com"
TITLE="Online Books Comments"><LINK
REL="up"
HREF="ch07_01.htm"
TITLE="7. Writing Scripts for awk"><LINK
REL="prev"
HREF="ch07_02.htm"
TITLE="7.2 Hello, World"><LINK
REL="next"
HREF="ch07_04.htm"
TITLE="7.4 Pattern Matching"></HEAD
><BODY
BGCOLOR="#FFFFFF"
TEXT="#000000"
><DIV
CLASS="htmlnav"
><H1
><IMG
SRC="gifs/smbanner.gif"
ALT="sed &amp; awk"
USEMAP="#srchmap"
BORDER="0"></H1
><MAP
NAME="srchmap"
><AREA
SHAPE="RECT"
COORDS="0,0,466,65"
HREF="index.htm"
ALT="sed &amp; awk"><AREA
SHAPE="RECT"
COORDS="467,0,514,18"
HREF="../search/ssrch.htm"
ALT="Search this book"></MAP
><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch07_02.htm"
TITLE="7.2 Hello, World"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 7.2 Hello, World"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><B
><FONT
FACE="ARIEL,HELVETICA,HELV,SANSERIF"
SIZE="-1"
>Chapter 7<BR>Writing Scripts for awk</FONT
></B
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch07_04.htm"
TITLE="7.4 Pattern Matching"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 7.4 Pattern Matching"
BORDER="0"></A
></TD
></TR
></TABLE
>&nbsp;<HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"></DIV
><DIV
CLASS="SECT1"
><H2
CLASS="sect1"
><A
CLASS="title"
NAME="SEDAWK-CH-7-SECT-3"
>7.3 Awk's Programming Model</A
></H2
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-4774"
></A
><A
CLASS="indexterm"
NAME="AUTOID-4777"
></A
>It's important to understand the basic model that awk offers the
programmer.  Part of the reason why awk is easier to learn than many
programming languages is that it offers such a well-defined and useful
model to the programmer.</P
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-4781"
></A
><A
CLASS="indexterm"
NAME="AUTOID-4783"
></A
><A
CLASS="indexterm"
NAME="AUTOID-4785"
></A
>An awk program
consists of what we will call a <EM
CLASS="emphasis"
>main input loop</EM
>.
A <EM
CLASS="emphasis"
>loop</EM
> is a routine that is executed over and
over again until some condition exists that terminates it.  You don't
write this loop, it is given&nbsp;- it exists as the framework within
which the code that you do write will be executed.  The main input
loop in awk is a routine that reads one line of input from a file and
makes it available for processing.  The actions you write to do the
processing assume that there is a line of input available.  In another
programming language, you would have to create the main input loop as
part of your program.  It would have to open the input file and read
one line at a time.  This is not necessarily a lot of work, but it
illustrates a basic awk shortcut that makes it easier for you to write
your program.</P
><P
CLASS="para"
>The main input loop is executed as many times as there are lines of
input.  As you saw in the &quot;Hello, world&quot; examples, this loop does not
execute until there is a line of input.  It terminates when there is
no more input to be read.</P
><P
CLASS="para"
>Awk allows you to write two special routines that can be executed
<EM
CLASS="emphasis"
>before</EM
> any input is read and
<EM
CLASS="emphasis"
>after</EM
> all input is read.  These are the
procedures associated with the <KBD
CLASS="command"
>BEGIN</KBD
> and
<KBD
CLASS="command"
>END</KBD
> rules, respectively.  In other words, you can
do some preprocessing before the main input loop is ever executed and
you can do some postprocessing after the main input loop has
terminated.  The <KBD
CLASS="command"
>BEGIN</KBD
> and <KBD
CLASS="command"
>END</KBD
>
procedures are optional.</P
><P
CLASS="para"
>You can think of an awk script as having potentially three major
parts: what happens before, what happens during, and what happens
after processing the input.  <A
CLASS="xref"
HREF="ch07_03.htm#SEDAWK-CH-7-FIG-1"
TITLE="Flow and control in awk scripts"
>Figure 7.1</A
> shows
the relationship of these parts in the flow of control of an awk
script.</P
><H4
CLASS="figure"
><A
CLASS="title"
NAME="SEDAWK-CH-7-FIG-1"
>Figure 7.1: Flow and control in awk scripts</A
></H4
><IMG
CLASS="graphic"
SRC="figs/sed_0701.gif"
ALT="Figure 7.1"><P
CLASS="para"
>Of these three parts, the main input loop or &quot;what happens during
processing&quot; is where most of the work gets done.  Inside the main
input loop, your instructions are written as a series of
pattern/action procedures.  A pattern is a rule for testing the input
line to determine whether or not the action should be applied to it.
The actions, as we shall see, can be quite complex, consisting of
statements, functions, and expressions.</P
><P
CLASS="para"
>The main thing to remember is that each pattern/action procedure sits
in the main input loop, which takes care of reading the input line.
The procedures that you write will be applied to each input line, one
line at a time.</P
></DIV
><DIV
CLASS="htmlnav"
><P
></P
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch07_02.htm"
TITLE="7.2 Hello, World"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 7.2 Hello, World"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="book"
HREF="index.htm"
TITLE="sed &amp; awk"
><IMG
SRC="../gifs/txthome.gif"
ALT="sed &amp; awk"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch07_04.htm"
TITLE="7.4 Pattern Matching"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 7.4 Pattern Matching"
BORDER="0"></A
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
>7.2 Hello, World</TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="index"
HREF="index/idx_0.htm"
TITLE="Book Index"
><IMG
SRC="../gifs/index.gif"
ALT="Book Index"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
>7.4 Pattern Matching</TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><IMG
SRC="../gifs/smnavbar.gif"
USEMAP="#map"
BORDER="0"
ALT="The UNIX CD Bookshelf Navigation"><MAP
NAME="map"
><AREA
SHAPE="RECT"
COORDS="0,0,73,21"
HREF="../index.htm"
ALT="The UNIX CD Bookshelf"><AREA
SHAPE="RECT"
COORDS="74,0,163,21"
HREF="../upt/index.htm"
ALT="UNIX Power Tools"><AREA
SHAPE="RECT"
COORDS="164,0,257,21"
HREF="../unixnut/index.htm"
ALT="UNIX in a Nutshell"><AREA
SHAPE="RECT"
COORDS="258,0,321,21"
HREF="../vi/index.htm"
ALT="Learning the vi Editor"><AREA
SHAPE="RECT"
COORDS="322,0,378,21"
HREF="index.htm"
ALT="sed &amp; awk"><AREA
SHAPE="RECT"
COORDS="379,0,438,21"
HREF="../ksh/index.htm"
ALT="Learning the Korn Shell"><AREA
SHAPE="RECT"
COORDS="439,0,514,21"
HREF="../lrnunix/index.htm"
ALT="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
