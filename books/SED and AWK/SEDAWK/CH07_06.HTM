<HTML
><HEAD
>
<TITLE>[Chapter 7] 7.6 Expressions</TITLE>
<META
NAME="DC.title"
CONTENT="sed &amp; awk"><META
NAME="DC.creator"
CONTENT="Dale Dougherty &amp; Arnold Robbins"><META
NAME="DC.publisher"
CONTENT="O'Reilly &amp; Associates, Inc."><META
NAME="DC.date"
CONTENT="1998-08-03T20:56:50Z"><META
NAME="DC.type"
CONTENT="Text.Monograph"><META
NAME="DC.format"
CONTENT="text/html"
SCHEME="MIME"><META
NAME="DC.source"
CONTENT="1-56592-225-5"
SCHEME="ISBN"><META
NAME="DC.language"
CONTENT="en-US"><META
NAME="generator"
CONTENT="Jade 1.1/O'Reilly DocBook 3.0 to HTML 4.0"><LINK
REV="made"
HREF="mailto:online-books@oreilly.com"
TITLE="Online Books Comments"><LINK
REL="up"
HREF="ch07_01.htm"
TITLE="7. Writing Scripts for awk"><LINK
REL="prev"
HREF="ch07_05.htm"
TITLE="7.5 Records and Fields"><LINK
REL="next"
HREF="ch07_07.htm"
TITLE="7.7 System Variables"></HEAD
><BODY
BGCOLOR="#FFFFFF"
TEXT="#000000"
><DIV
CLASS="htmlnav"
><H1
><IMG
SRC="gifs/smbanner.gif"
ALT="sed &amp; awk"
USEMAP="#srchmap"
BORDER="0"></H1
><MAP
NAME="srchmap"
><AREA
SHAPE="RECT"
COORDS="0,0,466,65"
HREF="index.htm"
ALT="sed &amp; awk"><AREA
SHAPE="RECT"
COORDS="467,0,514,18"
HREF="../search/ssrch.htm"
ALT="Search this book"></MAP
><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch07_05.htm"
TITLE="7.5 Records and Fields"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 7.5 Records and Fields"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><B
><FONT
FACE="ARIEL,HELVETICA,HELV,SANSERIF"
SIZE="-1"
>Chapter 7<BR>Writing Scripts for awk</FONT
></B
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch07_07.htm"
TITLE="7.7 System Variables"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 7.7 System Variables"
BORDER="0"></A
></TD
></TR
></TABLE
>&nbsp;<HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"></DIV
><DIV
CLASS="SECT1"
><H2
CLASS="sect1"
><A
CLASS="title"
NAME="SEDAWK-CH-7-SECT-6"
>7.6 Expressions</A
></H2
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="CH07.EXP"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5007"
></A
>The use of expressions in which you can store, manipulate, and retrieve
data is quite different from anything you can do in sed, yet it is a
common feature of most programming languages.</P
><P
CLASS="para"
>An expression is evaluated and returns a value.  An expression
consists of any combination of numeric and string constants,
variables, operators, functions, and regular expressions.  We covered
regular expressions in detail in <A
CLASS="xref"
HREF="ch02_01.htm"
TITLE="Understanding Basic Operations"
>Chapter 2, Understanding Basic Operations</A
>, and
they are summarized in Appendix B.  Functions will be discussed fully
in <A
CLASS="xref"
HREF="ch09_01.htm"
TITLE="Functions"
>Chapter 9, Functions</A
>.  In this section, we will look at
expressions consisting of constants, variables, and operators.</P
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-5015"
></A
>There are two types of constants: string or
numeric (<B
CLASS="emphasis.bold"
>&quot;red&quot;</B
>
or <KBD
CLASS="command"
>1</KBD
>).  A string must be quoted in
an expression.  Strings can make use of the escape sequences listed in
<A
CLASS="xref"
HREF="ch07_06.htm#SEDAWK-CH-7-TAB-1"
TITLE="Escape Sequences"
>Table 7.1</A
>.<A
CLASS="indexterm"
NAME="AUTOID-5020"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5022"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5025"
></A
></P
><TABLE
CLASS="table"
><CAPTION
CLASS="table"
><A
CLASS="title"
NAME="SEDAWK-CH-7-TAB-1"
>Table 7.1: Escape Sequences</A
></CAPTION
><THEAD
CLASS="thead"
><TR
CLASS="row"
VALIGN="TOP"
><TH
CLASS="entry"
ALIGN="LEFT"
ROWSPAN="1"
COLSPAN="1"
>Sequence</TH
><TH
CLASS="entry"
ALIGN="LEFT"
ROWSPAN="1"
COLSPAN="1"
>Description</TH
></TR
></THEAD
><TBODY
CLASS="tbody"
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\a</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Alert character, usually ASCII BEL character</TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\b</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Backspace</TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\f</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Formfeed</TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\n</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Newline</TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\r</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Carriage return</TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\t</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Horizontal tab</TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\v</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Vertical tab</TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\<CODE
CLASS="replaceable"
><I
>ddd</I
></CODE
></TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Character represented as 1 to 3 digit octal value<A
CLASS="indexterm"
NAME="AUTOID-5061"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5063"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5066"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\x<EM
CLASS="emphasis"
>hex</EM
><A
CLASS="indexterm"
NAME="AUTOID-5072"
></A
></TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Character represented as hexadecimal value[3]</TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>\<EM
CLASS="emphasis"
>c</EM
></TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Any literal character
<EM
CLASS="emphasis"
>c</EM
> (e.g., <B
CLASS="emphasis.bold"
>\&quot;</B
> for <B
CLASS="emphasis.bold"
>&quot;</B
>)[4]</TD
></TR
></TBODY
></TABLE
><BLOCKQUOTE
CLASS="footnote"
><P
CLASS="para"
>[3] POSIX does not provide &quot;\x&quot;, but it is commonly available.</P
><P
CLASS="para"
>[4]  Like ANSI C, POSIX leaves
purposely undefined what you get when you put a backslash before any
character not listed in the table. In most awks, you just get that
character.  </P
></BLOCKQUOTE
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-5087"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5089"
></A
>A <EM
CLASS="emphasis"
>variable</EM
> is an identifier that references a
value.  To define a variable, you only have to name it and assign it a
value.  The name can only contain letters, digits, and underscores,
and may not start with a digit.  Case distinctions in variable names<A
CLASS="indexterm"
NAME="AUTOID-5093"
></A
>
are important: <B
CLASS="emphasis.bold"
>Salary</B
> and 
<B
CLASS="emphasis.bold"
>salary</B
> are two different variables.  Variables
are not declared; you do not have to tell awk what
<EM
CLASS="emphasis"
>type</EM
> of value will be stored in a variable.  Each
variable has a string value and a numeric value, and awk uses the
appropriate value based on the context of the expression.  (Strings
that do not consist of numbers have a numeric value of 0.)  Variables
do not have to be initialized; awk automatically initializes
them to
the empty string, which acts like 0 if used as a number.  The
following expression assigns a value to <B
CLASS="emphasis.bold"
>x</B
>:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>x = 1</PRE
></BLOCKQUOTE
><P
CLASS="para"
><B
CLASS="emphasis.bold"
>x</B
> is the name of the variable, <KBD
CLASS="command"
>=</KBD
> is an assignment
operator, and <SPAN
CLASS="systemitem"
>1</SPAN
> is a numeric constant.</P
><P
CLASS="para"
>The following expression
assigns the string &quot;Hello&quot; to the variable <B
CLASS="emphasis.bold"
>z</B
>:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>z = &quot;Hello&quot;</PRE
></BLOCKQUOTE
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-5109"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5111"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5114"
></A
>A space is the string concatenation operator.  The
expression:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>z = &quot;Hello&quot; &quot;World&quot;</PRE
></BLOCKQUOTE
><P
CLASS="para"
>concatenates the two strings and
assigns &quot;HelloWorld&quot; to the variable <B
CLASS="emphasis.bold"
>z</B
>.</P
><P
CLASS="para"
>The dollar sign ($) operator is used to reference fields.
The following expression assigns the value of the first 
field of the current input record to the variable <B
CLASS="emphasis.bold"
>w</B
>:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>w = $1</PRE
></BLOCKQUOTE
><P
CLASS="para"
>A variety of operators can be used in expressions.
Arithmetic operators are listed in <A
CLASS="xref"
HREF="ch07_06.htm#SEDAWK-CH-7-TAB-2"
TITLE="Arithmetic Operators"
>Table 7.2</A
>.<A
CLASS="indexterm"
NAME="AUTOID-5125"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5129"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5132"
></A
></P
><TABLE
CLASS="table"
><CAPTION
CLASS="table"
><A
CLASS="title"
NAME="SEDAWK-CH-7-TAB-2"
>Table 7.2: Arithmetic Operators</A
></CAPTION
><THEAD
CLASS="thead"
><TR
CLASS="row"
VALIGN="TOP"
><TH
CLASS="entry"
ALIGN="LEFT"
ROWSPAN="1"
COLSPAN="1"
>Operator</TH
><TH
CLASS="entry"
ALIGN="LEFT"
ROWSPAN="1"
COLSPAN="1"
>Description</TH
></TR
></THEAD
><TBODY
CLASS="tbody"
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>+</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Addition<A
CLASS="indexterm"
NAME="AUTOID-5145"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5148"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5150"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>-</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Subtraction<A
CLASS="indexterm"
NAME="AUTOID-5156"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5159"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5161"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>*</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Multiplication<A
CLASS="indexterm"
NAME="AUTOID-5167"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5170"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5172"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>/</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Division<A
CLASS="indexterm"
NAME="AUTOID-5178"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5181"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5183"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>%</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Modulo<A
CLASS="indexterm"
NAME="AUTOID-5189"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5192"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5194"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>^</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Exponentiation<A
CLASS="indexterm"
NAME="AUTOID-5200"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5203"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5206"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5208"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>**</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Exponentiation[5]<A
CLASS="indexterm"
NAME="AUTOID-5216"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5219"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5222"
></A
></TD
></TR
></TBODY
></TABLE
><BLOCKQUOTE
CLASS="footnote"
><P
CLASS="para"
>[5] This is a common extension. It is not in the POSIX standard, and often
not in the system documentation, either. Its use is thus nonportable.</P
></BLOCKQUOTE
><P
CLASS="para"
>Once a variable has been assigned a value, that value can be
referenced using the name of the variable.  The following expression
adds 1 to the value of <B
CLASS="emphasis.bold"
>x</B
> and assigns it
to the variable <B
CLASS="emphasis.bold"
>y</B
>:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>y = x + 1</PRE
></BLOCKQUOTE
><P
CLASS="para"
>So, evaluate <B
CLASS="emphasis.bold"
>x</B
>, add 1 to it, and put the result
into the variable <B
CLASS="emphasis.bold"
>y</B
>.
The statement:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>print y</PRE
></BLOCKQUOTE
><P
CLASS="para"
>prints the value of <B
CLASS="emphasis.bold"
>y</B
>.  If the following sequence of 
statements appears in a script: </P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>x = 1
y = x + 1
print y</PRE
></BLOCKQUOTE
><P
CLASS="para"
>then the value of <B
CLASS="emphasis.bold"
>y</B
> is 2.</P
><P
CLASS="para"
>We could reduce these three statements to two:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>x = 1
print x + 1</PRE
></BLOCKQUOTE
><P
CLASS="para"
>Notice, however, that after the <KBD
CLASS="command"
>print</KBD
> statement the
value of <B
CLASS="emphasis.bold"
>x</B
> is still 1.  We didn't
change the value of <B
CLASS="emphasis.bold"
>x</B
>; we simply added
1 to it and printed that value.  In other words, if a third statement
<KBD
CLASS="command"
>print x</KBD
> followed, it would output 1.  If, in fact,
we wished to accumulate the value in <B
CLASS="emphasis.bold"
>x</B
>,
we could use an assignment operator <KBD
CLASS="command"
>+=</KBD
>.  This
operator combines two operations; it adds 1 to 
<B
CLASS="emphasis.bold"
>x</B
> and assigns the new value to 
<B
CLASS="emphasis.bold"
>x</B
>.  <A
CLASS="xref"
HREF="ch07_06.htm#SEDAWK-CH-7-TAB-3"
TITLE="Assignment Operators"
>Table 7.3</A
> lists the
assignment operators used in awk expressions.<A
CLASS="indexterm"
NAME="AUTOID-5250"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5252"
></A
></P
><TABLE
CLASS="table"
><CAPTION
CLASS="table"
><A
CLASS="title"
NAME="SEDAWK-CH-7-TAB-3"
>Table 7.3: Assignment Operators</A
></CAPTION
><THEAD
CLASS="thead"
><TR
CLASS="row"
VALIGN="TOP"
><TH
CLASS="entry"
ALIGN="LEFT"
ROWSPAN="1"
COLSPAN="1"
>Operator</TH
><TH
CLASS="entry"
ALIGN="LEFT"
ROWSPAN="1"
COLSPAN="1"
>Description</TH
></TR
></THEAD
><TBODY
CLASS="tbody"
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>++</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Add 1 to variable.<A
CLASS="indexterm"
NAME="AUTOID-5267"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5270"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5273"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>--</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Subtract 1 from variable.<A
CLASS="indexterm"
NAME="AUTOID-5278"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5281"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5284"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>+=</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Assign result of addition.<A
CLASS="indexterm"
NAME="AUTOID-5289"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5292"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>-=</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Assign result of subtraction.<A
CLASS="indexterm"
NAME="AUTOID-5298"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5301"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>*=</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Assign result of multiplication.<A
CLASS="indexterm"
NAME="AUTOID-5307"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5310"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>/=</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Assign result of division.<A
CLASS="indexterm"
NAME="AUTOID-5316"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5319"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>%=</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Assign result of modulo.<A
CLASS="indexterm"
NAME="AUTOID-5325"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5328"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>^=</TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Assign result of exponentiation.<A
CLASS="indexterm"
NAME="AUTOID-5334"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5337"
></A
></TD
></TR
><TR
CLASS="row"
VALIGN="TOP"
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>**=<A
CLASS="indexterm"
NAME="AUTOID-5342"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5345"
></A
></TD
><TD
CLASS="entry"
ROWSPAN="1"
COLSPAN="1"
>Assign result of exponentiation.[6]</TD
></TR
></TBODY
></TABLE
><BLOCKQUOTE
CLASS="footnote"
><P
CLASS="para"
>[6] As with &quot;**&quot;, this is a common extension, which is also nonportable.</P
></BLOCKQUOTE
><P
CLASS="para"
>Look at the following example, which counts each 
blank line in a file.</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
># Count blank lines.
/^$/ { 
	print x += 1 
     }</PRE
></BLOCKQUOTE
><P
CLASS="para"
>Although we didn't initialize the value of <B
CLASS="emphasis.bold"
>x</B
>,
we can safely assume that its value is 0
up until the first blank line is encountered.
The expression &quot;x += 1&quot; 
is evaluated each time
a blank line is matched and the value of <B
CLASS="emphasis.bold"
>x</B
> is
incremented by 1. The <KBD
CLASS="command"
>print</KBD
> statement prints the value 
returned by the expression. 
Because we execute the <KBD
CLASS="command"
>print</KBD
> statement for every blank line,
we get a running count of blank lines.</P
><P
CLASS="para"
>There are different ways to write expressions, some more terse
than others.  The expression &quot;x += 1&quot; is 
more concise than the following
equivalent expression:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>x = x + 1</PRE
></BLOCKQUOTE
><P
CLASS="para"
>But neither of these expressions is as terse as the following
expression:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>++x</PRE
></BLOCKQUOTE
><P
CLASS="para"
><A
CLASS="indexterm"
NAME="AUTOID-5363"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5366"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5369"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5371"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5374"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5377"
></A
>&quot;++&quot; is the increment operator.  (&quot;--&quot; is the decrement operator.)  
Each time the expression is evaluated the value of the variable
is incremented by one.  The increment and decrement operators
can appear on either side of the operand, as <EM
CLASS="emphasis"
>prefix</EM
>
or <EM
CLASS="emphasis"
>postfix</EM
> operators.  The position has a different effect. <A
CLASS="indexterm"
NAME="AUTOID-5381"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5383"
></A
><A
CLASS="indexterm"
NAME="AUTOID-5385"
></A
></P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>++x	<I
CLASS="lineannotation"
>Increment x before returning value (prefix)</I
>
x++	<I
CLASS="lineannotation"
>Increment x after returning value (postfix)</I
></PRE
></BLOCKQUOTE
><P
CLASS="para"
>For instance, if our example was written:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>/^$/ { 
	print x++
     }</PRE
></BLOCKQUOTE
><P
CLASS="para"
>When the
first blank line is matched, the expression returns
the value &quot;0&quot;; the second blank line returns &quot;1&quot;, and so on.  
If we put the increment operator before 
<B
CLASS="emphasis.bold"
>x</B
>, then the first time the expression is evaluated,
it will return &quot;1.&quot;</P
><P
CLASS="para"
>Let's implement that expression in our example.
In addition, instead of printing a count each time a blank
line is matched, we'll accumulate the count as the value of <B
CLASS="emphasis.bold"
>x</B
>
and print only the total number of blank lines.
The <KBD
CLASS="command"
>END</KBD
> pattern is the place to put the <KBD
CLASS="command"
>print</KBD
>
that displays the value of <B
CLASS="emphasis.bold"
>x</B
> after the last input line is read.</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
># Count blank lines.
/^$/ { 
	++x
}
END {
	print x
}</PRE
></BLOCKQUOTE
><P
CLASS="para"
>Let's try it on the sample file that 
has three blank lines in it. </P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$ <CODE
CLASS="userinput"
><B
>awk -f awkscr test</B
></CODE
>
3</PRE
></BLOCKQUOTE
><P
CLASS="para"
>The script outputs the number of blank lines.</P
><DIV
CLASS="sect2"
><H3
CLASS="sect2"
><A
CLASS="title"
NAME="SEDAWK-CH-7-SECT-6.1"
>7.6.1 Averaging Student Grades</A
></H3
><P
CLASS="para"
>Let's look at another example, one in which we sum a series of
student grades and then calculate the average.  Here's what
the input file looks like:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>john 85 92 78 94 88
andrea 89 90 75 90 86
jasper 84 88 80 92 84</PRE
></BLOCKQUOTE
><P
CLASS="para"
>There are five grades following the student's name.
Here is the script that will give us each student's
average:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
># average five grades 
{ total = $2 + $3 + $4 + $5 + $6
  avg = total / 5
  print $1, avg }</PRE
></BLOCKQUOTE
><P
CLASS="para"
>This script adds together fields 2 through 6 to get
the sum total of the five grades.
The value of <B
CLASS="emphasis.bold"
>total</B
> is divided by 5 and assigned
to the variable <B
CLASS="emphasis.bold"
>avg</B
>.  (&quot;/&quot; is the operator for
division.)  The <KBD
CLASS="command"
>print</KBD
> statement
outputs the student's name and average.
Note that we could have skipped the assignment of <B
CLASS="emphasis.bold"
>avg</B
>
and instead calculated the average as part of the <KBD
CLASS="command"
>print</KBD
>
statement, as follows:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>print $1, total / 5</PRE
></BLOCKQUOTE
><P
CLASS="para"
>This script shows how easy it is
to write programs in awk.  
Awk parses the input into fields and records.
You are spared having to read individual characters and declaring data
types.  Awk does this for you, automatically.</P
><P
CLASS="para"
>Let's see a sample run of the script that calculates student
averages:</P
><BLOCKQUOTE
CLASS="screen"
><PRE
CLASS="screen"
>$ <CODE
CLASS="userinput"
><B
>awk -f grades.awk grades</B
></CODE
>
john 87.4
andrea 86
jasper 85.6</PRE
></BLOCKQUOTE
><P
CLASS="para"
></P
></DIV
><A
CLASS="indexterm"
NAME="AUTOID-5423"
></A
></DIV
><DIV
CLASS="htmlnav"
><P
></P
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><TABLE
WIDTH="515"
BORDER="0"
CELLSPACING="0"
CELLPADDING="0"
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch07_05.htm"
TITLE="7.5 Records and Fields"
><IMG
SRC="../gifs/txtpreva.gif"
ALT="Previous: 7.5 Records and Fields"
BORDER="0"></A
></TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="book"
HREF="index.htm"
TITLE="sed &amp; awk"
><IMG
SRC="../gifs/txthome.gif"
ALT="sed &amp; awk"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
><A
CLASS="SECT1"
HREF="ch07_07.htm"
TITLE="7.7 System Variables"
><IMG
SRC="../gifs/txtnexta.gif"
ALT="Next: 7.7 System Variables"
BORDER="0"></A
></TD
></TR
><TR
><TD
ALIGN="LEFT"
VALIGN="TOP"
WIDTH="172"
>7.5 Records and Fields</TD
><TD
ALIGN="CENTER"
VALIGN="TOP"
WIDTH="171"
><A
CLASS="index"
HREF="index/idx_0.htm"
TITLE="Book Index"
><IMG
SRC="../gifs/index.gif"
ALT="Book Index"
BORDER="0"></A
></TD
><TD
ALIGN="RIGHT"
VALIGN="TOP"
WIDTH="172"
>7.7 System Variables</TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="515"
TITLE="footer"><IMG
SRC="../gifs/smnavbar.gif"
USEMAP="#map"
BORDER="0"
ALT="The UNIX CD Bookshelf Navigation"><MAP
NAME="map"
><AREA
SHAPE="RECT"
COORDS="0,0,73,21"
HREF="../index.htm"
ALT="The UNIX CD Bookshelf"><AREA
SHAPE="RECT"
COORDS="74,0,163,21"
HREF="../upt/index.htm"
ALT="UNIX Power Tools"><AREA
SHAPE="RECT"
COORDS="164,0,257,21"
HREF="../unixnut/index.htm"
ALT="UNIX in a Nutshell"><AREA
SHAPE="RECT"
COORDS="258,0,321,21"
HREF="../vi/index.htm"
ALT="Learning the vi Editor"><AREA
SHAPE="RECT"
COORDS="322,0,378,21"
HREF="index.htm"
ALT="sed &amp; awk"><AREA
SHAPE="RECT"
COORDS="379,0,438,21"
HREF="../ksh/index.htm"
ALT="Learning the Korn Shell"><AREA
SHAPE="RECT"
COORDS="439,0,514,21"
HREF="../lrnunix/index.htm"
ALT="Learning the UNIX Operating System"></MAP
></DIV
></BODY
></HTML
>
