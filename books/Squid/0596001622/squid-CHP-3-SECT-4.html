<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>3.4 The configure Script</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="squid-CHP-3-SECT-3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="squid-CHP-3-SECT-5.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="squid-CHP-3-SECT-4"></A>
<H3 class="docSection1Title">3.4 The configure Script</H3>

<P class="docText">Like many other <A NAME="squid-CHP-3-ITERM-1163"></A><A NAME="squid-CHP-3-ITERM-1164"></A>Unix software
packages, Squid uses a <I>./configure</I> script to learn
about an operating system before compiling. The
<I>./configure</I> script is generated by the popular GNU
<I>autoconf</I> program. When the script runs, it probes
the system in various ways to find out about libraries, functions,
types, parameters, and features that may or may not be present. One
of the first things that <I>./configure</I> does is look
for a working C compiler. If the compiler can't be
found or fails to compile a simple test program, the
<I>./configure</I> script can't proceed.</P>

<P class="docText">The <I>./configure</I> script has a number of different
options. The most important is the installation prefix. Before
running <I>./configure</I>, you need to decide where
Squid should live. The installation prefix determines the default
locations for the Squid logs, binaries, and configuration files. You
can change the location for those files after installing, but
it's easier if you decide now.</P>

<P class="docText">The default installation prefix is
<I>/usr/local/squid</I>. Squid puts files in seven
different subdirectories under the prefix:</P>

<PRE>% ls -l /usr/local/squid
total 5
drwxr-x---  2 wessels  wheel  512 Apr 28 20:42 bin
drwxr-x---  2 wessels  wheel  512 Apr 28 20:42 etc
drwxr-x---  2 wessels  wheel  512 Apr 28 20:42 libexec
drwxr-x---  3 wessels  wheel  512 Apr 28 20:43 man
drwxr-x---  2 wessels  wheel  512 Apr 28 20:42 sbin
drwxr-x---  4 wessels  wheel  512 Apr 28 20:42 share
drwxr-x---  4 wessels  wheel  512 Apr 28 20:43 var</PRE>

<P class="docText">Squid uses the <I>bin</I>, <I>etc</I>,
<I>libexec</I>, <I>man</I>,
<I>sbin</I>, and <I>share</I> directories
for a few, relatively small files (or other directories) that
don't change very often. The files under the
<I>var</I> directory, however, are a different story.
This is where you'll find Squid's
log files, which may grow quite large (tens or hundreds of
megabytes). <I>var</I> is also the default location for
the actual disk cache. You may want to put <I>var</I>
on a different partition with plenty of space. One easy way to do
this is with the <I>—localstatedir</I> option:</P>

<PRE>% ./configure --localstatedir=/bigdisk/var</PRE>

<P class="docText">You don't need to worry too much about pathnames
when configuring Squid. You can always change the pathnames later, in
the <I>squid.conf</I> file.</P>

<A NAME="squid-CHP-3-SECT-4.1"></A>
<H4 class="docSection2Title">3.4.1 configure Options</H4>

<P class="docText">The <I>./configure</I> script has a number of <A NAME="squid-CHP-3-ITERM-1165"></A><A NAME="squid-CHP-3-ITERM-1166"></A>different
options that all start with <I>—</I>. You can see the
full list of options by typing <TT><B>./configure
--help</B></TT>. Some of these options are common to all configure
scripts, and some are unique to Squid. Here are the standard options
that you might find useful:</P>

<DL class="docList"><br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--prefix</span></span> =<TT><I>PREFIX</I></TT></span></DT></p>
<DD>
<P class="docList">This sets the installation prefix directory, as described earlier.
The installation prefix is the default directory for all executables,
logs, and configuration files. Throughout this book,
<I>$prefix</I> refers to your choice for the
installation prefix.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--localstatedir</span></span> =<TT><I>DIR</I></TT></span></DT></p>
<DD>
<P class="docList">This option allows you to change the location for the
<span class="docEmphasis">var</span> directory. The default is
<I>$prefix/var</I>, but you might want to change it so
that Squid's disk cache and log files are stored
elsewhere.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--sysconfdir</span></span> =<TT><I>DIR</I></TT></span></DT></p>
<DD>
<P class="docList">This option allows you to change the location for the
<span class="docEmphasis">etc</span> directory. The default is
<I>$prefix/etc</I>. If you like to use
<I>/usr</I> as the installation prefix, you might want
to set <I>—sysconfdir</I> to
<I>/etc</I>.</P>
</DD>
</DL>

<P class="docText">Here are the Squid-specific <I>./configure</I> options:</P>

<A NAME="squid-CHP-3-ITERM-1167"></A><A NAME="squid-CHP-3-ITERM-1168"></A><DL class="docList"><br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-dlmalloc</span></span>[=<span class="docEmphasis">LIB</span>]</span></DT></p>
<DD>
<P class="docList">On some systems, the built-in memory allocation (malloc) functions
have poor performance characteristics when used with Squid. Using the
<I>—enable-dlmalloc</I> option builds and links with
the <TT>dlmalloc</TT> package included in the Squid source
code. If you already have <TT>dlmalloc</TT> built on your
system, you can specify the library's pathname as
the <span class="docEmphasis">=LIB</span> argument. See <A class="docLink" target="_blank" HREF="http://g.oswego.edu/dl/html/malloc.html">http://g.oswego.edu/dl/html/malloc.html</A> for
more information on <TT>dlmalloc</TT>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-gnuregex</span></span></span></DT></p>
<DD>
<P class="docList">Squid uses <I>regular expressions</I> for pattern
matching in access control lists and other configuration directives.
The GNU regular expression library comes with the Squid source code;
it can be used on operating systems that don't have
built-in regular expression functions. The
<I>./configure</I> script probes your system for a
regular expression library and enables the use of GNU regex if
necessary. If, for some reason, you want to force the usage of GNU
regex, you can add this option to the <I>./configure</I>
command.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-carp</span></span></span></DT></p>
<DD>
<P class="docList">The Cache Array Routing Protocol (CARP) is useful for forwarding
cache misses to an array, or cluster, of parent caches.
There's more about CARP in <A class="docLink" HREF="squid-CHP-10-SECT-9.html#squid-CHP-10-SECT-9">Section 10.9</A>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-async-io</span></span> [=<TT><I>N_THREADS</I></TT>]</span></DT></p>
<DD>
<P class="docList">Async I/O refers to one of Squid's techniques for
improved storage performance. The <span class="docEmphasis">aufs</span> storage
module uses a number of thread processes to perform disk I/O
operations. This code works only on Linux and Solaris systems. The
<span class="docEmphasis">=N_THREADS</span> argument changes the number of thread
processes Squid uses. <span class="docEmphasis">aufs</span> and Async I/O are
discussed in <A class="docLink" HREF="squid-CHP-8-SECT-4.html#squid-CHP-8-SECT-4">Section 8.4</A>.</P>

<P class="docList">Note that the <I>—enable-async-io</I> option is a
shortcut that turns on three other <I>./configure</I>
options. It is equivalent to specifying:</P>

<PRE>--with-aufs-threads=N_THREADS
--with-pthreads
--enable-storeio=ufs,aufs</PRE>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--with-pthread</span></span>s</span></DT></p>
<DD>
<P class="docList">The <I>—with-pthreads</I> option causes the
compilation procedure to link with your system's
Pthreads library. The <span class="docEmphasis">aufs</span> storage module is the
only part of Squid that uses threads. Normally, you
don't specify this option on the
<I>./configure</I> command line because
it's enabled automatically when you use
<I>—enable-async-io</I>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-storeio</span></span> =<TT><I>LIST</I></TT></span></DT></p>
<DD>
<P class="docList">Squid supports a number of different storage modules. With this
option, you tell <I>./configure</I> which modules to
compile. The <I>ufs</I>, <I>aufs</I>,
<I>diskd</I>, <I>coss</I>, and
<I>null</I> modules are supported in
Squid-2.5. You can also get a list by looking at the directories
under <I>src/fs</I>.</P>

<P class="docList"><TT><I>LIST</I></TT> is a comma-separated list of module
names. For example:</P>

<PRE>% ./configure --enable-storeio=afus,diskd,ufs</PRE>

<P class="docList">The <span class="docEmphasis">ufs</span> module is the default and least likely
to cause problems. Unfortunately, it also has limited performance
characteristics. The other modules may not necessarily compile on
your particular operating system. For a complete description of
Squid's storage modules, see <A class="docLink" HREF="squid-CHP-8.html#squid-CHP-8">Chapter 8</A>.</P>

</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--with-aufs-threads</span></span> =<TT><I>N_THREADS</I></TT></span></DT></p>
<DD>
<P class="docList">Specifies the number of threads to use for the
<span class="docEmphasis">aufs</span> storage scheme (see <A class="docLink" HREF="squid-CHP-8-SECT-4.html#squid-CHP-8-SECT-4">Section 8.4</A>). By default, Squid automatically calculates
how many threads to use, based on the number of cache directories.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-heap-replacement</span></span></span></DT></p>
<DD>
<P class="docList">This option has been deprecated but remains for backward
compatibility. You should always use the
<I>—enable-removal-policies</I> option instead.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-removal-policies</span></span> =<TT><I>LIST</I></TT></span></DT></p>
<DD>
<P class="docList">Removal policies are the algorithms Squid uses to eject cached
objects when making room for new ones. Squid-2.5 supports three
removal policies: least recently used (LRU), greed dual size (GDS),
and least frequently used (LFU).</P>

<P class="docList">However, for some reason, the <I>./configure</I> options
blur the distinction between a particular replacement policy and the
underlying data structures required to implement them. LRU, which is
the default, is implemented with a doubly linked list. The GDS and
LFU implementations use a data structure known as a
<I>heap</I>.</P>

<P class="docList">To use the GDS or LFU policies, you specify:</P>

<PRE>% ./configure --enable-removal-policies=heap</PRE>

<P class="docList">You then select between GDS and LFU in the Squid configuration file.
If you want to retain the option of using LRU, specify:</P>

<PRE>% ./configure --enable-removal-policies=heap,lru</PRE>

<P class="docList">There's more about replacement policies in <A class="docLink" HREF="squid-CHP-7-SECT-5.html#squid-CHP-7-SECT-5">Section 7.5</A>.</P>

</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-icmp</span></span></span></DT></p>
<DD>
<P class="docList">As you'll see in <A class="docLink" HREF="squid-CHP-10-SECT-5.html#squid-CHP-10-SECT-5">Section 10.5</A>, Squid
can make round-trip time measurements with ICMP messages, much like
the <I>ping</I> program. You can use this option to
enable these features.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-delay-pools</span></span></span></DT></p>
<DD>
<P class="docList">Delay pools are Squid's technique for traffic
shaping or bandwidth limiting. The pools consist of groups of client
IP addresses. When requests from these clients are cache misses,
their responses may be artificially delayed. See more about delay
pools in <A class="docLink" HREF="squid-APP-C.html#squid-APP-C">Appendix C</A>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-useragent-log</span></span></span></DT></p>
<DD>
<P class="docList">This option enables logging of the HTTP <TT>User-Agent</TT>
header from client requests. See more about this in <A class="docLink" HREF="squid-CHP-13-SECT-5.html#squid-CHP-13-SECT-5">Section 13.5</A>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-referer</span></span><span class="docEmphasis">-</span><span class="docPubcolor"><span class="docMonofont">log</span></span></span></DT></p>
<DD>
<P class="docList">This option enables logging of the HTTP <TT>referer</TT>
header from client requests. See more about this in <A class="docLink" HREF="squid-CHP-13-SECT-4.html#squid-CHP-13-SECT-4">Section 13.4</A>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--disable-wccp</span></span></span></DT></p>
<DD>
<P class="docList">The Web Cache Coordination Protocol (WCCP) is
Cisco's once-proprietary protocol for intercepting
and distributing HTTP requests to one or more caches. WCCP is enabled
by default, but you can use this option to prevent compilation of the
WCCP code if you like.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-snmp</span></span></span></DT></p>
<DD>
<P class="docList">The Simple Network Management Protocol (SNMP) is a popular way to
monitor network devices and servers. This option causes the build
procedure to compile all of the SNMP-related code, including a
cut-down version of the CMU SNMP library.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-cachemgr</span></span> -<span class="docPubcolor"><span class="docMonofont">hostname</span></span> [=<TT><I>hostname</I></TT>]</span></DT></p>
<DD>
<P class="docList"><span class="docEmphasis">cachemgr</span> is a CGI program you can use to
administratively query Squid. By default,
<span class="docEmphasis">cachemgr</span>'s hostname field is
blank, but you can create a default value with this option. For
example:</P>

<PRE>% ./configure --enable-cachemgr-hostname=mycache.myorg.net</PRE>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-arp-acl</span></span></span></DT></p>
<DD>
<P class="docList">Squid supports ARP, or Ethernet address, access control lists on some
operating systems. The code to implement ARP ACLs uses nonstandard
function interfaces, so it is disabled by default. If you run Squid
on Linux or Solaris, you may be able to use this feature.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-htcp</span></span></span></DT></p>
<DD>
<P class="docList">HTCP is the Hypertext Caching Protocol—an intercache protocol
similar to ICP. See <A class="docLink" HREF="squid-CHP-10-SECT-8.html#squid-CHP-10-SECT-8">Section 10.8</A> for more
information.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-ssl</span></span></span></DT></p>
<DD>
<P class="docList">Use this option to give Squid the ability to terminate SSL/TLS
connections. Note this only works for accelerated requests in
surrogate mode. See <A class="docLink" HREF="squid-CHP-15-SECT-2.html#squid-CHP-15-SECT-2.2">Section 15.2.2</A> for more
information.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--with-openssl</span></span> [=<TT><I>DIR</I></TT>]</span></DT></p>
<DD>
<P class="docList">This option exists so that you can tell the compiler where to find
the OpenSSL libraries and header files, if necessary. If they
aren't in the default location, enter the parent
directory after this option. For example:</P>

<PRE>% ./configure --enable-ssl --with-ssl=/opt/foo/openssl</PRE>

<P class="docList">Given this example, your compiler looks for the OpenSSL header files
in <I>/opt/foo/openssl/include</I>, and for libraries
in <I>/opt/foo/openssl/lib</I>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-cache-digests</span></span></span></DT></p>
<DD>
<P class="docList">Cache Digests are another alternative to ICP, but with significantly
different characteristics. See <A class="docLink" HREF="squid-CHP-10-SECT-7.html#squid-CHP-10-SECT-7">Section 10.7</A>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-err-languages</span></span> ="<TT><I>lang1</I></TT> <TT><I>lang2</I></TT> ..."</span></DT></p>
<DD>
<P class="docList">Squid supports customizable error messages and comes with error
messages in many different languages. This option determines the
languages that are copied to the installation directory
(<I>$prefix/share/errors</I>). If you
don't use this option, all available languages are
installed. To see which languages are available, look at a directory
listing of the <I>errors</I> directory in the source
distribution. Here's how to enable more than one
language:</P>

<PRE>% ./configure --enable-err-languages="Dutch German French" ...</PRE>

</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-default-err-language</span></span> =<TT><I>lang</I></TT></span></DT></p>
<DD>
<P class="docList">This option sets the default value for the
<span class="docEmphasis">error_directory</span> directive. For example, if you
want to use Dutch error messages, you can use this
<I>./configure</I> option:</P>

<PRE>% ./configure --enable-default-err-language=Dutch</PRE>

<P class="docList">You can also set the <span class="docEmphasis">error_directory</span> directive
in <I>squid.conf</I>, as described in <A class="docLink" HREF="appa-77585.html#appa-77585">Appendix A</A>. English is the default error language if you
omit this option.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--with-coss-membuf-size</span></span> =<TT><I>N</I></TT></span></DT></p>
<DD>
<P class="docList">The Cyclic Object Storage System (<I>coss</I>) is an
experimental storage scheme for Squid. This option sets the memory
buffer size for <span class="docEmphasis">coss</span> cache directories. Note
that in order to use <I>coss</I>, you must specify it
as a storage type in the <I>—enable-storeio</I>
option.</P>

<P class="docList">The argument is given in bytes. The default is 1,048,576 bytes or 1
MB. You can specify a 2-MB buffer like this:</P>

<PRE>% ./configure --with-coss-membuf-size=2097152</PRE>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-poll</span></span></span></DT></p>
<DD>
<P class="docList">Unix provides two similar functions that scan open file descriptors
for I/O events: <I>select( )</I> and <I>poll(
)</I>. The <I>./configure</I> script usually does
a very good job of figuring out when to use <I>poll(
)</I> over <I>select( )</I>. Use this option if
you want to override the <I>./configure</I> script and
force it to use <I>poll( )</I>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--disable-poll</span></span></span></DT></p>
<DD>
<P class="docList">Similarly, Unix gurus may want to force
<I>./configure</I> to not use <I>poll(
)</I>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--disable-http-violations</span></span></span></DT></p>
<DD>
<P class="docList">By default, Squid can be configured to violate the HTTP protocol
specifications. You can use this option to remove the code completely
that would violate HTTP.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-ipf-transparent</span></span></span></DT></p>
<DD>
<P class="docList">In <A class="docLink" HREF="squid-CHP-9.html#squid-CHP-9">Chapter 9</A>, I'll describe how
to configure Squid for interception caching. Some operating systems
use the IP Filter package to assist with the interception. In these
cases you should use this <I>./configure</I> option. If
you enable this option and get compiler errors on the
<I>src/client_side.c</I> file, chances are that the IP
Filter package isn't actually (or correctly)
installed on your system.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-pf-transparent</span></span></span></DT></p>
<DD>
<P class="docList">You may need this option to use HTTP interception on systems that use
the PF packet filter. PF is the standard packet filter for OpenBSD
and may have been ported to other systems as well. If you enable this
option and get compiler errors on the
<I>src/client_side.c</I> file, chances are that PF
isn't actually installed on your system.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-linux-netfilter</span></span></span></DT></p>
<DD>
<P class="docList">Netfilter is the name of the Linux packet filter for the 2.4 kernel
series. Enable this option if you want to use HTTP interception with
Linux 2.4 or later.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--disable-ident-lookups</span></span></span></DT></p>
<DD>
<P class="docList"><I>ident</I> is a simple protocol that allows a
server to find the username associated with a
client's particular TCP connection. If you use this
option, the compiler excludes completely the code that performs such
lookups. Even if you leave the code enabled at compile time, Squid
doesn't make <span class="docEmphasis">ident</span> lookups
unless you configure them in <I>squid.conf</I>.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--disable-internal-dns</span></span></span></DT></p>
<DD>
<P class="docList">The Squid source code includes two different DNS resolution
implementations, called <span class="docEmphasis">internal</span> and
<span class="docEmphasis">external</span>. Internal lookups are the default, but
some people prefer the external technique. This option disables the
internal functionality and reverts to the older method.</P>

<P class="docList">Internal lookups use Squid's own implementation of
the DNS protocol. That is, Squid generates raw DNS queries and sends
them to a resolver. It retransmits queries that time out, and you can
specify any number of resolvers. One of the benefits to this
implementation is that Squid gets accurate TTLs for DNS replies.</P>

<P class="docList">External lookups use the C library's
<I>gethostbyname( )</I> and <I>gethostbyaddr(
)</I> functions. Since these routines block the process until
the answer comes back, they must be called from external, helper
processes. Squid uses a pool of external processes to make queries in
parallel. The primary drawback to external DNS resolution is that you
need more helper processes as Squid's load
increases. Another annoyance is that the C library functions
don't convey TTLs with the answers, in which case
Squid uses a constant value supplied by the
<span class="docEmphasis">positive_dns_ttl</span> directive.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-truncate</span></span></span></DT></p>
<DD>
<P class="docList">The <I>truncate( )</I> system call is an alternative to
using <I>unlink( )</I>. While <I>unlink(
)</I> removes a cache file altogether, <I>truncate(
)</I> sets the file size to zero. This frees the disk space
associated with the file but leaves the directory entry in place.
This option exists because some people believed (or hoped) that
<TT>truncate( )</TT> would produce better performance than
<TT>unlink( )</TT>. However, benchmarks have shown little or
no real difference.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--disable-hostname-checks</span></span></span></DT></p>
<DD>
<P class="docList">By default, Squid requires that URL hostnames conform to the somewhat
archaic specifications in RFC 1034:</P>

<blockquote>
<p class="docText">The labels must follow the rules for ARPANET host names. They must
start with a letter, end with a letter or digit, and have as interior
characters only letters, digits, and hyphen.</p>
</blockquote>

<P class="docList">Here, "letter" means the ASCII
characters A through Z. Since internationalized domain names are
becoming increasingly popular, you may want to use this option to
remove the restriction.</P>

</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-underscores</span></span></span></DT></p>
<DD>
<P class="docList">This option controls Squid's behavior regarding
underscore characters in hostnames. General consensus is that
hostnames must not include underscore characters, although some
people disagree. Squid, by default, generates an error message for
requests that have an underscore in a URL hostname. You can use this
option to make Squid treat them as valid. However, your DNS resolver
may also enforce the no-underscore requirement and fail to resolve
such hostnames.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-auth</span></span> [=<TT><I>LIST</I></TT>]</span></DT></p>
<DD>
<P class="docList">This option controls which HTTP authentication schemes to support in
the Squid binary. You can select any combination of the following
schemes: <span class="docEmphasis">basic</span>, <span class="docEmphasis">digest</span>, and
<span class="docEmphasis">ntlm</span>. If you omit the option, Squid supports
only basic authentication. If you give the
<I>—enable-auth</I> option without any arguments, the
build process adds support for all schemes. Otherwise, you can give a
comma-separated list of schemes to support:</P>

<PRE>% ./configure --enable-auth=digest,ntlm</PRE>

<P class="docList">I talk more about authentication in Chapters 
<A class="docLink" HREF="squid-CHP-6.html#squid-CHP-6">6</A> and 
<A class="docLink" HREF="squid-CHP-12.html#squid-CHP-12">12</A>.</P> 

</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-auth-helpers</span></span> =<TT><I>LIST</I></TT></span></DT></p>
<DD>
<P class="docList">This old option is now deprecated, but still remains for backward
compatibility. You should use
<I>—enable-basic-auth-helpers=</I><TT><I>LIST</I></TT>
instead.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-basic-auth-helpers</span></span> =<TT><I>LIST</I></TT></span></DT></p>
<DD>
<P class="docList">With this option, you can build one or more of the HTTP Basic
authentication helper programs found in
<I>helpers/basic_auth</I>. See <A class="docLink" HREF="squid-CHP-12-SECT-2.html#squid-CHP-12-SECT-2">Section 12.2</A> for their names and descriptions.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-ntlm-auth-helpers</span></span> =<TT><I>LIST</I></TT></span></DT></p>
<DD>
<P class="docList">With this option, you can build one or more of the HTTP NTLM
authentication helper programs found in
<I>helpers/ntlm_auth</I>. See <A class="docLink" HREF="squid-CHP-12-SECT-4.html#squid-CHP-12-SECT-4">Section 12.4</A> for their names and descriptions.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-ntlm-fail-open</span></span></span></DT></p>
<DD>
<P class="docList">When you enable this option, Squid's NTLM
authentication module defaults to allow access in the event of an
error or problem.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-digest-auth-modules</span></span>=<span class="docEmphasis">LIST</span></span></DT></p>
<DD>
<P class="docList">With this option, you can build one or more of the HTTP Digest
authentication helper programs found in
<I>helpers/digest_auth</I>. See <A class="docLink" HREF="squid-CHP-12-SECT-3.html#squid-CHP-12-SECT-3">Section 12.3</A> for their names and descriptions.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-external-acl-helpers</span></span>=<span class="docEmphasis">LIST</span></span></DT></p>
<DD>
<P class="docList">With this option, you can build one or more of the external ACL
helper programs that I discuss in <A class="docLink" HREF="squid-CHP-12-SECT-5.html#squid-CHP-12-SECT-5">Section 12.5</A>. For
example:</P>

<PRE>% ./configure --enable-external-acl-helpers=ip_user,ldap_group</PRE>

</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--disable-unlinkd</span></span></span></DT></p>
<DD>
<P class="docList"><span class="docEmphasis">Unlinkd</span> is another one of
Squid's external helper processes. Its sole job is
to execute the <I>unlink( )</I> (or <I>truncate(
)</I>) system call on cache files. Squid realizes a
significant performance gain by implementing file deletion in an
external process. Use this option to disable the external unlink
daemon feature.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-stacktrace</span></span></span></DT></p>
<DD>
<P class="docList">Some operating systems support automatic generation of stack trace
data in the event of a program crash. When you enable this feature
and Squid crashes, the stack trace information is written to the
<I>cache.log</I> file. This information is often
helpful to developers in tracking down programming bugs.</P>
</DD>
<br><p><DT><span class="docPubcolor"><span class="docPubcolor"><span class="docMonofont">--enable-x-accelerator-vary</span></span></span></DT></p>
<DD>
<P class="docList">This advanced feature may <A NAME="squid-CHP-3-ITERM-1167"></A>be used when Squid is configured as a
surrogate. It instructs Squid to look for
<TT>X-Accelerator-Vary</TT> headers in responses from
backend origin <A NAME="squid-CHP-3-ITERM-1168"></A>servers. See <A class="docLink" HREF="squid-CHP-15-SECT-5.html#squid-CHP-15-SECT-5">Section 15.5</A>.</P>
</DD>
</DL>


<A NAME="squid-CHP-3-SECT-4.2"></A>
<H4 class="docSection2Title">3.4.2 Running configure</H4>

<P class="docText">Now we're ready to <A NAME="squid-CHP-3-ITERM-1169"></A>run the
<I>./configure</I> script. Go to the top-level source
directory and type <I>./configure</I>, followed by any of
the options mentioned previously. For example:</P>

<PRE>% cd squid-2.5.STABLE4
% ./configure --enable-icmp --enable-htcp</PRE>

<P class="docText"><I>./configure</I>'s job is to probe
your operating system and find out which things are available, and
which are not. One of the first things it does is make sure your C
compiler is working. If <I>./configure</I> detects a
problem with your C compiler, the script exits with this error
message:</P>

<PRE>configure: error: installation or configuration problem: C compiler
cannot create executables.</PRE>

<P class="docText">Most likely, you'll never see that message. If you
do, it means either your system doesn't have a C
compiler at all or that the compiler isn't installed
correctly. Look at the <I>config.log</I> file for hints
as to the exact problem. If your system has more than one C compiler,
you can tell <I>./configure</I> which to use by setting
the <TT>CC</TT> environment variable before running
<I>./configure</I>:</P>

<PRE>% setenv CC /usr/local/bin/gcc
% ./configure ...</PRE>

<P class="docText">After <I>./configure</I> checks out the compiler, it
looks for a long list of header files, libraries, and functions.
Normally you won't have to worry about this part. In
some cases, <I>./configure</I> pauses to get your
attention about something that may be a problem (such as not enough
file descriptors). It may also stop if you specify incompatible or
unreasonable command-line options. If something does go wrong, check
the <I>config.log</I> output.
<I>./configure</I>'s final task is to
create <I>Makefile</I>s and other files based on the
things it learned about your system. At this point,
you're ready to begin compiling.</P>



<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="squid-CHP-3-SECT-3.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="squid-CHP-3-SECT-5.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
