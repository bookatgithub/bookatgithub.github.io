<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>5.8 Stopping Squid</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="squid-CHP-5-SECT-7.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="squid-CHP-5-SECT-9.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="squid-CHP-5-SECT-8"></A>
<H3 class="docSection1Title">5.8 Stopping Squid</H3>

<P class="docText">The safest way to shut down
<A NAME="squid-CHP-5-ITERM-1273"></A>Squid is with the
<I>squid -k shutdown</I> command:</P>

<PRE>% squid -k shutdown</PRE>

<P class="docText">This command sends the TERM signal to the running Squid process. Upon
receipt of the TERM signal, Squid closes its incoming sockets so that
new requests aren't accepted. It then waits some
amount of time for outstanding requests to complete. The default is
30 seconds, which you can change with the
<span class="docEmphasis">shutdown_lifetime</span> directive.</P>

<P class="docText">If, for some reason, <A NAME="squid-CHP-5-ITERM-1274"></A>the <I>squid.pid</I> file is
missing or unreadable, the <TT>squid</TT>
<TT>-k</TT> commands don't work. In this
case, you can manually kill Squid by finding the process ID with
<I>ps</I>. For example:</P>

<PRE>% ps ax | grep squid</PRE>

<P class="docText">If you see more than one Squid process, be sure to kill the one that
shows up as <TT>(squid)</TT>. For example:</P>

<PRE>% ps ax | grep squid
  294  ??  Is     0:00.01 squid -sD
  296  ??  S      0:00.27 (squid) -sD (squid)
% kill -TERM 296</PRE>

<P class="docText">After sending the TERM signal, you may want to watch the log file to
double-check that Squid is shutting down:</P>

<PRE>% tail -f logs/cache.log
2003/09/29 21:49:30| Preparing for shutdown after 9316 requests
2003/09/29 21:49:30| Waiting 10 seconds for active connections to finish
2003/09/29 21:49:30| FD 11 Closing HTTP connection
2003/09/29 21:49:31| Shutting down...
2003/09/29 21:49:31| FD 12 Closing ICP connection
2003/09/29 21:49:31| Closing unlinkd pipe on FD 9
2003/09/29 21:49:31| storeDirWriteCleanLogs: Starting...
2003/09/29 21:49:32| Finished.  Wrote 253 entries.
2003/09/29 21:49:32| Took 0.1 seconds (1957.6 entries/sec).
2003/09/29 21:49:32| Squid Cache (Version 2.5.STABLE4): Exiting normally.</PRE>

<P class="docText">If you use <I>squid -k interrupt</I>, Squid shuts down
immediately, without waiting for active requests to complete. This is
equivalent to sending the INT signal with <I>kill</I>.</P>


<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="squid-CHP-5-SECT-7.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="squid-CHP-5-SECT-9.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
