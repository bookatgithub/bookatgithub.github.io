<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title> Credit Card Numbers</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="app02lev1sec11.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="app02lev1sec13.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="app02lev1sec12"></A><H3 class="docSection1Title"> Credit Card Numbers</H3>
<P class="docText">Credit card numbers cannot be truly validated using regular expressions; final validation always requires some interaction with a credit card processing organization. However, regular expression validation can indeed be useful in trapping typos (like one digit too many or too few) before submitting any data anywhere.<A NAME="idd1e16640"></A><A NAME="idd1e16643"></A></P>
<A NAME="app02note13"></A><div class="docNote"><p class="docNoteTitle">Note</p><p><table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="40" HEIGHT="29" SRC="images/0672325667/graphics/r6_10min_icon.gif" ALT="graphics/r6_10min_icon.gif"></td><td valign="top"><P class="docText">The patterns used here all assume that any embedded spaces or hyphens have been removed. This is generally a good practice to remove any nondigits from credit card numbers before performing any regular expression processing.</P></td></tr></table></p></div><br>
<P class="docText">All credit cards follow a basic numbering scheme—an opening digit sequence followed by a specified number of digits. We'll start with MasterCard.<A NAME="idd1e16665"></A></P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: 371234567890123
Discover: 601112345678901234
Diners Club: 38812345678901
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
5[1-5]\d{14}
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: 371234567890123
Discover: 601112345678901234
Diners Club: 38812345678901
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">All MasterCard numbers are 16 digits; the first digit is always <TT>5</TT>, and the second digit is <TT>1</TT> through <TT>5</TT>. <TT>5[1-5]</TT> matches the first two digits; <TT>\d{14}</TT> matches the next 14 digits.<A NAME="idd1e16713"></A><A NAME="idd1e16716"></A><A NAME="idd1e16719"></A></P>
<P class="docText">Visa is a little trickier.</P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: 371234567890123
Discover: 601112345678901234
Diners Club: 38812345678901
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
4\d{12}(\d{3})?
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: <span class="docEmphMark">4123456789012</span>
Visa 2: <span class="docEmphMark">4123456789012345</span>
Amex: 371234567890123
Discover: 601112345678901234
Diners Club: 38812345678901
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">All Visa numbers start with <TT>4</TT> and are 13 or 16 digits (but not 14 or 15, and so a range cannot be used). <TT>4</TT> matches <TT>4</TT>, <TT>\d{12}</TT> matches the next 12 digits, and <TT>(\d{3})?</TT> matches an additional 3 digits if they are present.<A NAME="idd1e16780"></A><A NAME="idd1e16783"></A></P>
<P class="docText">American Express requires a much simpler pattern.<A NAME="idd1e16789"></A></P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: 371234567890123
Discover: 601112345678901234
Diners Club: 38812345678901
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
3[47]\d{13}
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: <span class="docEmphMark">371234567890123</span>
Discover: 601112345678901234
Diners Club: 38812345678901
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">American Express numbers are 15 digits and start with <TT>34</TT> or <TT>37</TT>. <TT>3[47]</TT> matches the first 2 digits, and <TT>\d{13}</TT> matches the remaining 13 digits.<A NAME="idd1e16837"></A><A NAME="idd1e16840"></A></P>
<P class="docText">Discover uses a simple pattern.</P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: 371234567890123
Discover: 601112345678901234
Diners Club: 38812345678901
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
6011\d{14}
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: 371234567890123
Discover: <span class="docEmphMark">601112345678901234</span>
Diners Club: 38812345678901
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">All Discover cards are 16 digits and start with digits <TT>6011</TT>; <TT>6011\d{14}</TT> does the trick.<A NAME="idd1e16889"></A><A NAME="idd1e16892"></A><A NAME="idd1e16899"></A></P>
<P class="docText">Diners Club is a little trickier.<A NAME="idd1e16905"></A></P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: 371234567890123
Discover: 601112345678901234
Diners Club: 38812345678901
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
(30[0-5]|36\d|38\d)\d{11}
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: 371234567890123
Discover: 601112345678901234
Diners Club: <span class="docEmphMark">38812345678901</span>
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">Diners Club numbers are 14 digits and begin with <TT>300</TT> through <TT>305</TT>, <TT>36</TT>, or <TT>38</TT>. If the opening digits are <TT>300</TT> through <TT>305</TT>, an additional 11 digits are needed, whereas if the opening digits are <TT>36</TT> or <TT>38</TT>, an additional 12 digits are needed. To make this simpler, the pattern first matches the first three digits regardless of what they are. <TT>(30[0-5]|36\d|38\d)</TT> has three expressions, any of which must match; <TT>30[0-5]</TT> matches <TT>300</TT> through <TT>305</TT>, <TT>36\d</TT> matches any three-digit number starting with <TT>36</TT>, and <TT>38\d</TT> matches any three-digit number starting with <TT>38</TT>. This way, <TT>\d{11}</TT> can be used to match the remaining 11 digits.<A NAME="idd1e16992"></A></P>
<P class="docText">All that remains now is a way to check any of the five card types used here.<A NAME="idd1e16998"></A><A NAME="idd1e17001"></A></P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
MasterCard: 5212345678901234
Visa 1: 4123456789012
Visa 2: 4123456789012345
Amex: 371234567890123
Discover: 601112345678901234
Diners Club: 38812345678901
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
(5[1-5]\d{14})|(4\d{12}(\d{3})?)|(3[47]\d{13})|(6011\d{14})|((30[0-5]|36\d|38\d)\d{11})
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
MasterCard: <span class="docEmphMark">5212345678901234</span>
Visa 1: <span class="docEmphMark">4123456789012</span>
Visa 2: <span class="docEmphMark">4123456789012345</span>
Amex: <span class="docEmphMark">371234567890123</span>
Discover: <span class="docEmphMark">601112345678901234</span>
Diners Club: <span class="docEmphMark">38812345678901</span>
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">The pattern here uses alternation (providing alternatives <span class="docEmphasis">or</span> statements) to include all the previous patterns, each separated by a <TT>|</TT>. The result? Simple validation of all major credit card types.</P>
<A NAME="app02note14"></A><div class="docNote"><p class="docNoteTitle">Note</p><p><table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="40" HEIGHT="29" SRC="images/0672325667/graphics/r6_10min_icon.gif" ALT="graphics/r6_10min_icon.gif"></td><td valign="top"><P class="docText">The patterns used here ensure that the credit card number has the correct opening digits and is of the correct length. However, not every 13-digit number that begins with 4 is a valid Visa number. A formula known as <span class="docEmphasis">Mod 10</span> can be used to perform a calculation on the digits (of all the credit card types mentioned here) so as to determine if the digits are truly valid. Mod 10 is an important part of implementing credit card processing, but it is not a job for regular expressions because it involves performing mathematical calculations.<A NAME="idd1e17077"></A><A NAME="idd1e17080"></A></P></td></tr></table></p></div><br>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="app02lev1sec11.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="app02lev1sec13.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
