<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title> Grouping with Subexpressions</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch07lev1sec1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch07lev1sec3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch07lev1sec2"></A><H3 class="docSection1Title"> Grouping with Subexpressions</H3>
<P class="docText">This brings us to the topic of subexpressions. Subexpressions are parts of a bigger expression; the parts are grouped together so that they are treated as a single entity. Subexpressions are enclosed between <TT>(</TT> and <TT>)</TT> characters.<A NAME="idd1e9070"></A><A NAME="idd1e9075"></A><A NAME="idd1e9080"></A><A NAME="idd1e9087"></A><A NAME="idd1e9094"></A></P>
<A NAME="ch07note01"></A><div class="docNote"><p class="docNoteTitle">Tip</p><p><table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="24" HEIGHT="40" SRC="images/0672325667/graphics/pips_icon.gif" ALT="graphics/pips_icon.gif"></td><td valign="top"><P class="docText"><TT>(</TT> and <TT>)</TT> are metacharacters. To match the actual characters <TT>(</TT> and <TT>)</TT>, you must escape them as <TT>\(</TT> and <TT>\)</TT>, respectively.</P></td></tr></table></p></div><br>
<P class="docText">To demonstrate the use of subexpressions, let's revisit the previous example:</P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
Hello, my name is Ben&amp;nbsp;Forta, and I am
the author of books on SQL, ColdFusion, WAP,
Windows&amp;nbsp;&amp;nbsp;2000, and other subjects.
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
(&amp;nbsp;){2,}
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
Hello, my name is Ben&amp;nbsp;Forta, and I am
the author of books on SQL, ColdFusion, WAP,
Windows<span class="docEmphMark">&amp;nbsp;&amp;nbsp;</span>2000, and other subjects.
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText"><TT>(&amp;nbsp;)</TT> is a subexpression and is treated as single entity. As such, the <TT>{2,}</TT> that follows it applies to the entire subexpression (not just the semicolon). That did the trick.<A NAME="idd1e9171"></A><A NAME="idd1e9176"></A><A NAME="idd1e9181"></A><A NAME="idd1e9188"></A><A NAME="idd1e9195"></A></P>
<P class="docText">Here is another example—this time a regular expression is used to locate IP addresses. IP addresses are formatted as four sets of numbers separated by periods, such as <TT>12.159.46.200</TT>. Because each of the numbers can be one, two, or three digits, the pattern to match each number could be expressed as <TT>\d{1,3}</TT>. This is shown in the following example:</P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
Pinging hog.forta.com [12.159.46.200]
with 32 bytes of data:
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
Pinging hog.forta.com [<span class="docEmphMark">12.159.46.200</span>]
with 32 bytes of data:
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">Each instance of <TT>\d{1,3}</TT> matches one of the numbers in an IP address. The four numbers are separated by <TT>.</TT>, which is escaped as <TT>\.</TT></P>
<P class="docText">The pattern <TT>\d{1,3}\.</TT> (up to <TT>3</TT> digits followed by <TT>.</TT>) is repeated three times and can thus be expressed as a repetition as well. Following is an alternative version of the same example:</P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
Pinging hog.forta.com [12.159.46.200]
with 32 bytes of data:
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
(\d{1,3}\.){3}\d{1,3}
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
Pinging hog.forta.com [<span class="docEmphMark">12.159.46.200</span>]
with 32 bytes of data:
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">This pattern worked just as well as the previous one, but the syntax is different. The expression <TT>\d{1,3}\.</TT> has been enclosed within <TT>(</TT> and <TT>)</TT> to make it a subexpression. <TT>(\d{1,3}\.){3}</TT> repeats the subexpression <TT>3</TT> times (for the first three numbers in the IP address), and then <TT>\d{1,3}</TT> matches the final number.<A NAME="idd1e9315"></A><A NAME="idd1e9320"></A><A NAME="idd1e9325"></A><A NAME="idd1e9332"></A><A NAME="idd1e9339"></A></P>
<A NAME="ch07note02"></A><div class="docNote"><p class="docNoteTitle">Note</p><p><table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="40" HEIGHT="29" SRC="images/0672325667/graphics/r6_10min_icon.gif" ALT="graphics/r6_10min_icon.gif"></td><td valign="top"><P class="docText"><TT>(\d{1,3}\.){4}</TT> is not a viable alternative to the pattern just used. Can you work out why it would have failed in this example?</P></td></tr></table></p></div><br>
<A NAME="ch07note03"></A><div class="docNote"><p class="docNoteTitle">Tip</p><p><table width="90%" border="0" cellspacing="0" cellpadding="1"><tr><td width="60" valign="top"><IMG BORDER="0" ALIGN="LEFT" WIDTH="24" HEIGHT="40" SRC="images/0672325667/graphics/pips_icon.gif" ALT="graphics/pips_icon.gif"></td><td valign="top"><P class="docText">Some users like to enclose parts of expressions as subexpressions to improve readability; the previous pattern would be expressed as <TT>(\d{1,3}\.){3}(\d{1,3})</TT>. This practice is perfectly legal, and using it has no effect on the actual behavior of the expression (although there may be performance implications, depending on the regular expression implementation being used).</P></td></tr></table></p></div><br>
<P class="docText">The use of subexpressions for grouping is so important that it is worthwhile to look at one more example—one not involving repetitions at all. This example attempts to match a year in a user record:</P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
ID: 042
SEX: M
DOB: 1967-08-17
Status: Active
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
19|20\d{2}
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
ID: 042
SEX: M
DOB: <span class="docEmphMark">19</span>67-08-17
Status: Active
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">In this example, the pattern was to have located a four-digit year, but for greater accuracy, the first two digits are explicitly listed as <TT>19</TT> and <TT>20</TT>. As explained in <A class="docLink" HREF="ch03.html#ch03">Lesson 3</A>, "Matching Sets of Characters," <TT>|</TT> is the OR operator, and so <TT>19|20</TT> matches either <TT>19</TT> or <TT>20</TT>, and pattern <TT>19|20\d2</TT> should therefore match any four-digit number beginning with <TT>19</TT> or <TT>20</TT> (<TT>19</TT> or <TT>20</TT> followed by <TT>2</TT> digits). Obviously, this did not work. Why not? The <TT>|</TT> operator looks at what is to its left and to its right and reads pattern <TT>19|20\d{2}</TT> as either <TT>19</TT> or <TT>20\d{2}</TT> (thinking that the <TT>\d{2}</TT> is part of the expression that started with <TT>20</TT>). In other words, it will match the number <TT>19</TT> or any four-digit year beginning with <TT>20</TT>. As such, <TT>19</TT> matched.<A NAME="idd1e9480"></A><A NAME="idd1e9485"></A><A NAME="idd1e9490"></A><A NAME="idd1e9497"></A><A NAME="idd1e9504"></A></P>
<P class="docText">The solution is to group <TT>19|20</TT> as a subexpression, as follows:</P>
<pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/text_icon.gif" ALT="graphics/text_icon.gif"></pre><pre>
ID: 042
SEX: M
DOB: 1967-08-17
Status: Active
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/regex_icon.gif" ALT="graphics/regex_icon.gif"></pre><pre>
(19|20)\d{2}
</pre><pre><IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/result_icon.gif" ALT="graphics/result_icon.gif"></pre><pre>
ID: 042
SEX: M
DOB: <span class="docEmphMark">1967</span>-08-17
Status: Active
</pre>
<IMG BORDER="0" WIDTH="70" HEIGHT="22" SRC="images/0672325667/graphics/analysis_icon.gif" ALT="graphics/analysis_icon.gif">
<P class="docText">With the options all within a subexpression, <TT>|</TT> knows that what is wanted is one of the options within the group. <TT>(19|20)\d{2}</TT> thus correctly matches <TT>1967</TT> and would also match any four digits beginning with <TT>19</TT> or <TT>20</TT>. At some later date (close to a hundred years from now), if the code needed to be modified to also match years starting with <TT>21</TT>, the pattern could be changed to <TT>(19|20|21)\d{2}</TT>.<A NAME="idd1e9571"></A><A NAME="idd1e9576"></A><A NAME="idd1e9581"></A><A NAME="idd1e9588"></A><A NAME="idd1e9595"></A></P>
<UL><LI><P class="docList">Although this lesson covers the use of subexpressions for grouping, there is another extremely important use for subexpressions. This is covered in <A class="docLink" HREF="ch08.html#ch08">Lesson 8</A>, "Using Backreferences."</P></LI></UL>
<ul></ul></td></tr></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="ch07lev1sec1.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="ch07lev1sec3.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
