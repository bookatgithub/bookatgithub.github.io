<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="20.2 Plan 9: The Way the Future Was"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
	<a href="0131429019_ch20lev1sec1.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0131429019_ch20lev1sec3.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch20lev1sec2"></A>
<H3 class="docSection1Title">20.2 Plan 9: The Way the Future Was</H3>
<P class="docText"><A NAME="idd1e42302"></A><A NAME="idd1e42305"></A>We know what Unix's future used to look like. It was designed by the research group at Bell Labs<A NAME="idd1e42309"></A> that built Unix and called 'Plan 9 from Bell Labs'.<sup class="docFootnote"><A class="docLink" HREF="#ch20en02">[2]</A></sup> Plan 9 was an attempt to do Unix over again, better.</P><blockquote><p class="docFootnote"><sup><A NAME="ch20en02">[2]</A></sup> The name is a tribute to the 1958 movie that has passed into legend as "the worst ever made", <span class="docEmphasis">Plan 9 from Outer Space</span>. (The legend is, unfortunately, incorrect, as the few who have seen an even worse stinkeroo from 1966 called <span class="docEmphasis">Manos: The Hands of Fate</span> can attest.) Documentation, including a survey paper describing the architecture, along with complete source code and a distribution that installs on PCs, can be readily found with a Web search for the phrase 'Plan 9 from Bell Labs'.</p></blockquote>
<P class="docText">The central design challenge the designers attempted to meet in Plan 9 was integrating graphics and ubiquitous networking into a comfortable Unix-like framework. They kept the Unix choice to mediate access to as many system services as possible through a single big file-hierarchy name space. In fact, they improved on it; many facilities that under Unix are accessed through various ad-hoc interfaces like BSD sockets<A NAME="idd1e42326"></A>, <span class="docEmphasis">fcntl</span>(2)<A NAME="idd1e42333"></A>, and <span class="docEmphasis">ioctl</span>(2)<A NAME="idd1e42340"></A> are in Plan 9 accessed through ordinary read and write operations on special files analogous to device files. For portability and ease of access, almost all device interfaces are textual rather than binary. Most system services (including, for example, the window system) are <span class="docEmphasis">file servers</span><A NAME="idd1e42346"></A> containing special files or directory trees representing the served resources. By representing all resources as files, Plan 9 turns the problem of accessing resources on different servers into the problem of accessing files on different servers.</P>
<P class="docText">Plan 9 combined this more-Unix-than-Unix file model with a new concept: private name spaces. Every user (in fact, every process) can have its own view of the system's services by creating its own tree of file-server mounts. Some of the file server mounts will have been manually set up by the user, and others automatically set up at login time. So (as the <span class="docEmphasis">Plan 9 from Bell Labs</span> survey paper points out) "<TT>/dev/cons</TT> always refers to your terminal device and <TT>/bin/date</TT> to the correct version of the date command to run, but which files those names represent depends on circumstances such as the architecture of the machine executing <span class="docEmphStrong"><TT>date</TT></span>".</P>
<P class="docText">The single most important feature of Plan 9 is that all mounted file servers export the same file-system-like interface, regardless of the implementation behind them. Some might correspond to local file systems, some to remote file systems accessed over a network, some to instances of system servers running in user space (like the window system or an alternate network stack), and some to kernel interfaces. To users and client programs, all these cases look alike.</P>
<P class="docText">One of the examples from the Plan 9 survey paper is the way FTP access to remote sites is implemented. There is no <span class="docEmphasis">ftp</span>(1)<A NAME="idd1e42378"></A> command under Plan 9. Instead there is an <span class="docEmphasis">ftpfs</span> fileserver, and each FTP connection looks like a file system mount. <span class="docEmphasis">ftpfs</span> automatically translates open, read, and write commands on files and directories under the mount point into FTP protocol transactions. Thus, all ordinary file-handling tools such as <span class="docEmphasis">ls</span>(1)<A NAME="idd1e42397"></A>, <span class="docEmphasis">mv</span>(1)<A NAME="idd1e42404"></A> and <span class="docEmphasis">cp</span>(1)<A NAME="idd1e42411"></A> simply work, both underneath the FTP mount point and across the boundaries with the rest of the user's view of the namespace. The only difference the user (or his scripts and programs) will notice is retrieval speed.</P>
<P class="docText">Plan 9 has much else to recommend it, including the reinvention of some of the more problematic areas of the Unix system-call interface, the elimination of superuser, and many other interesting rethinkings. Its pedigree is impeccable, its design elegant, and it exposes some significant errors in the design of Unix. Unlike most efforts at a second system, it produced an architecture that was in many ways simpler and more elegant than its predecessor. Why didn't it take over the world?</P>
<P class="docText">One could argue for a lot of specific reasons—lack of any serious effort to market it, scanty documentation, much confusion and stumbling over fees and licensing. For those unfamiliar with Plan 9, it seemed to function mainly as a device for generating interesting papers on operating-systems research. But Unix itself had previously surmounted all these sorts of obstacles to attract a dedicated following that spread it worldwide. Why didn't Plan 9?</P>
<P class="docText">The long view of history may tell a different story, but in 2003 it looks like Plan 9 failed simply because it fell short of being a compelling enough improvement on Unix to displace its ancestor. Compared to Plan 9, Unix creaks and clanks and has obvious rust spots, but it gets the job done well enough to hold its position. There is a lesson here for ambitious system architects: the most dangerous enemy of a better solution is an existing codebase that is just good enough.</P>
<P class="docText">Some Plan 9 ideas have been absorbed into modern Unixes, particularly the more innovative open-source versions. FreeBSD<A NAME="idd1e42430"></A> has a <TT>/proc</TT> file system modeled exactly on that of Plan 9 that can be used to query or control running processes. FreeBSD's <span class="docEmphasis">rfork</span>(2)<A NAME="idd1e42440"></A> and Linux's <span class="docEmphasis">clone</span>(2)<A NAME="idd1e42447"></A> system calls are modeled on Plan 9's <span class="docEmphasis">rfork</span>(2). Linux's <TT>/proc</TT> file system, in addition to presenting process information, holds a variety of synthesized Plan 9-like device files used to query and control kernel internals using predominantly textual interfaces. Experimental 2003 versions of Linux are implementing per-process mount points, a long step toward Plan 9's private namespaces. The various open-source Unixes are all moving toward systemwide support for UTF-8, an encoding actually invented for Plan 9.<sup class="docFootnote"><A class="docLink" HREF="#ch20en03">[3]</A></sup></P><blockquote><p class="docFootnote"><sup><A NAME="ch20en03">[3]</A></sup> The tale of how UTF-8 was born involves Ken Thompson<A NAME="idd1e42460"></A>, Rob Pike<A NAME="idd1e42464"></A>, a new Jersey diner, and a frenzied overnight hack &lt;<A class="docLink" target="_blank" HREF="http://www.cl.cam.ac.uk/~mgk25/ucs/utf-8-history.txt">http://www.cl.cam.ac.uk/~mgk25/ucs/utf-8-history.txt</A>&gt;.</p></blockquote>
<P class="docText">It may well be that over time, much more of Plan 9 will work its way into Unix as various portions of Unix's architecture slide into senescence. This is one possible line of development for Unix's future.</P>

<ul></ul></td></tr></table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
          <a href="0131429019_ch20lev1sec1.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0131429019_ch20lev1sec3.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
