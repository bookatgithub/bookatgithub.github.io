<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Exercises</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch01lev1sec3.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch02.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a name="ch01lev1sec4"></a>
<h3 id="title-IDANPEK" class="docSection1Title">Exercises</H3>
<a name="ch01lev2sec7"></a>
<H4 id="title-IDAWPEK" class="docSection2Title">Exercise 1</h4>
<P><table border="0" cellspacing="16" cellpadding="0"><tr valign="top"><TD align="right" class="docText" width="50"><a name="ch01qa1q1"></a><B></b></TD><TD><p class="docText">One of the biggest difficulties in writing code that uses heavily templatized types, such as <tt>tuple</tt>, is deciphering the messages that your compiler and your library implementation produce when your code has an error.</p>
<p class="docText">For each of the following errors, write a simple test case containing the error, and try to compile it. In the error messages, look for the key words that relate to the error in the code. This will make developing code that uses <tt>tuple</tt> much easier.</P>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList">Attempting default construction of a <tt>tuple</tt> object when one or more of the element types does not have a default constructor</P></div></LI><li><div style="font-weight:normal"><p class="docList">Attempting copy construction of a <tt>tuple&lt;T&gt;</tt> object from a <tt>tuple&lt;U&gt;</tt> object when objects of type <tt>U</tt> are not convertible to type <tt>T</tt></P></div></LI><li><div style="font-weight:normal"><p class="docList">Attempting assignment of a <tt>tuple&lt;T&gt;</tt> object from a <tt>tuple&lt;U&gt;</tt> object when objects of type <tt>U</tt> are not convertible to type <tt>T</tt></p></div></li><li><div style="font-weight:normal"><p class="docList">Attempting copy construction or assignment to a <tt>tuple</tt> object from a <tt>tuple</tt> object with a different number of elements</P></div></li><li><div style="font-weight:normal"><p class="docList">Attempting to call <tt>get</tt> with an index that is greater than the number of elements in the <tt>tuple</tt> argument</P></div></LI></ol></div>
</TD></tr></table></p>

<a name="ch01lev2sec8"></a>
<H4 id="title-IDAQSEK" class="docSection2Title">Exercise 2</h4>
<p><table border="0" cellspacing="16" cellpadding="0"><tr valign="top"><td align="right" class="docText" width="50"><a name="ch01qa2q1"></a><b></b></td><td><p class="docText">Write and compile a source file that defines the following types:</p>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList"><tt>tuple0</tt>, a type that is a synonym for a <tt>tuple</tt> specialization that holds no elements</p></div></li><li><div style="font-weight:normal"><p class="docList"><tt>tuple1</tt>, a type that is a synonym for a <tt>tuple</tt> specialization that holds one element, of type <tt>long double</tt></P></div></li><LI><div style="font-weight:normal"><p class="docList"><tt>tuple2</tt>, a type that is a synonym for a <tt>tuple</tt> specialization that holds two elements: the first of type <tt>long double</tt> and the second of type reference to <tt>unsigned long</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><tt>tuple7</tt>, a type that is a synonym for a <tt>tuple</tt> specialization that holds elements of the following types: <tt>char</tt>, <tt>short</tt>, <tt>int</tt>, <tt>long</tt>, <tt>float</tt>, <tt>double</tt>, <tt>long double</tt></P></div></LI></ol></div>
</td></TR></table></p>

<a name="ch01lev2sec9"></a>
<H4 id="title-IDA5UEK" class="docSection2Title">Exercise 3</H4>
<P><table border="0" cellspacing="16" cellpadding="0"><TR valign="top"><td align="right" class="docText" width="50"><a name="ch01qa3q1"></a><B></b></td><TD><p class="docText">Write a program that creates objects of type <tt>tuple&lt;unsigned char, unsigned char, unsigned char&gt;</tt><sup class="docFootnote"><a class="docLink" href="#ch01fn4">[4]</a></sup> in three ways and displays their stored values. Do this in two steps:</P><blockquote><p class="docFootnote"><sup><a name="ch01fn4">[4]</a></sup> A <tt>tuple</tt> holding <tt>int</tt> values is more natural, but technically, you can't copy or display uninitialized values of integral types other than the three forms of <tt>char</tt> in portable code. Although this is rarely a problem in practice, the behavior of a program that does this is not defined by the C++ standard.</p></blockquote>
<div style="font-weight:bold"><ol class="docList" type="1"><LI><div style="font-weight:normal"><p class="docList">Write a function named <tt>show</tt> that takes an argument of type <tt>const tuple&lt;unsigned char, unsigned char, unsigned char&gt;&amp;</tt> and displays the three values that it holds. Use the templates <tt>get&lt;0&gt;</tt>, <tt>get&lt;1&gt;</tt>, and <tt>get&lt;2&gt;</tt> to get the values.</P></div></li><li><div style="font-weight:normal"><p class="docList">In the <tt>main</tt> function, create the objects and pass them to <tt>show</tt>.</p></div></li></ol></div>
</TD></tr></table></p>

<a name="ch01lev2sec10"></a>
<H4 id="title-IDADXEK" class="docSection2Title">Exercise 4</H4>
<P><table border="0" cellspacing="16" cellpadding="0"><tr valign="top"><td align="right" class="docText" width="50"><a name="ch01qa4q1"></a><B></b></td><td><p class="docText">Write a program that creates three <tt>auto</tt> variables of type <tt>int</tt>, all initialized to <tt>0</tt>, and an <tt>auto</tt> object of type <tt>tuple&lt;int&amp;, int&amp;, int&amp;&gt;</tt> that holds references to the three <tt>auto</tt> variables. Use the <tt>tuple</tt> object to show the values of the <tt>auto</tt> variables. Now change the values of the <tt>auto</tt> variables.</p>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList">Write three statements that use the <tt>tuple</tt> object to change the values of the three <tt>auto</tt> variables one at a time to <tt>1</tt>, <tt>2</tt>, and <tt>3</tt>. Use the <tt>tuple</tt> object to show the new values.</p></div></li><li><div style="font-weight:normal"><p class="docList">Write a single statement that uses the <tt>tuple</tt> object to change the values of the three <tt>auto</tt> variables to <tt>4</tt>, <tt>5</tt>, and <tt>6</tt>. Show the new values of the <tt>auto</tt> variables. <span class="docEmphasis">Hint:</span> Use <tt>make_tuple</tt>.</p></div></li><li><div style="font-weight:normal"><p class="docList">Write a single statement that creates a temporary object of type <tt>tuple&lt;int, int, int&gt;</tt> holding the values <tt>7</tt>, <tt>8</tt>, and <tt>9</tt> and assigns the values held in that <tt>tuple</tt> object to the three <tt>auto</tt> variables. Show the new values of the <tt>auto</tt> variables. <span class="docEmphasis">Hint:</span> Use a temporary object of type <tt>tuple&lt;int&amp;, int&amp;, int&amp;&gt;</tt> to change the values of the three <tt>auto</tt> variables.</p></div></li><LI><div style="font-weight:normal"><p class="docList">Write a single statement that creates a temporary object of type <tt>tuple&lt;int, int, int&gt;</tt> holding the values <tt>10</tt>, <tt>11</tt>, and <tt>12</tt> and assigns the first and third values held in that <tt>tuple</tt> object to the first and third <tt>auto</tt> variables. Show the new values of the <tt>auto</tt> variables. <span class="docEmphasis">Hint:</span> Use <tt>tie</tt>.</p></div></LI></ol></div>
</td></tr></table></p>

<a name="ch01lev2sec11"></a>
<H4 id="title-IDAN1EK" class="docSection2Title">Exercise 5</H4>
<p><table border="0" cellspacing="16" cellpadding="0"><TR valign="top"><td align="right" class="docText" width="50"><a name="ch01qa5q1"></a><B></b></TD><TD><p class="docText">Write a program that shows the properties of several <tt>tuple</tt> instances.</P>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList">Write a function template that can be called with a <tt>tuple</tt> object holding an arbitrary number of elements that shows how many elements the object holds. Use this function to show the sizes of several <tt>tuple</tt> types. <span class="docEmphasis">Hint:</span> To write a function template that takes only <tt>tuple</tt> instances of various sizes, you'd have to write a separate function for each possible size. That's tedious and not particularly interesting. Instead, write a function template that takes an argument of any type and assumes that the type of the argument is, in fact, a <tt>tuple</tt> instance.</P></div></li><LI><div style="font-weight:normal"><p class="docList">Write a function template that can be called with a <tt>tuple</tt> object holding two elements that shows the types of the elements, using <tt>typeid::name</tt>. Use this function to show the types of the elements in several <tt>tuple</tt> instances.</P></div></li></ol></div>
</TD></TR></table></p>

<a name="ch01lev2sec12"></a>
<h4 id="title-IDAI3EK" class="docSection2Title">Exercise 6</h4>
<p><table border="0" cellspacing="16" cellpadding="0"><TR valign="top"><td align="right" class="docText" width="50"><a name="ch01qa6q1"></a><b></b></TD><TD><p class="docText">Consider the following objects:</P>
<div class="docText"><pre>tuple&lt;int, int, int&gt; t0 (1, 2, 3);
tuple&lt;double, double, double&gt; t1 (1.0, 2.0, 3.0);
tuple&lt;double, double, double&gt; t2 (1.0, 2.1, 2.9);
</pre></div><br>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList">What should the result of each of the following comparisons be?</P><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList"><tt>t0 == t1</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><tt>t0 == t2</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><tt>t0 &lt; t1</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><tt>t0 &lt; t2</tt></p></div></li></ol></div></div></LI><li><div style="font-weight:normal"><p class="docList">Now write a program to create these three objects, perform each of the preceding comparisons, and report the result. Compile and run the program.</P></div></li></ol></div>
</td></tr></table></P>

<a name="ch01lev2sec13"></a>
<H4 id="title-IDAR5EK" class="docSection2Title">Exercise 7</h4>
<P><table border="0" cellspacing="16" cellpadding="0"><tr valign="top"><TD align="right" class="docText" width="50"><a name="ch01qa7q1"></a><B></b></TD><TD><p class="docText">Some math libraries implement the <tt>sin</tt> and <tt>cos</tt> functions by calling a single function that computes both values, then picking the appropriate result.</p>
<div style="font-weight:bold"><ol class="docList" type="1"><LI><div style="font-weight:normal"><p class="docList">Write the prototype for that single function, with the name <tt>sincos</tt>, taking one argument of type <tt>double</tt> and returning the two <tt>double</tt> values in a <tt>tuple</tt> object.</p></div></LI><LI><div style="font-weight:normal"><p class="docList">Write a function named <tt>split</tt> that takes one argument of type <tt>double</tt> and two arguments of type <tt>double&amp;</tt>, calls <tt>sincos</tt>, and copies the two result values into its two reference arguments, without using any <tt>tuple</tt> variables.</p></div></LI><LI><div style="font-weight:normal"><p class="docList">Assume that the function <tt>sincos</tt> has three overloaded versions, one taking an argument of type <tt>float</tt> and returning values of type <tt>float</tt>, one taking an argument of type <tt>double</tt> and returning values of type <tt>double</tt>, and one taking an argument of type <tt>long double</tt> and returning values of type <tt>long double</tt>. Rewrite the function <tt>split</tt> as a template that calls the appropriate version of <tt>sincos</tt>, depending on the type of its arguments.</p></div></li></ol></div>
</td></tr></table></P>

<a name="ch01lev2sec14"></a>
<h4 id="title-IDAHCFK" class="docSection2Title">Exercise 8</h4>
<P><table border="0" cellspacing="16" cellpadding="0"><TR valign="top"><TD align="right" class="docText" width="50"><a name="ch01qa8q1"></a><b></b></td><TD><p class="docText">Suppose that we want to calculate the distance from the origin to a point in one-, two-, or three-dimensional space, with the location of the point held in an appropriately sized <tt>tuple</tt> object.</p>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList">Write a function named <tt>distance1</tt><sup class="docFootnote"><a class="docLink" href="#ch01fn5">[5]</a></sup> that takes an object of type <tt>tuple&lt;double&gt;</tt> and returns the distance from the origin to the point in one-dimensional space.</p><blockquote><p class="docFootnote"><sup><a name="ch01fn5">[5]</a></sup> This function could be called <tt>distance</tt> and suitably overloaded, but that would get confusing when we start talking about a template with that name later on.</p></blockquote></div></li><li><div style="font-weight:normal"><p class="docList">Write a function named <tt>distance2</tt> that takes an object of type <tt>tuple &lt;double, double&gt;</tt> and returns the distance from the origin to the point in two-dimensional space.</p></div></li><li><div style="font-weight:normal"><p class="docList">Write a function named <tt>distance3</tt> that takes an object of type <tt>tuple&lt;double, double, double&gt;</tt> and returns the distance from the origin to the point in three-dimensional space.</p></div></li><li><div style="font-weight:normal"><p class="docList">Test the three distance functions with the following values:</P><div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList"><tt>make_tuple(1.0)</tt></P></div></li><li><div style="font-weight:normal"><p class="docList"><tt>make_tuple(3.0, 4.0)</tt></p></div></LI><LI><div style="font-weight:normal"><p class="docList"><tt>make_tuple(3.5, 4.5, 5.5)</tt></p></div></LI></ol></div></div></li><LI><div style="font-weight:normal"><p class="docList">What happens if you call any of the distance functions with a <tt>tuple</tt> object that holds no elements?</P></div></LI></ol></div>
</TD></tr></table></P>

<a name="ch01lev2sec15"></a>
<h4 id="title-IDAJFFK" class="docSection2Title">Exercise 9</H4>
<P><table border="0" cellspacing="16" cellpadding="0"><tr valign="top"><TD align="right" class="docText" width="50"><a name="ch01qa9q1"></a><B></b></td><td><p class="docText">Obviously, writing a separate function for each size <tt>tuple</tt> object will get pretty tedious. Since the code is so repetitive, there ought to be a way to write a single set of function templates that can calculate the distance from the origin to a point in <span class="docEmphasis">n</span>-dimensional space, given a representation of the location of that point as a <tt>tuple</tt> object with <span class="docEmphasis">n</span> elements. With a little template metaprogramming, the solution is fairly simple, although getting to it can be confusing.</p>
<p class="docText">We'll need a function template named <tt>distance</tt> that takes an arbitrary type <tt>T</tt>. If we assume that <tt>T</tt> is a specialization of <tt>tuple</tt>, we know from the previous exercises that we need to compute the sum of the squares of the elements of <tt>T</tt> and take the square root of that sum. We'll do that with a helper that calculates the sum of the squares of the elements of a <tt>tuple</tt> object; <tt>distance</tt> returns the square root of the value returned by that helper.</p>
<p class="docText">Let's look at implementing that helper. Here's where things start to get tricky. If the <tt>tuple</tt> that we're processing has one element, it's easy: The sum of the squares of the elements is simply the square of that one element. If our <tt>tuple</tt> has more than one element, the sum of the squares of its elements is the square of its first element plus the sum of the squares of the rest of its elements. This is a typical formulation for a problem that can be solved by recursion: We have a termination rule that handles the simplest case and a recursion rule that handles complex cases in terms of simpler ones. As long as each recursion results in a simpler case, we eventually bottom out at the termination case and can combine the intermediate results to get the answer. So our helper has to handle two cases: one in which we have only one element and the other in which we have more than one element. We can find out how many elements a <tt>tuple</tt> type has with the template <tt>tuple_size</tt>, and we can pick off individual elements with <tt>get</tt>. But there's a problem here: The index that we pass to <tt>get</tt> has to be a compile-time constant. Because of the limitations of template arguments to function templates, our helper has to be a class template, not a function template.</P>
<div style="font-weight:bold"><ol class="docList" type="1"><li><div style="font-weight:normal"><p class="docList">Write a declaration for the class template <tt>distance_helper</tt>. The template should take two template arguments: a value <tt>elt</tt> of type <tt>size_t</tt> and a class type <tt>T</tt>. Don't give it a body.</p></div></LI><LI><div style="font-weight:normal"><p class="docList">Write a partial specialization of <tt>distance_helper</tt> whose <tt>size_t</tt> argument is 0; it should still take an arbitrary type <tt>T</tt>. The specialization should have a static member function named <tt>eval</tt> that takes an argument of type <tt>const T&amp;</tt>, assumes that <tt>T</tt> is a <tt>tuple</tt> type, and returns the square of the element at index 0 of <tt>T</tt>. This is the termination case.</P></div></li><li><div style="font-weight:normal"><p class="docList">Write the general version of the template <tt>distance_helper</tt>. It should have a static member function named <tt>eval</tt> that takes an argument of type <tt>const T&amp;</tt>. The function returns the square of the element at <tt>elt</tt> added to the sum of the squares of the remaining <tt>elt - 1</tt> elements. Use <tt>distance_helper&lt;elt -1, T&gt;</tt> to calculate that sum. This is the recursion rule.</P></div></li><li><div style="font-weight:normal"><p class="docList">Now all that's left is to call <tt>distance_helper</tt>'s function <tt>eval</tt> from <tt>distance</tt>. Write the function <tt>distance</tt>. <span class="docEmphasis">Caution:</span> <tt>distance_helper</tt> takes the index of an element; the number of elements in a <tt>tuple</tt> object is not a valid index.</p></div></li><li><div style="font-weight:normal"><p class="docList">Test the <tt>distance</tt> function with the following values:
<div style="font-weight:bold"><ol class="docList" type="a"><li><div style="font-weight:normal"><p class="docList"><tt>make_tuple(1.0)</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><tt>make_tuple(3.0, 4.0)</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><tt>make_tuple(3.5, 4.5, 5.5)</tt></P></div></li></ol></div>
</P></div></li><li><div style="font-weight:normal"><p class="docList">What happens if you call <tt>distance</tt> with a <tt>tuple</tt> object that holds no elements?</p></div></LI></ol></div>
</TD></tr></table></P>


<a href="31031536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a></TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch01lev1sec3.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch02.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>