<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Exercises</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec5.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch07.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a name="ch06lev1sec6"></a>
<h3 id="title-IDA4EOWG" class="docSection1Title">Exercises</H3>
<a name="ch06lev2sec1"></a>
<H4 id="title-IDAHFOWG" class="docSection2Title">Exercise 1</h4>
<P><table border="0" cellspacing="16" cellpadding="0"><tr valign="top"><TD align="right" class="docText" width="50"><a name="ch06qa1q1"></a><B></b></TD><TD><p class="docText">For each of the following errors, write a simple test case containing the error, and try to compile it. In the error messages, look for the key words that relate to the error in the code.</p>
<div style="font-weight:bold"><ol class="docList" type="1"><LI><div style="font-weight:normal"><p class="docList">Specializing <tt>result_of</tt> with a type argument having a different number of types in its argument list than the callable type actually takes.</p></div></LI><LI><div style="font-weight:normal"><p class="docList">Specializing <tt>result_of</tt> with a type argument whose callable type is a class having neither a nested type named <tt>result_type</tt> nor a nested template named <tt>result</tt> and that names at least one type in its argument list.</p></div></LI></ol></div>
</TD></tr></table></p>

<a name="ch06lev2sec2"></a>
<h4 id="title-IDAXGOWG" class="docSection2Title">Exercise 2</h4>
<P><table border="0" cellspacing="16" cellpadding="0"><tr valign="top"><td align="right" class="docText" width="50"><a name="ch06qa2q1"></a><B></b></TD><TD><p class="docText">For each of these uses of <span class="docEmphasis">INVOKE</span>, write the equivalent code, give its return type, and state whether the code is valid. Use the following declarations and definitions:</p>
<div class="docText"><pre>void func(int,double,double);
int func(int,double);

struct S
  {
  void mem_fun0(int) const;
  double mem_fun1(long,int) const;
  int mem_data;
  const int cmem_data;
  };
S s0;
const S s1;
const S *ptr = new S;
shared_ptr&lt;S&gt; sp(ptr);

struct oper
  {
  bool operator()() const;
  int operator()(int,double) const;
  };
oper op;
</pre></div><br>
<div style="font-weight:bold"><ol class="docList" type="1"><LI><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(func, 1, 2, 3)</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(func, 1, 2)</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(func, 1, 2.0, double)</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(&amp;S::mem_fun0, s0, 1)</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(&amp;S::mem_fun0, s1, 1L, 2)</tt></P></div></li><LI><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(&amp;S::mem_fun1, s1, 1L, 2)</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(&amp;S::mem_fun1, ptr, 1L, 2)</tt></P></div></LI><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(&amp;S::mem_fun0, sp, 1)</tt></P></div></li><LI><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(&amp;S::mem_data, s0)</tt></P></div></LI><LI><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(&amp;S::cmem_data, s0)</tt></p></div></LI><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(&amp;S::mem_data, s1)</tt></P></div></LI><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(&amp;S::cmem_data, s1)</tt></P></div></LI><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(op)</tt></p></div></li><li><div style="font-weight:normal"><p class="docList"><span class="docEmphasis">INVOKE</span><tt>(op, 1, 1.0)</tt></P></div></li></ol></div>
</td></TR></table></P>

<a name="ch06lev2sec3"></a>
<H4 id="title-IDAYKOWG" class="docSection2Title">Exercise 3</h4>
<p><table border="0" cellspacing="16" cellpadding="0"><TR valign="top"><td align="right" class="docText" width="50"><a name="ch06qa3q1"></a><b>Q1:</b></td><td><p class="docText">Each part of this exercise has a type definition, an object of that type, and an expression that calls that object. For each of these expressions, what is the type of the result of that expression, what should <tt>result_of::type</tt> be for the types used in that expression under the compiler compromise rules, and what is the type of <tt>result_of::type</tt> using your implementation of the TR1 library? For example:</p>
<p><table cellspacing="0" FRAME="void" RULES="none" cellpadding="5"><colgroup align="left" span="2"><col width="250"><col width="250"></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Type:</p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>typedef float(*t)(float);</tt></p></TD></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText">Object:</p></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>t obj = cosf;</tt></P></td></TR><tr><TD class="docTableCell" align="left" valign="top"><p class="docText">Expression:</P></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>obj(1.0)</tt></p></TD></tr></table></P><BR>
<p class="docText">The return type of <tt>obj(1.0)</tt> is <tt>float</tt>, the type of <tt>result_of::type</tt> is supposed to be <tt>float</tt>, and with the Dinkumware implementation of the TR1 library, the type of <tt>result_of::type</tt> is <tt>float</tt>. (Some of the exercises are a little more difficult than this.)</p>
<p class="docText">The exercises use the following definitions:</P>
<div class="docText"><pre><span class="docEmphasis">// types</span>
struct S
{
void f();
int m;
double d;
};
struct S1
{
bool operator()() const;
};

struct S2
{
bool operator()() const;
typedef bool result_type;
};

struct S3
{
bool operator()() const;
int operator()(int) const;
};

struct S4
{
bool operator()() const;
int operator()(int) const;
typedef bool result_type;
};

<span class="docEmphasis">// objects</span>
S s;
const S cs;
S1 s1;
S2 s2;
S3 s3;
S4 s4;
</pre></div><BR>
<p><table cellspacing="0" FRAME="void" RULES="none" cellpadding="5"><colgroup align="left" span="3"><col width="75"><col width="175"><col width="250"></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText">1.</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Type:</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>typedef void(S::*t0)();</tt></P></td></tr><TR><td class="docTableCell" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top"><p class="docText">Object:</p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>t0 obj0 = &amp;S::f;</tt></p></td></tr><tr><td class="docTableCell" align="left" valign="top">&nbsp;</td><TD class="docTableCell" align="left" valign="top"><p class="docText">Expression:</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>(s.*obj0)()</tt></p></td></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText">2.</P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Type:</P></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>typedef int S::*t1;</tt></p></TD></tr><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</td><TD class="docTableCell" align="left" valign="top"><p class="docText">Object:</P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>t1 obj1 = &amp;S::m;</tt></p></td></TR><tr><td class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Expression:</P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>s.*obj1</tt></P></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">3.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Type:</p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>typedef double S::*t2;</tt></p></td></TR><tr><TD class="docTableCell" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top"><p class="docText">Object:</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>t2 obj2 = &amp;S::d;</tt></p></TD></tr><TR><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Expression:</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>cs.*obj2</tt></P></TD></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText">4.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Type:</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>S1</tt></p></TD></TR><TR><td class="docTableCell" align="left" valign="top">&nbsp;</td><TD class="docTableCell" align="left" valign="top"><p class="docText">Object:</p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>S1 obj3;</tt></p></td></tr><tr><td class="docTableCell" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top"><p class="docText">Expression:</p></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>obj3()</tt></p></TD></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">5.</P></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Type:</P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>S2</tt></P></TD></TR><tr><TD class="docTableCell" align="left" valign="top">&nbsp;</td><TD class="docTableCell" align="left" valign="top"><p class="docText">Object:</P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>S2 obj4;</tt></P></td></tr><tr><td class="docTableCell" align="left" valign="top">&nbsp;</TD><td class="docTableCell" align="left" valign="top"><p class="docText">Expression:</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>obj4()</tt></P></td></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText">6.</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Type:</p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>S3</tt></p></td></tr><tr><td class="docTableCell" align="left" valign="top">&nbsp;</TD><td class="docTableCell" align="left" valign="top"><p class="docText">Object:</P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>S3 obj5;</tt></p></TD></TR><tr><TD class="docTableCell" align="left" valign="top">&nbsp;</td><TD class="docTableCell" align="left" valign="top"><p class="docText">Expression:</P></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>obj5(1)</tt></p></TD></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText">7.</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Type:</p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>S4</tt></p></TD></tr><tr><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Object:</p></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>S4 obj6;</tt></p></td></tr><tr><td class="docTableCell" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top"><p class="docText">Expression:</p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>obj6(1)</tt></p></td></TR></table></p><BR>
</td></tr></table></p>


</TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec5.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch07.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>