<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 12.2.&nbsp; Representing Floating-Point Values</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch12lev1sec1.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch12lev1sec3.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a href="31031536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a><a name="ch12lev1sec2"></a>
<h3 id="title-IDAAHLQF" class="docSection1Title">12.2. Representing Floating-Point Values</H3>
<p class="docText">Floating-point math is tricky, and most programmers don't understand it well enough to use it correctly. Since I'm in that group, I'm not going to write <a name="iddle1208"></a><a name="iddle1245"></a><a name="iddle1293"></a><a name="iddle1294"></a><a name="iddle1493"></a><a name="iddle1711"></a>about how to get accurate results from complex computations.<sup class="docFootnote"><a class="docLink" href="#ch12fn4">[4]</a></sup></P><blockquote><p class="docFootnote"><sup><a name="ch12fn4">[4]</a></sup> People get PhDs in how to do floating-point math accurately. A little closer to home, P.J. Plauger and Chris Walker, both also at Dinkumware, have burned thousands of hours of computer time refining the Dinkumware implementation of the TR1 Math Special Functions (<a class="docLink" href="ch12lev1sec8.html#ch12lev1sec8">Section 12.8</a>), producing results that are far more accurate than any other implementation of these functions that we know of.</p></blockquote>
<a name="ch12lev2sec1"></a>
<H4 id="title-IDA5ILQF" class="docSection2Title">12.2.1. The Floating-Point Model</h4>
<p class="docText">The C99 standard uses an abstract model to describe the representation of floating-point values. A floating-point value <tt>x</tt> is represented as:</P>


<p class="docText">
<img border="0" alt="" width="146" height="52" SRC="images/243equ01.jpg"></P>


<BR>
<p class="docText">where <span class="docEmphasis">&#946;</span> and <span class="docEmphasis">p</span> are characteristics of the floating-point representation (<tt>float</tt>, <tt>double</tt>, or <tt>long double</tt>).</P>
<ul><LI><p class="docList"><span class="docEmphasis">&#946;</span> is the base of the floating-point representation. It must be an integer with a value of 2 or more. Most floating-point representations today use a base of 2, although base 10 is gaining in popularity.</p></LI><LI><p class="docList"><span class="docEmphasis">p</span> is the precision of the floating-point value, that is, the number of digits in base <span class="docEmphasis">&#946;</span> in a value's significand.</p></LI><LI><p class="docList">Each digit <span class="docEmphasis">d<sub>i</sub></span> is greater than or equal to 0 and less than <span class="docEmphasis">&#946;</span>.</p></li></ul>
<p class="docText">The values of <span class="docEmphasis">e</span> and the various <span class="docEmphasis">d <sub>i</sub></span>s are determined by the particular value being represented.</p>
<UL><li><p class="docList">The value <span class="docEmphasis">e</span> is the <span class="docEmphasis">exponent</span> that the base should be raised to.</p></LI><LI><p class="docList">The values <span class="docEmphasis">d<sub>i</sub></span> are the digits in the value's <span class="docEmphasis">significand</span>.</P></li></ul>
<p class="docText">For example, .602 x 10<sup>24</sup> represents a value in base 10 (<span class="docEmphasis">&#946;</span> = 10) having three significant digits (<span class="docEmphasis">p</span> = 3). Its digits are 6, 0, and 2 (<span class="docEmphasis">d</span><sub>1</sub> = 6, <span class="docEmphasis">d</span><sub>2</sub> = 0, and <span class="docEmphasis">d</span><sub>3</sub> = 2); its exponent is 24 (<span class="docEmphasis">e</span> = 24); and its significand is .602.</P>
<p class="docText">A floating-point value is <span class="docEmphasis">normalized</span> if its value is 0 or if <span class="docEmphasis">d <sub>1</sub></span> &gt; 0.<sup class="docFootnote"><a class="docLink" href="#ch12fn5">[5]</a></sup> So .602 x <span class="docEmphasis">10<sup>24</sup></span> is normalized, and .0602 x 10<sup>25</sup>, even though it represents the same value, is not. A floating-point value is <span class="docEmphasis">denormalized</span> if its value is not 0 and <span class="docEmphasis">d</span><sub>1</sub> = 0.</p><blockquote><p class="docFootnote"><sup><a name="ch12fn5">[5]</a></sup> Thus, in a normalized representation, the value of the significand of a nonzero number is always greater than or equal to 1<span class="docEmphasis">/</span><span class="docEmphasis">&#946;</span> and less than 1.</p></blockquote>

<a name="ch12lev2sec2"></a>

<h4 id="title-IDA0NLQF" class="docSection2Title">12.2.2. Properties of Floating-Point Types</h4>
<p class="docText">C and C++ provide three floating-point types<tt>float</tt>, <tt>double</tt>, and <tt>long double</tt>distinguished by the range of values that the type can represent. Sometimes it's important to know the limits on these ranges. You can find these limits in two ways: In C and C++, you can use the macros defined in the header <tt>&lt;float.h&gt;</tt><sup class="docFootnote"><a class="docLink" href="#ch12fn6">[6]</a></sup> (as well as <tt>&lt;cfloat&gt;</tt> in C++); in C++, you can also use the <tt>numeric_limits</tt> template defined in the header <tt>&lt;limits&gt;</tt>. <a class="docLink" href="#ch12table01">Table 12.1</a> lists the macros and <tt>numeric_limits</tt> members that describe the fundamental properties of the type <tt>double</tt>.<sup class="docFootnote"><a class="docLink" href="#ch12fn7">[7]</a></sup> The resulting values are all compile-time constants.</p><blockquote><p class="docFootnote"><sup><a name="ch12fn6">[6]</a></sup> The full contents of this header are presented in <a class="docLink" href="app01.html#app01">Appendix A</a>, in <a class="docLink" href="app01lev1sec4.html#app01lev1sec4">Section A.4</a>.</p></blockquote><blockquote><p class="docFootnote"><sup><a name="ch12fn7">[7]</a></sup> Similar macros, with names that begin with <tt>FLT</tt> and <tt>LDBL</tt> instead of <tt>DBL</tt>, describe the properties of the types <tt>float</tt> and <tt>long double</tt>, respectively. The members of the template specializations <tt>numeric_limits&lt;float&gt;</tt> and <tt>numeric_limits&lt;long double&gt;</tt> describe <tt>float</tt> and <tt>long double</tt>.</p></blockquote>
<a name="ch12table01"></a><p><table cellspacing="0" class="allBorders" border="1" RULES="groups" cellpadding="5"><caption><h5 class="docTableTitle">Table 12.1. Fundamental Floating-Point Properties</h5></caption><colgroup align="left" span="3"><col width="150"><col width="150"><col width="200"></colgroup><thead><tr><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">&lt;float.h&gt;</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">numeric_limits &lt;double&gt;</P></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">Definition</p></th></TR></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>FLT_RADIX</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>radix</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">&#946;</span>, the base of the floating-point representation</P></TD></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>DBL_MANT_DIG</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>digits</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">p</span>, the number of digits in the significand</P></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>DBL_MIN_EXP</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>min_exponent</tt></P></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">e</span><sub>min</sub>, the minimum value of <span class="docEmphasis">e</span> such that <span class="docEmphasis">&#946;</span><span class="docEmphasis"><sup>e-1</sup></span> is normalized and nonzero</p></td></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>DBL_MAX_EXP</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>max_exponent</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">e</span><sub>max</sub>, the maximum value of <span class="docEmphasis">e</span> such that <span class="docEmphasis">&#946;</span><span class="docEmphasis"><sup>e-1</sup></span> is representable</p></td></tr></table></p><BR>
<p class="docText">The four values in <a class="docLink" href="#ch12table01">Table 12.1</a> completely describe the numbers that can be represented as normalized values. However, since most uses of floating-point math involve decimal values, it's convenient to have decimal approximations<sup class="docFootnote"><a class="docLink" href="#ch12fn8">[8]</a></sup> of the precision and minimum and maximum exponents. The code for these properties is in <a class="docLink" href="#ch12table02">Table 12.2</a>. These values, too, are all compile-time constants.</p><blockquote><p class="docFootnote"><sup><a name="ch12fn8">[8]</a></sup> Which are, of course, exact when the base of the representation is 10.</P></blockquote>

<p class="docText"></p><a name="ch12table02"></a><p><table cellspacing="0" class="allBorders" border="1" RULES="groups" cellpadding="5"><caption><h5 class="docTableTitle">Table 12.2. Decimal-valued Floating-Point Properties</H5></caption><colgroup align="left" span="3"><col width="150"><col width="150"><col width="200"></colgroup><thead><TR><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText"><a name="iddle1295"></a>&lt;float.h&gt;</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">numeric_limits &lt;double&gt;</P></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">Definition</p></th></TR></thead><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>DBL_DIG</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>digits10</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">The number of decimal digits representable in the significand: <span class="docEmphasis">p</span> log<sub>10</sub> <span class="docEmphasis">&#946;</span> if <span class="docEmphasis">&#946;</span> is a power of 10; otherwise, <img src=images/U230A.jpg border=0>(<span class="docEmphasis">p</span> - 1) log<sub>10</sub><span class="docEmphasis">&#946;</span><img src=images/U230B.jpg border=0></p></TD></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>DBL_MIN_10_EXP</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>min_exponent10</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">The minimum value of <span class="docEmphasis">y</span> such that 10<span class="docEmphasis"><sup>y</sup></span> is normalized and nonzero: <img src=images/U230A.jpg border=0>log<sub>10</sub><span class="docEmphasis">&#946;</span><span class="docEmphasis"><sup>e<sub>min</sub>-1</sup></span><img src=images/U230B.jpg border=0></P></TD></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>DBL_MAX_10_EXP</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>max_exponent10</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">The maximum value of <span class="docEmphasis">y</span> such that 10<span class="docEmphasis"><sup>y</sup></span> is representable: <img src=images/U230A.jpg border=0>log<sub>10</sub>((1 - <span class="docEmphasis">&#946;</span><span class="docEmphasis"><sup>-p</sup></span>)<span class="docEmphasis">&#946;</span><span class="docEmphasis"><sup>e <sub>max</sub></sup></span>)<img src=images/U230B.jpg border=0></p></td></tr></table></p><br>
<p class="docText">Three other values are important when you need to understand the results of a floating-point computation. Access to the minimum and maximum floating-point values and another way of handling precision are described in <a class="docLink" href="#ch12table03">Table 12.3</a>. The values that you get from the C macros are compile-time constants; the values from the <tt>numeric_limits</tt> template are not.</p>
<a name="ch12table03"></a><P><table cellspacing="0" class="allBorders" border="1" RULES="groups" cellpadding="5"><caption><h5 class="docTableTitle">Table 12.3. Other Floating-Point Properties</H5></caption><colgroup align="left" span="3"><col width="150"><col width="150"><col width="200"></colgroup><thead><tr><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">&lt;float.h&gt;</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">numeric_limits &lt;double&gt;</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">Definition</P></th></TR></thead><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>DBL_MIN</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>min()</tt></P></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">&#946;</span><span class="docEmphasis"><sup>e min -1</sup></span>, the minimum positive normalized value</P></td></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>DBL_MAX</tt></P></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>max()</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">(1 <span class="docEmphasis">&#946;</span><span class="docEmphasis"><sup>-p</sup></span>)<span class="docEmphasis">&#946;</span><sup><span class="docEmphasis">e</span> max</sup>, the maximum representable finite value</P></td></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>DBL_EPSILON</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>epsilon()</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><span class="docEmphasis">&#946;</span><sup>1 - <span class="docEmphasis">p</span></sup>, one less than the least representable value greater than 1</p></td></tr></table></p><br>

<a name="ch12lev2sec3"></a>

<h4 id="title-IDAI5LQF" class="docSection2Title">12.2.3. Floating-Point Types</h4>
<p class="docText">The C and C++ standards give mimimum or maximum values for several of the properties described in the previous section.<sup class="docFootnote"><a class="docLink" href="#ch12fn9">[9]</a></sup> The requirements for <tt>float</tt> result in a smaller range and less precision than the requirements for <tt>double</tt>; the requirements for <tt>long double</tt> are the same as the requirements for <tt>double</tt>, but some implementations provide a larger range and more precision. These requirements are listed in <a class="docLink" href="#ch12table04">Table 12.4</a>.</p><blockquote><p class="docFootnote"><sup><a name="ch12fn9">[9]</a></sup> Since floating-point values are written in base 10, the requirements are given for the base 10 versions of the various properties.</p></blockquote>
<a name="ch12table04"></a><p><table cellspacing="0" class="allBorders" border="1" RULES="groups" cellpadding="5"><caption><H5 class="docTableTitle">Table 12.4. Required Values for Floating-Point Properties</h5></caption><colgroup align="left" span="3"><col width="150"><col width="100"><col width="100"></colgroup><thead><TR><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">Property numeric_limits</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">float</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">double</p></th></TR></thead><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>radix</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 2</tt></P></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 2</tt>
</p></TD></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>digits10</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 6</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 10</tt>
</p></TD></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>min_exponent10</tt></P></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= -37</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= -37</tt>
</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>max_exponent10</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 37</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 37</tt>
</P></td></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>min()</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 1e-37</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 1e-37</tt>
</P></TD></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>max()</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 1e37</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>&gt;= 1e37</tt>
</P></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>epsilon()</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>&lt;= 1e-5</tt></P></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>&lt;= 1e-9</tt>
</p></td></TR></table></p><br>
<p class="docText">For an implementation that conforms to the IEC 60559 Standard <a class="docLink" href="biblio01.html#biblio0_012">[Int89]</a>, the requirements given in <a class="docLink" href="#ch12table05">Table 12.5</a><sup class="docFootnote"><a class="docLink" href="#ch12fn10">[10]</a></sup> apply. Again, the requirements for <tt>long double</tt> are the same as for <tt>double</tt>.</p><blockquote><p class="docFootnote"><sup><a name="ch12fn10">[10]</a></sup> The C99 standard gives more details.</p></blockquote>
<a name="ch12table05"></a><p><table cellspacing="0" class="allBorders" border="1" RULES="groups" cellpadding="5"><caption><h5 class="docTableTitle">Table 12.5. Floating-Point Properties for IEC 60559</h5></caption><colgroup align="left" span="3"><col width="150"><col width="150"><col width="200"></colgroup><thead><tr><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">Property numeric_limits</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">float</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">double</p></th></tr></thead><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>radix</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>2</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>2</tt>
</p></TD></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>digits</tt></P></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>24</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>53</tt>
</P></td></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>min_exponent</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-125</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-1021</tt>
</P></TD></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>max_exponent</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>128</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>1024</tt>
</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>digits10</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>6</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>15</tt>
</p></td></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>min_exponent10</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-37</tt></P></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-307</tt>
</p></TD></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>max_exponent10</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>38</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>308</tt>
</p></TD></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>min()</tt></P></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>1.17549435e-38f</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>2.2250738585072014e-308</tt>
</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>max()</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>3.40282347e38f</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>1.7976931348623157e308</tt>
</P></td></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>epsilon()</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>1.19209290e-7f</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>2.2204460492503131e-16</tt>
</P></TD></TR></table></P><br>


<a href="31031536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a></TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch12lev1sec1.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch12lev1sec3.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>