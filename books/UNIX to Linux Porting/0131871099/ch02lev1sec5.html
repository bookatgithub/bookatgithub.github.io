<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 2.5.&nbsp; Packaging</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch02lev1sec4.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch02lev1sec6.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><TD valign="top"><a name="ch02lev1sec5"></a>
<H3 id="588026-961" class="docSection1Title">2.5. <a name="iddle1908"></a>Packaging</H3>
<p class="docText">For some applications, you might need to use a <a name="iddle1905"></a>package manager to uniformly distribute and install the application on any Linux platform<a name="d0e4960"></a>. As an alternative to distributing the application on a tarball image, using a package manager to distribute and install the application on Linux has its advantages. One advantage to using a packaging manager is it allows versions of the application to be managed properly.<a name="d0e4962"></a></P>
<p class="docText">The <a name="iddle2103"></a>Red Hat Package Manager (RPM) is the most popular package manager available in Linux. It is a command-line utility used to install, uninstall, verify, query, and update software packages in Linux. Before <a name="iddle2108"></a>RPM became available, there was no easy and elegant way to manage software application installations on a Linux server<a name="d0e4978"></a>. Installation was done through compressed and tar'ed files, and the only way to find out whether an application was dependent on another package was by reading the documentation that came with it or by running the application and hoping it produced a message describing the missing component. The availability of RPM changed all this!</P>
<p class="docText">Applications packaged in RPM format made maintaining and managing software applications on a Linux machine easier. Red Hat, the originator of RPM, also became the most popular Linux distribution as a result of the release of RPM. Today, most if not all Linux distributions support RPM as the de facto package manager. It is for this reason that we recommend applications ported to Linux be packaged in an RPM format. More detailed documentations for RPM can be found at <a class="docLink" target="_blank" href="http://www.rpm.org/">www.rpm.org/</a>.</p>
<a name="ch02lev2sec11"></a>

<h4 id="title-IDABMATH" class="docSection2Title">2.5.1. <a name="iddle2110"></a>Packaging the Application with <a name="iddle1907"></a>RPM</h4>
<p class="docText">At the heart of RPM is the RPM engine. The engine requires several files as input and builds the packaged application as the output. One of the input files that RPM requires is the spec file. The spec file contains informational and instructional verbiage that will be displayed or acted on by RPM, respectively, during the package build or user installation. The spec file has the following sections:</P>
<UL><LI><p class="docText"><span class="docEmphStrong">Preamble.</span> Contains information that displays when information about the package is requested</P></LI><li><p class="docText"><span class="docEmphStrong">Prep.</span> Contains a script used by RPM to prepare for the actual build of the package</P></li><li><p class="docText"><span class="docEmphStrong">Build.</span> Contains scripts to actually build the package from source files</P></LI><li><p class="docText"><span class="docEmphStrong">Install.</span> Contains commands to install the software application when the build step completes</p></li><li><p class="docText"><span class="docEmphStrong">Install and uninstall.</span> Contains the install and uninstall scripts that are run on the user's system when he or she installs the software application through the RPM command utility</P></li><li><p class="docText"><span class="docEmphStrong">Verify.</span> Contains a script to verify the installation of a package in the user system</p></li><LI><p class="docText"><span class="docEmphStrong">Clean.</span> Contains a script to clean up after a package build</P></li><li><p class="docText"><span class="docEmphStrong">File list.</span> Contains the list of files to be packaged, file permissions when files are installed on the user system, documentation, and configuration information</p></li></ul>
<p class="docText">The sections of the spec file used during the build of the package are the prep, build, install, clean, and file list sections. The sections used by RPM when installing the package on the user system are the install and uninstall, verify, and file list sections.</p>
<p class="docText">When building a package, a package <a name="iddle1910"></a>with RPM follows these steps:</p>
<a name="ch02pro01"></a>




<table border="0" class="docText"><tr><td width="25" valign="top"><div class="docText"><b>1. </b></div></td><td><div class="docText">Create a build environment that includes the source. This is the environment where the sources will be patched if patches are available and compiled to create the binary distribution.<br><br></div></TD></tr><tr><td width="25" valign="top"><div class="docText"><B>2. </b></div></TD><TD><div class="docText">Run the installation script in the install section after the build is complete to install the binaries into the correct directory locations.<BR><BR></div></td></tr><tr><TD></TD><TD></TD></TR><tr><TD width="25" valign="top"><div class="docText"><b>3. </b></div></td><TD><div class="docText">After the binaries have been installed, create the package using the file list section. Note that RPM does not create the file list automatically. This list needs to be created manually.<a name="d0e5106"></a><BR><br></div></td></tr><tr><TD width="25" valign="top"><div class="docText"><b>4. </b></div></td><td><div class="docText">The final output of the build is the RPM distribution package.<br><BR></div></TD></tr></table>
<p class="docText">For a complete reference on how to build an RPM package, refer to the Maximum RPM documentation available at <a class="docLink" target="_blank" href="http://www.rpm.org/max-rpm-snapshot/">www.rpm.org/max-rpm-snapshot/</a>.</p>

<a name="ch02lev2sec12"></a>
<h4 id="title-IDAYRATH" class="docSection2Title">2.5.2. <a name="iddle2109"></a>Basic RPM Usage</h4>
<p class="docText">After the software application has been packaged as an RPM file, it can be tested with the command syntax described in the following sections.</p>
<a name="ch02lev3sec2"></a>
<h5 id="title-IDAOSATH" class="docSection3Title">2.5.2.1. rpm -i</h5>
<p class="docText">The command <tt><a name="iddle1150"></a><a name="iddle2112"></a>rpm i</tt> tells RPM to install a software package<a name="d0e5154"></a><a name="d0e5155"></a>. This command also performs dependency checks and pre-installation tasks, unpacks installation files from the package and places them in the proper directories, performs post-installation tasks, and creates a log of what was done.</p>

<a name="ch02lev3sec3"></a>
<h5 id="title-IDA3TATH" class="docSection3Title">2.5.2.2. <a name="iddle1149"></a><a name="iddle2111"></a>rpm e</h5>
<p class="docText">The command <tt>rpm e</tt> removes or erases one or more packages from the system. This command checks the RPM database for package dependencies, performs pre-uninstall tasks, saves modified configuration files, removes files belonging to this package, and executes post-uninstall tasks.<a name="d0e5179"></a><a name="d0e5180"></a></p>

<a name="ch02lev3sec4"></a>
<h5 id="title-IDAKVATH" class="docSection3Title">2.5.2.3. rpm -U</h5>
<p class="docText">The command <tt><a name="iddle1152"></a><a name="iddle2114"></a>rpm U</tt> upgrades an old version of the application software<a name="d0e5203"></a><a name="d0e5204"></a>. This command removes the previous version of the software and installs a new version. It is basically a combination of the <tt>rpm i</tt> and <tt>rpm e</tt> command.</p>

<a name="ch02lev3sec5"></a>
<H5 id="title-IDA3WATH" class="docSection3Title">2.5.2.4. <a name="iddle1151"></a><a name="iddle2113"></a>rpm q</h5>
<p class="docText">The command <tt>rpm q</tt> provides information about a specific software application. The information may include but is not limited to the version of a package, identifying what file belongs to what package and version of the installed package.<a name="d0e5234"></a><a name="d0e5235"></a></p>

<a name="ch02lev3sec6"></a>

<h5 id="title-IDAPYATH" class="docSection3Title">2.5.2.5. rpm -V</H5>
<p class="docText">The command <tt><a name="iddle1153"></a><a name="iddle2115"></a>rpm V</tt> verifies an installed package<a name="d0e5260"></a><a name="d0e5261"></a>. This command can verify the file attributes of files included in a package. This can give a sense of what may have changed for a particular software installation. Information verified by the <tt>rpm V</tt> command includes but is not limited to the owner, group, MD5 checksum, and size of the file. These attributes are compared to the RPM database to make sure that they match the original installation results.<a name="d0e5266"></a><a name="d0e5267"></a></P>


<a name="ch02lev2sec13"></a>
<H4 id="title-IDAL0ATH" class="docSection2Title">2.5.3. <a name="iddle1079"></a><a name="iddle1761"></a><a name="iddle1909"></a>Baseline Packaging Format as Recommended by the LSB</H4>
<p class="docText">The Linux Standard Base 1.2 specification offers a baseline RPM recommendation for Linux packages so that these packages can be installed and used in all Linux distributions. It recommends that applications packaged in the RPM format follow the specifications in the appendix section of the 1997 edition of Maximum RPM (<a class="docLink" target="_blank" href="http://www.rpm.org/max-rpm/">www.rpm.org/max-rpm/</a>) with some restrictions. You can find these restrictions on the LSB website (<a class="docLink" target="_blank" href="http://www.linuxbase.org/spec/refspecs/LSB_1.2.0/gLSB/swinstall.html#FTN.PKG-1">www.linuxbase.org/spec/refspecs/LSB_1.2.0/gLSB/swinstall.html#FTN.PKG-1</a>).<a name="d0e5300"></a><a name="d0e5301"></a><a name="d0e5302"></a></P>
<p class="docText">As a side note, another package manager available for Linux is called <a name="iddle1207"></a><a name="iddle1906"></a>DEB.<sup class="docFootnote"><a class="docLink" href="#ch02fn18">[18]</a></sup>,<sup class="docFootnote"><a class="docLink" href="#ch02fn19">[19]</a></sup> DEB is similar to RPM in almost all respects when it comes to packaging features<a name="d0e5329"></a><a name="d0e5330"></a>. The main difference between DEB and RPM is the package format. Although RPM packages are most commonly used to package Linux applications for installation on almost all Linux platforms, DEB packages are used to package products for installation on the Debian distribution of Linux.<sup class="docFootnote"><a class="docLink" href="#ch02fn20">[20]</a></sup> RPM packages can still be installed on Debian Linux, but only after they are converted from an RPM format to a DEB format. A tool that can convert RPM packages to DEB packages and vice versa is <tt>alien</tt>.<sup class="docFootnote"><a class="docLink" href="#ch02fn21">[21]</a></sup></p><blockquote><p class="docFootnote"><sup><a name="ch02fn18">[18]</a></sup> &quot;How to make Debian packages&quot;: <a class="docLink" target="_blank" href="http://linuxdevices.com/articles/AT8047723203.html">http://linuxdevices.com/articles/AT8047723203.html</a></p></blockquote><blockquote><p class="docFootnote"><sup><a name="ch02fn19">[19]</a></sup> &quot;Debian packages&quot;: <a class="docLink" target="_blank" href="http://www.tldp.org/HOWTO/Debian-Binary-Package-Building-HOWTO/">www.tldp.org/HOWTO/Debian-Binary-Package-Building-HOWTO/</a></p></blockquote><blockquote><p class="docFootnote"><sup><a name="ch02fn20">[20]</a></sup> And other Debian variants, such as Lindows</P></blockquote><blockquote><p class="docFootnote"><sup><a name="ch02fn21">[21]</a></sup> See Linux man pages alien(1).</P></blockquote>


</TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch02lev1sec4.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch02lev1sec6.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>