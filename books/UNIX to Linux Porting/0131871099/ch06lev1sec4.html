<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 6.4.&nbsp; Linker</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec3.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec5.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><td valign="top"><a href="9001536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a><a name="ch06lev1sec4"></a>
<H3 id="title-IDAMUOQ1" class="docSection1Title">6.4. <a name="iddle1526"></a>Linker<sup class="docFootnote"><a class="docLink" href="#ch06fn21">[21]</a></sup></h3><blockquote><p class="docFootnote"><sup><a name="ch06fn21">[21]</a></sup> Refer to <a class="docLink" target="_blank" href="http://people.redhat.com/drepper/dsohowto.pdf">http://people.redhat.com/drepper/dsohowto.pdf</a> for a good reference on writing shared libraries in Linux.</P></blockquote>
<p class="docText">Both <a name="iddle1734"></a>HP-UX and GNU compilers support sending options directly to the linker. This is done by using <tt>-Wl,</tt><span class="docEmphasis"><tt>option</tt></span>, which can appear as many times as needed on the command line. Although some command-line switches for HP-UX and GNU <tt>ld</tt> are similar, it is recommended that linker command-line arguments be inspected thoroughly as to their intended purpose.<sup class="docFootnote"><a class="docLink" href="#ch06fn22">[22]</a></sup></p><blockquote><p class="docFootnote"><sup><a name="ch06fn22">[22]</a></sup> Refer to GNU <tt>ld</tt> documentation at <a class="docLink" target="_blank" href="http://www.gnu.org/software/binutils/manual/ld-2.9.1/ld.html">www.gnu.org/software/binutils/manual/ld-2.9.1/ld.html</a>.</p></blockquote>
<p class="docText"><a class="docLink" href="#ch06table08">Table 6-8</a> compares some HP-UX and GNU <tt>ld</tt> linker options.<a name="d0e63692"></a></p>
<a name="ch06table08"></a><p><table cellspacing="0" FRAME="hsides" RULES="groups" cellpadding="5"><caption><H5 class="docTableTitle">Table 6-8. HP-UX and Linux Linker Options Comparison Table</H5></caption><colgroup align="left" span="3"><col width="150"><col width="150"><col width="200"></colgroup><thead><TR><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">HP-UX ld Option</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">GNU ld Equivalent</P></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">Description</p></th></tr></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText">Most options starting with +.</P></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Not supported</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">HP-UX <tt>ld</tt> options that start with a +.</P></td></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText">For example, <tt>+b</tt>,</p></td><TD class="docTableCell" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>+vtype, +s</tt>.</p></td><td class="docTableCell" align="left" valign="top">&nbsp;</td><td class="docTableCell" align="left" valign="top">&nbsp;</td></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-a {archive | shared | default | archive_shared | shared_archive}</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-a {archive | shared | default} -Bdynamic|-dy| -call_shared -Bstatic|-dn| -non_shared|-static</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Tells the linker what type of library to link to.</p></td></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-B [immediate| restricted| symbolic]</tt></P></TD><td class="docTableCell" align="left" valign="top"><p class="docText">None</P></td><td class="docTableCell" align="left" valign="top"><p class="docText">Changes binding behavior of application to linked libraries at startup time.</p></td></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-e entry</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-e entry</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Use entry as the explicit symbol for beginning execution of your program, rather than the default entry point.</p></td></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>+e</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-E|-export-dynamic</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Exports symbols.</p>
</td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-h</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText">None<sup class="docFootnote"><a class="docLink" href="#ch06fn23">[23]</a></sup></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Hides symbols.</p></TD></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-L</tt><span class="docEmphasis"><tt>dir</tt></span></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-rpath</tt><span class="docEmphasis"> <tt>path</tt></span></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Specifies the search direction to the runtime linker.</p></td></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-L</tt><span class="docEmphasis"><tt>dir</tt></span></P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-L</tt><span class="docEmphasis"><tt>dir</tt></span></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Augments system default search directories with directories specified with the <tt>-L</tt> flag.</p></td></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-l:</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">None</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">In HP-UX, specifies the full base-name of the library to link with. For example, <tt>-l:libfoo.a</tt>.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-r</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-r</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Generates relocatable output (that is, generates an output file that can in turn serve as input to <tt>ld</tt>).</p></TD></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-s</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-s</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Omits all symbol information from the output file.</P></TD></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-t</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-t</tt></P></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Prints the names of the input files as ld processes them.</p></td></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-u</tt> <span class="docEmphasis"><tt>symbol</tt></span></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-u</tt> <span class="docEmphasis"><tt>symbol</tt></span></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Enters <span class="docEmphasis"><tt>symbol</tt></span> as an undefined symbol in the symbol table.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-v</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">None</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Displays verbose messages during linking.</p></td></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-V</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-V, -v</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Displays the version number for <tt>ld</tt>.</p></td></tr><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-G</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-S</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Strips all unloadable data (such as debug information).</p></TD></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-x</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>-x</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Deletes all temporary local symbols.</P></td></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-y</tt> <span class="docEmphasis"><tt>symbol</tt></span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-y</tt> <span class="docEmphasis"><tt>symbol</tt></span></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Prints the name of each linked file in which <span class="docEmphasis"><tt>symbol</tt></span> appears.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>-Z</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">None</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Allows dereferencing of null pointers (<a name="iddle1328"></a>HP-UX only).<a name="d0e64140"></a></P></td></TR></table></p><br><blockquote><p class="docFootnote"><sup><a name="ch06fn23">[23]</a></sup> Use the export maps through the <tt>-version-script</tt> option in GNU <tt>ld</tt>.</p></blockquote>
<p class="docText">Refer to <a class="docLink" href="ch03.html#ch03">Chapter 3</a> for information on library versioning available on Linux.</p>
<a name="ch06lev2sec17"></a>
<H4 id="title-IDAKGPQ1" class="docSection2Title">6.4.1. Export Map</H4>
<p class="docText"><a name="iddle1527"></a>Export maps enable users to tell the linker explicitly which symbols to export from the generated object<a name="d0e64171"></a>. The GNU linker supports export maps. To generate a shared object with this method, the user has to pass the name of the map file with the <tt>-version-script</tt> option of the linker:</P>
<div class="docText"><pre>$ gcc -shared -o bar.so bar.c -fPIC -Wl,--version-script=bar.map
</pre></div><br>
<p class="docText">The file bar.map can contain text such as this:</P>
<div class="docText"><pre>{
      global: index;
      local: *;
};
</pre></div><br>
<p class="docText"><a class="docLink" href="ch03.html#ch03">Chapter 3</a> has more information on using export maps on Linux.<a name="d0e64199"></a></p>

<a name="ch06lev2sec18"></a>
<h4 id="title-IDASIPQ1" class="docSection2Title">6.4.2. <a name="iddle1528"></a><a name="iddle2484"></a>Linker Tools</h4>
<p class="docText">Some application makefiles make use of linker tools that are present in <a name="iddle1731"></a>HP-UX<a name="d0e64231"></a>. These tools are used to examine object files and manipulate them to create the final object file or executable on HP-UX. <a class="docLink" href="#ch06table09">Table 6-9</a> compares other HP-UX linker tools and their equivalents on Linux.<a name="d0e64237"></a><a name="d0e64238"></a></P>
<a name="ch06table09"></a><P><table cellspacing="0" FRAME="hsides" RULES="groups" cellpadding="5"><caption><h5 class="docTableTitle">Table 6-9. HP-UX and Linux Linker Tools Comparison Table</h5></caption><colgroup align="left" span="3"><col width="100"><col width="100"><col width="300"></colgroup><thead><tr><th class="bottomBorder thead" scope="col" align="left" valign="bottom"><p class="docText">HP-UX Tool</p></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">Linux Equivalent</P></th><th class="bottomBorder thead" scope="col" align="left" valign="bottom"><p class="docText">Description</p></th></tr></thead><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>chatr</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">None</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Displays or modifies the internal attributes of an object file.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>elfdump</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>objdump</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Displays the contents of an ELF object file.</p></td></TR><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>fastbind</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">None</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Improves startup time of programs that use shared libraries.</P></TD></TR><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>ldd</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>ldd</tt></p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText">Lists dynamic dependencies of executable files and shared libraries.</p></td></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>lorder</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">None</P></td><td class="docTableCell" align="left" valign="top"><p class="docText">Finds ordering relationship for an object library.</P></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>nm</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>nm</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Displays the symbol table of an object file.</p></td></tr><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>odump</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>objdump</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Displays the contents of a 32-bit native code object file (HP-UX).</p></td></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>size</tt></P></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>size</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText">Prints sizes of object file elements.</p></td></TR><TR><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>strip</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>strip</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText">Strips symbol and debugging information from an object file, executable, or archive library.</p></TD></tr></table></p><BR>
<p class="docText">See <a class="docLink" href="ch02.html#ch02">Chapter 2</a> for more information on the GNU binutils.</p>


<a href="9001536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a></TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec3.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec5.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>