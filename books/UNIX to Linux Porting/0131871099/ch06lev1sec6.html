<html>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<head>
<title>Section 6.6.&nbsp; Dynamic Linking and Shared Libraries</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec5.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec7.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
<br><table width="100%" border="0" cellspacing="0" cellpadding="0"><TR><td valign="top"><a href="9001536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a><a name="ch06lev1sec6"></a>
<H3 id="title-IDAHNW5EB" class="docSection1Title">6.6. <a name="iddle1239"></a><a name="iddle1504"></a>Dynamic Linking and <a name="iddle1542"></a><a name="iddle1710"></a>Shared Libraries</h3>
<p class="docText"><a name="iddle2146"></a>HP-UX applications that use dynamic linking functions such as <tt>shl_load, shl_finsym</tt>, and others need to be ported to use Linux dynamic link functions that begin with <tt>dl</tt><a name="d0e64653"></a>. HP-UX applications that already use the <tt>dl*</tt> functions need to be checked for proper API use because some <tt>dl</tt> functions that HP-UX supports are not supported on Linux.<a name="d0e64661"></a><a name="d0e64662"></a><a name="d0e64663"></a></P>
<p class="docText"><a class="docLink" href="#ch06table10">Table 6-10</a> shows the HP-UX <tt>dl*</tt> function equivalents to HP-UX <tt>shl_*</tt> calls as well as other <tt>dl*</tt> calls present in HP-UX only.</p>
<a name="ch06table10"></a><p><table cellspacing="0" FRAME="hsides" RULES="groups" cellpadding="5"><caption><h5 class="docTableTitle">Table 6-10. Dynamic Loading Library Functions Comparison Table</h5></caption><colgroup align="left" span="3"><col width="100"><col width="200"><col width="200"></colgroup><thead><TR><th class="bottomBorder thead" scope="col" align="left" valign="bottom"><p class="docText">Routines</P></th><th class="bottomBorder thead" scope="col" align="left" valign="top"><p class="docText">dl* Routines Present in HP-UX and Linux</P></th><th class="bottomBorder thead" scope="col" align="left" valign="bottom"><p class="docText">Description</p></th></TR></thead><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>shl_load</tt> and <tt>cxxshl_load</tt></p></td><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>dlopen</tt> HP-UX mode: <tt>RTLD_LAZY, RTLD_NOW, RTLD_GLOBAL, RTLD_LOCAL, RTLD_GROUP, RTLD_WORLD, RTLD_PARENT</tt> Linux flags: <tt>RTLD_LAZY, RTLD_NOW, RTLD_GLOBAL, RTLD_LOCAL, RTLD_NODELETE, RTLD_NOLOAD, RTLD_BINDING_MASK, RTLD_DEEPBIND</tt></P></td><td class="docTableCell" align="left" valign="top"><p class="docText">Loads a shared library.</p></td></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>shl_findsym</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>dlsym</tt> HP-UX handle: <tt>RTLD_DEFAULT, RTLD_NEXT, RTLD_SELF</tt> Linux handle: <tt>RTLD_DEFAULT, RTLD_NEXT</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Finds the address of a global symbol in a shared library.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>shd_get</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>dlget</tt> (HP-UX only)</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Gets information about currently loaded library.</p></TD></tr><tr><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>shl_gethandle</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>dlmodinfo</tt> (HP-UX only)</P></td><td class="docTableCell" align="left" valign="top"><p class="docText">Gets descriptor information about a loaded shared library.</p></td></TR><TR><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>shl_definesym</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">No equivalent</p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Adds a new symbol to the global shared library symbol table.</P></TD></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>shl_getsymbols</tt></p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">No equivalent</p></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Returns a list of symbols in a shared library.</p></td></TR><tr><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>shl_unload</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>dlclose</tt></p></td><td class="docTableCell" align="left" valign="top"><p class="docText">Unloads the shared library.</p></td></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">None</P></td><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>dlerror</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Returns a pointer to information about the last <tt>dlopen, dlsym</tt>, or <tt>dlclose</tt> error.
</p></TD></tr><tr><td class="docTableCell" align="left" valign="top"><p class="docText">None</p></TD><TD class="docTableCell" align="left" valign="top"><p class="docText"><tt>dladdr</tt> HP-UX <tt>DI_info</tt> structure: <tt>const char *dli_fname; void *dli_fbase; const char *dli_sname; void *dli_saddr; size_t dli_size; int dli_bind; int dli_type;</tt></P></td><TD class="docTableCell" align="left" valign="top"><p class="docText">Translates address to symbolic information.</p></td></tr><tr><TD class="docTableCell" align="left" valign="top">&nbsp;</TD><td class="docTableCell" align="left" valign="top"><p class="docText">Linux <tt>DI_info</tt> structure: <tt>const char *dli_fname; void *dli_fbase; const char *dli_sname; void *dli_saddr; size_t dli_size;</tt></p></td><td class="docTableCell" align="left" valign="top">&nbsp;</TD></tr><tr><td class="docTableCell" align="left" valign="top">&nbsp;</TD><td class="docTableCell" align="left" valign="top"><p class="docText"><tt>dlgetname</tt> (HP-UX only)</p></TD><td class="docTableCell" align="left" valign="top"><p class="docText">Retrieves the name of a loaded module given a load model descriptor.</p></td></tr></table></p><br>
<p class="docText">In Linux, a program that uses <a name="iddle1240"></a><a name="iddle1505"></a>dynamic linking is linked with the <tt>libld.so</tt> library, <tt>-ldl</tt><a name="d0e64947"></a><a name="d0e64948"></a>. The libraries it loads do not need to be linked in during the build process. <a class="docLink" href="ch03.html#ch03">Chapter 3</a> contains example code that compiles on Linux using <tt>dl*</tt> routines.</p>
<a name="ch06lev2sec21"></a>
<h4 id="title-IDA00W5EB" class="docSection2Title">6.6.1. <a name="iddle1456"></a>GNU <a name="iddle1727"></a>libtool</h4>
<p class="docText">If portability is important to your program, you should consider using GNU <tt>libtool</tt> to build and install libraries. <tt>libtool</tt> masks the complexity of using <a name="iddle1543"></a><a name="iddle2147"></a>shared libraries with a consistent, portable interface<a name="d0e64995"></a>.<a name="d0e64997"></a> For more information, visit <a class="docLink" target="_blank" href="http://www.gnu.org/software/libtool/libtool.html">www.gnu.org/software/libtool/libtool.html</a>.<a name="d0e65002"></a><a name="d0e65003"></a></p>


<a href="9001536.html"><img src="images/pixel.jpg" alt="" width="1" height="1" border="0"></a></TD></TR></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tr><td><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec5.html><img src="images/prev.gif" width="60" height="17" border="0" align="absmiddle" alt="Previous Page"></a>
<td align="right"><div STYLE="MARGIN-LEFT: 0.15in;">
<a href=ch06lev1sec7.html><img src="images/next.gif" width="60" height="17" border="0" align="absmiddle" alt="Next Page"></a>
</div></td></tr></table>
</body></html>