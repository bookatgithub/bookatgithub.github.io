<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Exercises</title>
<link rel="STYLESHEET" type="text/css" href="images/style.css">
<link rel="STYLESHEET" type="text/css" href="images/docsafari.css">
</head>
<body >
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="databaseid-CHP-5-SECT-10.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="databaseid-CHP-6.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><a name="databaseid-CHP-5-SECT-11"></a>
<h3 class="docSection1Title" >Exercises</h3>
<a name="databaseid-CHP-5-SECT-11.1"></a>
<h4 class="docSection2Title"></h4>
<a name="databaseid-CHP-5-SECT-11.1.1"></a>
<h5 class="docSection3Title">Exercise 5-1.</h5>
<p class="docText">From a relational perspective, what's wrong (if anything) with the following SQL expressions?</p>
<pre>
  a. SELECT * FROM S, SP
  b. SELECT S.SNO, S.CITY FROM S
  c. SELECT SP.SNO, SP.PNO, 2 * SP.QTY FROM SP
  d. SELECT P.PNO FROM P
  e. SELECT S.SNO FROM S, SP
  f. SELECT S.SNO FROM S ORDER BY S.CITY DESC
</pre><br>


<a name="databaseid-CHP-5-SECT-11.1.2"></a>
<h5 class="docSection3Title">Exercise 5-2.</h5>
<p class="docText">Closure is important in the relational model for the same kind of reason that numeric closure<a name="IDX-CHP-5-0451"></a> is important in ordinary arithmetic. In arithmetic, however, there's one situation where the closure property breaks down, in a sense—namely, division by zero. Is there any analogous situation in the relational algebra?</p>

<a name="databaseid-CHP-5-SECT-11.1.3"></a>
<H5 class="docSection3Title">Exercise 5-3.</h5>
<p class="docText">Given the usual suppliers-and-parts database, what's the value of the expression JOIN{S,SP,P}? What's the corresponding predicate? <span class="docEmphasis">Warning:</span> There's a trap here; in fact, some might even argue that the trap is such that it makes join (as I've defined it in the body of this chapter) a rather dangerous operation. What do you think of that argument?</p>

<a name="databaseid-CHP-5-SECT-11.1.4"></a>
<h5 class="docSection3Title">Exercise 5-4.</h5>
<p class="docText">Why do you think the project operator is so called?</P>

<a name="databaseid-CHP-5-SECT-11.1.5"></a>
<H5 class="docSection3Title">Exercise 5-5.</h5>
<p class="docText">Given our usual sample values for the suppliers-and-parts database, what values do the following expressions denote? In each case, give an informal interpretation of the expression in natural language.</P>
<pre>
  a. S SEMIJOIN ( SP WHERE PNO = PNO('P2') )
  b. P NOT MATCHING ( SP WHERE SNO = SNO('S2') )
  c. S { CITY } MINUS P { CITY }
  d. ( S { SNO, CITY } JOIN P { PNO, CITY } ) { ALL BUT CITY }
  e. JOIN { ( S RENAME ( CITY AS SC ) ) { SC } ,
        ( P RENAME ( CITY AS PC ) ) { PC } }
</pre><BR>


<a name="databaseid-CHP-5-SECT-11.1.6"></a>
<H5 class="docSection3Title">Exercise 5-6.</h5>
<p class="docText">Union, intersection, product, and join are all both commutative and associative. Verify these claims. Also verify that semijoin is associative but not commutative.</P>

<a name="databaseid-CHP-5-SECT-11.1.7"></a>
<H5 class="docSection3Title">Exercise 5-7.</H5>
<p class="docText">In what circumstances (if any) are <span class="docEmphasis">r</span> SEMIJOIN <span class="docEmphasis">s</span> and <span class="docEmphasis">s</span> SEMIJOIN <span class="docEmphasis">r</span> equivalent?</P>

<a name="databaseid-CHP-5-SECT-11.1.8"></a>
<H5 class="docSection3Title">Exercise 5-8.</H5>
<p class="docText">Which of the algebraic operators (if any) have a definition that doesn't rely on tuple equality<a name="IDX-CHP-5-0452"></a>?</p>

<a name="databaseid-CHP-5-SECT-11.1.9"></a>
<h5 class="docSection3Title">Exercise 5-9.</H5>
<p class="docText">The SQL FROM clause FROM <span class="docEmphasis">t1, t2, . . . , tn</span> (where each <span class="docEmphasis">ti</span> is an expression denoting a table) returns the cartesian product of its arguments. But what if <span class="docEmphasis">n</span> = 1? What's the cartesian product of just one table? And by the way, what's the product of <span class="docEmphasis">t1</span> and <span class="docEmphasis">t2</span> if <span class="docEmphasis">t1</span> and <span class="docEmphasis">t2</span> both contain duplicate rows?</P>

<a name="databaseid-CHP-5-SECT-11.1.10"></a>
<h5 class="docSection3Title">Exercise 5-10.</h5>
<p class="docText">Show that rename isn't primitive.</p>

<a name="databaseid-CHP-5-SECT-11.1.11"></a>
<h5 class="docSection3Title">Exercise 5-11.</H5>
<p class="docText">Distinguish between a "summary" and an aggregate operator. What do the SQL analogs of these constructs look like?</p>

<a name="databaseid-CHP-5-SECT-11.1.12"></a>
<H5 class="docSection3Title">Exercise 5-12.</h5>
<p class="docText">Give an expression involving EXTEND instead of SUMMARIZE that's logically equivalent to the following:</P>
<pre>
  SUMMARIZE SP PER ( S { SNO } ) ADD ( COUNT ( ) AS NP )
</pre><BR>


<a name="databaseid-CHP-5-SECT-11.1.13"></a>
<H5 class="docSection3Title">Exercise 5-13.</H5>
<p class="docText">Given our usual sample values for the suppliers-and-parts database, what values do the following expressions denote? In each case, give an informal interpretation of the expression in natural language.</p>
<pre>
  a. EXTEND S ADD ( 'Supplier' AS TAG )
  b. EXTEND ( P JOIN SP ) ADD ( WEIGHT * QTY AS SHIPWT )
  c. EXTEND P ADD ( WEIGHT * 454 AS GMWT, WEIGHT * 16 AS OZWT )
  d. EXTEND S
      ADD ( COUNT ( ( SP RENAME ( SNO AS X ) ) WHERE X = SNO )
        AS NP )
  e. SUMMARIZE S BY { CITY } ADD ( AVG ( STATUS ) AS AVG_STATUS )
</pre><br>


<a name="databaseid-CHP-5-SECT-11.1.14"></a>
<h5 class="docSection3Title">Exercise 5-14.</h5>
<p class="docText">Which of the following expressions are equivalent?</p>
<pre>
  a. SUMMARIZE <span class="docEmphasis">r</span> PER ( <span class="docEmphasis">r</span> { } ) ADD ( COUNT ( ) AS CT )
  b. SUMMARIZE <span class="docEmphasis">r</span> ADD ( COUNT ( ) AS CT )
  c. SUMMARIZE <span class="docEmphasis">r</span> BY { } ADD ( COUNT ( ) AS CT )
  d. EXTEND TABLE_DEE ADD ( COUNT ( <span class="docEmphasis">r</span> ) AS CT )
</pre><br>


<a name="databaseid-CHP-5-SECT-11.1.15"></a>
<h5 class="docSection3Title">Exercise 5-15.</h5>
<p class="docText">Simplifying just slightly, an aggregate operator invocation in <span class="docEmphStrong">Tutorial D</span> takes the form:</p>
<pre>
  <span class="docEmphasis">&lt;agg op name&gt;</span> ( <span class="docEmphasis">&lt;relation exp&gt;</span> [, <span class="docEmphasis">&lt;attribute name&gt;</span> ] )
</pre><br>

<p class="docText">If the <span class="docEmphasis">&lt;agg op name&gt;</span> is COUNT, the <span class="docEmphasis">&lt;attribute name&gt;</span> is irrelevant and must be omitted; otherwise, it can be omitted if and only if the <span class="docEmphasis">&lt;relation exp&gt;</span> denotes a relation of degree one, in which case the sole attribute of the result of that <span class="docEmphasis">&lt;relation exp&gt;</span> is assumed by default. Here are a couple of examples:</p>
<pre>
  SUM ( SP WHERE SNO = SNO('S1'), QTY )
  SUM ( ( SP WHERE SNO = SNO('S1') ) { QTY } )
</pre><br>

<p class="docText">Note the difference between these two expressions: the first gives the total of <span class="docEmphasis">all</span> shipment quantities for supplier S1, and the second gives the total of all <span class="docEmphasis">distinct</span> shipment quantities for supplier S1. How does the scheme just outlined differ from its SQL counterpart?</p>

<a name="databaseid-CHP-5-SECT-11.1.16"></a>
<h5 class="docSection3Title">Exercise 5-16.</H5>
<p class="docText">In <span class="docEmphStrong">Tutorial D</span>, if the argument to an aggregate operator invocation happens to be an empty set, COUNT returns zero and so does SUM; MAX and MIN return, respectively, the lowest and the highest value of the applicable type; AND and OR return TRUE and FALSE, respectively; and AVG raises an exception (I ignore <span class="docEmphStrong">Tutorial D</span>'s other aggregate operators<a name="IDX-CHP-5-0453"></a> here deliberately). What does SQL do in these circumstances and why?</p>

<a name="databaseid-CHP-5-SECT-11.1.17"></a>
<h5 class="docSection3Title">Exercise 5-17.</h5>
<p class="docText">Let relation R4 from <a class="docLink" href="databaseid-CHP-5-SECT-5.html#databaseid-CHP-5-FIG-1">Figure 5-1</a> denote the current value of some relvar <span class="docEmphasis">R</span>. If R4 has the meaning described in <a class="docLink" href="databaseid-CHP-2.html#databaseid-CHP-2">Chapter 2</a>, give the predicate for that relvar <span class="docEmphasis">R</span>.</p>

<a name="databaseid-CHP-5-SECT-11.1.18"></a>
<H5 class="docSection3Title">Exercise 5-18.</H5>
<p class="docText">Let <span class="docEmphasis">r</span> be the relation denoted by the following expression:</p>
<pre>
  SP GROUP ( { } AS X )
</pre><BR>

<p class="docText">What does <span class="docEmphasis">r</span> look like, given our usual sample value for SP? Also, what does the following expression yield?</P>
<pre>
  <span class="docEmphasis">r</span> UNGROUP ( X )
</pre><BR>


<a name="databaseid-CHP-5-SECT-11.1.19"></a>
<h5 class="docSection3Title">Exercise 5-19.</H5>
<a name="IDX-CHP-5-0454"></a>
<p class="docText">Without using the IS_EMPTY shorthand, write a <span class="docEmphStrong">Tutorial D</span> expression that returns TRUE if the current value of the parts relvar P is empty and FALSE otherwise. Also show an SQL analog of that expression.</P>

<a name="databaseid-CHP-5-SECT-11.1.20"></a>
<H5 class="docSection3Title">Exercise 5-20.</H5>
<p class="docText">Write <span class="docEmphStrong">Tutorial D</span> and/or SQL expressions for the following queries on the suppliers-and-parts database:</P>
<div style="font-weight:bold"><ol class="docList" type="a"><LI><div style="font-weight:normal"><p class="docList">Get all shipments.</p></div></li><LI><div style="font-weight:normal"><p class="docList">Get supplier numbers for suppliers who supply part P1.</P></div></li><li><div style="font-weight:normal"><p class="docList">Get suppliers with status in the range 15 to 25 inclusive.</p></div></li><LI><div style="font-weight:normal"><p class="docList">Get part numbers for parts supplied by a supplier in London.</p></div></LI><li><div style="font-weight:normal"><p class="docList">Get part numbers for parts not supplied by any supplier in London.</P></div></LI><LI><div style="font-weight:normal"><p class="docList">Get city names for cities in which at least two suppliers are located.</P></div></li><li><div style="font-weight:normal"><p class="docList">Get all pairs of part numbers such that some supplier supplies both of the indicated parts.</p></div></li><li><div style="font-weight:normal"><p class="docList">Get the total number of parts supplied by supplier S1.</p></div></li><li><div style="font-weight:normal"><p class="docList">Get supplier numbers for suppliers with a status lower than that of supplier S1.</p></div></li><li><div style="font-weight:normal"><p class="docList">Get supplier numbers for suppliers whose city is first in the alphabetic list of such cities.</p></div></li><li><div style="font-weight:normal"><p class="docList">Get part numbers for parts supplied by all suppliers in London.</P></div></li><li><div style="font-weight:normal"><p class="docList">Get supplier-number/part-number pairs such that the indicated supplier does not supply the indicated part.</p></div></li><LI><div style="font-weight:normal"><p class="docList">Get suppliers who supply at least all parts supplied by supplier S2.</P></div></li><LI><div style="font-weight:normal"><p class="docList">Get supplier numbers for suppliers who supply at least all parts supplied by at least one supplier who supplies at least one London part.</P></div></LI></ol></div>

<a name="databaseid-CHP-5-SECT-11.1.21"></a>
<h5 class="docSection3Title">Exercise 5-21.</H5>
<p class="docText">Prove the following statements (making them more precise, where necessary):</P>
<div style="font-weight:bold"><ol class="docList" type="a"><LI><div style="font-weight:normal"><p class="docList">A sequence of restrictions against a given relation can be transformed into a single restriction.</P></div></LI><LI><div style="font-weight:normal"><p class="docList">A sequence of projections against a given relation can be transformed into a single projection.</p></div></li><LI><div style="font-weight:normal"><p class="docList">A restriction of a projection can be transformed into a projection of a restriction.</P></div></li></ol></div>

<a name="databaseid-CHP-5-SECT-11.1.22"></a>
<h5 class="docSection3Title">Exercise 5-22.</h5>
<p class="docText">Union is said to be <span class="docEmphasis">idempotent</span>, because <span class="docEmphasis">r</span> UNION <span class="docEmphasis">r</span> is identically equal to <span class="docEmphasis">r</span> for all <span class="docEmphasis">r</span>. (Is this true in SQL?) As you might expect, idempotence can be useful in expression transformation. Which other relational operators (if any) are idempotent?</p>

<a name="databaseid-CHP-5-SECT-11.1.23"></a>
<H5 class="docSection3Title">Exercise 5-23.</h5>
<a name="IDX-CHP-5-0455"></a><a name="IDX-CHP-5-0456"></a>
<p class="docText">Let <span class="docEmphasis">r</span> be a relation. What does the expression <span class="docEmphasis">r</span>{ } mean? What does it return?</P>

<a name="databaseid-CHP-5-SECT-11.1.24"></a>
<h5 class="docSection3Title">Exercise 5-24.</H5>
<p class="docText">The following boolean expression:</P>
<pre>
  <span class="docEmphasis">x</span> &gt; <span class="docEmphasis">y</span> AND <span class="docEmphasis">y</span> &gt; 3
</pre><BR>

<p class="docText">(which might be part of a query) is clearly equivalent to—and can therefore be transformed into—the following:</P>
<pre>
  <span class="docEmphasis">x</span> &gt; <span class="docEmphasis">y</span> AND <span class="docEmphasis">y</span> &gt; 3 AND <span class="docEmphasis">x</span> &gt; 3
</pre><br>

<p class="docText">The equivalence is based on the fact that the comparison operator "&gt;" is <span class="docEmphasis">transitive</span>. The transformation is worth making if <span class="docEmphasis">x</span> and <span class="docEmphasis">y</span> are from different relations, because it enables the system to perform an additional restriction (using <span class="docEmphasis">x</span> &gt; 3) before doing the greater-than join implied by <span class="docEmphasis">x</span> &gt; <span class="docEmphasis">y</span>. As we saw in the body of the chapter, doing restrictions early is generally a good idea; having the system <span class="docEmphasis">infer</span> additional "early" restrictions, as here, is also a good idea. Do you know of any commercial products that actually perform this kind of optimization?</p>

<a name="databaseid-CHP-5-SECT-11.1.25"></a>
<h5 class="docSection3Title">Exercise 5-25.</h5>
<p class="docText">Consider the following expressions:</p>
<pre>
  a. WITH ( P WHERE COLOR = 'Purple' ) AS PP ,
      ( SP RENAME ( SNO AS X ) ) AS T :
     S WHERE ( T WHERE X = SNO ) { PNO } <img src=images/ent/U2287.GIF border=0> PP { PNO }

  b. WITH ( P WHERE COLOR = 'Purple' ) AS PP :
     S JOIN ( SP { SNO, PNO } DIVIDEBY PP { PNO } )
</pre><br>

<p class="docText">These are both attempts at formulating the query "Get suppliers who supply every purple part." Given our usual sample data values, show the result returned in each case. Which result (and which formulation), if either, do you regard as correct? Justify your answer.</p>

<a name="databaseid-CHP-5-SECT-11.1.26"></a>
<h5 class="docSection3Title">Exercise 5-26.</h5>
<p class="docText">Consider the restriction <span class="docEmphasis">r</span> WHERE <span class="docEmphasis">bx</span>. In the body of the chapter, I said that every attribute mentioned in the restriction condition <span class="docEmphasis">bx</span> must be an attribute of <span class="docEmphasis">r</span>, but I also mentioned that <span class="docEmphasis">bx</span> was subject to certain further limitations. One of those limitations<sup class="docFootnote"><a class="docLink" href="#databaseid-CHP-5-FNOTE-15">[*]</a></sup> is that, strictly speaking, <span class="docEmphasis">bx</span> is supposed to consist of just a single term of the form <span class="docEmphasis">x Op y</span>,where each of <span class="docEmphasis">x</span> and <span class="docEmphasis">y</span> is either an attribute of <span class="docEmphasis">r</span> or a literal and <span class="docEmphasis">Op</span> is a comparison operator that makes sense for <span class="docEmphasis">x</span> and <span class="docEmphasis">y</span>. But a real language will allow WHERE clauses to contain boolean expressions of arbitrary complexity, just as long as the only "free variables" (see <a class="docLink" href="databaseid-appa.html#databaseid-appa">Appendix A</a>) in that expression are attributes of <span class="docEmphasis">r</span>. Show that it's legitimate to extend the definition of restrict in such ways—that is, show that such extensions are really just shorthand for something we already know is legitimate.</p><blockquote><p class="docFootnote"><sup><a name="databaseid-CHP-5-FNOTE-15">[*]</a></sup> Another is that <span class="docEmphasis">bx</span> mustn't involve any quantifiers, nor must it be equivalent to an expression that does (see <a class="docLink" href="databaseid-appa.html#databaseid-appa">Appendix A</a>).</p></blockquote>

<a name="databaseid-CHP-5-SECT-11.1.27"></a>
<h5 class="docSection3Title">Exercise 5-27.</h5>
<p class="docText">Here are two simple expressions involving relation R4 from <a class="docLink" href="databaseid-CHP-5-SECT-5.html#databaseid-CHP-5-FIG-1">Figure 5-1</a> in the body of the chapter. What queries do they represent?</p>
<pre>
  ( R4 WHERE TUPLE { PNO PNO('P2') } <img src=images/ent/U220A.GIF border=0>PNO_REL ) { SNO }

  ( ( R4 WHERE SNO = SNO('S2') ) UNGROUP ( PNO_REL ) ) { PNO }
</pre><BR>


<a name="databaseid-CHP-5-SECT-11.1.28"></a>
<h5 class="docSection3Title">Exercise 5-28.</h5>
<a name="IDX-CHP-5-0457"></a>
<p class="docText">Given our usual sample values for the suppliers-and-parts database, what does the following expression denote?</p>
<pre>
  EXTEND S
     ADD ( ( ( SP RENAME ( SNO AS X ) ) WHERE X = SNO ) { PNO }
      AS PNO_REL )
</pre><br>


<a name="databaseid-CHP-5-SECT-11.1.29"></a>
<H5 class="docSection3Title">Exercise 5-29.</H5>
<p class="docText">Let the relation returned by the expression in the previous exercise be kept as a relvar called SSP. What do the following updates do?</p>
<pre>
  INSERT SSP RELATION
    { TUPLE { SNO SNO('S6'),
        PNO_REL RELATION { TUPLE { PNO PNO('P5') } } } } ;

  UPDATE SSP WHERE SNO = SNO('S2')
    ( INSERT PNO_REL RELATION { TUPLE { PNO PNO('P5') } } ) ;
</pre><BR>


<a name="databaseid-CHP-5-SECT-11.1.30"></a>
<H5 class="docSection3Title">Exercise 5-30.</H5>
<p class="docText">Using relvar SSP from the previous exercise, write expressions for the following queries:</p>
<UL><LI><p class="docList">Get pairs of supplier numbers for suppliers who supply exactly the same set of parts.</P></LI><LI><p class="docList">Get pairs of part numbers for parts supplied by exactly the same set of supliers.</P></li></ul>

<a name="databaseid-CHP-5-SECT-11.1.31"></a>
<H5 class="docSection3Title">Exercise 5-31.</H5>
<p class="docText">A <span class="docEmphasis">quota query</span><a name="IDX-CHP-5-0458"></a> is a query that specifies a desired limit, or quota, on the cardinality of the result: for example, the query "Get the three heaviest parts," for which the specified quota is three. Give <span class="docEmphStrong">Tutorial D</span> and SQL formulations of this query.</p>



<ul></ul></td></TR></table>
<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#e6e6e6">
<tr style="background-image: url(images/tile_back.gif);">
<td class="v2" align="left" width="30%">
<a href="databaseid-CHP-5-SECT-10.html"><img src="images/previous.gif" width="70" height="19" border="0" align="absmiddle" alt="Previous Section"></a>
</td>
<td class="v2" align="center" width="40%">
<a href="main.html" style="color:white;text-decoration:none;text-underline:none">&nbsp;&lt;&nbsp;Day Day Up&nbsp;&gt;&nbsp;</a>
</td>
<td class="v2" align="right" width="30%">
<a href="databaseid-CHP-6.html"><img src="images/next.gif" width="70" height="19" border="0" align="absmiddle" alt="Next Section"></a>
</td>
</tr>
</table>
</body>
</html>
